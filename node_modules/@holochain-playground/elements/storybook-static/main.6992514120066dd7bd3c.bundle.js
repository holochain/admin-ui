/*! For license information please see main.6992514120066dd7bd3c.bundle.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1160:function(module,exports,__webpack_require__){"use strict";__webpack_require__(9),__webpack_require__(5),__webpack_require__(62),__webpack_require__(178),__webpack_require__(54),__webpack_require__(55),__webpack_require__(199),__webpack_require__(39),__webpack_require__(47);var _clientApi=__webpack_require__(80),_clientLogger=__webpack_require__(58),_configFilename=__webpack_require__(1161);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}(_configFilename.args||_configFilename.argTypes)&&_clientLogger.logger.warn("Invalid args/argTypes in config, ignoring.",JSON.stringify({args:_configFilename.args,argTypes:_configFilename.argTypes})),_configFilename.decorators&&_configFilename.decorators.forEach((function(decorator){return(0,_clientApi.addDecorator)(decorator,!1)})),_configFilename.loaders&&_configFilename.loaders.forEach((function(loader){return(0,_clientApi.addLoader)(loader,!1)})),(_configFilename.parameters||_configFilename.globals||_configFilename.globalTypes)&&(0,_clientApi.addParameters)(_objectSpread(_objectSpread({},_configFilename.parameters),{},{globals:_configFilename.globals,globalTypes:_configFilename.globalTypes}),!1),_configFilename.argTypesEnhancers&&_configFilename.argTypesEnhancers.forEach((function(enhancer){return(0,_clientApi.addArgTypesEnhancer)(enhancer)}))},1161:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"parameters",(function(){return parameters}));var _storybook_web_components__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(249),_custom_elements_json__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(586),_dist__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(186);Object(_storybook_web_components__WEBPACK_IMPORTED_MODULE_0__.setCustomElements)(_custom_elements_json__WEBPACK_IMPORTED_MODULE_1__);var parameters={actions:{argTypesRegex:"^on[A-Z].*"}};customElements.define("holochain-playground-container",_dist__WEBPACK_IMPORTED_MODULE_2__.e),customElements.define("dht-cells",_dist__WEBPACK_IMPORTED_MODULE_2__.b),customElements.define("source-chain",_dist__WEBPACK_IMPORTED_MODULE_2__.f),customElements.define("entry-graph",_dist__WEBPACK_IMPORTED_MODULE_2__.d),customElements.define("entry-contents",_dist__WEBPACK_IMPORTED_MODULE_2__.c),customElements.define("call-zome-fns",_dist__WEBPACK_IMPORTED_MODULE_2__.a)},1214:function(module,exports,__webpack_require__){"use strict";(function(module){(0,__webpack_require__(249).configure)([__webpack_require__(1215),__webpack_require__(1216)],module,!1)}).call(this,__webpack_require__(168)(module))},1215:function(module,exports){function webpackEmptyContext(req){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}webpackEmptyContext.keys=function(){return[]},webpackEmptyContext.resolve=webpackEmptyContext,module.exports=webpackEmptyContext,webpackEmptyContext.id=1215},1216:function(module,exports,__webpack_require__){var map={"./elements/call-zome-fns/call-zome-fns.stories.js":1217,"./elements/dht-cells/dht-cells.stories.js":1218,"./elements/entry-contents/entry-contents.stories.js":1219,"./elements/entry-graph/entry-graph.stories.js":1220,"./elements/source-chain/source-chain.stories.js":1221};function webpackContext(req){var id=webpackContextResolve(req);return __webpack_require__(id)}function webpackContextResolve(req){if(!__webpack_require__.o(map,req)){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}return map[req]}webpackContext.keys=function webpackContextKeys(){return Object.keys(map)},webpackContext.resolve=webpackContextResolve,module.exports=webpackContext,webpackContext.id=1216},1217:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"Simple",(function(){return Simple}));__webpack_require__(9),__webpack_require__(5),__webpack_require__(62),__webpack_require__(178),__webpack_require__(54),__webpack_require__(55),__webpack_require__(199),__webpack_require__(39),__webpack_require__(47),__webpack_require__(10),__webpack_require__(41);var _templateObject,lit_element__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(0);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}__webpack_exports__.default={title:"Call Zome Fns",component:"call-zome-fns"};var Simple=function Simple(){return Object(lit_element__WEBPACK_IMPORTED_MODULE_11__.e)(_templateObject||(_templateObject=function _taggedTemplateLiteral(strings,raw){return raw||(raw=strings.slice(0)),Object.freeze(Object.defineProperties(strings,{raw:{value:Object.freeze(raw)}}))}(["\n    <holochain-playground-container\n      .numberOfSimulatedConductors=","\n      @ready=",'\n    >\n      <call-zome-fns style="flex: 1; min-height: 500px;"></call-zome-fns>\n    </holochain-playground-container>\n  '])),1,(function(e){var cellId=e.detail.conductors[0].getAllCells()[0].cellId;e.target.activeAgentPubKey=cellId[1]}))};Simple.parameters=function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}({storySource:{source:'() => {\n  return html`\n    <holochain-playground-container\n      .numberOfSimulatedConductors=${1}\n      @ready=${(e) => {\n        const conductor = e.detail.conductors[0];\n\n        const cellId = conductor.getAllCells()[0].cellId;\n\n        e.target.activeAgentPubKey = cellId[1];\n      }}\n    >\n      <call-zome-fns style="flex: 1; min-height: 500px;"></call-zome-fns>\n    </holochain-playground-container>\n  `;\n}'}},Simple.parameters)},1218:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"Simple",(function(){return Simple}));__webpack_require__(9),__webpack_require__(5),__webpack_require__(62),__webpack_require__(178),__webpack_require__(54),__webpack_require__(55),__webpack_require__(199),__webpack_require__(39),__webpack_require__(47),__webpack_require__(10),__webpack_require__(41);var _templateObject,lit_element__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(0);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}__webpack_exports__.default={title:"DHT Cells",component:"dht-cells"};var Simple=function Simple(){return Object(lit_element__WEBPACK_IMPORTED_MODULE_11__.e)(_templateObject||(_templateObject=function _taggedTemplateLiteral(strings,raw){return raw||(raw=strings.slice(0)),Object.freeze(Object.defineProperties(strings,{raw:{value:Object.freeze(raw)}}))}(['\n  <holochain-playground-container>\n    <dht-cells style="flex: 1; min-height: 700px;"></dht-cells>\n  </holochain-playground-container>\n'])))};Simple.parameters=function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}({storySource:{source:'() => html`\n  <holochain-playground-container>\n    <dht-cells style="flex: 1; min-height: 700px;"></dht-cells>\n  </holochain-playground-container>\n`'}},Simple.parameters)},1219:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"Simple",(function(){return Simple}));__webpack_require__(9),__webpack_require__(5),__webpack_require__(62),__webpack_require__(178),__webpack_require__(54),__webpack_require__(55),__webpack_require__(199),__webpack_require__(39),__webpack_require__(47),__webpack_require__(10),__webpack_require__(41);var _templateObject,lit_element__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(0);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}__webpack_exports__.default={title:"Entry Contents",component:"entry-contents"};var Simple=function Simple(){return Object(lit_element__WEBPACK_IMPORTED_MODULE_11__.e)(_templateObject||(_templateObject=function _taggedTemplateLiteral(strings,raw){return raw||(raw=strings.slice(0)),Object.freeze(Object.defineProperties(strings,{raw:{value:Object.freeze(raw)}}))}(["\n    <holochain-playground-container\n      .numberOfSimulatedConductors=","\n      @ready=",'\n    >\n      <entry-contents style="flex: 1; min-height: 300px;"></entry-contents>\n    </holochain-playground-container>\n  '])),1,(function(e){var cellId=e.detail.conductors[0].getAllCells()[0].cellId;e.target.activeAgentPubKey=cellId[1],e.target.activeHash=cellId[1]}))};Simple.parameters=function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}({storySource:{source:'() => {\n  return html`\n    <holochain-playground-container\n      .numberOfSimulatedConductors=${1}\n      @ready=${(e) => {\n        const conductor = e.detail.conductors[0];\n\n        const cellId = conductor.getAllCells()[0].cellId;\n\n        e.target.activeAgentPubKey = cellId[1];\n        e.target.activeHash = cellId[1];\n      }}\n    >\n      <entry-contents style="flex: 1; min-height: 300px;"></entry-contents>\n    </holochain-playground-container>\n  `;\n}'}},Simple.parameters)},1220:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"Simple",(function(){return Simple}));__webpack_require__(9),__webpack_require__(5),__webpack_require__(62),__webpack_require__(178),__webpack_require__(54),__webpack_require__(55),__webpack_require__(199),__webpack_require__(39),__webpack_require__(47),__webpack_require__(10),__webpack_require__(41);var _templateObject,lit_element__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(0);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}__webpack_exports__.default={title:"Entry Graph",component:"entry-graph"};var Simple=function Simple(){return Object(lit_element__WEBPACK_IMPORTED_MODULE_11__.e)(_templateObject||(_templateObject=function _taggedTemplateLiteral(strings,raw){return raw||(raw=strings.slice(0)),Object.freeze(Object.defineProperties(strings,{raw:{value:Object.freeze(raw)}}))}(["\n    <holochain-playground-container\n      .numberOfSimulatedConductors=","\n      @ready=",'\n    >\n      <entry-graph style="flex: 1; min-height: 300px;"></entry-graph>\n    </holochain-playground-container>\n  '])),1,(function(e){var conductor=e.detail.conductors[0],cellId=conductor.getAllCells()[0].cellId;conductor.callZomeFn({cellId:cellId,zome:"demo_entries",fnName:"create_entry",payload:{content:{test:"bon dia pel matí!"},entry_type:"haha"},cap:null}),e.target.activeAgentPubKey=cellId[1]}))};Simple.parameters=function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}({storySource:{source:"() => {\n  return html`\n    <holochain-playground-container\n      .numberOfSimulatedConductors=${1}\n      @ready=${(e) => {\n        const conductor = e.detail.conductors[0];\n\n        const cellId = conductor.getAllCells()[0].cellId;\n        conductor.callZomeFn({\n          cellId,\n          zome: 'demo_entries',\n          fnName: 'create_entry',\n          payload: {\n            content: { test: 'bon dia pel matí!' },\n            entry_type: 'haha',\n          },\n          cap: null,\n        });\n\n        e.target.activeAgentPubKey = cellId[1];\n      }}\n    >\n      <entry-graph style=\"flex: 1; min-height: 300px;\"></entry-graph>\n    </holochain-playground-container>\n  `;\n}"}},Simple.parameters)},1221:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"Simple",(function(){return Simple}));__webpack_require__(9),__webpack_require__(5),__webpack_require__(62),__webpack_require__(178),__webpack_require__(54),__webpack_require__(55),__webpack_require__(199),__webpack_require__(39),__webpack_require__(47),__webpack_require__(10),__webpack_require__(41);var _templateObject,lit_element__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(0);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}__webpack_exports__.default={title:"Source Chain",component:"source-chain"};var Simple=function Simple(){return Object(lit_element__WEBPACK_IMPORTED_MODULE_11__.e)(_templateObject||(_templateObject=function _taggedTemplateLiteral(strings,raw){return raw||(raw=strings.slice(0)),Object.freeze(Object.defineProperties(strings,{raw:{value:Object.freeze(raw)}}))}(["\n    <holochain-playground-container\n      .numberOfSimulatedConductors=","\n      @ready=",'\n    >\n      <source-chain\n        style="flex: 1; min-height: 400px;"\n      ></source-chain>\n    </holochain-playground-container>\n  '])),1,(function(e){var conductor=e.detail.conductors[0],cellId=conductor.getAllCells()[0].cellId;conductor.callZomeFn({cellId:cellId,zome:"demo_entries",fnName:"create_entry",payload:{content:{test:"bon dia pel matí!"},entry_type:"haha"},cap:null}),e.target.activeAgentPubKey=cellId[1]}))};Simple.parameters=function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}({storySource:{source:"() => {\n  return html`\n    <holochain-playground-container\n      .numberOfSimulatedConductors=${1}\n      @ready=${(e) => {\n        const conductor = e.detail.conductors[0];\n\n        const cellId = conductor.getAllCells()[0].cellId;\n        conductor.callZomeFn({\n          cellId,\n          zome: 'demo_entries',\n          fnName: 'create_entry',\n          payload: {\n            content: { test: 'bon dia pel matí!' },\n            entry_type: 'haha',\n          },\n          cap: null,\n        });\n\n        e.target.activeAgentPubKey = cellId[1];\n      }}\n    >\n      <source-chain\n        style=\"flex: 1; min-height: 400px;\"\n      ></source-chain>\n    </holochain-playground-container>\n  `;\n}"}},Simple.parameters)},186:function(module,__webpack_exports__,__webpack_require__){"use strict";(function(global,setImmediate){__webpack_require__.d(__webpack_exports__,"a",(function(){return CallZomeFns})),__webpack_require__.d(__webpack_exports__,"b",(function(){return DhtCells})),__webpack_require__.d(__webpack_exports__,"c",(function(){return EntryContents})),__webpack_require__.d(__webpack_exports__,"d",(function(){return EntryGraph})),__webpack_require__.d(__webpack_exports__,"e",(function(){return HolochainPlaygroundContainer})),__webpack_require__.d(__webpack_exports__,"f",(function(){return SourceChain}));__webpack_require__(245),__webpack_require__(39),__webpack_require__(1162),__webpack_require__(37),__webpack_require__(217),__webpack_require__(178),__webpack_require__(47),__webpack_require__(9),__webpack_require__(278),__webpack_require__(28),__webpack_require__(62),__webpack_require__(103),__webpack_require__(6),__webpack_require__(102),__webpack_require__(131),__webpack_require__(54),__webpack_require__(55),__webpack_require__(147),__webpack_require__(35),__webpack_require__(489),__webpack_require__(197),__webpack_require__(94),__webpack_require__(38),__webpack_require__(22),__webpack_require__(237),__webpack_require__(1163),__webpack_require__(21),__webpack_require__(1164),__webpack_require__(1166),__webpack_require__(111),__webpack_require__(96),__webpack_require__(350),__webpack_require__(82),__webpack_require__(8),__webpack_require__(1167),__webpack_require__(32),__webpack_require__(545),__webpack_require__(1168),__webpack_require__(19),__webpack_require__(30),__webpack_require__(382),__webpack_require__(10),__webpack_require__(548),__webpack_require__(1170),__webpack_require__(25),__webpack_require__(5),__webpack_require__(17),__webpack_require__(29),__webpack_require__(23),__webpack_require__(27),__webpack_require__(150),__webpack_require__(387),__webpack_require__(547),__webpack_require__(1171),__webpack_require__(512),__webpack_require__(243),__webpack_require__(238),__webpack_require__(1172),__webpack_require__(554),__webpack_require__(480),__webpack_require__(171),__webpack_require__(1173),__webpack_require__(1178),__webpack_require__(1180),__webpack_require__(1181),__webpack_require__(1182),__webpack_require__(1184),__webpack_require__(1185),__webpack_require__(1186),__webpack_require__(1187),__webpack_require__(1188),__webpack_require__(1189),__webpack_require__(1190),__webpack_require__(1191),__webpack_require__(1193),__webpack_require__(1194),__webpack_require__(1195),__webpack_require__(1196),__webpack_require__(1197),__webpack_require__(1198),__webpack_require__(1199),__webpack_require__(1200),__webpack_require__(1201),__webpack_require__(1202),__webpack_require__(1203),__webpack_require__(1204),__webpack_require__(1205),__webpack_require__(1206),__webpack_require__(1207),__webpack_require__(1208),__webpack_require__(130),__webpack_require__(244),__webpack_require__(1209),__webpack_require__(191),__webpack_require__(41),__webpack_require__(460),__webpack_require__(462),__webpack_require__(461);var _templateObject,_templateObject2,_templateObject3,_templateObject4,_templateObject5,_templateObject6,_templateObject7,_templateObject8,_templateObject9,_templateObject10,_templateObject11,_templateObject12,_templateObject13,_templateObject14,_templateObject15,_templateObject16,_templateObject17,_templateObject18,_templateObject19,_templateObject20,_templateObject21,_templateObject22,_templateObject23,_templateObject24,_templateObject25,_templateObject26,_templateObject27,_templateObject28,_templateObject29,_templateObject30,_templateObject31,_templateObject32,_templateObject33,_templateObject34,_templateObject35,_templateObject36,_templateObject37,_templateObject38,_templateObject39,_templateObject40,_templateObject41,_templateObject42,_templateObject43,_templateObject44,_templateObject45,_templateObject46,_templateObject47,_templateObject48,_templateObject49,_templateObject50,_templateObject51,_templateObject52,_templateObject53,_templateObject54,_templateObject55,_templateObject56,_templateObject57,_templateObject58,_templateObject59,_templateObject60,_templateObject61,_templateObject62,_templateObject63,_templateObject64,_templateObject65,_templateObject66,_templateObject67,_templateObject68,_templateObject69,_templateObject70,_templateObject71,_templateObject72,_templateObject73,_templateObject74,_templateObject75,_templateObject76,_templateObject77,_templateObject78,_templateObject79,_templateObject80,_templateObject81,_templateObject82,_templateObject83,_templateObject84,_templateObject85,_templateObject86,_templateObject87,_templateObject88,_templateObject89,_templateObject90,_templateObject91,_templateObject92,_templateObject93,_templateObject94,_templateObject95,scoped_material_components_mwc_snackbar__WEBPACK_IMPORTED_MODULE_98__=__webpack_require__(414),scoped_material_components_mwc_circular_progress__WEBPACK_IMPORTED_MODULE_99__=__webpack_require__(415),scoped_material_components_mwc_icon_button__WEBPACK_IMPORTED_MODULE_100__=__webpack_require__(160),lit_element_context__WEBPACK_IMPORTED_MODULE_101__=__webpack_require__(416),lit_element__WEBPACK_IMPORTED_MODULE_102__=__webpack_require__(0),_open_wc_scoped_elements__WEBPACK_IMPORTED_MODULE_103__=__webpack_require__(121),_holochain_playground_core__WEBPACK_IMPORTED_MODULE_104__=__webpack_require__(20),scoped_material_components_mwc_textfield__WEBPACK_IMPORTED_MODULE_105__=__webpack_require__(256),scoped_material_components_mwc_button__WEBPACK_IMPORTED_MODULE_106__=__webpack_require__(158),scoped_material_components_mwc_icon__WEBPACK_IMPORTED_MODULE_107__=__webpack_require__(255),lit_html_directives_style_map__WEBPACK_IMPORTED_MODULE_108__=__webpack_require__(36),scoped_material_components_mwc_tab__WEBPACK_IMPORTED_MODULE_109__=__webpack_require__(409),scoped_material_components_mwc_tab_bar__WEBPACK_IMPORTED_MODULE_110__=__webpack_require__(412),scoped_material_components_mwc_card__WEBPACK_IMPORTED_MODULE_111__=__webpack_require__(159),scoped_material_components_mwc_list_item__WEBPACK_IMPORTED_MODULE_112__=__webpack_require__(136),scoped_material_components_mwc_list__WEBPACK_IMPORTED_MODULE_113__=__webpack_require__(410),scoped_material_components_mwc_drawer__WEBPACK_IMPORTED_MODULE_114__=__webpack_require__(589),scoped_material_components_mwc_dialog__WEBPACK_IMPORTED_MODULE_115__=__webpack_require__(187),scoped_material_components_mwc_menu_surface__WEBPACK_IMPORTED_MODULE_116__=__webpack_require__(587),scoped_material_components_mwc_slider__WEBPACK_IMPORTED_MODULE_117__=__webpack_require__(588),scoped_material_components_mwc_switch__WEBPACK_IMPORTED_MODULE_118__=__webpack_require__(590),lit_html__WEBPACK_IMPORTED_MODULE_119__=__webpack_require__(14),scoped_material_components_mwc_linear_progress__WEBPACK_IMPORTED_MODULE_120__=__webpack_require__(411),scoped_material_components_mwc_formfield__WEBPACK_IMPORTED_MODULE_121__=__webpack_require__(413),rxjs__WEBPACK_IMPORTED_MODULE_122__=__webpack_require__(1227),scoped_material_components_mwc_menu__WEBPACK_IMPORTED_MODULE_123__=__webpack_require__(216),lodash_es__WEBPACK_IMPORTED_MODULE_124__=__webpack_require__(418),lodash_es__WEBPACK_IMPORTED_MODULE_125__=__webpack_require__(417),scoped_material_components_mwc_checkbox__WEBPACK_IMPORTED_MODULE_126__=__webpack_require__(591),_holochain_open_dev_core_types__WEBPACK_IMPORTED_MODULE_127__=__webpack_require__(16);function _wrapNativeSuper(Class){var _cache="function"==typeof Map?new Map:void 0;return(_wrapNativeSuper=function _wrapNativeSuper(Class){if(null===Class||!function _isNativeFunction(fn){return-1!==Function.toString.call(fn).indexOf("[native code]")}(Class))return Class;if("function"!=typeof Class)throw new TypeError("Super expression must either be null or a function");if(void 0!==_cache){if(_cache.has(Class))return _cache.get(Class);_cache.set(Class,Wrapper)}function Wrapper(){return _construct(Class,arguments,_getPrototypeOf(this).constructor)}return Wrapper.prototype=Object.create(Class.prototype,{constructor:{value:Wrapper,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(Wrapper,Class)})(Class)}function _construct(Parent,args,Class){return(_construct=_isNativeReflectConstruct()?Reflect.construct:function _construct(Parent,args,Class){var a=[null];a.push.apply(a,args);var instance=new(Function.bind.apply(Parent,a));return Class&&_setPrototypeOf(instance,Class.prototype),instance}).apply(null,arguments)}function _slicedToArray2(arr,i){return function _arrayWithHoles2(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit2(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||_unsupportedIterableToArray(arr,i)||function _nonIterableRest2(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(iter))return Array.from(iter)}(arr)||_unsupportedIterableToArray(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"==typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e3){didErr=!0,err=_e3},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _defineProperty2(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _get(target,property,receiver){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(target,property,receiver){var base=function _superPropBase(object,property){for(;!Object.prototype.hasOwnProperty.call(object,property)&&null!==(object=_getPrototypeOf(object)););return object}(target,property);if(base){var desc=Object.getOwnPropertyDescriptor(base,property);return desc.get?desc.get.call(receiver):desc.value}})(target,property,receiver||target)}function _taggedTemplateLiteral(strings,raw){return raw||(raw=strings.slice(0)),Object.freeze(Object.defineProperties(strings,{raw:{value:Object.freeze(raw)}}))}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function _classCallCheck2(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function __defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass2(Constructor,protoProps,staticProps){return protoProps&&__defineProperties(Constructor.prototype,protoProps),staticProps&&__defineProperties(Constructor,staticProps),Constructor}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof2(call)&&"function"!=typeof call?_assertThisInitialized(self):call}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function _typeof2(obj){return(_typeof2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof2(obj){return typeof obj}:function _typeof2(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function __decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"===("undefined"==typeof Reflect?"undefined":_typeof2(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}function __metadata(metadataKey,metadataValue){if("object"===("undefined"==typeof Reflect?"undefined":_typeof2(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(metadataKey,metadataValue)}var HolochainPlaygroundContainer=function(_ProviderMixin){_inherits(HolochainPlaygroundContainer,_ProviderMixin);var _firstUpdated,_super2=_createSuper(HolochainPlaygroundContainer);function HolochainPlaygroundContainer(){var _this2;return _classCallCheck2(this,HolochainPlaygroundContainer),(_this2=_super2.apply(this,arguments)).numberOfSimulatedConductors=10,_this2.simulatedDnaTemplate=Object(_holochain_playground_core__WEBPACK_IMPORTED_MODULE_104__.f)(),_this2.conductors=[],_this2}return _createClass2(HolochainPlaygroundContainer,[{key:"firstUpdated",value:(_firstUpdated=_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var _this3=this;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(this.conductorsUrls){_context.next=6;break}return _context.next=3,Object(_holochain_playground_core__WEBPACK_IMPORTED_MODULE_104__.e)(this.numberOfSimulatedConductors,[],this.simulatedDnaTemplate);case 3:this.conductors=_context.sent,this.activeDna=this.conductors[0].getAllCells()[0].dnaHash,this.dispatchEvent(new CustomEvent("ready",{bubbles:!0,composed:!0,detail:{activeDna:this.activeDna,activeAgentPubKey:this.activeAgentPubKey,activeHash:this.activeHash,conductors:this.conductors,conductorsUrls:this.conductorsUrls}}));case 6:this.addEventListener("update-context",(function(e){for(var _i13=0,_keys2=Object.keys(e.detail);_i13<_keys2.length;_i13++){var key=_keys2[_i13];_this3[key]=e.detail[key]}})),this.addEventListener("show-message",(function(e){_this3.showMessage(e.detail.message)}));case 8:case"end":return _context.stop()}}),_callee,this)}))),function firstUpdated(){return _firstUpdated.apply(this,arguments)})},{key:"showMessage",value:function showMessage(message){this.message=message,this.snackbar.show()}},{key:"renderSnackbar",value:function renderSnackbar(){return Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject||(_templateObject=_taggedTemplateLiteral(['\n      <mwc-snackbar id="snackbar" labelText=','>\n        <mwc-icon-button icon="close" slot="dismiss"></mwc-icon-button>\n      </mwc-snackbar>\n    '])),this.message)}},{key:"render",value:function render(){return Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject2||(_templateObject2=_taggedTemplateLiteral(["\n      ","\n      ","\n    "])),this.renderSnackbar(),this.conductors?Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject3||(_templateObject3=_taggedTemplateLiteral([" <slot></slot> "]))):Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject4||(_templateObject4=_taggedTemplateLiteral([" <mwc-circular-progress></mwc-circular-progress>"]))))}}],[{key:"provide",get:function get(){return["activeDna","activeAgentPubKey","activeHash","conductors","conductorsUrls"]}},{key:"styles",get:function get(){return Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.b)(_templateObject5||(_templateObject5=_taggedTemplateLiteral(["\n      :host {\n        display: contents;\n      }\n    "])))}},{key:"scopedElements",get:function get(){return{"mwc-circular-progress":scoped_material_components_mwc_circular_progress__WEBPACK_IMPORTED_MODULE_99__.a,"mwc-snackbar":scoped_material_components_mwc_snackbar__WEBPACK_IMPORTED_MODULE_98__.a,"mwc-icon-button":scoped_material_components_mwc_icon_button__WEBPACK_IMPORTED_MODULE_100__.a}}}]),HolochainPlaygroundContainer}(Object(lit_element_context__WEBPACK_IMPORTED_MODULE_101__.b)(Object(_open_wc_scoped_elements__WEBPACK_IMPORTED_MODULE_103__.a)(lit_element__WEBPACK_IMPORTED_MODULE_102__.a)));__decorate([Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.g)({type:Number}),__metadata("design:type",Number)],HolochainPlaygroundContainer.prototype,"numberOfSimulatedConductors",void 0),__decorate([Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.g)({type:Object}),__metadata("design:type",Object)],HolochainPlaygroundContainer.prototype,"simulatedDnaTemplate",void 0),__decorate([Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.h)("#snackbar"),__metadata("design:type",scoped_material_components_mwc_snackbar__WEBPACK_IMPORTED_MODULE_98__.a)],HolochainPlaygroundContainer.prototype,"snackbar",void 0),__decorate([Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.g)({type:String}),__metadata("design:type",String)],HolochainPlaygroundContainer.prototype,"message",void 0),__decorate([Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.g)({type:String}),__metadata("design:type",String)],HolochainPlaygroundContainer.prototype,"activeDna",void 0),__decorate([Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.g)({type:String}),__metadata("design:type",String)],HolochainPlaygroundContainer.prototype,"activeAgentPubKey",void 0),__decorate([Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.g)({type:String}),__metadata("design:type",String)],HolochainPlaygroundContainer.prototype,"activeHash",void 0),__decorate([Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.g)({type:Array}),__metadata("design:type",Array)],HolochainPlaygroundContainer.prototype,"conductors",void 0),__decorate([Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.g)({type:Array}),__metadata("design:type",Array)],HolochainPlaygroundContainer.prototype,"conductorsUrls",void 0);var PlaygroundElement=function(_PlaygroundMixin){_inherits(PlaygroundElement,_PlaygroundMixin);var _super4=_createSuper(PlaygroundElement);function PlaygroundElement(){var _this5;return _classCallCheck2(this,PlaygroundElement),(_this5=_super4.apply(this,arguments))._subscriptions={},_this5._observedCells=[],_this5}return _createClass2(PlaygroundElement,[{key:"observedCells",value:function observedCells(){return[]}},{key:"onNewObservedCell",value:function onNewObservedCell(cell){return[]}},{key:"onCellsChanged",value:function onCellsChanged(){}},{key:"getStrCellId",value:function getStrCellId(cell){return"".concat(cell.dnaHash,"/").concat(cell.agentPubKey)}},{key:"updated",value:function updated(changedValues){var _this6=this;_get(_getPrototypeOf(PlaygroundElement.prototype),"updated",this).call(this,changedValues),this._observedCells=this.observedCells().filter((function(cell){return!!cell}));var _step2,newCellsById=this._observedCells.reduce((function(acc,next){return Object.assign({},acc,_defineProperty2({},_this6.getStrCellId(next),next))}),{}),newCellsIds=Object.keys(newCellsById),oldCellsIds=Object.keys(this._subscriptions),addedCellsIds=newCellsIds.filter((function(cellId){return!oldCellsIds.includes(cellId)})),removedCellsIds=oldCellsIds.filter((function(cellId){return!newCellsIds.includes(cellId)})),_iterator=_createForOfIteratorHelper(addedCellsIds);try{for(_iterator.s();!(_step2=_iterator.n()).done;){var addedCellId=_step2.value,cell=newCellsById[addedCellId],defaultSubscription=cell.workflowExecutor.success(_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:_this6.requestUpdate();case 1:case"end":return _context2.stop()}}),_callee2)}))));this._subscriptions[addedCellId]=[].concat(_toConsumableArray(this.onNewObservedCell(cell)),[defaultSubscription])}}catch(err){_iterator.e(err)}finally{_iterator.f()}removedCellsIds.forEach((function(cellId){return _this6.unsubscribeFromCellId(cellId)})),(addedCellsIds.length>0||removedCellsIds.length>0)&&this.onCellsChanged()}},{key:"unsubscribeFromCellId",value:function unsubscribeFromCellId(cellId){var _step3,_iterator2=_createForOfIteratorHelper(this._subscriptions[cellId]);try{for(_iterator2.s();!(_step3=_iterator2.n()).done;){_step3.value.unsubscribe()}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}this._subscriptions[cellId]=void 0,delete this._subscriptions[cellId]}},{key:"disconnectedCallback",value:function disconnectedCallback(){_get(_getPrototypeOf(PlaygroundElement.prototype),"disconnectedCallback",this).call(this);for(var _i14=0,_Object$values=Object.values(this._subscriptions);_i14<_Object$values.length;_i14++){var _step4,_iterator3=_createForOfIteratorHelper(_Object$values[_i14]);try{for(_iterator3.s();!(_step4=_iterator3.n()).done;){_step4.value.unsubscribe()}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}}}}]),PlaygroundElement}(function PlaygroundMixin(baseClass){var PE=function(_ConsumerMixin){_inherits(PE,_ConsumerMixin);var _super3=_createSuper(PE);function PE(){var _this4;return _classCallCheck2(this,PE),(_this4=_super3.apply(this,arguments)).conductors=[],_this4}return _createClass2(PE,[{key:"updatePlayground",value:function updatePlayground(context){this.dispatchEvent(new CustomEvent("update-context",{bubbles:!0,composed:!0,detail:context}))}},{key:"showMessage",value:function showMessage(message){this.dispatchEvent(new CustomEvent("show-message",{bubbles:!0,composed:!0,detail:{message:message}}))}}],[{key:"inject",get:function get(){return["activeDna","activeAgentPubKey","activeHash","conductors","conductorsUrls"]}}]),PE}(Object(lit_element_context__WEBPACK_IMPORTED_MODULE_101__.a)(baseClass));return __decorate([Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.g)({type:String}),__metadata("design:type",String)],PE.prototype,"activeDna",void 0),__decorate([Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.g)({type:String}),__metadata("design:type",String)],PE.prototype,"activeAgentPubKey",void 0),__decorate([Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.g)({type:String}),__metadata("design:type",String)],PE.prototype,"activeHash",void 0),__decorate([Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.g)({type:Array}),__metadata("design:type",Array)],PE.prototype,"conductors",void 0),__decorate([Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.g)({type:Array}),__metadata("design:type",Array)],PE.prototype,"conductorsUrls",void 0),PE}(Object(_open_wc_scoped_elements__WEBPACK_IMPORTED_MODULE_103__.a)(lit_element__WEBPACK_IMPORTED_MODULE_102__.a))),sharedStyles=Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.b)(_templateObject6||(_templateObject6=_taggedTemplateLiteral(["\n  .row {\n    display: flex;\n    flex-direction: row;\n  }\n  .column {\n    display: flex;\n    flex-direction: column;\n  }\n  .fill {\n    flex: 1;\n  }\n\n  .center-content {\n    align-items: center;\n    justify-content: center;\n    display: flex;\n  }\n\n  span {\n    margin-block-start: 0;\n  }\n\n  .title {\n    font-size: 20px;\n  }\n\n  .placeholder {\n    opacity: 0.6;\n  }\n\n  .flex-scrollable-parent {\n    position: relative;\n    display: flex;\n    flex: 1;\n  }\n\n  .flex-scrollable-container {\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n  }\n\n  .flex-scrollable-x {\n    max-width: 100%;\n    overflow-x: auto;\n  }\n  .flex-scrollable-y {\n    max-height: 100%;\n    overflow-y: auto;\n  }\n\n  .json-info {\n    padding: 4px;\n    max-width: 400px;\n  }\n\n  .block-card {\n    width: auto;\n    position: relative;\n    flex: 1;\n  }\n\n  .block-title {\n    font-size: 20px;\n  }\n\n  .block-help {\n    position: absolute;\n    right: 8px;\n    top: 8px;\n  }\n\n  .horizontal-divider {\n    background-color: grey;\n    height: 1px;\n    opacity: 0.3;\n    margin-bottom: 0;\n    width: 100%;\n  }\n  .vertical-divider {\n    background-color: grey;\n    width: 1px;\n    height: 60%; \n    opacity: 0.3;\n    margin-bottom: 0;\n  }\n  \n"])));function selectCells(dna,conductor){return conductor.getCells(dna)}function selectAllCells(dna,conductors){var _ref18,cells=conductors.map((function(c){return selectCells(dna,c)}));return(_ref18=[]).concat.apply(_ref18,_toConsumableArray(cells))}function selectCell(dnaHash,agentPubKey,conductors){var _step6,_iterator5=_createForOfIteratorHelper(conductors);try{for(_iterator5.s();!(_step6=_iterator5.n()).done;){var _step7,_iterator6=_createForOfIteratorHelper(_step6.value.getAllCells());try{for(_iterator6.s();!(_step7=_iterator6.n()).done;){var cell=_step7.value;if(cell.agentPubKey===agentPubKey&&cell.dnaHash===dnaHash)return cell}}catch(err){_iterator6.e(err)}finally{_iterator6.f()}}}catch(err){_iterator5.e(err)}finally{_iterator5.f()}}function selectRedundancyFactor(cell){return cell.p2p.redundancyFactor}var compose=function compose(){for(var _len2=arguments.length,fns=new Array(_len2),_key2=0;_key2<_len2;_key2++)fns[_key2]=arguments[_key2];return fns.reduce((function(f,g){return function(){return f(g.apply(void 0,arguments))}}))},isString=function isString(x){return"string"==typeof x},trim=function trim(s){return s.trim()},replace=function replace(){for(var _len3=arguments.length,args=new Array(_len3),_key3=0;_key3<_len3;_key3++)args[_key3]=arguments[_key3];return function(s){return s.replace.apply(s,args)}},stripUndefined=compose((function fromEntries(xs){return Object.fromEntries?Object.fromEntries(xs):xs.reduce((function(o,_ref19){var _ref20=_slicedToArray2(_ref19,2),k=_ref20[0],v=_ref20[1];return Object.assign(_defineProperty2({},k,v),o)}),{})}),function flatMap(f){return function(xs){return"flatMap"in Array.prototype?xs.flatMap(f):xs.reduce((function(acc,x){return acc.concat(f(x))}),[])}}((function(_ref21){var _ref22=_slicedToArray2(_ref21,2),k=_ref22[0],v=_ref22[1];return void 0===v?[]:[[k,v]]})),Object.entries),replacer=function replacer(k,v){return""===k?v:function mark(x){return x instanceof Element?"<mark part='string'>".concat(x.outerHTML.replace(/</g,"&lt;").replace(/"/g,"'"),"</mark>"):function isObject(x){return null!==x&&"[object Object]"==="".concat(x)}(x)||Array.isArray(x)?x:"<mark part='".concat(null===x?"null":_typeof2(x),"'>").concat(x,"</mark>")}(v)},markKeys=replace(/"(.*)":/g,(function(_,key){return'<mark part="key">"'.concat(key,'"</mark>:')})),json=compose(replace(/"<mark(.*)>(.*)<\/mark>"/g,(function(_,attrs,content){return"<mark".concat(attrs,">").concat(attrs.includes("string")?'"'.concat(content,'"'):content,"</mark>")})),markKeys,(function pretty(o){return JSON.stringify(o,replacer,2)}),stripUndefined),css='\n[hidden],\n:host([hidden]) {\n  display: none !important;\n}\n\n:host {\n  display: block;\n  position: relative;\n  color: var(--json-viewer-color, currentColor);\n}\n\ncode { white-space: pre; }\nmark { background: none; }\n\n@media (prefers-color-scheme: dark), (prefers-color-scheme: no-preference) {\n  :host { background: var(--json-viewer-background, #212529); }\n  [part="key"] { color: var(--json-viewer-key-color, #ff922b); }\n  [part="boolean"] { color: var(--json-viewer-boolean-color, #22b8cf); }\n  [part="number"] { color: var(--json-viewer-number-color, #51cf66); }\n  [part="null"] { color: var(--json-viewer-null-color, #ff6b6b); }\n  [part="string"] { color: var(--json-viewer-string-color, #22b8cf); }\n}\n\n@media (prefers-color-scheme: light) {\n  :host { background: var(--json-viewer-background, white); }\n  [part="key"] { color: var(--json-viewer-key-color, #f76707); }\n  [part="boolean"] { color: var(--json-viewer-boolean-color, #0c8599); }\n  [part="number"] { color: var(--json-viewer-number-color, #0ca678); }\n  [part="null"] { color: var(--json-viewer-null-color, #e03131); }\n  [part="string"] { color: var(--json-viewer-string-color, #0c8599); }\n}\n',template=document.createElement("template");template.innerHTML='<code hidden part="code"></code>';var JsonViewer=function(_HTMLElement){_inherits(JsonViewer,_HTMLElement);var _super5=_createSuper(JsonViewer);function JsonViewer(){var _this7;if(_classCallCheck2(this,JsonViewer),(_this7=_super5.call(this)).__error=null,_this7.__allowlist=[],_this7.__mo=new MutationObserver(_this7.parse.bind(_assertThisInitialized(_this7))),_this7.__mo.observe(_assertThisInitialized(_this7),{subtree:!0,characterData:!0,childList:!0}),_this7.attachShadow({mode:"open"}),"adoptedStyleSheets"in Document.prototype){var styles=new CSSStyleSheet;styles.replaceSync(css),_this7.shadowRoot.adoptedStyleSheets=[styles]}else _this7.shadowRoot.innerHTML="<style>".concat(css,"</style>");return _this7.shadowRoot.append(template.content.cloneNode(!0)),_this7}return _createClass2(JsonViewer,[{key:"object",get:function get(){return this.__object},set:function set(val){val&&"string"==typeof val&&(val=this.tryParse(val)),this.__object=val,this.render()}},{key:"allowlist",get:function get(){return this.__allowlist},set:function set(val){if(!function isAllStrings(xs){return Array.isArray(xs)&&xs.every(isString)}(val))throw new Error("allowlist must be an array of strings");this.__allowlist=val;var attr=val.join(",");attr&&this.setAttribute("allowlist",attr),this.render()}},{key:"error",get:function get(){return this.__error},set:function set(error){this.__error=error,error instanceof Error&&this.dispatchEvent(new CustomEvent("json-parse-error"))}},{key:"connectedCallback",value:function connectedCallback(){this.parse(),this.object&&this.shadowRoot.querySelector("code").hidden&&this.render()}},{key:"attributeChangedCallback",value:function attributeChangedCallback(name,oldVal,newVal){switch(name){case"allowlist":return this.allowlistAttrChanged(newVal,oldVal);case"object":return this.objectAttrChanged(newVal,oldVal)}}},{key:"allowlistAttrChanged",value:function allowlistAttrChanged(allowlist,oldVal){var next=allowlist;this.allowlist.join(",")!==next&&(this.allowlist=function toStringList(string){return(string||"").split(",").map(trim).filter(Boolean)}(next))}},{key:"objectAttrChanged",value:function objectAttrChanged(objectAttr,oldVal){objectAttr!==oldVal&&(this.object=this.tryParse(objectAttr))}},{key:"getHighlightedDomString",value:function getHighlightedDomString(){var allowlist=this.allowlist,object=this.object;if(void 0===object)return"";var objectToRender=Array.isArray(allowlist)&&allowlist.length?function pick(keys,element){return keys.reduce((function(pojo,key){return Object.assign(pojo,_defineProperty2({},key,element[key]))}),{})}(allowlist,object):object;return json(objectToRender)}},{key:"render",value:function render(){var highlighted=this.getHighlightedDomString();this.shadowRoot.querySelector("code").hidden=!highlighted,this.shadowRoot.querySelector("code").innerHTML=highlighted}},{key:"parse",value:function parse(){var _parent$textContent=(this.querySelector('script[type="application/json"]')||this.querySelector('script[type="application/ld+json"]')||this).textContent,textContent=void 0===_parent$textContent?"":_parent$textContent;textContent.trim()&&(this.object=this.tryParse(textContent))}},{key:"tryParse",value:function tryParse(string){var object;try{object=JSON.parse(string)}catch(error){object={name:error.name,message:error.message,string:string},this.error=error}return object}}],[{key:"is",get:function get(){return"json-viewer"}},{key:"observedAttributes",get:function get(){return["allowlist","object"]}}]),JsonViewer}(_wrapNativeSuper(HTMLElement));customElements.define(JsonViewer.is,JsonViewer);var ExpandableLine=function(_ScopedElementsMixin){_inherits(ExpandableLine,_ScopedElementsMixin);var _super6=_createSuper(ExpandableLine);function ExpandableLine(){var _this8;return _classCallCheck2(this,ExpandableLine),(_this8=_super6.apply(this,arguments))._expanded=!1,_this8}return _createClass2(ExpandableLine,[{key:"render",value:function render(){var _this9=this;return Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject7||(_templateObject7=_taggedTemplateLiteral(['\n      <div class="row">\n        <mwc-icon-button\n          style="--mdc-icon-button-size: 30px; margin-right: 4px;"\n          .icon=',"\n          @click=","\n        ></mwc-icon-button>\n\n        <div\n          style=","\n        >\n          <div\n            style=","\n          ></div>\n          <div\n            style=","\n          >\n            <slot></slot>\n          </div>\n        </div>\n      </div>\n    "])),this._expanded?"arrow_drop_up":"arrow_drop_down",(function(){return _this9._expanded=!_this9._expanded}),Object(lit_html_directives_style_map__WEBPACK_IMPORTED_MODULE_108__.a)({position:this._expanded?"unset":"relative",flex:"1",display:"flex"}),Object(lit_html_directives_style_map__WEBPACK_IMPORTED_MODULE_108__.a)({display:this._expanded?"none":"block","z-index":"3",position:this._expanded?"unset":"absolute",width:"100%",height:"100%","box-shadow":this._expanded?"":"inset 0 -10px 10px -10px #000000"}),Object(lit_html_directives_style_map__WEBPACK_IMPORTED_MODULE_108__.a)({height:this._expanded?"auto":"30px",width:this._expanded?"auto":"100%",overflow:this._expanded?"auto":"hidden",position:this._expanded?"unset":"absolute",flex:"1"}))}}],[{key:"styles",get:function get(){return sharedStyles}},{key:"scopedElements",get:function get(){return{"mwc-icon-button":scoped_material_components_mwc_icon_button__WEBPACK_IMPORTED_MODULE_100__.a}}}]),ExpandableLine}(Object(_open_wc_scoped_elements__WEBPACK_IMPORTED_MODULE_103__.a)(lit_element__WEBPACK_IMPORTED_MODULE_102__.a));__decorate([Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.g)({type:Boolean}),__metadata("design:type",Object)],ExpandableLine.prototype,"_expanded",void 0);var CallZomeFns=function(_PlaygroundElement){_inherits(CallZomeFns,_PlaygroundElement);var _callZomeFunction,_super7=_createSuper(CallZomeFns);function CallZomeFns(){var _this10;return _classCallCheck2(this,CallZomeFns),(_this10=_super7.apply(this,arguments)).hideResults=!1,_this10.hideZomeSelector=!1,_this10.hideAgentPubKey=!1,_this10.selectedZomeFnName=void 0,_this10._selectedZomeIndex=0,_this10._results={},_this10._arguments={},_this10}return _createClass2(CallZomeFns,[{key:"activeCell",get:function get(){return selectCell(this.activeDna,this.activeAgentPubKey,this.conductors)}},{key:"activeZome",get:function get(){return this.activeCell.getSimulatedDna().zomes[this._selectedZomeIndex]}},{key:"activeZomeFn",get:function get(){var zomeFnName=Object.keys(this.activeZome.zome_functions)[0];return this.selectedZomeFnName&&(zomeFnName=this.selectedZomeFnName),{name:zomeFnName,fn:this.activeZome.zome_functions[zomeFnName]}}},{key:"observedCells",value:function observedCells(){return[this.activeCell]}},{key:"setResultValue",value:function setResultValue(timestamp,value){var dnaHash=this.activeCell.dnaHash,agentPubKey=this.activeCell.agentPubKey;this._results[dnaHash]||(this._results[dnaHash]={}),this._results[dnaHash][agentPubKey]||(this._results[dnaHash][agentPubKey]={}),this._results[dnaHash][agentPubKey][timestamp]=value}},{key:"getResultValue",value:function getResultValue(timestamp){return this.getActiveResults()[timestamp]}},{key:"getActiveResults",value:function getActiveResults(){var dnaHash=this.activeCell.dnaHash,agentPubKey=this.activeCell.agentPubKey;return this._results[dnaHash]&&this._results[dnaHash][agentPubKey]||{}}},{key:"setFunctionArgument",value:function setFunctionArgument(fnName,argName,argValue){var dnaHash=this.activeCell.dnaHash,pubKey=this.activeCell.agentPubKey,zomeName=this.activeZome.name;this._arguments[dnaHash]||(this._arguments[dnaHash]={}),this._arguments[dnaHash][pubKey]||(this._arguments[dnaHash][pubKey]={}),this._arguments[dnaHash][pubKey][zomeName]||(this._arguments[dnaHash][pubKey][zomeName]={}),this._arguments[dnaHash][pubKey][zomeName][fnName]||(this._arguments[dnaHash][pubKey][zomeName][fnName]={}),this._arguments[dnaHash][pubKey][zomeName][fnName][argName]=argValue,this.requestUpdate()}},{key:"getFunctionArguments",value:function getFunctionArguments(fnName){var dnaHash=this.activeCell.dnaHash,agentPubKey=this.activeCell.agentPubKey,zomeName=this.activeZome.name;return this._arguments[dnaHash]&&this._arguments[dnaHash][agentPubKey]&&this._arguments[dnaHash][agentPubKey][zomeName]&&this._arguments[dnaHash][agentPubKey][zomeName][fnName]}},{key:"getFunctionArgument",value:function getFunctionArgument(fnName,argName){var dnaHash=this.activeCell.dnaHash,agentPubKey=this.activeCell.agentPubKey,zomeName=this.activeZome.name;return this._arguments[dnaHash]&&this._arguments[dnaHash][agentPubKey]&&this._arguments[dnaHash][agentPubKey][zomeName]&&this._arguments[dnaHash][agentPubKey][zomeName][fnName]&&this._arguments[dnaHash][agentPubKey][zomeName][fnName][argName]}},{key:"callZomeFunction",value:(_callZomeFunction=_asyncToGenerator(regeneratorRuntime.mark((function _callee3(fnName){var zome,timestamp,resultValue,result;return regeneratorRuntime.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return zome=this.activeZome,timestamp=Date.now(),resultValue={cellId:this.activeCell.cellId,result:void 0,fnName:fnName,zome:zome},this.setResultValue(timestamp,resultValue),this.requestUpdate(),_context3.prev=5,_context3.next=8,this.activeCell.conductor.callZomeFn({cellId:this.activeCell.cellId,zome:zome.name,payload:this.getFunctionArguments(fnName),fnName:fnName,cap:null});case 8:result=_context3.sent,resultValue.result={success:!0,payload:result},this.setResultValue(timestamp,resultValue),_context3.next=17;break;case 13:_context3.prev=13,_context3.t0=_context3.catch(5),resultValue.result={success:!1,payload:_context3.t0.message},this.setResultValue(timestamp,resultValue);case 17:return _context3.prev=17,this.requestUpdate(),_context3.finish(17);case 20:case"end":return _context3.stop()}}),_callee3,this,[[5,13,17,20]])}))),function callZomeFunction(_x7){return _callZomeFunction.apply(this,arguments)})},{key:"renderCallableFunction",value:function renderCallableFunction(fnName,zomeFunction){var _this11=this;return Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject8||(_templateObject8=_taggedTemplateLiteral([' <div class="column" style="flex: 1; margin: 16px;">\n      <div class="flex-scrollable-parent">\n        <div class="flex-scrollable-container">\n          <div class="flex-scrollable-y">\n            <div class="column" style="flex: 1;">\n              ',"\n            </div>\n          </div>\n        </div>\n      </div>\n      <mwc-button raised @click=","\n        >Execute</mwc-button\n      >\n    </div>"])),0===zomeFunction.arguments.length?Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject9||(_templateObject9=_taggedTemplateLiteral(['<span class="placeholder" style="margin-top: 28px;"\n                    >This function has no arguments</span\n                  >']))):zomeFunction.arguments.map((function(arg){return Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject10||(_templateObject10=_taggedTemplateLiteral(['<mwc-textfield\n                      style="margin-top: 8px"\n                      outlined\n                      label=',"\n                      .value=","\n                      @input=","\n                    ></mwc-textfield>"])),arg.name+": "+arg.type,_this11.getFunctionArgument(fnName,arg.name)||"",(function(e){return _this11.setFunctionArgument(fnName,arg.name,e.target.value)}))})),(function(){return _this11.callZomeFunction(fnName)}))}},{key:"renderActiveZomeFns",value:function renderActiveZomeFns(){var _this12=this,zome=this.activeCell.getSimulatedDna().zomes[this._selectedZomeIndex],zomeFns=Object.entries(zome.zome_functions);return 0===zomeFns.length?Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject11||(_templateObject11=_taggedTemplateLiteral(['<div class="fill center-content">\n        <span class="placeholder" style="padding: 24px;"\n          >This zome has no functions</span\n        >\n      </div> ']))):Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject12||(_templateObject12=_taggedTemplateLiteral(['\n      <mwc-drawer style="--mdc-drawer-width: auto;">\n        <mwc-list\n          activatable\n          @selected=',"\n        >\n          ",'\n        </mwc-list>\n        <div slot="appContent" class="column" style="height: 100%;">\n          <div class="column" style="flex: 1;">\n            ',"\n          </div>\n        </div>\n      </mwc-drawer>\n    "])),(function(e){return _this12.selectedZomeFnName=zomeFns[e.detail.index][0]}),zomeFns.map((function(_ref23){var _ref24=_slicedToArray2(_ref23,2),name=_ref24[0];_ref24[1];return Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject13||(_templateObject13=_taggedTemplateLiteral(["\n              <mwc-list-item .activated=","\n                >","\n              </mwc-list-item>\n            "])),_this12.activeZomeFn.name===name,name)})),this.renderCallableFunction(this.activeZomeFn.name,this.activeZomeFn.fn))}},{key:"renderResult",value:function renderResult(result){return result.result?result.result.payload&&"string"!=typeof result.result.payload?Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject16||(_templateObject16=_taggedTemplateLiteral(["\n        <expandable-line>\n          <json-viewer\n            .object=",'\n            class="fill"\n          ></json-viewer>\n        </expandable-line>\n      '])),result.result.payload):Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject15||(_templateObject15=_taggedTemplateLiteral(["<span>","</span>"])),result.result.payload):Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject14||(_templateObject14=_taggedTemplateLiteral(['<span class="placeholder">Executing...</span>'])))}},{key:"renderResults",value:function renderResults(){var _this13=this,results=this.getActiveResults(),sortedResults=Object.keys(results).sort().map((function(timestamp){return[timestamp,results[timestamp]]}));return Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject17||(_templateObject17=_taggedTemplateLiteral(['\n      <div class="column" style="flex: 1;">\n        ',"\n      </div>\n    "])),0===sortedResults.length?Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject18||(_templateObject18=_taggedTemplateLiteral(['\n              <div class="row fill center-content">\n                <span class="placeholder" style="margin: 0 24px;"\n                  >Call a ZomeFn to see its results</span\n                >\n              </div>\n            ']))):Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject19||(_templateObject19=_taggedTemplateLiteral([' <div class="flex-scrollable-parent">\n              <div class="flex-scrollable-container">\n                <div class="flex-scrollable-y">\n                  <div style="margin: 0 16px;">\n                    ',"\n                  </div>\n                </div>\n              </div>\n            </div>"])),sortedResults.map((function(_ref25,index){var _ref26=_slicedToArray2(_ref25,2),timestamp=_ref26[0],result=_ref26[1];return Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject20||(_templateObject20=_taggedTemplateLiteral(['\n                          <div class="column" style="flex: 1;">\n                            <div class="row" style="margin: 8px 0;">\n                              ','\n                              <div\n                                class="column"\n                                style="flex: 1; margin: 12px; margin-right: 0;"\n                              >\n                                <div class="row" style="flex: 1;">\n                                  <span style="flex: 1; margin-bottom: 8px;">\n                                    ','\n                                    <span class="placeholder">\n                                      in ',"\n                                      zome",'\n                                    </span>\n                                  </span>\n                                  <span class="placeholder">\n                                    ',"\n                                  </span>\n                                </div>\n                                ","\n                              </div>\n                            </div>\n                            ","\n                          </div>\n                        "])),result.result?Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject21||(_templateObject21=_taggedTemplateLiteral(["\n                                    <mwc-icon\n                                      style=","\n                                      >","</mwc-icon\n                                    >\n                                  "])),Object(lit_html_directives_style_map__WEBPACK_IMPORTED_MODULE_108__.a)({color:result.result.success?"green":"red","align-self":"start","margin-top":"16px","--mdc-icon-size":"36px"}),result.result.success?"check_circle_outline":"error_outline"):Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject22||(_templateObject22=_taggedTemplateLiteral(['\n                                    <mwc-circular-progress\n                                      indeterminate\n                                      density="-2"\n                                      style="align-self: center;"\n                                    ></mwc-circular-progress>\n                                  ']))),result.fnName,result.zome.name,result.result?result.result.success?", result:":", error:":"",new Date(parseInt(timestamp)).toLocaleTimeString(),_this13.renderResult(result),index<sortedResults.length-1?Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject23||(_templateObject23=_taggedTemplateLiteral(['\n                                  <span\n                                    class="horizontal-divider"\n                                    style="align-self: center;"\n                                  ></span>\n                                ']))):Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject24||(_templateObject24=_taggedTemplateLiteral([""]))))}))))}},{key:"render",value:function render(){var _this14=this;return Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject25||(_templateObject25=_taggedTemplateLiteral(['\n      <mwc-card style="width: auto; flex: 1;">\n        ',"\n      </mwc-card>\n    "])),this.activeCell?Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject26||(_templateObject26=_taggedTemplateLiteral(['\n              <div class="column" style="flex: 1">\n                <span class="title" style="margin: 16px;"\n                  >Call Zome\n                  Fns',"</span\n                >\n                ",'\n                <div class="row" style="flex: 1;">\n                  <div class="column" style="flex: 1">\n                    ',"\n                    ","\n                  </div>\n\n                  ","\n                </div>\n              </div>\n            "])),this.hideAgentPubKey?Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject27||(_templateObject27=_taggedTemplateLiteral([""]))):Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject28||(_templateObject28=_taggedTemplateLiteral([',\n                        <span class="placeholder"\n                          >for agent ',"</span\n                        > "])),this.activeAgentPubKey),this.hideZomeSelector?Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject29||(_templateObject29=_taggedTemplateLiteral([' <span class="horizontal-divider"></span> ']))):Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject30||(_templateObject30=_taggedTemplateLiteral([""]))),this.hideZomeSelector?Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject31||(_templateObject31=_taggedTemplateLiteral([""]))):Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject32||(_templateObject32=_taggedTemplateLiteral(["\n                          <mwc-tab-bar\n                            .activeIndex=","\n                            @MDCTabBar:activated=","\n                          >\n                            ","\n                          </mwc-tab-bar>\n                        "])),this._selectedZomeIndex,(function(e){_this14.selectedZomeFnName=void 0,_this14._selectedZomeIndex=e.detail.index}),this.activeCell.getSimulatedDna().zomes.map((function(zome){return Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject33||(_templateObject33=_taggedTemplateLiteral(["\n                                    <mwc-tab .label=","></mwc-tab>\n                                  "])),zome.name)}))),this.renderActiveZomeFns(),this.hideResults?Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject34||(_templateObject34=_taggedTemplateLiteral([""]))):Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject35||(_templateObject35=_taggedTemplateLiteral(['\n                        <span\n                          class="vertical-divider"\n                          style="height: 100%;"\n                        ></span>\n                        ',"\n                      "])),this.renderResults())):Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject36||(_templateObject36=_taggedTemplateLiteral(['<div class="fill center-content placeholder">\n              <span style="padding: 24px;"\n                >Select a cell to call its zome functions</span\n              >\n            </div>']))))}}],[{key:"styles",get:function get(){return[sharedStyles,Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.b)(_templateObject37||(_templateObject37=_taggedTemplateLiteral(["\n        :host {\n          display: flex;\n          flex: 1;\n        }\n      "])))]}},{key:"scopedElements",get:function get(){return{"mwc-button":scoped_material_components_mwc_button__WEBPACK_IMPORTED_MODULE_106__.a,"mwc-textfield":scoped_material_components_mwc_textfield__WEBPACK_IMPORTED_MODULE_105__.a,"mwc-circular-progress":scoped_material_components_mwc_circular_progress__WEBPACK_IMPORTED_MODULE_99__.a,"mwc-icon":scoped_material_components_mwc_icon__WEBPACK_IMPORTED_MODULE_107__.a,"mwc-tab":scoped_material_components_mwc_tab__WEBPACK_IMPORTED_MODULE_109__.a,"mwc-list":scoped_material_components_mwc_list__WEBPACK_IMPORTED_MODULE_113__.a,"mwc-drawer":scoped_material_components_mwc_drawer__WEBPACK_IMPORTED_MODULE_114__.a,"mwc-list-item":scoped_material_components_mwc_list_item__WEBPACK_IMPORTED_MODULE_112__.a,"mwc-tab-bar":scoped_material_components_mwc_tab_bar__WEBPACK_IMPORTED_MODULE_110__.a,"mwc-card":scoped_material_components_mwc_card__WEBPACK_IMPORTED_MODULE_111__.a,"json-viewer":JsonViewer,"expandable-line":ExpandableLine}}}]),CallZomeFns}(PlaygroundElement);__decorate([Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.g)({type:Boolean,attribute:"hide-results"}),__metadata("design:type",Object)],CallZomeFns.prototype,"hideResults",void 0),__decorate([Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.g)({type:Boolean,attribute:"hide-zome-selector"}),__metadata("design:type",Object)],CallZomeFns.prototype,"hideZomeSelector",void 0),__decorate([Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.g)({type:Boolean,attribute:"hide-agent-pub-key"}),__metadata("design:type",Object)],CallZomeFns.prototype,"hideAgentPubKey",void 0),__decorate([Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.g)({type:String}),__metadata("design:type",String)],CallZomeFns.prototype,"selectedZomeFnName",void 0),__decorate([Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.g)({type:Number}),__metadata("design:type",Number)],CallZomeFns.prototype,"_selectedZomeIndex",void 0),__decorate([Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.g)({type:Array}),__metadata("design:type",Object)],CallZomeFns.prototype,"_results",void 0);var DhtShard=function(_PlaygroundElement2){_inherits(DhtShard,_PlaygroundElement2);var _super8=_createSuper(DhtShard);function DhtShard(){var _this15;return _classCallCheck2(this,DhtShard),(_this15=_super8.apply(this,arguments)).cell=void 0,_this15}return _createClass2(DhtShard,[{key:"activeCell",get:function get(){return selectCell(this.activeDna,this.activeAgentPubKey,this.conductors)||selectAllCells(this.activeDna,this.conductors)[0]}},{key:"render",value:function render(){return Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject38||(_templateObject38=_taggedTemplateLiteral(['\n      <div class="column">\n        ',"\n      </div>\n    "])),this.activeCell?Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject39||(_templateObject39=_taggedTemplateLiteral(['\n              <span>\n                <strong>\n                  Entries with associated metadata, and agent ids with all their\n                  headers\n                </strong>\n              </span>\n              <json-viewer\n                id="dht-shard"\n                style="margin-top: 16px;"\n                .object=',"\n              >\n              </json-viewer>\n            "])),JSON.stringify(Object(_holochain_playground_core__WEBPACK_IMPORTED_MODULE_104__.i)(this.activeCell.getState()))):Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject40||(_templateObject40=_taggedTemplateLiteral(['\n              <span class="placeholder">\n                Select a cell to see its DHT Shard\n              </span>\n            ']))))}}],[{key:"style",value:function style(){return sharedStyles}},{key:"scopedElements",get:function get(){return{"json-viewer":JsonViewer}}}]),DhtShard}(PlaygroundElement);function shortenStrRec(object){if(null==object)return object;if(Array.isArray(object))return object.map(shortenStrRec);if("object"===_typeof2(object)){for(var _i16=0,_Object$keys2=Object.keys(object);_i16<_Object$keys2.length;_i16++){var key=_Object$keys2[_i16];object[key]=shortenStrRec(object[key])}return object}return"string"==typeof object&&object.length>23?"".concat(object.substring(0,20),"..."):object}__decorate([Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.g)({type:Object}),__metadata("design:type",Object)],DhtShard.prototype,"cell",void 0);var EntryContents=function(_PlaygroundElement3){_inherits(EntryContents,_PlaygroundElement3);var _super9=_createSuper(EntryContents);function EntryContents(){return _classCallCheck2(this,EntryContents),_super9.apply(this,arguments)}return _createClass2(EntryContents,[{key:"activeHashedContent",get:function get(){var allCells=selectAllCells(this.activeDna,this.conductors);return function selectFromCAS(hash,cells){if(hash){var _step9,_iterator8=_createForOfIteratorHelper(cells);try{for(_iterator8.s();!(_step9=_iterator8.n()).done;){var entry=_step9.value.getState().CAS[hash];if(entry)return entry}}catch(err){_iterator8.e(err)}finally{_iterator8.f()}}}(this.activeHash,allCells)}},{key:"render",value:function render(){return Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject41||(_templateObject41=_taggedTemplateLiteral(['\n      <mwc-card style="width: auto; min-height: 200px;" class="fill">\n        <div class="column fill" style="padding: 16px;">\n          <span class="title">\n            ',"\n            Contents</span\n          >\n          ","\n        </div>\n      </mwc-card>\n    "])),this.activeHashedContent&&this.activeHashedContent.header?"Header":"Entry",this.activeHashedContent?Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject42||(_templateObject42=_taggedTemplateLiteral(['\n                <div class="column fill">\n                  <span style="margin-bottom: 16px;">\n                    ',"\n                    Hash: ",'\n                  </span>\n                  <div class="fill flex-scrollable-parent">\n                    <div class="flex-scrollable-container">\n                      <div class="flex-scrollable-y" style="height: 100%;">\n                        <json-viewer\n                          .object=','\n                          class="fill"\n                        ></json-viewer>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              '])),this.activeHashedContent.header?"Header":"Entry",this.activeHash,shortenStrRec(this.activeHashedContent)):Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject43||(_templateObject43=_taggedTemplateLiteral(['\n                <div class="column fill center-content">\n                  <span class="placeholder">Select entry to inspect</span>\n                </div>\n              ']))))}}],[{key:"styles",get:function get(){return[sharedStyles,Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.b)(_templateObject44||(_templateObject44=_taggedTemplateLiteral(["\n        :host {\n          display: flex;\n        }\n      "])))]}},{key:"scopedElements",get:function get(){return{"json-viewer":JsonViewer,"mwc-card":scoped_material_components_mwc_card__WEBPACK_IMPORTED_MODULE_111__.a}}}]),EntryContents}(PlaygroundElement),ConductorDetail=function(_PlaygroundElement4){_inherits(ConductorDetail,_PlaygroundElement4);var _super10=_createSuper(ConductorDetail);function ConductorDetail(){var _this16;return _classCallCheck2(this,ConductorDetail),(_this16=_super10.apply(this,arguments)).selectedTabIndex=0,_this16}return _createClass2(ConductorDetail,[{key:"firstUpdated",value:function firstUpdated(){var _this17=this;this.addEventListener("entry-committed",(function(e){_this17.selectedTabIndex=0}))}},{key:"renderAgentHelp",value:function renderAgentHelp(){return Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject45||(_templateObject45=_taggedTemplateLiteral(['\n      <mwc-dialog\n        id="conductor-help"\n        heading="Node Help"\n        style="--mdc-dialog-max-width: 700px"\n      >\n        <span>\n          You\'ve selected the node or conductor with Agent ID\n          ','. Here you can see its internal state:\n          <ul>\n            <li>\n              <strong>Source Chain</strong>: entries that this node has\n              committed. Here you can see in grey the\n              <a\n                href="https://developer.holochain.org/docs/concepts/3_private_data/"\n                target="_blank"\n                >headers\n              </a>\n              of the entries, and in colors the entries themselves. When you\n              select an entry, the other nodes that are holding the entry DHT\n              will be hightlighted in the DHT.\n            </li>\n            <br />\n            <li>\n              <strong>DHT Shard</strong>: slice of the DHT that this node is\n              holding. You can see the list of all the entries that this node is\n              holding indexed by their hash, and metadata associated to those\n              entries.\n            </li>\n            <br />\n            <li>\n              <strong>Commit Entries</strong>: here you can actually create\n              entries yourself. They will be created on behalf of this node. Try\n              it! You can create an entry and see where it lands on the DHT, and\n              go to the DHT Shard of those nodes and check it\'s there.\n            </li>\n          </ul>\n        </span>\n        <mwc-button slot="primaryAction" dialogAction="cancel">\n          Got it!\n        </mwc-button>\n      </mwc-dialog>\n    '])),this.activeAgentPubKey)}},{key:"render",value:function render(){var _this18=this;return Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject46||(_templateObject46=_taggedTemplateLiteral(["\n      ",'\n      <mwc-card style="width: auto;" class="fill">\n        <div class="column fill">\n          <div class="row" style="padding: 16px">\n            <div class="column" style="flex: 1;">\n              <span class="title">Conductor Detail</span>\n              <span>Agent Pub Key: ','</span>\n            </div>\n            <mwc-icon-button\n              icon="help_outline"\n              @click=','\n            ></mwc-icon-button>\n          </div>\n          <div class="column fill">\n            <mwc-tab-bar\n              @MDCTabBar:activated=',"\n              .activeIndex=",'\n            >\n              <mwc-tab label="Source Chain"></mwc-tab>\n              <mwc-tab label="DHT Shard"></mwc-tab>\n              <mwc-tab label="Commit entries"></mwc-tab>\n            </mwc-tab-bar>\n            <div style="padding: 16px;" class="column fill">\n              ',"\n            </div>\n          </div>\n        </div>\n      </mwc-card>\n    "])),this.renderAgentHelp(),this.activeAgentPubKey,(function(){return _this18.conductorHelp.open=!0}),(function(e){return _this18.selectedTabIndex=e.detail.index}),this.selectedTabIndex,0===this.selectedTabIndex?Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject47||(_templateObject47=_taggedTemplateLiteral(['\n                    <div class="row fill">\n                      <holochain-playground-source-chain\n                        class="fill"\n                      ></holochain-playground-source-chain>\n                      <div class="flex-scrollable-parent">\n                        <div class="flex-scrollable-container">\n                          <div class="flex-scrollable-y">\n                            <holochain-playground-entry-detail\n                              class="fill"\n                            ></holochain-playground-entry-detail>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  ']))):1===this.selectedTabIndex?Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject48||(_templateObject48=_taggedTemplateLiteral(['\n                    <div class="flex-scrollable-parent">\n                      <div class="flex-scrollable-container">\n                        <div class="flex-scrollable-y">\n                          <holochain-playground-dht-shard></holochain-playground-dht-shard>\n                        </div>\n                      </div>\n                    </div>\n                  ']))):Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject49||(_templateObject49=_taggedTemplateLiteral(["\n                    <holochain-playground-create-entries></holochain-playground-create-entries>\n                  "]))))}}],[{key:"styles",get:function get(){return[sharedStyles,Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.b)(_templateObject50||(_templateObject50=_taggedTemplateLiteral(["\n        :host {\n          display: flex;\n        }\n\n        mwc-card {\n          padding: 16px;\n        }\n      "])))]}},{key:"scopedElements",get:function get(){return{"holochain-playground-dht-shard":DhtShard,"holochain-playground-entry-detail":EntryContents,"mwc-tab":scoped_material_components_mwc_tab__WEBPACK_IMPORTED_MODULE_109__.a,"mwc-tab-bar":scoped_material_components_mwc_tab_bar__WEBPACK_IMPORTED_MODULE_110__.a,"mwc-card":scoped_material_components_mwc_card__WEBPACK_IMPORTED_MODULE_111__.a,"mwc-icon-button":scoped_material_components_mwc_icon_button__WEBPACK_IMPORTED_MODULE_100__.a,"mwc-dialog":scoped_material_components_mwc_dialog__WEBPACK_IMPORTED_MODULE_115__.a}}}]),ConductorDetail}(PlaygroundElement);__decorate([Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.g)({type:Number}),__metadata("design:type",Number)],ConductorDetail.prototype,"selectedTabIndex",void 0),__decorate([Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.h)("#conductor-help"),__metadata("design:type",scoped_material_components_mwc_dialog__WEBPACK_IMPORTED_MODULE_115__.a)],ConductorDetail.prototype,"conductorHelp",void 0);var commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==global?global:"undefined"!=typeof self?self:{};function createCommonjsModule(fn,basedir,module){return fn(module={path:basedir,exports:{},require:function require(path,base){return commonjsRequire(null==base&&module.path)}},module.exports),module.exports}function commonjsRequire(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var reTrim=/^\s+|\s+$/g,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt,freeGlobal="object"==_typeof2(commonjsGlobal)&&commonjsGlobal&&commonjsGlobal.Object===Object&&commonjsGlobal,freeSelf="object"==("undefined"==typeof self?"undefined":_typeof2(self))&&self&&self.Object===Object&&self,root=freeGlobal||freeSelf||Function("return this")(),objectToString=Object.prototype.toString,nativeMax=Math.max,nativeMin=Math.min,now=function now(){return root.Date.now()};function isObject$1(value){var type=_typeof2(value);return!!value&&("object"==type||"function"==type)}function isSymbol(value){return"symbol"==_typeof2(value)||function isObjectLike(value){return!!value&&"object"==_typeof2(value)}(value)&&"[object Symbol]"==objectToString.call(value)}function toNumber(value){if("number"==typeof value)return value;if(isSymbol(value))return NaN;if(isObject$1(value)){var other="function"==typeof value.valueOf?value.valueOf():value;value=isObject$1(other)?other+"":other}if("string"!=typeof value)return 0===value?value:+value;value=value.replace(reTrim,"");var isBinary=reIsBinary.test(value);return isBinary||reIsOctal.test(value)?freeParseInt(value.slice(2),isBinary?2:8):reIsBadHex.test(value)?NaN:+value}var lodash_debounce=function debounce(func,wait,options){var lastArgs,lastThis,maxWait,result,timerId,lastCallTime,lastInvokeTime=0,leading=!1,maxing=!1,trailing=!0;if("function"!=typeof func)throw new TypeError("Expected a function");function invokeFunc(time){var args=lastArgs,thisArg=lastThis;return lastArgs=lastThis=void 0,lastInvokeTime=time,result=func.apply(thisArg,args)}function leadingEdge(time){return lastInvokeTime=time,timerId=setTimeout(timerExpired,wait),leading?invokeFunc(time):result}function shouldInvoke(time){var timeSinceLastCall=time-lastCallTime;return void 0===lastCallTime||timeSinceLastCall>=wait||timeSinceLastCall<0||maxing&&time-lastInvokeTime>=maxWait}function timerExpired(){var time=now();if(shouldInvoke(time))return trailingEdge(time);timerId=setTimeout(timerExpired,function remainingWait(time){var result=wait-(time-lastCallTime);return maxing?nativeMin(result,maxWait-(time-lastInvokeTime)):result}(time))}function trailingEdge(time){return timerId=void 0,trailing&&lastArgs?invokeFunc(time):(lastArgs=lastThis=void 0,result)}function debounced(){var time=now(),isInvoking=shouldInvoke(time);if(lastArgs=arguments,lastThis=this,lastCallTime=time,isInvoking){if(void 0===timerId)return leadingEdge(lastCallTime);if(maxing)return timerId=setTimeout(timerExpired,wait),invokeFunc(lastCallTime)}return void 0===timerId&&(timerId=setTimeout(timerExpired,wait)),result}return wait=toNumber(wait)||0,isObject$1(options)&&(leading=!!options.leading,maxWait=(maxing="maxWait"in options)?nativeMax(toNumber(options.maxWait)||0,wait):maxWait,trailing="trailing"in options?!!options.trailing:trailing),debounced.cancel=function cancel(){void 0!==timerId&&clearTimeout(timerId),lastInvokeTime=0,lastArgs=lastCallTime=lastThis=timerId=void 0},debounced.flush=function flush(){return void 0===timerId?result:trailingEdge(now())},debounced},heap$1=createCommonjsModule((function(module,exports){(function(){var Heap,defaultCmp,floor,heapify,heappop,heappush,heappushpop,heapreplace,insort,min,nlargest,nsmallest,updateItem,_siftdown,_siftup;floor=Math.floor,min=Math.min,defaultCmp=function defaultCmp(x,y){return x<y?-1:x>y?1:0},insort=function insort(a,x,lo,hi,cmp){var mid;if(null==lo&&(lo=0),null==cmp&&(cmp=defaultCmp),lo<0)throw new Error("lo must be non-negative");for(null==hi&&(hi=a.length);lo<hi;)cmp(x,a[mid=floor((lo+hi)/2)])<0?hi=mid:lo=mid+1;return[].splice.apply(a,[lo,lo-lo].concat(x)),x},heappush=function heappush(array,item,cmp){return null==cmp&&(cmp=defaultCmp),array.push(item),_siftdown(array,0,array.length-1,cmp)},heappop=function heappop(array,cmp){var lastelt,returnitem;return null==cmp&&(cmp=defaultCmp),lastelt=array.pop(),array.length?(returnitem=array[0],array[0]=lastelt,_siftup(array,0,cmp)):returnitem=lastelt,returnitem},heapreplace=function heapreplace(array,item,cmp){var returnitem;return null==cmp&&(cmp=defaultCmp),returnitem=array[0],array[0]=item,_siftup(array,0,cmp),returnitem},heappushpop=function heappushpop(array,item,cmp){var _ref;return null==cmp&&(cmp=defaultCmp),array.length&&cmp(array[0],item)<0&&(item=(_ref=[array[0],item])[0],array[0]=_ref[1],_siftup(array,0,cmp)),item},heapify=function heapify(array,cmp){var i,_i,_len,_ref1,_results,_results1;for(null==cmp&&(cmp=defaultCmp),_results=[],_i=0,_len=(_ref1=function(){_results1=[];for(var _j=0,_ref=floor(array.length/2);0<=_ref?_j<_ref:_j>_ref;0<=_ref?_j++:_j--)_results1.push(_j);return _results1}.apply(this).reverse()).length;_i<_len;_i++)i=_ref1[_i],_results.push(_siftup(array,i,cmp));return _results},updateItem=function updateItem(array,item,cmp){var pos;if(null==cmp&&(cmp=defaultCmp),-1!==(pos=array.indexOf(item)))return _siftdown(array,0,pos,cmp),_siftup(array,pos,cmp)},nlargest=function nlargest(array,n,cmp){var elem,result,_i,_len,_ref;if(null==cmp&&(cmp=defaultCmp),!(result=array.slice(0,n)).length)return result;for(heapify(result,cmp),_i=0,_len=(_ref=array.slice(n)).length;_i<_len;_i++)elem=_ref[_i],heappushpop(result,elem,cmp);return result.sort(cmp).reverse()},nsmallest=function nsmallest(array,n,cmp){var elem,los,result,_i,_j,_len,_ref,_ref1,_results;if(null==cmp&&(cmp=defaultCmp),10*n<=array.length){if(!(result=array.slice(0,n).sort(cmp)).length)return result;for(los=result[result.length-1],_i=0,_len=(_ref=array.slice(n)).length;_i<_len;_i++)cmp(elem=_ref[_i],los)<0&&(insort(result,elem,0,null,cmp),result.pop(),los=result[result.length-1]);return result}for(heapify(array,cmp),_results=[],_j=0,_ref1=min(n,array.length);0<=_ref1?_j<_ref1:_j>_ref1;0<=_ref1?++_j:--_j)_results.push(heappop(array,cmp));return _results},_siftdown=function _siftdown(array,startpos,pos,cmp){var newitem,parent,parentpos;for(null==cmp&&(cmp=defaultCmp),newitem=array[pos];pos>startpos&&cmp(newitem,parent=array[parentpos=pos-1>>1])<0;)array[pos]=parent,pos=parentpos;return array[pos]=newitem},_siftup=function _siftup(array,pos,cmp){var childpos,endpos,newitem,rightpos,startpos;for(null==cmp&&(cmp=defaultCmp),endpos=array.length,startpos=pos,newitem=array[pos],childpos=2*pos+1;childpos<endpos;)(rightpos=childpos+1)<endpos&&!(cmp(array[childpos],array[rightpos])<0)&&(childpos=rightpos),array[pos]=array[childpos],childpos=2*(pos=childpos)+1;return array[pos]=newitem,_siftdown(array,startpos,pos,cmp)},Heap=function(){function Heap(cmp){this.cmp=null!=cmp?cmp:defaultCmp,this.nodes=[]}return Heap.push=heappush,Heap.pop=heappop,Heap.replace=heapreplace,Heap.pushpop=heappushpop,Heap.heapify=heapify,Heap.updateItem=updateItem,Heap.nlargest=nlargest,Heap.nsmallest=nsmallest,Heap.prototype.push=function(x){return heappush(this.nodes,x,this.cmp)},Heap.prototype.pop=function(){return heappop(this.nodes,this.cmp)},Heap.prototype.peek=function(){return this.nodes[0]},Heap.prototype.contains=function(x){return-1!==this.nodes.indexOf(x)},Heap.prototype.replace=function(x){return heapreplace(this.nodes,x,this.cmp)},Heap.prototype.pushpop=function(x){return heappushpop(this.nodes,x,this.cmp)},Heap.prototype.heapify=function(){return heapify(this.nodes,this.cmp)},Heap.prototype.updateItem=function(x){return updateItem(this.nodes,x,this.cmp)},Heap.prototype.clear=function(){return this.nodes=[]},Heap.prototype.empty=function(){return 0===this.nodes.length},Heap.prototype.size=function(){return this.nodes.length},Heap.prototype.clone=function(){var heap;return(heap=new Heap).nodes=this.nodes.slice(0),heap},Heap.prototype.toArray=function(){return this.nodes.slice(0)},Heap.prototype.insert=Heap.prototype.push,Heap.prototype.top=Heap.prototype.peek,Heap.prototype.front=Heap.prototype.peek,Heap.prototype.has=Heap.prototype.contains,Heap.prototype.copy=Heap.prototype.clone,Heap}(),module.exports=Heap}).call(commonjsGlobal)}));function _interopDefault(ex){return ex&&"object"===_typeof2(ex)&&"default"in ex?ex.default:ex}var util=_interopDefault(lodash_debounce),Heap=_interopDefault(heap$1);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function _typeof(obj){return _typeof2(obj)}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var window$1="undefined"==typeof window?null:window,navigator=window$1?window$1.navigator:null;window$1&&window$1.document;var typeofstr=_typeof(""),typeofobj=_typeof({}),typeoffn=_typeof((function(){})),typeofhtmlele="undefined"==typeof HTMLElement?"undefined":_typeof(HTMLElement),instanceStr=function instanceStr(obj){return obj&&obj.instanceString&&fn(obj.instanceString)?obj.instanceString():null},string=function string(obj){return null!=obj&&_typeof(obj)==typeofstr},fn=function fn(obj){return null!=obj&&_typeof(obj)===typeoffn},array=function array(obj){return!elementOrCollection(obj)&&(Array.isArray?Array.isArray(obj):null!=obj&&obj instanceof Array)},plainObject=function plainObject(obj){return null!=obj&&_typeof(obj)===typeofobj&&!array(obj)&&obj.constructor===Object},number=function number(obj){return null!=obj&&_typeof(obj)===_typeof(1)&&!isNaN(obj)},htmlElement=function htmlElement(obj){return"undefined"===typeofhtmlele?void 0:null!=obj&&obj instanceof HTMLElement},elementOrCollection=function elementOrCollection(obj){return element(obj)||collection(obj)},element=function element(obj){return"collection"===instanceStr(obj)&&obj._private.single},collection=function collection(obj){return"collection"===instanceStr(obj)&&!obj._private.single},core=function core(obj){return"core"===instanceStr(obj)},stylesheet=function stylesheet(obj){return"stylesheet"===instanceStr(obj)},emptyString=function emptyString(obj){return null==obj||!(""!==obj&&!obj.match(/^\s+$/))},promise=function promise(obj){return function object(obj){return null!=obj&&_typeof(obj)===typeofobj}(obj)&&fn(obj.then)},memoize=function memoize(fn,keyFn){keyFn||(keyFn=function keyFn(){if(1===arguments.length)return arguments[0];if(0===arguments.length)return"undefined";for(var args=[],i=0;i<arguments.length;i++)args.push(arguments[i]);return args.join("$")});var memoizedFn=function memoizedFn(){var ret,self=this,args=arguments,k=keyFn.apply(self,args),cache=memoizedFn.cache;return(ret=cache[k])||(ret=cache[k]=fn.apply(self,args)),ret};return memoizedFn.cache={},memoizedFn},camel2dash=memoize((function(str){return str.replace(/([A-Z])/g,(function(v){return"-"+v.toLowerCase()}))})),dash2camel=memoize((function(str){return str.replace(/(-\w)/g,(function(v){return v[1].toUpperCase()}))})),prependCamel=memoize((function(prefix,str){return prefix+str[0].toUpperCase()+str.substring(1)}),(function(prefix,str){return prefix+"$"+str})),capitalize=function capitalize(str){return emptyString(str)?str:str.charAt(0).toUpperCase()+str.substring(1)},number$1="(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))",ascending=function ascending(a,b){return a<b?-1:a>b?1:0},extend=null!=Object.assign?Object.assign.bind(Object):function(tgt){for(var args=arguments,i=1;i<args.length;i++){var obj=args[i];if(null!=obj)for(var keys=Object.keys(obj),j=0;j<keys.length;j++){var k=keys[j];tgt[k]=obj[k]}}return tgt},color2tuple=function color2tuple(color){return(array(color)?color:null)||function colorname2tuple(color){return colors[color.toLowerCase()]}(color)||function hex2tuple(hex){if((4===hex.length||7===hex.length)&&"#"===hex[0]){var r,g,b;return 4===hex.length?(r=parseInt(hex[1]+hex[1],16),g=parseInt(hex[2]+hex[2],16),b=parseInt(hex[3]+hex[3],16)):(r=parseInt(hex[1]+hex[2],16),g=parseInt(hex[3]+hex[4],16),b=parseInt(hex[5]+hex[6],16)),[r,g,b]}}(color)||function rgb2tuple(rgb){var ret,m=new RegExp("^rgb[a]?\\(((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%]?)\\s*,\\s*((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%]?)\\s*,\\s*((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%]?)(?:\\s*,\\s*((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))))?\\)$").exec(rgb);if(m){ret=[];for(var isPct=[],i=1;i<=3;i++){var channel=m[i];if("%"===channel[channel.length-1]&&(isPct[i]=!0),channel=parseFloat(channel),isPct[i]&&(channel=channel/100*255),channel<0||channel>255)return;ret.push(Math.floor(channel))}var atLeastOneIsPct=isPct[1]||isPct[2]||isPct[3],allArePct=isPct[1]&&isPct[2]&&isPct[3];if(atLeastOneIsPct&&!allArePct)return;var alpha=m[4];if(void 0!==alpha){if((alpha=parseFloat(alpha))<0||alpha>1)return;ret.push(alpha)}}return ret}(color)||function hsl2tuple(hsl){var ret,h,s,l,a,r,g,b;function hue2rgb(p,q,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?p+6*(q-p)*t:t<.5?q:t<2/3?p+(q-p)*(2/3-t)*6:p}var m=new RegExp("^hsl[a]?\\(((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?)))\\s*,\\s*((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%])\\s*,\\s*((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%])(?:\\s*,\\s*((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))))?\\)$").exec(hsl);if(m){if((h=parseInt(m[1]))<0?h=(360- -1*h%360)%360:h>360&&(h%=360),h/=360,(s=parseFloat(m[2]))<0||s>100)return;if(s/=100,(l=parseFloat(m[3]))<0||l>100)return;if(l/=100,void 0!==(a=m[4])&&((a=parseFloat(a))<0||a>1))return;if(0===s)r=g=b=Math.round(255*l);else{var q=l<.5?l*(1+s):l+s-l*s,p=2*l-q;r=Math.round(255*hue2rgb(p,q,h+1/3)),g=Math.round(255*hue2rgb(p,q,h)),b=Math.round(255*hue2rgb(p,q,h-1/3))}ret=[r,g,b,a]}return ret}(color)},colors={transparent:[0,0,0,0],aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],grey:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},setMap=function setMap(options){for(var obj=options.map,keys=options.keys,l=keys.length,i=0;i<l;i++){var key=keys[i];if(plainObject(key))throw Error("Tried to set map with object key");i<keys.length-1?(null==obj[key]&&(obj[key]={}),obj=obj[key]):obj[key]=options.value}},getMap=function getMap(options){for(var obj=options.map,keys=options.keys,l=keys.length,i=0;i<l;i++){var key=keys[i];if(plainObject(key))throw Error("Tried to get map with object key");if(null==(obj=obj[key]))return obj}return obj},performance=window$1?window$1.performance:null,pnow=performance&&performance.now?function(){return performance.now()}:function(){return Date.now()},raf=function(){if(window$1){if(window$1.requestAnimationFrame)return function(fn){window$1.requestAnimationFrame(fn)};if(window$1.mozRequestAnimationFrame)return function(fn){window$1.mozRequestAnimationFrame(fn)};if(window$1.webkitRequestAnimationFrame)return function(fn){window$1.webkitRequestAnimationFrame(fn)};if(window$1.msRequestAnimationFrame)return function(fn){window$1.msRequestAnimationFrame(fn)}}return function(fn){fn&&setTimeout((function(){fn(pnow())}),1e3/60)}}(),requestAnimationFrame=function requestAnimationFrame(fn){return raf(fn)},performanceNow=pnow,K=65599,hashIterableInts=function hashIterableInts(iterator){for(var entry,seed=arguments.length>1&&void 0!==arguments[1]?arguments[1]:9261,hash=seed;!(entry=iterator.next()).done;)hash=hash*K+entry.value|0;return hash},hashInt=function hashInt(num){var seed=arguments.length>1&&void 0!==arguments[1]?arguments[1]:9261;return seed*K+num|0},hashIntAlt=function hashIntAlt(num){var seed=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5381;return(seed<<5)+seed+num|0},combineHashesArray=function combineHashesArray(hashes){return 2097152*hashes[0]+hashes[1]},hashArrays=function hashArrays(hashes1,hashes2){return[hashInt(hashes1[0],hashes2[0]),hashIntAlt(hashes1[1],hashes2[1])]},hashString=function hashString(str,seed){var entry={value:0,done:!1},i=0,length=str.length;return hashIterableInts({next:function next(){return i<length?entry.value=str.charCodeAt(i++):entry.done=!0,entry}},seed)},hashStrings=function hashStrings(){return hashStringsArray(arguments)},hashStringsArray=function hashStringsArray(strs){for(var hash,i=0;i<strs.length;i++){var str=strs[i];hash=0===i?hashString(str):hashString(str,hash)}return hash},warningsEnabled=!0,warnSupported=null!=console.warn,traceSupported=null!=console.trace,MAX_INT=Number.MAX_SAFE_INTEGER||9007199254740991,trueify=function trueify(){return!0},falsify=function falsify(){return!1},zeroify=function zeroify(){return 0},noop=function noop(){},error=function error(msg){throw new Error(msg)},warnings=function warnings(enabled){if(void 0===enabled)return warningsEnabled;warningsEnabled=!!enabled},warn=function warn(msg){warnings()&&(warnSupported?console.warn(msg):(console.log(msg),traceSupported&&console.trace()))},copy=function copy(obj){return null==obj?obj:array(obj)?obj.slice():plainObject(obj)?function clone(obj){return extend({},obj)}(obj):obj},uuid=function uuid(a,b){for(b=a="";a++<36;b+=51*a&52?(15^a?8^Math.random()*(20^a?16:4):4).toString(16):"-");return b},_staticEmptyObject={},staticEmptyObject=function staticEmptyObject(){return _staticEmptyObject},defaults=function defaults(_defaults){var keys=Object.keys(_defaults);return function(opts){for(var filledOpts={},i=0;i<keys.length;i++){var key=keys[i],optVal=null==opts?void 0:opts[key];filledOpts[key]=void 0===optVal?_defaults[key]:optVal}return filledOpts}},removeFromArray=function removeFromArray(arr,ele,manyCopies){for(var i=arr.length;i>=0&&(arr[i]!==ele||(arr.splice(i,1),manyCopies));i--);},clearArray=function clearArray(arr){arr.splice(0,arr.length)},getPrefixedProperty=function getPrefixedProperty(obj,propName,prefix){return prefix&&(propName=prependCamel(prefix,propName)),obj[propName]},setPrefixedProperty=function setPrefixedProperty(obj,propName,prefix,value){prefix&&(propName=prependCamel(prefix,propName)),obj[propName]=value},Map$1="undefined"!=typeof Map?Map:function(){function ObjectMap(){_classCallCheck(this,ObjectMap),this._obj={}}return _createClass(ObjectMap,[{key:"set",value:function set(key,val){return this._obj[key]=val,this}},{key:"delete",value:function _delete(key){return this._obj[key]=void 0,this}},{key:"clear",value:function clear(){this._obj={}}},{key:"has",value:function has(key){return void 0!==this._obj[key]}},{key:"get",value:function get(key){return this._obj[key]}}]),ObjectMap}(),ObjectSet=function(){function ObjectSet(arrayOrObjectSet){if(_classCallCheck(this,ObjectSet),this._obj=Object.create(null),this.size=0,null!=arrayOrObjectSet){var arr;arr=null!=arrayOrObjectSet.instanceString&&arrayOrObjectSet.instanceString()===this.instanceString()?arrayOrObjectSet.toArray():arrayOrObjectSet;for(var i=0;i<arr.length;i++)this.add(arr[i])}}return _createClass(ObjectSet,[{key:"instanceString",value:function instanceString(){return"set"}},{key:"add",value:function add(val){var o=this._obj;1!==o[val]&&(o[val]=1,this.size++)}},{key:"delete",value:function _delete(val){var o=this._obj;1===o[val]&&(o[val]=0,this.size--)}},{key:"clear",value:function clear(){this._obj=Object.create(null)}},{key:"has",value:function has(val){return 1===this._obj[val]}},{key:"toArray",value:function toArray(){var _this=this;return Object.keys(this._obj).filter((function(key){return _this.has(key)}))}},{key:"forEach",value:function forEach(callback,thisArg){return this.toArray().forEach(callback,thisArg)}}]),ObjectSet}(),Set$1="undefined"!==("undefined"==typeof Set?"undefined":_typeof(Set))?Set:ObjectSet,Element$1=function Element(cy,params){var restore=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(void 0!==cy&&void 0!==params&&core(cy)){var group=params.group;if(null==group&&(group=params.data&&null!=params.data.source&&null!=params.data.target?"edges":"nodes"),"nodes"===group||"edges"===group){this.length=1,this[0]=this;var _p=this._private={cy:cy,single:!0,data:params.data||{},position:params.position||{x:0,y:0},autoWidth:void 0,autoHeight:void 0,autoPadding:void 0,compoundBoundsClean:!1,listeners:[],group:group,style:{},rstyle:{},styleCxts:[],styleKeys:{},removed:!0,selected:!!params.selected,selectable:void 0===params.selectable||!!params.selectable,locked:!!params.locked,grabbed:!1,grabbable:void 0===params.grabbable||!!params.grabbable,pannable:void 0===params.pannable?"edges"===group:!!params.pannable,active:!1,classes:new Set$1,animation:{current:[],queue:[]},rscratch:{},scratch:params.scratch||{},edges:[],children:[],parent:null,traversalCache:{},backgrounding:!1,bbCache:null,bbCacheShift:{x:0,y:0},bodyBounds:null,overlayBounds:null,labelBounds:{all:null,source:null,target:null,main:null},arrowBounds:{source:null,target:null,"mid-source":null,"mid-target":null}};if(null==_p.position.x&&(_p.position.x=0),null==_p.position.y&&(_p.position.y=0),params.renderedPosition){var rpos=params.renderedPosition,pan=cy.pan(),zoom=cy.zoom();_p.position={x:(rpos.x-pan.x)/zoom,y:(rpos.y-pan.y)/zoom}}var classes=[];array(params.classes)?classes=params.classes:string(params.classes)&&(classes=params.classes.split(/\s+/));for(var i=0,l=classes.length;i<l;i++){var cls=classes[i];cls&&""!==cls&&_p.classes.add(cls)}this.createEmitter();var bypass=params.style||params.css;bypass&&(warn("Setting a `style` bypass at element creation should be done only when absolutely necessary.  Try to use the stylesheet instead."),this.style(bypass)),(void 0===restore||restore)&&this.restore()}else error("An element must be of type `nodes` or `edges`; you specified `"+group+"`")}else error("An element must have a core reference and parameters set")},defineSearch=function defineSearch(params){return params={bfs:params.bfs||!params.dfs,dfs:params.dfs||!params.bfs},function searchFn(roots,fn$1,directed){var options;plainObject(roots)&&!elementOrCollection(roots)&&(roots=(options=roots).roots||options.root,fn$1=options.visit,directed=options.directed),directed=2!==arguments.length||fn(fn$1)?directed:fn$1,fn$1=fn(fn$1)?fn$1:function(){};for(var found,cy=this._private.cy,v=roots=string(roots)?this.filter(roots):roots,Q=[],connectedNodes=[],connectedBy={},id2depth={},V={},j=0,_this$byGroup=this.byGroup(),nodes=_this$byGroup.nodes,edges=_this$byGroup.edges,i=0;i<v.length;i++){var vi=v[i],viId=vi.id();vi.isNode()&&(Q.unshift(vi),params.bfs&&(V[viId]=!0,connectedNodes.push(vi)),id2depth[viId]=0)}var _loop2=function _loop2(){var v=params.bfs?Q.shift():Q.pop(),vId=v.id();if(params.dfs){if(V[vId])return"continue";V[vId]=!0,connectedNodes.push(v)}var ret,depth=id2depth[vId],prevEdge=connectedBy[vId],src=null!=prevEdge?prevEdge.source():null,tgt=null!=prevEdge?prevEdge.target():null,prevNode=null==prevEdge?void 0:v.same(src)?tgt[0]:src[0];if(!0===(ret=fn$1(v,prevEdge,prevNode,j++,depth)))return found=v,"break";if(!1===ret)return"break";for(var vwEdges=v.connectedEdges().filter((function(e){return(!directed||e.source().same(v))&&edges.has(e)})),_i2=0;_i2<vwEdges.length;_i2++){var e=vwEdges[_i2],w=e.connectedNodes().filter((function(n){return!n.same(v)&&nodes.has(n)})),wId=w.id();0===w.length||V[wId]||(w=w[0],Q.push(w),params.bfs&&(V[wId]=!0,connectedNodes.push(w)),connectedBy[wId]=e,id2depth[wId]=id2depth[vId]+1)}};_loop:for(;0!==Q.length;){var _ret=_loop2();switch(_ret){case"continue":continue;case"break":break _loop}}for(var connectedEles=cy.collection(),_i=0;_i<connectedNodes.length;_i++){var node=connectedNodes[_i],edge=connectedBy[node.id()];null!=edge&&connectedEles.push(edge),connectedEles.push(node)}return{path:cy.collection(connectedEles),found:cy.collection(found)}}},elesfn={breadthFirstSearch:defineSearch({bfs:!0}),depthFirstSearch:defineSearch({dfs:!0})};elesfn.bfs=elesfn.breadthFirstSearch,elesfn.dfs=elesfn.depthFirstSearch;var dijkstraDefaults=defaults({root:null,weight:function weight(edge){return 1},directed:!1}),elesfn$1={dijkstra:function dijkstra(options){if(!plainObject(options)){var args=arguments;options={root:args[0],weight:args[1],directed:args[2]}}var _dijkstraDefaults=dijkstraDefaults(options),root=_dijkstraDefaults.root,weight=_dijkstraDefaults.weight,directed=_dijkstraDefaults.directed,eles=this,weightFn=weight,source=string(root)?this.filter(root)[0]:root[0],dist={},prev={},knownDist={},_this$byGroup=this.byGroup(),nodes=_this$byGroup.nodes,edges=_this$byGroup.edges;edges.unmergeBy((function(ele){return ele.isLoop()}));for(var getDist=function getDist(node){return dist[node.id()]},setDist=function setDist(node,d){dist[node.id()]=d,Q.updateItem(node)},Q=new Heap((function(a,b){return getDist(a)-getDist(b)})),i=0;i<nodes.length;i++){var node=nodes[i];dist[node.id()]=node.same(source)?0:1/0,Q.push(node)}for(var distBetween=function distBetween(u,v){for(var smallestEdge,uvs=(directed?u.edgesTo(v):u.edgesWith(v)).intersect(edges),smallestDistance=1/0,_i=0;_i<uvs.length;_i++){var edge=uvs[_i],_weight=weightFn(edge);(_weight<smallestDistance||!smallestEdge)&&(smallestDistance=_weight,smallestEdge=edge)}return{edge:smallestEdge,dist:smallestDistance}};Q.size()>0;){var u=Q.pop(),smalletsDist=getDist(u),uid=u.id();if(knownDist[uid]=smalletsDist,smalletsDist!==1/0)for(var neighbors=u.neighborhood().intersect(nodes),_i2=0;_i2<neighbors.length;_i2++){var v=neighbors[_i2],vid=v.id(),vDist=distBetween(u,v),alt=smalletsDist+vDist.dist;alt<getDist(v)&&(setDist(v,alt),prev[vid]={node:u,edge:vDist.edge})}}return{distanceTo:function distanceTo(node){var target=string(node)?nodes.filter(node)[0]:node[0];return knownDist[target.id()]},pathTo:function pathTo(node){var target=string(node)?nodes.filter(node)[0]:node[0],S=[],u=target,uid=u.id();if(target.length>0)for(S.unshift(target);prev[uid];){var p=prev[uid];S.unshift(p.edge),S.unshift(p.node),uid=(u=p.node).id()}return eles.spawn(S)}}}},elesfn$2={kruskal:function kruskal(weightFn){weightFn=weightFn||function(edge){return 1};for(var _this$byGroup=this.byGroup(),nodes=_this$byGroup.nodes,edges=_this$byGroup.edges,numNodes=nodes.length,forest=new Array(numNodes),A=nodes,findSetIndex=function findSetIndex(ele){for(var i=0;i<forest.length;i++){if(forest[i].has(ele))return i}},i=0;i<numNodes;i++)forest[i]=this.spawn(nodes[i]);for(var S=edges.sort((function(a,b){return weightFn(a)-weightFn(b)})),_i=0;_i<S.length;_i++){var edge=S[_i],u=edge.source()[0],v=edge.target()[0],setUIndex=findSetIndex(u),setVIndex=findSetIndex(v),setU=forest[setUIndex],setV=forest[setVIndex];setUIndex!==setVIndex&&(A.merge(edge),setU.merge(setV),forest.splice(setVIndex,1))}return A}},aStarDefaults=defaults({root:null,goal:null,weight:function weight(edge){return 1},heuristic:function heuristic(edge){return 0},directed:!1}),elesfn$3={aStar:function aStar(options){var cy=this.cy(),_aStarDefaults=aStarDefaults(options),root=_aStarDefaults.root,goal=_aStarDefaults.goal,heuristic=_aStarDefaults.heuristic,directed=_aStarDefaults.directed,weight=_aStarDefaults.weight;root=cy.collection(root)[0],goal=cy.collection(goal)[0];var cMin,cMinId,sid=root.id(),tid=goal.id(),gScore={},fScore={},closedSetIds={},openSet=new Heap((function(a,b){return fScore[a.id()]-fScore[b.id()]})),openSetIds=new Set$1,cameFrom={},cameFromEdge={},addToOpenSet=function addToOpenSet(ele,id){openSet.push(ele),openSetIds.add(id)},popFromOpenSet=function popFromOpenSet(){cMin=openSet.pop(),cMinId=cMin.id(),openSetIds.delete(cMinId)},isInOpenSet=function isInOpenSet(id){return openSetIds.has(id)};addToOpenSet(root,sid),gScore[sid]=0,fScore[sid]=heuristic(root);for(var steps=0;openSet.size()>0;){if(popFromOpenSet(),steps++,cMinId===tid){for(var path=[],pathNode=goal,pathNodeId=tid,pathEdge=cameFromEdge[pathNodeId];path.unshift(pathNode),null!=pathEdge&&path.unshift(pathEdge),null!=(pathNode=cameFrom[pathNodeId]);)pathEdge=cameFromEdge[pathNodeId=pathNode.id()];return{found:!0,distance:gScore[cMinId],path:this.spawn(path),steps:steps}}closedSetIds[cMinId]=!0;for(var vwEdges=cMin._private.edges,i=0;i<vwEdges.length;i++){var e=vwEdges[i];if(this.hasElementWithId(e.id())&&(!directed||e.data("source")===cMinId)){var wSrc=e.source(),wTgt=e.target(),w=wSrc.id()!==cMinId?wSrc:wTgt,wid=w.id();if(this.hasElementWithId(wid)&&!closedSetIds[wid]){var tempScore=gScore[cMinId]+weight(e);isInOpenSet(wid)?tempScore<gScore[wid]&&(gScore[wid]=tempScore,fScore[wid]=tempScore+heuristic(w),cameFrom[wid]=cMin):(gScore[wid]=tempScore,fScore[wid]=tempScore+heuristic(w),addToOpenSet(w,wid),cameFrom[wid]=cMin,cameFromEdge[wid]=e)}}}}return{found:!1,distance:void 0,path:void 0,steps:steps}}},floydWarshallDefaults=defaults({weight:function weight(edge){return 1},directed:!1}),elesfn$4={floydWarshall:function floydWarshall(options){for(var cy=this.cy(),_floydWarshallDefault=floydWarshallDefaults(options),weight=_floydWarshallDefault.weight,directed=_floydWarshallDefault.directed,weightFn=weight,_this$byGroup=this.byGroup(),nodes=_this$byGroup.nodes,edges=_this$byGroup.edges,N=nodes.length,Nsq=N*N,indexOf=function indexOf(node){return nodes.indexOf(node)},atIndex=function atIndex(i){return nodes[i]},dist=new Array(Nsq),n=0;n<Nsq;n++){var j=n%N,i=(n-j)/N;dist[n]=i===j?0:1/0}for(var next=new Array(Nsq),edgeNext=new Array(Nsq),_i=0;_i<edges.length;_i++){var edge=edges[_i],src=edge.source()[0],tgt=edge.target()[0];if(src!==tgt){var s=indexOf(src),t=indexOf(tgt),st=s*N+t,_weight=weightFn(edge);if(dist[st]>_weight&&(dist[st]=_weight,next[st]=t,edgeNext[st]=edge),!directed){var ts=t*N+s;!directed&&dist[ts]>_weight&&(dist[ts]=_weight,next[ts]=s,edgeNext[ts]=edge)}}}for(var k=0;k<N;k++)for(var _i2=0;_i2<N;_i2++)for(var ik=_i2*N+k,_j=0;_j<N;_j++){var ij=_i2*N+_j,kj=k*N+_j;dist[ik]+dist[kj]<dist[ij]&&(dist[ij]=dist[ik]+dist[kj],next[ij]=next[ik])}var indexOfArgEle=function indexOfArgEle(ele){return indexOf(function getArgEle(ele){return(string(ele)?cy.filter(ele):ele)[0]}(ele))};return{distance:function distance(from,to){var i=indexOfArgEle(from),j=indexOfArgEle(to);return dist[i*N+j]},path:function path(from,to){var i=indexOfArgEle(from),j=indexOfArgEle(to),fromNode=atIndex(i);if(i===j)return fromNode.collection();if(null==next[i*N+j])return cy.collection();var edge,path=cy.collection(),prev=i;for(path.merge(fromNode);i!==j;)prev=i,i=next[i*N+j],edge=edgeNext[prev*N+i],path.merge(edge),path.merge(atIndex(i));return path}}}},bellmanFordDefaults=defaults({weight:function weight(edge){return 1},directed:!1,root:null}),elesfn$5={bellmanFord:function bellmanFord(options){var _this=this,_bellmanFordDefaults=bellmanFordDefaults(options),weight=_bellmanFordDefaults.weight,directed=_bellmanFordDefaults.directed,root=_bellmanFordDefaults.root,weightFn=weight,eles=this,cy=this.cy(),_this$byGroup=this.byGroup(),edges=_this$byGroup.edges,nodes=_this$byGroup.nodes,numNodes=nodes.length,infoMap=new Map$1,hasNegativeWeightCycle=!1;root=cy.collection(root)[0],edges.unmergeBy((function(edge){return edge.isLoop()}));for(var numEdges=edges.length,getInfo=function getInfo(node){var obj=infoMap.get(node.id());return obj||(obj={},infoMap.set(node.id(),obj)),obj},getNodeFromTo=function getNodeFromTo(to){return(string(to)?cy.$(to):to)[0]},i=0;i<numNodes;i++){var node=nodes[i],info=getInfo(node);node.same(root)?info.dist=0:info.dist=1/0,info.pred=null,info.edge=null}for(var replacedEdge=!1,checkForEdgeReplacement=function checkForEdgeReplacement(node1,node2,edge,info1,info2,weight){var dist=info1.dist+weight;dist<info2.dist&&!edge.same(info1.edge)&&(info2.dist=dist,info2.pred=node1,info2.edge=edge,replacedEdge=!0)},_i=1;_i<numNodes;_i++){replacedEdge=!1;for(var e=0;e<numEdges;e++){var edge=edges[e],src=edge.source(),tgt=edge.target(),_weight=weightFn(edge),srcInfo=getInfo(src),tgtInfo=getInfo(tgt);checkForEdgeReplacement(src,0,edge,srcInfo,tgtInfo,_weight),directed||checkForEdgeReplacement(tgt,0,edge,tgtInfo,srcInfo,_weight)}if(!replacedEdge)break}if(replacedEdge)for(var _e=0;_e<numEdges;_e++){var _edge=edges[_e],_src=_edge.source(),_tgt=_edge.target(),_weight2=weightFn(_edge),srcDist=getInfo(_src).dist,tgtDist=getInfo(_tgt).dist;if(srcDist+_weight2<tgtDist||!directed&&tgtDist+_weight2<srcDist){warn("Graph contains a negative weight cycle for Bellman-Ford"),hasNegativeWeightCycle=!0;break}}return{distanceTo:function distanceTo(to){return getInfo(getNodeFromTo(to)).dist},pathTo:function pathTo(to){for(var thisStart=arguments.length>1&&void 0!==arguments[1]?arguments[1]:root,end=getNodeFromTo(to),path=[],node=end;;){if(null==node)return _this.spawn();var _getInfo=getInfo(node),edge=_getInfo.edge,pred=_getInfo.pred;if(path.unshift(node[0]),node.same(thisStart)&&path.length>0)break;null!=edge&&path.unshift(edge),node=pred}return eles.spawn(path)},hasNegativeWeightCycle:hasNegativeWeightCycle,negativeWeightCycles:[]}}},sqrt2=Math.sqrt(2),collapse=function collapse(edgeIndex,nodeMap,remainingEdges){0===remainingEdges.length&&error("Karger-Stein must be run on a connected (sub)graph");for(var edgeInfo=remainingEdges[edgeIndex],sourceIn=edgeInfo[1],targetIn=edgeInfo[2],partition1=nodeMap[sourceIn],partition2=nodeMap[targetIn],newEdges=remainingEdges,i=newEdges.length-1;i>=0;i--){var edge=newEdges[i],src=edge[1],tgt=edge[2];(nodeMap[src]===partition1&&nodeMap[tgt]===partition2||nodeMap[src]===partition2&&nodeMap[tgt]===partition1)&&newEdges.splice(i,1)}for(var _i=0;_i<newEdges.length;_i++){var _edge=newEdges[_i];_edge[1]===partition2?(newEdges[_i]=_edge.slice(),newEdges[_i][1]=partition1):_edge[2]===partition2&&(newEdges[_i]=_edge.slice(),newEdges[_i][2]=partition1)}for(var _i2=0;_i2<nodeMap.length;_i2++)nodeMap[_i2]===partition2&&(nodeMap[_i2]=partition1);return newEdges},contractUntil=function contractUntil(metaNodeMap,remainingEdges,size,sizeLimit){for(;size>sizeLimit;){var edgeIndex=Math.floor(Math.random()*remainingEdges.length);remainingEdges=collapse(edgeIndex,metaNodeMap,remainingEdges),size--}return remainingEdges},elesfn$6={kargerStein:function kargerStein(){var _this=this,_this$byGroup=this.byGroup(),nodes=_this$byGroup.nodes,edges=_this$byGroup.edges;edges.unmergeBy((function(edge){return edge.isLoop()}));var numNodes=nodes.length,numEdges=edges.length,numIter=Math.ceil(Math.pow(Math.log(numNodes)/Math.LN2,2)),stopSize=Math.floor(numNodes/sqrt2);if(!(numNodes<2)){for(var edgeIndexes=[],i=0;i<numEdges;i++){var e=edges[i];edgeIndexes.push([i,nodes.indexOf(e.source()),nodes.indexOf(e.target())])}for(var minCutSize=1/0,minCutEdgeIndexes=[],minCutNodeMap=new Array(numNodes),metaNodeMap=new Array(numNodes),metaNodeMap2=new Array(numNodes),copyNodesMap=function copyNodesMap(from,to){for(var _i3=0;_i3<numNodes;_i3++)to[_i3]=from[_i3]},iter=0;iter<=numIter;iter++){for(var _i4=0;_i4<numNodes;_i4++)metaNodeMap[_i4]=_i4;var edgesState=contractUntil(metaNodeMap,edgeIndexes.slice(),numNodes,stopSize),edgesState2=edgesState.slice();copyNodesMap(metaNodeMap,metaNodeMap2);var res1=contractUntil(metaNodeMap,edgesState,stopSize,2),res2=contractUntil(metaNodeMap2,edgesState2,stopSize,2);res1.length<=res2.length&&res1.length<minCutSize?(minCutSize=res1.length,minCutEdgeIndexes=res1,copyNodesMap(metaNodeMap,minCutNodeMap)):res2.length<=res1.length&&res2.length<minCutSize&&(minCutSize=res2.length,minCutEdgeIndexes=res2,copyNodesMap(metaNodeMap2,minCutNodeMap))}for(var cut=this.spawn(minCutEdgeIndexes.map((function(e){return edges[e[0]]}))),partition1=this.spawn(),partition2=this.spawn(),witnessNodePartition=minCutNodeMap[0],_i5=0;_i5<minCutNodeMap.length;_i5++){var partitionId=minCutNodeMap[_i5],node=nodes[_i5];partitionId===witnessNodePartition?partition1.merge(node):partition2.merge(node)}var constructComponent=function constructComponent(subset){var component=_this.spawn();return subset.forEach((function(node){component.merge(node),node.connectedEdges().forEach((function(edge){_this.contains(edge)&&!cut.contains(edge)&&component.merge(edge)}))})),component},components=[constructComponent(partition1),constructComponent(partition2)];return{cut:cut,components:components,partition1:partition1,partition2:partition2}}error("At least 2 nodes are required for Karger-Stein algorithm")}},modelToRenderedPosition=function modelToRenderedPosition(p,zoom,pan){return{x:p.x*zoom+pan.x,y:p.y*zoom+pan.y}},renderedToModelPosition=function renderedToModelPosition(p,zoom,pan){return{x:(p.x-pan.x)/zoom,y:(p.y-pan.y)/zoom}},array2point=function array2point(arr){return{x:arr[0],y:arr[1]}},getAngleFromDisp=function getAngleFromDisp(dispX,dispY){return Math.atan2(dispY,dispX)-Math.PI/2},log2=Math.log2||function(n){return Math.log(n)/Math.log(2)},signum=function signum(x){return x>0?1:x<0?-1:0},dist=function dist(p1,p2){return Math.sqrt(sqdist(p1,p2))},sqdist=function sqdist(p1,p2){var dx=p2.x-p1.x,dy=p2.y-p1.y;return dx*dx+dy*dy},inPlaceSumNormalize=function inPlaceSumNormalize(v){for(var length=v.length,total=0,i=0;i<length;i++)total+=v[i];for(var _i=0;_i<length;_i++)v[_i]=v[_i]/total;return v},qbezierAt=function qbezierAt(p0,p1,p2,t){return(1-t)*(1-t)*p0+2*(1-t)*t*p1+t*t*p2},qbezierPtAt=function qbezierPtAt(p0,p1,p2,t){return{x:qbezierAt(p0.x,p1.x,p2.x,t),y:qbezierAt(p0.y,p1.y,p2.y,t)}},bound=function bound(min,val,max){return Math.max(min,Math.min(max,val))},makeBoundingBox=function makeBoundingBox(bb){if(null==bb)return{x1:1/0,y1:1/0,x2:-1/0,y2:-1/0,w:0,h:0};if(null!=bb.x1&&null!=bb.y1){if(null!=bb.x2&&null!=bb.y2&&bb.x2>=bb.x1&&bb.y2>=bb.y1)return{x1:bb.x1,y1:bb.y1,x2:bb.x2,y2:bb.y2,w:bb.x2-bb.x1,h:bb.y2-bb.y1};if(null!=bb.w&&null!=bb.h&&bb.w>=0&&bb.h>=0)return{x1:bb.x1,y1:bb.y1,x2:bb.x1+bb.w,y2:bb.y1+bb.h,w:bb.w,h:bb.h}}},updateBoundingBox=function updateBoundingBox(bb1,bb2){bb1.x1=Math.min(bb1.x1,bb2.x1),bb1.x2=Math.max(bb1.x2,bb2.x2),bb1.w=bb1.x2-bb1.x1,bb1.y1=Math.min(bb1.y1,bb2.y1),bb1.y2=Math.max(bb1.y2,bb2.y2),bb1.h=bb1.y2-bb1.y1},expandBoundingBoxByPoint=function expandBoundingBoxByPoint(bb,x,y){bb.x1=Math.min(bb.x1,x),bb.x2=Math.max(bb.x2,x),bb.w=bb.x2-bb.x1,bb.y1=Math.min(bb.y1,y),bb.y2=Math.max(bb.y2,y),bb.h=bb.y2-bb.y1},expandBoundingBox=function expandBoundingBox(bb){var padding=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return bb.x1-=padding,bb.x2+=padding,bb.y1-=padding,bb.y2+=padding,bb.w=bb.x2-bb.x1,bb.h=bb.y2-bb.y1,bb},expandBoundingBoxSides=function expandBoundingBoxSides(bb){var top,right,bottom,left,padding=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0];if(1===padding.length)top=right=bottom=left=padding[0];else if(2===padding.length)top=bottom=padding[0],left=right=padding[1];else if(4===padding.length){var _padding=_slicedToArray(padding,4);top=_padding[0],right=_padding[1],bottom=_padding[2],left=_padding[3]}return bb.x1-=left,bb.x2+=right,bb.y1-=top,bb.y2+=bottom,bb.w=bb.x2-bb.x1,bb.h=bb.y2-bb.y1,bb},assignBoundingBox=function assignBoundingBox(bb1,bb2){bb1.x1=bb2.x1,bb1.y1=bb2.y1,bb1.x2=bb2.x2,bb1.y2=bb2.y2,bb1.w=bb1.x2-bb1.x1,bb1.h=bb1.y2-bb1.y1},boundingBoxesIntersect=function boundingBoxesIntersect(bb1,bb2){return!(bb1.x1>bb2.x2)&&(!(bb2.x1>bb1.x2)&&(!(bb1.x2<bb2.x1)&&(!(bb2.x2<bb1.x1)&&(!(bb1.y2<bb2.y1)&&(!(bb2.y2<bb1.y1)&&(!(bb1.y1>bb2.y2)&&!(bb2.y1>bb1.y2)))))))},inBoundingBox=function inBoundingBox(bb,x,y){return bb.x1<=x&&x<=bb.x2&&bb.y1<=y&&y<=bb.y2},pointInBoundingBox=function pointInBoundingBox(bb,pt){return inBoundingBox(bb,pt.x,pt.y)},boundingBoxInBoundingBox=function boundingBoxInBoundingBox(bb1,bb2){return inBoundingBox(bb1,bb2.x1,bb2.y1)&&inBoundingBox(bb1,bb2.x2,bb2.y2)},roundRectangleIntersectLine=function roundRectangleIntersectLine(x,y,nodeX,nodeY,width,height,padding){var straightLineIntersections,cornerRadius=getRoundRectangleRadius(width,height),halfWidth=width/2,halfHeight=height/2,topStartY=nodeY-halfHeight-padding;if((straightLineIntersections=finiteLinesIntersect(x,y,nodeX,nodeY,nodeX-halfWidth+cornerRadius-padding,topStartY,nodeX+halfWidth-cornerRadius+padding,topStartY,!1)).length>0)return straightLineIntersections;var rightStartX=nodeX+halfWidth+padding;if((straightLineIntersections=finiteLinesIntersect(x,y,nodeX,nodeY,rightStartX,nodeY-halfHeight+cornerRadius-padding,rightStartX,nodeY+halfHeight-cornerRadius+padding,!1)).length>0)return straightLineIntersections;var bottomStartY=nodeY+halfHeight+padding;if((straightLineIntersections=finiteLinesIntersect(x,y,nodeX,nodeY,nodeX-halfWidth+cornerRadius-padding,bottomStartY,nodeX+halfWidth-cornerRadius+padding,bottomStartY,!1)).length>0)return straightLineIntersections;var arcIntersections,leftStartX=nodeX-halfWidth-padding;if((straightLineIntersections=finiteLinesIntersect(x,y,nodeX,nodeY,leftStartX,nodeY-halfHeight+cornerRadius-padding,leftStartX,nodeY+halfHeight-cornerRadius+padding,!1)).length>0)return straightLineIntersections;var topLeftCenterX=nodeX-halfWidth+cornerRadius,topLeftCenterY=nodeY-halfHeight+cornerRadius;if((arcIntersections=intersectLineCircle(x,y,nodeX,nodeY,topLeftCenterX,topLeftCenterY,cornerRadius+padding)).length>0&&arcIntersections[0]<=topLeftCenterX&&arcIntersections[1]<=topLeftCenterY)return[arcIntersections[0],arcIntersections[1]];var topRightCenterX=nodeX+halfWidth-cornerRadius,topRightCenterY=nodeY-halfHeight+cornerRadius;if((arcIntersections=intersectLineCircle(x,y,nodeX,nodeY,topRightCenterX,topRightCenterY,cornerRadius+padding)).length>0&&arcIntersections[0]>=topRightCenterX&&arcIntersections[1]<=topRightCenterY)return[arcIntersections[0],arcIntersections[1]];var bottomRightCenterX=nodeX+halfWidth-cornerRadius,bottomRightCenterY=nodeY+halfHeight-cornerRadius;if((arcIntersections=intersectLineCircle(x,y,nodeX,nodeY,bottomRightCenterX,bottomRightCenterY,cornerRadius+padding)).length>0&&arcIntersections[0]>=bottomRightCenterX&&arcIntersections[1]>=bottomRightCenterY)return[arcIntersections[0],arcIntersections[1]];var bottomLeftCenterX=nodeX-halfWidth+cornerRadius,bottomLeftCenterY=nodeY+halfHeight-cornerRadius;return(arcIntersections=intersectLineCircle(x,y,nodeX,nodeY,bottomLeftCenterX,bottomLeftCenterY,cornerRadius+padding)).length>0&&arcIntersections[0]<=bottomLeftCenterX&&arcIntersections[1]>=bottomLeftCenterY?[arcIntersections[0],arcIntersections[1]]:[]},inLineVicinity=function inLineVicinity(x,y,lx1,ly1,lx2,ly2,tolerance){var t=tolerance,x1=Math.min(lx1,lx2),x2=Math.max(lx1,lx2),y1=Math.min(ly1,ly2),y2=Math.max(ly1,ly2);return x1-t<=x&&x<=x2+t&&y1-t<=y&&y<=y2+t},inBezierVicinity=function inBezierVicinity(x,y,x1,y1,x2,y2,x3,y3,tolerance){var bb_x1=Math.min(x1,x3,x2)-tolerance,bb_x2=Math.max(x1,x3,x2)+tolerance,bb_y1=Math.min(y1,y3,y2)-tolerance,bb_y2=Math.max(y1,y3,y2)+tolerance;return!(x<bb_x1||x>bb_x2||y<bb_y1||y>bb_y2)},sqdistToQuadraticBezier=function sqdistToQuadraticBezier(x,y,x1,y1,x2,y2,x3,y3){var roots=[];!function solveCubic(a,b,c,d,result){var discriminant,q,r,dum1,s,t,term1,r13;0===a&&(a=1e-5),r=-27*(d/=a)+(b/=a)*(9*(c/=a)-b*b*2),discriminant=(q=(3*c-b*b)/9)*q*q+(r/=54)*r,result[1]=0,term1=b/3,discriminant>0?(s=(s=r+Math.sqrt(discriminant))<0?-Math.pow(-s,1/3):Math.pow(s,1/3),t=(t=r-Math.sqrt(discriminant))<0?-Math.pow(-t,1/3):Math.pow(t,1/3),result[0]=-term1+s+t,term1+=(s+t)/2,result[4]=result[2]=-term1,term1=Math.sqrt(3)*(-t+s)/2,result[3]=term1,result[5]=-term1):(result[5]=result[3]=0,0===discriminant?(r13=r<0?-Math.pow(-r,1/3):Math.pow(r,1/3),result[0]=2*r13-term1,result[4]=result[2]=-(r13+term1)):(dum1=(q=-q)*q*q,dum1=Math.acos(r/Math.sqrt(dum1)),r13=2*Math.sqrt(q),result[0]=-term1+r13*Math.cos(dum1/3),result[2]=-term1+r13*Math.cos((dum1+2*Math.PI)/3),result[4]=-term1+r13*Math.cos((dum1+4*Math.PI)/3)))}(1*x1*x1-4*x1*x2+2*x1*x3+4*x2*x2-4*x2*x3+x3*x3+y1*y1-4*y1*y2+2*y1*y3+4*y2*y2-4*y2*y3+y3*y3,9*x1*x2-3*x1*x1-3*x1*x3-6*x2*x2+3*x2*x3+9*y1*y2-3*y1*y1-3*y1*y3-6*y2*y2+3*y2*y3,3*x1*x1-6*x1*x2+x1*x3-x1*x+2*x2*x2+2*x2*x-x3*x+3*y1*y1-6*y1*y2+y1*y3-y1*y+2*y2*y2+2*y2*y-y3*y,1*x1*x2-x1*x1+x1*x-x2*x+y1*y2-y1*y1+y1*y-y2*y,roots);for(var params=[],index=0;index<6;index+=2)Math.abs(roots[index+1])<1e-7&&roots[index]>=0&&roots[index]<=1&&params.push(roots[index]);params.push(1),params.push(0);for(var curX,curY,distSquared,minDistanceSquared=-1,i=0;i<params.length;i++)curX=Math.pow(1-params[i],2)*x1+2*(1-params[i])*params[i]*x2+params[i]*params[i]*x3,curY=Math.pow(1-params[i],2)*y1+2*(1-params[i])*params[i]*y2+params[i]*params[i]*y3,distSquared=Math.pow(curX-x,2)+Math.pow(curY-y,2),minDistanceSquared>=0?distSquared<minDistanceSquared&&(minDistanceSquared=distSquared):minDistanceSquared=distSquared;return minDistanceSquared},sqdistToFiniteLine=function sqdistToFiniteLine(x,y,x1,y1,x2,y2){var offset=[x-x1,y-y1],line=[x2-x1,y2-y1],lineSq=line[0]*line[0]+line[1]*line[1],hypSq=offset[0]*offset[0]+offset[1]*offset[1],dotProduct=offset[0]*line[0]+offset[1]*line[1],adjSq=dotProduct*dotProduct/lineSq;return dotProduct<0?hypSq:adjSq>lineSq?(x-x2)*(x-x2)+(y-y2)*(y-y2):hypSq-adjSq},pointInsidePolygonPoints=function pointInsidePolygonPoints(x,y,points){for(var x1,y1,x2,y2,up=0,i=0;i<points.length/2;i++)if(x1=points[2*i],y1=points[2*i+1],i+1<points.length/2?(x2=points[2*(i+1)],y2=points[2*(i+1)+1]):(x2=points[2*(i+1-points.length/2)],y2=points[2*(i+1-points.length/2)+1]),x1==x&&x2==x);else{if(!(x1>=x&&x>=x2||x1<=x&&x<=x2))continue;(x-x1)/(x2-x1)*(y2-y1)+y1>y&&up++}return up%2!=0},pointInsidePolygon=function pointInsidePolygon(x,y,basePoints,centerX,centerY,width,height,direction,padding){var angle,transformedPoints=new Array(basePoints.length);null!=direction[0]?(angle=Math.atan(direction[1]/direction[0]),direction[0]<0?angle+=Math.PI/2:angle=-angle-Math.PI/2):angle=direction;for(var points,cos=Math.cos(-angle),sin=Math.sin(-angle),i=0;i<transformedPoints.length/2;i++)transformedPoints[2*i]=width/2*(basePoints[2*i]*cos-basePoints[2*i+1]*sin),transformedPoints[2*i+1]=height/2*(basePoints[2*i+1]*cos+basePoints[2*i]*sin),transformedPoints[2*i]+=centerX,transformedPoints[2*i+1]+=centerY;if(padding>0){var expandedLineSet=expandPolygon(transformedPoints,-padding);points=joinLines(expandedLineSet)}else points=transformedPoints;return pointInsidePolygonPoints(x,y,points)},joinLines=function joinLines(lineSet){for(var currentLineStartX,currentLineStartY,currentLineEndX,currentLineEndY,nextLineStartX,nextLineStartY,nextLineEndX,nextLineEndY,vertices=new Array(lineSet.length/2),i=0;i<lineSet.length/4;i++){currentLineStartX=lineSet[4*i],currentLineStartY=lineSet[4*i+1],currentLineEndX=lineSet[4*i+2],currentLineEndY=lineSet[4*i+3],i<lineSet.length/4-1?(nextLineStartX=lineSet[4*(i+1)],nextLineStartY=lineSet[4*(i+1)+1],nextLineEndX=lineSet[4*(i+1)+2],nextLineEndY=lineSet[4*(i+1)+3]):(nextLineStartX=lineSet[0],nextLineStartY=lineSet[1],nextLineEndX=lineSet[2],nextLineEndY=lineSet[3]);var intersection=finiteLinesIntersect(currentLineStartX,currentLineStartY,currentLineEndX,currentLineEndY,nextLineStartX,nextLineStartY,nextLineEndX,nextLineEndY,!0);vertices[2*i]=intersection[0],vertices[2*i+1]=intersection[1]}return vertices},expandPolygon=function expandPolygon(points,pad){for(var currentPointX,currentPointY,nextPointX,nextPointY,expandedLineSet=new Array(2*points.length),i=0;i<points.length/2;i++){currentPointX=points[2*i],currentPointY=points[2*i+1],i<points.length/2-1?(nextPointX=points[2*(i+1)],nextPointY=points[2*(i+1)+1]):(nextPointX=points[0],nextPointY=points[1]);var offsetX=nextPointY-currentPointY,offsetY=-(nextPointX-currentPointX),offsetLength=Math.sqrt(offsetX*offsetX+offsetY*offsetY),normalizedOffsetX=offsetX/offsetLength,normalizedOffsetY=offsetY/offsetLength;expandedLineSet[4*i]=currentPointX+normalizedOffsetX*pad,expandedLineSet[4*i+1]=currentPointY+normalizedOffsetY*pad,expandedLineSet[4*i+2]=nextPointX+normalizedOffsetX*pad,expandedLineSet[4*i+3]=nextPointY+normalizedOffsetY*pad}return expandedLineSet},checkInEllipse=function checkInEllipse(x,y,width,height,centerX,centerY,padding){return x-=centerX,y-=centerY,(x/=width/2+padding)*x+(y/=height/2+padding)*y<=1},intersectLineCircle=function intersectLineCircle(x1,y1,x2,y2,centerX,centerY,radius){var d=[x2-x1,y2-y1],f=[x1-centerX,y1-centerY],a=d[0]*d[0]+d[1]*d[1],b=2*(f[0]*d[0]+f[1]*d[1]),discriminant=b*b-4*a*(f[0]*f[0]+f[1]*f[1]-radius*radius);if(discriminant<0)return[];var t1=(-b+Math.sqrt(discriminant))/(2*a),t2=(-b-Math.sqrt(discriminant))/(2*a),tMin=Math.min(t1,t2),tMax=Math.max(t1,t2),inRangeParams=[];if(tMin>=0&&tMin<=1&&inRangeParams.push(tMin),tMax>=0&&tMax<=1&&inRangeParams.push(tMax),0===inRangeParams.length)return[];var nearIntersectionX=inRangeParams[0]*d[0]+x1,nearIntersectionY=inRangeParams[0]*d[1]+y1;return inRangeParams.length>1?inRangeParams[0]==inRangeParams[1]?[nearIntersectionX,nearIntersectionY]:[nearIntersectionX,nearIntersectionY,inRangeParams[1]*d[0]+x1,inRangeParams[1]*d[1]+y1]:[nearIntersectionX,nearIntersectionY]},midOfThree=function midOfThree(a,b,c){return b<=a&&a<=c||c<=a&&a<=b?a:a<=b&&b<=c||c<=b&&b<=a?b:c},finiteLinesIntersect=function finiteLinesIntersect(x1,y1,x2,y2,x3,y3,x4,y4,infiniteLines){var dx13=x1-x3,dx21=x2-x1,dx43=x4-x3,dy13=y1-y3,dy21=y2-y1,dy43=y4-y3,ua_t=dx43*dy13-dy43*dx13,ub_t=dx21*dy13-dy21*dx13,u_b=dy43*dx21-dx43*dy21;if(0!==u_b){var ua=ua_t/u_b,ub=ub_t/u_b;return-.001<=ua&&ua<=1.001&&-.001<=ub&&ub<=1.001||infiniteLines?[x1+ua*dx21,y1+ua*dy21]:[]}return 0===ua_t||0===ub_t?midOfThree(x1,x2,x4)===x4?[x4,y4]:midOfThree(x1,x2,x3)===x3?[x3,y3]:midOfThree(x3,x4,x2)===x2?[x2,y2]:[]:[]},polygonIntersectLine=function polygonIntersectLine(x,y,basePoints,centerX,centerY,width,height,padding){var intersection,points,currentX,currentY,nextX,nextY,intersections=[],transformedPoints=new Array(basePoints.length),doTransform=!0;if(null==width&&(doTransform=!1),doTransform){for(var i=0;i<transformedPoints.length/2;i++)transformedPoints[2*i]=basePoints[2*i]*width+centerX,transformedPoints[2*i+1]=basePoints[2*i+1]*height+centerY;if(padding>0){var expandedLineSet=expandPolygon(transformedPoints,-padding);points=joinLines(expandedLineSet)}else points=transformedPoints}else points=basePoints;for(var _i2=0;_i2<points.length/2;_i2++)currentX=points[2*_i2],currentY=points[2*_i2+1],_i2<points.length/2-1?(nextX=points[2*(_i2+1)],nextY=points[2*(_i2+1)+1]):(nextX=points[0],nextY=points[1]),0!==(intersection=finiteLinesIntersect(x,y,centerX,centerY,currentX,currentY,nextX,nextY)).length&&intersections.push(intersection[0],intersection[1]);return intersections},shortenIntersection=function shortenIntersection(intersection,offset,amount){var disp=[intersection[0]-offset[0],intersection[1]-offset[1]],length=Math.sqrt(disp[0]*disp[0]+disp[1]*disp[1]),lenRatio=(length-amount)/length;return lenRatio<0&&(lenRatio=1e-5),[offset[0]+lenRatio*disp[0],offset[1]+lenRatio*disp[1]]},generateUnitNgonPointsFitToSquare=function generateUnitNgonPointsFitToSquare(sides,rotationRadians){var points=generateUnitNgonPoints(sides,rotationRadians);return points=fitPolygonToSquare(points)},fitPolygonToSquare=function fitPolygonToSquare(points){for(var x,y,sides=points.length/2,minX=1/0,minY=1/0,maxX=-1/0,maxY=-1/0,i=0;i<sides;i++)x=points[2*i],y=points[2*i+1],minX=Math.min(minX,x),maxX=Math.max(maxX,x),minY=Math.min(minY,y),maxY=Math.max(maxY,y);for(var sx=2/(maxX-minX),sy=2/(maxY-minY),_i5=0;_i5<sides;_i5++)x=points[2*_i5]=points[2*_i5]*sx,y=points[2*_i5+1]=points[2*_i5+1]*sy,minX=Math.min(minX,x),maxX=Math.max(maxX,x),minY=Math.min(minY,y),maxY=Math.max(maxY,y);if(minY<-1)for(var _i6=0;_i6<sides;_i6++)y=points[2*_i6+1]=points[2*_i6+1]+(-1-minY);return points},generateUnitNgonPoints=function generateUnitNgonPoints(sides,rotationRadians){var increment=1/sides*2*Math.PI,startAngle=sides%2==0?Math.PI/2+increment/2:Math.PI/2;startAngle+=rotationRadians;for(var currentAngle,points=new Array(2*sides),i=0;i<sides;i++)currentAngle=i*increment+startAngle,points[2*i]=Math.cos(currentAngle),points[2*i+1]=Math.sin(-currentAngle);return points},getRoundRectangleRadius=function getRoundRectangleRadius(width,height){return Math.min(width/4,height/4,8)},getRoundPolygonRadius=function getRoundPolygonRadius(width,height){return Math.min(width/10,height/10,8)},getBarrelCurveConstants=function getBarrelCurveConstants(width,height){return{heightOffset:Math.min(15,.05*height),widthOffset:Math.min(100,.25*width),ctrlPtOffsetPct:.05}},pageRankDefaults=defaults({dampingFactor:.8,precision:1e-6,iterations:200,weight:function weight(edge){return 1}}),elesfn$7={pageRank:function pageRank(options){for(var _pageRankDefaults=pageRankDefaults(options),dampingFactor=_pageRankDefaults.dampingFactor,precision=_pageRankDefaults.precision,iterations=_pageRankDefaults.iterations,weight=_pageRankDefaults.weight,cy=this._private.cy,_this$byGroup=this.byGroup(),nodes=_this$byGroup.nodes,edges=_this$byGroup.edges,numNodes=nodes.length,numNodesSqd=numNodes*numNodes,numEdges=edges.length,matrix=new Array(numNodesSqd),columnSum=new Array(numNodes),additionalProb=(1-dampingFactor)/numNodes,i=0;i<numNodes;i++){for(var j=0;j<numNodes;j++){matrix[i*numNodes+j]=0}columnSum[i]=0}for(var _i=0;_i<numEdges;_i++){var edge=edges[_i],srcId=edge.data("source"),tgtId=edge.data("target");if(srcId!==tgtId){var s=nodes.indexOfId(srcId),t=nodes.indexOfId(tgtId),w=weight(edge);matrix[t*numNodes+s]+=w,columnSum[s]+=w}}for(var p=1/numNodes+additionalProb,_j=0;_j<numNodes;_j++)if(0===columnSum[_j])for(var _i2=0;_i2<numNodes;_i2++){matrix[_i2*numNodes+_j]=p}else for(var _i3=0;_i3<numNodes;_i3++){var _n3=_i3*numNodes+_j;matrix[_n3]=matrix[_n3]/columnSum[_j]+additionalProb}for(var previous,eigenvector=new Array(numNodes),temp=new Array(numNodes),_i4=0;_i4<numNodes;_i4++)eigenvector[_i4]=1;for(var iter=0;iter<iterations;iter++){for(var _i5=0;_i5<numNodes;_i5++)temp[_i5]=0;for(var _i6=0;_i6<numNodes;_i6++)for(var _j2=0;_j2<numNodes;_j2++){var _n4=_i6*numNodes+_j2;temp[_i6]+=matrix[_n4]*eigenvector[_j2]}inPlaceSumNormalize(temp),previous=eigenvector,eigenvector=temp,temp=previous;for(var diff=0,_i7=0;_i7<numNodes;_i7++){var delta=previous[_i7]-eigenvector[_i7];diff+=delta*delta}if(diff<precision)break}return{rank:function rank(node){return node=cy.collection(node)[0],eigenvector[nodes.indexOf(node)]}}}},defaults$1=defaults({root:null,weight:function weight(edge){return 1},directed:!1,alpha:0}),elesfn$8={degreeCentralityNormalized:function degreeCentralityNormalized(options){options=defaults$1(options);var cy=this.cy(),nodes=this.nodes(),numNodes=nodes.length;if(options.directed){for(var indegrees={},outdegrees={},maxIndegree=0,maxOutdegree=0,_i=0;_i<numNodes;_i++){var _node=nodes[_i],id=_node.id();options.root=_node;var _currDegree=this.degreeCentrality(options);maxIndegree<_currDegree.indegree&&(maxIndegree=_currDegree.indegree),maxOutdegree<_currDegree.outdegree&&(maxOutdegree=_currDegree.outdegree),indegrees[id]=_currDegree.indegree,outdegrees[id]=_currDegree.outdegree}return{indegree:function indegree(node){return 0==maxIndegree?0:(string(node)&&(node=cy.filter(node)),indegrees[node.id()]/maxIndegree)},outdegree:function outdegree(node){return 0===maxOutdegree?0:(string(node)&&(node=cy.filter(node)),outdegrees[node.id()]/maxOutdegree)}}}for(var degrees={},maxDegree=0,i=0;i<numNodes;i++){var node=nodes[i];options.root=node;var currDegree=this.degreeCentrality(options);maxDegree<currDegree.degree&&(maxDegree=currDegree.degree),degrees[node.id()]=currDegree.degree}return{degree:function degree(node){return 0===maxDegree?0:(string(node)&&(node=cy.filter(node)),degrees[node.id()]/maxDegree)}}},degreeCentrality:function degreeCentrality(options){options=defaults$1(options);var cy=this.cy(),callingEles=this,_options=options,root=_options.root,weight=_options.weight,directed=_options.directed,alpha=_options.alpha;if(root=cy.collection(root)[0],directed){for(var edges=root.connectedEdges(),incoming=edges.filter((function(edge){return edge.target().same(root)&&callingEles.has(edge)})),outgoing=edges.filter((function(edge){return edge.source().same(root)&&callingEles.has(edge)})),k_in=incoming.length,k_out=outgoing.length,s_in=0,s_out=0,_i2=0;_i2<incoming.length;_i2++)s_in+=weight(incoming[_i2]);for(var _i3=0;_i3<outgoing.length;_i3++)s_out+=weight(outgoing[_i3]);return{indegree:Math.pow(k_in,1-alpha)*Math.pow(s_in,alpha),outdegree:Math.pow(k_out,1-alpha)*Math.pow(s_out,alpha)}}for(var connEdges=root.connectedEdges().intersection(callingEles),k=connEdges.length,s=0,i=0;i<connEdges.length;i++)s+=weight(connEdges[i]);return{degree:Math.pow(k,1-alpha)*Math.pow(s,alpha)}}};elesfn$8.dc=elesfn$8.degreeCentrality,elesfn$8.dcn=elesfn$8.degreeCentralityNormalised=elesfn$8.degreeCentralityNormalized;var defaults$2=defaults({harmonic:!0,weight:function weight(){return 1},directed:!1,root:null}),elesfn$9={closenessCentralityNormalized:function closenessCentralityNormalized(options){for(var _defaults=defaults$2(options),harmonic=_defaults.harmonic,weight=_defaults.weight,directed=_defaults.directed,cy=this.cy(),closenesses={},maxCloseness=0,nodes=this.nodes(),fw=this.floydWarshall({weight:weight,directed:directed}),i=0;i<nodes.length;i++){for(var currCloseness=0,node_i=nodes[i],j=0;j<nodes.length;j++)if(i!==j){var d=fw.distance(node_i,nodes[j]);currCloseness+=harmonic?1/d:d}harmonic||(currCloseness=1/currCloseness),maxCloseness<currCloseness&&(maxCloseness=currCloseness),closenesses[node_i.id()]=currCloseness}return{closeness:function closeness(node){return 0==maxCloseness?0:(node=string(node)?cy.filter(node)[0].id():node.id(),closenesses[node]/maxCloseness)}}},closenessCentrality:function closenessCentrality(options){var _defaults2=defaults$2(options),root=_defaults2.root,weight=_defaults2.weight,directed=_defaults2.directed,harmonic=_defaults2.harmonic;root=this.filter(root)[0];for(var dijkstra=this.dijkstra({root:root,weight:weight,directed:directed}),totalDistance=0,nodes=this.nodes(),i=0;i<nodes.length;i++){var n=nodes[i];if(!n.same(root)){var d=dijkstra.distanceTo(n);totalDistance+=harmonic?1/d:d}}return harmonic?totalDistance:1/totalDistance}};elesfn$9.cc=elesfn$9.closenessCentrality,elesfn$9.ccn=elesfn$9.closenessCentralityNormalised=elesfn$9.closenessCentralityNormalized;var defaults$3=defaults({weight:null,directed:!1}),elesfn$a={betweennessCentrality:function betweennessCentrality(options){for(var _defaults=defaults$3(options),directed=_defaults.directed,weight=_defaults.weight,weighted=null!=weight,cy=this.cy(),V=this.nodes(),A={},_C={},max=0,C_set=function set(key,val){_C[key]=val,val>max&&(max=val)},C_get=function get(key){return _C[key]},i=0;i<V.length;i++){var v=V[i],vid=v.id();A[vid]=directed?v.outgoers().nodes():v.openNeighborhood().nodes(),C_set(vid,0)}for(var _loop=function _loop(s){for(var sid=V[s].id(),S=[],P={},g={},d={},Q=new Heap((function(a,b){return d[a]-d[b]})),_i=0;_i<V.length;_i++){var _vid=V[_i].id();P[_vid]=[],g[_vid]=0,d[_vid]=1/0}for(g[sid]=1,d[sid]=0,Q.push(sid);!Q.empty();){var _v=Q.pop();if(S.push(_v),weighted)for(var j=0;j<A[_v].length;j++){var w=A[_v][j],vEle=cy.getElementById(_v),edge=void 0;edge=vEle.edgesTo(w).length>0?vEle.edgesTo(w)[0]:w.edgesTo(vEle)[0];var edgeWeight=weight(edge);w=w.id(),d[w]>d[_v]+edgeWeight&&(d[w]=d[_v]+edgeWeight,Q.nodes.indexOf(w)<0?Q.push(w):Q.updateItem(w),g[w]=0,P[w]=[]),d[w]==d[_v]+edgeWeight&&(g[w]=g[w]+g[_v],P[w].push(_v))}else for(var _j=0;_j<A[_v].length;_j++){var _w=A[_v][_j].id();d[_w]==1/0&&(Q.push(_w),d[_w]=d[_v]+1),d[_w]==d[_v]+1&&(g[_w]=g[_w]+g[_v],P[_w].push(_v))}}for(var e={},_i2=0;_i2<V.length;_i2++)e[V[_i2].id()]=0;for(;S.length>0;){for(var _w2=S.pop(),_j2=0;_j2<P[_w2].length;_j2++){var _v2=P[_w2][_j2];e[_v2]=e[_v2]+g[_v2]/g[_w2]*(1+e[_w2])}_w2!=V[s].id()&&C_set(_w2,C_get(_w2)+e[_w2])}},s=0;s<V.length;s++)_loop(s);var ret={betweenness:function betweenness(node){var id=cy.collection(node).id();return C_get(id)},betweennessNormalized:function betweennessNormalized(node){if(0==max)return 0;var id=cy.collection(node).id();return C_get(id)/max}};return ret.betweennessNormalised=ret.betweennessNormalized,ret}};elesfn$a.bc=elesfn$a.betweennessCentrality;var defaults$4=defaults({expandFactor:2,inflateFactor:2,multFactor:1,maxIterations:20,attributes:[function(edge){return 1}]}),getSimilarity=function getSimilarity(edge,attributes){for(var total=0,i=0;i<attributes.length;i++)total+=attributes[i](edge);return total},normalize=function normalize(M,n){for(var sum,col=0;col<n;col++){sum=0;for(var row=0;row<n;row++)sum+=M[row*n+col];for(var _row=0;_row<n;_row++)M[_row*n+col]=M[_row*n+col]/sum}},mmult=function mmult(A,B,n){for(var C=new Array(n*n),i=0;i<n;i++){for(var j=0;j<n;j++)C[i*n+j]=0;for(var k=0;k<n;k++)for(var _j=0;_j<n;_j++)C[i*n+_j]+=A[i*n+k]*B[k*n+_j]}return C},expand=function expand(M,n,expandFactor){for(var _M=M.slice(0),p=1;p<expandFactor;p++)M=mmult(M,_M,n);return M},inflate=function inflate(M,n,inflateFactor){for(var _M=new Array(n*n),i=0;i<n*n;i++)_M[i]=Math.pow(M[i],inflateFactor);return normalize(_M,n),_M},hasConverged=function hasConverged(M,_M,n2,roundFactor){for(var i=0;i<n2;i++){if(Math.round(M[i]*Math.pow(10,roundFactor))/Math.pow(10,roundFactor)!==Math.round(_M[i]*Math.pow(10,roundFactor))/Math.pow(10,roundFactor))return!1}return!0},isDuplicate=function isDuplicate(c1,c2){for(var i=0;i<c1.length;i++)if(!c2[i]||c1[i].id()!==c2[i].id())return!1;return!0},markovClustering=function markovClustering(options){for(var nodes=this.nodes(),edges=this.edges(),cy=this.cy(),opts=function setOptions(options){return defaults$4(options)}(options),id2position={},i=0;i<nodes.length;i++)id2position[nodes[i].id()]=i;for(var _M,n=nodes.length,n2=n*n,M=new Array(n2),_i=0;_i<n2;_i++)M[_i]=0;for(var e=0;e<edges.length;e++){var edge=edges[e],_i2=id2position[edge.source().id()],j=id2position[edge.target().id()],sim=getSimilarity(edge,opts.attributes);M[_i2*n+j]+=sim,M[j*n+_i2]+=sim}!function addLoops(M,n,val){for(var i=0;i<n;i++)M[i*n+i]=val}(M,n,opts.multFactor),normalize(M,n);for(var isStillMoving=!0,iterations=0;isStillMoving&&iterations<opts.maxIterations;)isStillMoving=!1,_M=expand(M,n,opts.expandFactor),M=inflate(_M,n,opts.inflateFactor),hasConverged(M,_M,n2,4)||(isStillMoving=!0),iterations++;var clusters=function assign(M,n,nodes,cy){for(var clusters=[],i=0;i<n;i++){for(var cluster=[],j=0;j<n;j++)Math.round(1e3*M[i*n+j])/1e3>0&&cluster.push(nodes[j]);0!==cluster.length&&clusters.push(cy.collection(cluster))}return clusters}(M,n,nodes,cy);return clusters=function removeDuplicates(clusters){for(var i=0;i<clusters.length;i++)for(var j=0;j<clusters.length;j++)i!=j&&isDuplicate(clusters[i],clusters[j])&&clusters.splice(j,1);return clusters}(clusters)},markovClustering$1={markovClustering:markovClustering,mcl:markovClustering},identity=function identity(x){return x},absDiff=function absDiff(p,q){return Math.abs(q-p)},addAbsDiff=function addAbsDiff(total,p,q){return total+absDiff(p,q)},addSquaredDiff=function addSquaredDiff(total,p,q){return total+Math.pow(q-p,2)},sqrt=function sqrt(x){return Math.sqrt(x)},maxAbsDiff=function maxAbsDiff(currentMax,p,q){return Math.max(currentMax,absDiff(p,q))},getDistance=function getDistance(length,getP,getQ,init,visit){for(var post=arguments.length>5&&void 0!==arguments[5]?arguments[5]:identity,ret=init,dim=0;dim<length;dim++)ret=visit(ret,getP(dim),getQ(dim));return post(ret)},distances={euclidean:function euclidean(length,getP,getQ){return length>=2?getDistance(length,getP,getQ,0,addSquaredDiff,sqrt):getDistance(length,getP,getQ,0,addAbsDiff)},squaredEuclidean:function squaredEuclidean(length,getP,getQ){return getDistance(length,getP,getQ,0,addSquaredDiff)},manhattan:function manhattan(length,getP,getQ){return getDistance(length,getP,getQ,0,addAbsDiff)},max:function max(length,getP,getQ){return getDistance(length,getP,getQ,-1/0,maxAbsDiff)}};function clusteringDistance(method,length,getP,getQ,nodeP,nodeQ){var impl;return impl=fn(method)?method:distances[method]||distances.euclidean,0===length&&fn(method)?impl(nodeP,nodeQ):impl(length,getP,getQ,nodeP,nodeQ)}distances["squared-euclidean"]=distances.squaredEuclidean,distances.squaredeuclidean=distances.squaredEuclidean;var defaults$5=defaults({k:2,m:2,sensitivityThreshold:1e-4,distance:"euclidean",maxIterations:10,attributes:[],testMode:!1,testCentroids:null}),setOptions$1=function setOptions(options){return defaults$5(options)},getDist=function getDist(type,node,centroid,attributes,mode){var getP="kMedoids"!==mode?function(i){return centroid[i]}:function(i){return attributes[i](centroid)},nodeP=centroid,nodeQ=node;return clusteringDistance(type,attributes.length,getP,(function getQ(i){return attributes[i](node)}),nodeP,nodeQ)},randomCentroids=function randomCentroids(nodes,k,attributes){for(var ndim=attributes.length,min=new Array(ndim),max=new Array(ndim),centroids=new Array(k),centroid=null,i=0;i<ndim;i++)min[i]=nodes.min(attributes[i]).value,max[i]=nodes.max(attributes[i]).value;for(var c=0;c<k;c++){centroid=[];for(var _i=0;_i<ndim;_i++)centroid[_i]=Math.random()*(max[_i]-min[_i])+min[_i];centroids[c]=centroid}return centroids},classify=function classify(node,centroids,distance,attributes,type){for(var min=1/0,index=0,i=0;i<centroids.length;i++){var dist=getDist(distance,node,centroids[i],attributes,type);dist<min&&(min=dist,index=i)}return index},buildCluster=function buildCluster(centroid,nodes,assignment){for(var cluster=[],node=null,n=0;n<nodes.length;n++)assignment[(node=nodes[n]).id()]===centroid&&cluster.push(node);return cluster},haveValuesConverged=function haveValuesConverged(v1,v2,sensitivityThreshold){return Math.abs(v2-v1)<=sensitivityThreshold},haveMatricesConverged=function haveMatricesConverged(v1,v2,sensitivityThreshold){for(var i=0;i<v1.length;i++)for(var j=0;j<v1[i].length;j++){if(Math.abs(v1[i][j]-v2[i][j])>sensitivityThreshold)return!1}return!0},seenBefore=function seenBefore(node,medoids,n){for(var i=0;i<n;i++)if(node===medoids[i])return!0;return!1},randomMedoids=function randomMedoids(nodes,k){var medoids=new Array(k);if(nodes.length<50)for(var i=0;i<k;i++){for(var node=nodes[Math.floor(Math.random()*nodes.length)];seenBefore(node,medoids,i);)node=nodes[Math.floor(Math.random()*nodes.length)];medoids[i]=node}else for(var _i2=0;_i2<k;_i2++)medoids[_i2]=nodes[Math.floor(Math.random()*nodes.length)];return medoids},findCost=function findCost(potentialNewMedoid,cluster,attributes){for(var cost=0,n=0;n<cluster.length;n++)cost+=getDist("manhattan",cluster[n],potentialNewMedoid,attributes,"kMedoids");return cost},updateCentroids=function updateCentroids(centroids,nodes,U,weight,opts){for(var numerator,denominator,n=0;n<nodes.length;n++)for(var c=0;c<centroids.length;c++)weight[n][c]=Math.pow(U[n][c],opts.m);for(var _c=0;_c<centroids.length;_c++)for(var dim=0;dim<opts.attributes.length;dim++){numerator=0,denominator=0;for(var _n2=0;_n2<nodes.length;_n2++)numerator+=weight[_n2][_c]*opts.attributes[dim](nodes[_n2]),denominator+=weight[_n2][_c];centroids[_c][dim]=numerator/denominator}},updateMembership=function updateMembership(U,_U,centroids,nodes,opts){for(var i=0;i<U.length;i++)_U[i]=U[i].slice();for(var sum,numerator,denominator,pow=2/(opts.m-1),c=0;c<centroids.length;c++)for(var n=0;n<nodes.length;n++){sum=0;for(var k=0;k<centroids.length;k++)numerator=getDist(opts.distance,nodes[n],centroids[c],opts.attributes,"cmeans"),denominator=getDist(opts.distance,nodes[n],centroids[k],opts.attributes,"cmeans"),sum+=Math.pow(numerator/denominator,pow);U[n][c]=1/sum}},fuzzyCMeans=function fuzzyCMeans(options){var centroids,U,_U,weight,cy=this.cy(),nodes=this.nodes(),opts=setOptions$1(options);_U=new Array(nodes.length);for(var i=0;i<nodes.length;i++)_U[i]=new Array(opts.k);U=new Array(nodes.length);for(var _i3=0;_i3<nodes.length;_i3++)U[_i3]=new Array(opts.k);for(var _i4=0;_i4<nodes.length;_i4++){for(var total=0,j=0;j<opts.k;j++)U[_i4][j]=Math.random(),total+=U[_i4][j];for(var _j=0;_j<opts.k;_j++)U[_i4][_j]=U[_i4][_j]/total}centroids=new Array(opts.k);for(var _i5=0;_i5<opts.k;_i5++)centroids[_i5]=new Array(opts.attributes.length);weight=new Array(nodes.length);for(var _i6=0;_i6<nodes.length;_i6++)weight[_i6]=new Array(opts.k);for(var isStillMoving=!0,iterations=0;isStillMoving&&iterations<opts.maxIterations;)isStillMoving=!1,updateCentroids(centroids,nodes,U,weight,opts),updateMembership(U,_U,centroids,nodes,opts),haveMatricesConverged(U,_U,opts.sensitivityThreshold)||(isStillMoving=!0),iterations++;return{clusters:function assign(nodes,U,opts,cy){for(var max,index,clusters=new Array(opts.k),c=0;c<clusters.length;c++)clusters[c]=[];for(var n=0;n<U.length;n++){max=-1/0,index=-1;for(var _c2=0;_c2<U[0].length;_c2++)U[n][_c2]>max&&(max=U[n][_c2],index=_c2);clusters[index].push(nodes[n])}for(var _c3=0;_c3<clusters.length;_c3++)clusters[_c3]=cy.collection(clusters[_c3]);return clusters}(nodes,U,opts,cy),degreeOfMembership:U}},kClustering={kMeans:function kMeans(options){var centroids,cy=this.cy(),nodes=this.nodes(),node=null,opts=setOptions$1(options),clusters=new Array(opts.k),assignment={};centroids=opts.testMode?"number"==typeof opts.testCentroids?randomCentroids(nodes,opts.k,opts.attributes):"object"===_typeof(opts.testCentroids)?opts.testCentroids:randomCentroids(nodes,opts.k,opts.attributes):randomCentroids(nodes,opts.k,opts.attributes);for(var isStillMoving=!0,iterations=0;isStillMoving&&iterations<opts.maxIterations;){for(var n=0;n<nodes.length;n++)assignment[(node=nodes[n]).id()]=classify(node,centroids,opts.distance,opts.attributes,"kMeans");isStillMoving=!1;for(var c=0;c<opts.k;c++){var cluster=buildCluster(c,nodes,assignment);if(0!==cluster.length){for(var ndim=opts.attributes.length,centroid=centroids[c],newCentroid=new Array(ndim),sum=new Array(ndim),d=0;d<ndim;d++){sum[d]=0;for(var i=0;i<cluster.length;i++)node=cluster[i],sum[d]+=opts.attributes[d](node);newCentroid[d]=sum[d]/cluster.length,haveValuesConverged(newCentroid[d],centroid[d],opts.sensitivityThreshold)||(isStillMoving=!0)}centroids[c]=newCentroid,clusters[c]=cy.collection(cluster)}}iterations++}return clusters},kMedoids:function kMedoids(options){var medoids,curCost,cy=this.cy(),nodes=this.nodes(),node=null,opts=setOptions$1(options),clusters=new Array(opts.k),assignment={},minCosts=new Array(opts.k);opts.testMode?"number"==typeof opts.testCentroids||(medoids="object"===_typeof(opts.testCentroids)?opts.testCentroids:randomMedoids(nodes,opts.k)):medoids=randomMedoids(nodes,opts.k);for(var isStillMoving=!0,iterations=0;isStillMoving&&iterations<opts.maxIterations;){for(var n=0;n<nodes.length;n++)assignment[(node=nodes[n]).id()]=classify(node,medoids,opts.distance,opts.attributes,"kMedoids");isStillMoving=!1;for(var m=0;m<medoids.length;m++){var cluster=buildCluster(m,nodes,assignment);if(0!==cluster.length){minCosts[m]=findCost(medoids[m],cluster,opts.attributes);for(var _n=0;_n<cluster.length;_n++)(curCost=findCost(cluster[_n],cluster,opts.attributes))<minCosts[m]&&(minCosts[m]=curCost,medoids[m]=cluster[_n],isStillMoving=!0);clusters[m]=cy.collection(cluster)}}iterations++}return clusters},fuzzyCMeans:fuzzyCMeans,fcm:fuzzyCMeans},defaults$6=defaults({distance:"euclidean",linkage:"min",mode:"threshold",threshold:1/0,addDendrogram:!1,dendrogramDepth:0,attributes:[]}),linkageAliases={single:"min",complete:"max"},mergeClosest=function mergeClosest(clusters,index,dists,mins,opts){for(var dist,minKey=0,min=1/0,attrs=opts.attributes,getDist=function getDist(n1,n2){return clusteringDistance(opts.distance,attrs.length,(function(i){return attrs[i](n1)}),(function(i){return attrs[i](n2)}),n1,n2)},i=0;i<clusters.length;i++){var key=clusters[i].key,_dist=dists[key][mins[key]];_dist<min&&(minKey=key,min=_dist)}if("threshold"===opts.mode&&min>=opts.threshold||"dendrogram"===opts.mode&&1===clusters.length)return!1;var merged,c1=index[minKey],c2=index[mins[minKey]];merged="dendrogram"===opts.mode?{left:c1,right:c2,key:c1.key}:{value:c1.value.concat(c2.value),key:c1.key},clusters[c1.index]=merged,clusters.splice(c2.index,1),index[c1.key]=merged;for(var _i=0;_i<clusters.length;_i++){var cur=clusters[_i];c1.key===cur.key?dist=1/0:"min"===opts.linkage?(dist=dists[c1.key][cur.key],dists[c1.key][cur.key]>dists[c2.key][cur.key]&&(dist=dists[c2.key][cur.key])):"max"===opts.linkage?(dist=dists[c1.key][cur.key],dists[c1.key][cur.key]<dists[c2.key][cur.key]&&(dist=dists[c2.key][cur.key])):dist="mean"===opts.linkage?(dists[c1.key][cur.key]*c1.size+dists[c2.key][cur.key]*c2.size)/(c1.size+c2.size):"dendrogram"===opts.mode?getDist(cur.value,c1.value):getDist(cur.value[0],c1.value[0]),dists[c1.key][cur.key]=dists[cur.key][c1.key]=dist}for(var _i2=0;_i2<clusters.length;_i2++){var key1=clusters[_i2].key;if(mins[key1]===c1.key||mins[key1]===c2.key){for(var _min=key1,j=0;j<clusters.length;j++){var key2=clusters[j].key;dists[key1][key2]<dists[key1][_min]&&(_min=key2)}mins[key1]=_min}clusters[_i2].index=_i2}return c1.key=c2.key=c1.index=c2.index=null,!0},getAllChildren=function getAllChildren(root,arr,cy){root&&(root.value?arr.push(root.value):(root.left&&getAllChildren(root.left,arr),root.right&&getAllChildren(root.right,arr)))},hierarchicalClustering=function hierarchicalClustering(options){for(var cy=this.cy(),nodes=this.nodes(),opts=function setOptions(options){var opts=defaults$6(options),preferredAlias=linkageAliases[opts.linkage];return null!=preferredAlias&&(opts.linkage=preferredAlias),opts}(options),attrs=opts.attributes,getDist=function getDist(n1,n2){return clusteringDistance(opts.distance,attrs.length,(function(i){return attrs[i](n1)}),(function(i){return attrs[i](n2)}),n1,n2)},clusters=[],dists=[],mins=[],index=[],n=0;n<nodes.length;n++){var cluster={value:"dendrogram"===opts.mode?nodes[n]:[nodes[n]],key:n,index:n};clusters[n]=cluster,index[n]=cluster,dists[n]=[],mins[n]=0}for(var i=0;i<clusters.length;i++)for(var j=0;j<=i;j++){var dist=void 0;dist="dendrogram"===opts.mode?i===j?1/0:getDist(clusters[i].value,clusters[j].value):i===j?1/0:getDist(clusters[i].value[0],clusters[j].value[0]),dists[i][j]=dist,dists[j][i]=dist,dist<dists[i][mins[i]]&&(mins[i]=j)}for(var retClusters,merged=mergeClosest(clusters,index,dists,mins,opts);merged;)merged=mergeClosest(clusters,index,dists,mins,opts);return"dendrogram"===opts.mode?(retClusters=function buildClustersFromTree(root,k,cy){if(!root)return[];var left=[],right=[],leaves=[];return 0===k?(root.left&&getAllChildren(root.left,left),root.right&&getAllChildren(root.right,right),leaves=left.concat(right),[cy.collection(leaves)]):1===k?root.value?[cy.collection(root.value)]:(root.left&&getAllChildren(root.left,left),root.right&&getAllChildren(root.right,right),[cy.collection(left),cy.collection(right)]):root.value?[cy.collection(root.value)]:(root.left&&(left=buildClustersFromTree(root.left,k-1,cy)),root.right&&(right=buildClustersFromTree(root.right,k-1,cy)),left.concat(right))}(clusters[0],opts.dendrogramDepth,cy),opts.addDendrogram&&function buildDendrogram(root,cy){if(!root)return"";if(root.left&&root.right){var leftStr=buildDendrogram(root.left,cy),rightStr=buildDendrogram(root.right,cy),node=cy.add({group:"nodes",data:{id:leftStr+","+rightStr}});return cy.add({group:"edges",data:{source:leftStr,target:node.id()}}),cy.add({group:"edges",data:{source:rightStr,target:node.id()}}),node.id()}return root.value?root.value.id():void 0}(clusters[0],cy)):(retClusters=new Array(clusters.length),clusters.forEach((function(cluster,i){cluster.key=cluster.index=null,retClusters[i]=cy.collection(cluster.value)}))),retClusters},hierarchicalClustering$1={hierarchicalClustering:hierarchicalClustering,hca:hierarchicalClustering},defaults$7=defaults({distance:"euclidean",preference:"median",damping:.8,maxIterations:1e3,minIterations:100,attributes:[]}),getSimilarity$1=function getSimilarity(type,n1,n2,attributes){var attr=function attr(n,i){return attributes[i](n)};return-clusteringDistance(type,attributes.length,(function(i){return attr(n1,i)}),(function(i){return attr(n2,i)}),n1,n2)},getPreference=function getPreference(S,preference){return"median"===preference?function median(arr){var begin=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,end=arguments.length>2&&void 0!==arguments[2]?arguments[2]:arr.length,copy=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],sort=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],includeHoles=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];copy?arr=arr.slice(begin,end):(end<arr.length&&arr.splice(end,arr.length-end),begin>0&&arr.splice(0,begin));for(var off=0,i=arr.length-1;i>=0;i--){var v=arr[i];includeHoles?isFinite(v)||(arr[i]=-1/0,off++):arr.splice(i,1)}sort&&arr.sort((function(a,b){return a-b}));var len=arr.length,mid=Math.floor(len/2);return len%2!=0?arr[mid+1+off]:(arr[mid-1+off]+arr[mid+off])/2}(S):"mean"===preference?function mean(arr){for(var begin=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,end=arguments.length>2&&void 0!==arguments[2]?arguments[2]:arr.length,total=0,n=0,i=begin;i<end;i++){var val=arr[i];isFinite(val)&&(total+=val,n++)}return total/n}(S):"min"===preference?function min(arr){for(var begin=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,end=arguments.length>2&&void 0!==arguments[2]?arguments[2]:arr.length,min=1/0,i=begin;i<end;i++){var val=arr[i];isFinite(val)&&(min=Math.min(val,min))}return min}(S):"max"===preference?function max(arr){for(var begin=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,end=arguments.length>2&&void 0!==arguments[2]?arguments[2]:arr.length,max=-1/0,i=begin;i<end;i++){var val=arr[i];isFinite(val)&&(max=Math.max(val,max))}return max}(S):preference},assignClusters=function assignClusters(n,S,exemplars){for(var clusters=[],i=0;i<n;i++){for(var index=-1,max=-1/0,ei=0;ei<exemplars.length;ei++){var e=exemplars[ei];S[i*n+e]>max&&(index=e,max=S[i*n+e])}index>0&&clusters.push(index)}for(var _ei=0;_ei<exemplars.length;_ei++)clusters[exemplars[_ei]]=exemplars[_ei];return clusters},affinityPropagation=function affinityPropagation(options){for(var n,n2,S,p,R,A,cy=this.cy(),nodes=this.nodes(),opts=function setOptions(options){var dmp=options.damping,pref=options.preference;.5<=dmp&&dmp<1||error("Damping must range on [0.5, 1).  Got: ".concat(dmp));var validPrefs=["median","mean","min","max"];return validPrefs.some((function(v){return v===pref}))||number(pref)||error("Preference must be one of [".concat(validPrefs.map((function(p){return"'".concat(p,"'")})).join(", "),"] or a number.  Got: ").concat(pref)),defaults$7(options)}(options),id2position={},i=0;i<nodes.length;i++)id2position[nodes[i].id()]=i;n2=(n=nodes.length)*n,S=new Array(n2);for(var _i=0;_i<n2;_i++)S[_i]=-1/0;for(var _i2=0;_i2<n;_i2++)for(var j=0;j<n;j++)_i2!==j&&(S[_i2*n+j]=getSimilarity$1(opts.distance,nodes[_i2],nodes[j],opts.attributes));p=getPreference(S,opts.preference);for(var _i3=0;_i3<n;_i3++)S[_i3*n+_i3]=p;R=new Array(n2);for(var _i4=0;_i4<n2;_i4++)R[_i4]=0;A=new Array(n2);for(var _i5=0;_i5<n2;_i5++)A[_i5]=0;for(var old=new Array(n),Rp=new Array(n),se=new Array(n),_i6=0;_i6<n;_i6++)old[_i6]=0,Rp[_i6]=0,se[_i6]=0;for(var iter,e=new Array(n*opts.minIterations),_i7=0;_i7<e.length;_i7++)e[_i7]=0;for(iter=0;iter<opts.maxIterations;iter++){for(var _i8=0;_i8<n;_i8++){for(var max=-1/0,max2=-1/0,maxI=-1,AS=0,_j=0;_j<n;_j++)old[_j]=R[_i8*n+_j],(AS=A[_i8*n+_j]+S[_i8*n+_j])>=max?(max2=max,max=AS,maxI=_j):AS>max2&&(max2=AS);for(var _j2=0;_j2<n;_j2++)R[_i8*n+_j2]=(1-opts.damping)*(S[_i8*n+_j2]-max)+opts.damping*old[_j2];R[_i8*n+maxI]=(1-opts.damping)*(S[_i8*n+maxI]-max2)+opts.damping*old[maxI]}for(var _i9=0;_i9<n;_i9++){for(var sum=0,_j3=0;_j3<n;_j3++)old[_j3]=A[_j3*n+_i9],Rp[_j3]=Math.max(0,R[_j3*n+_i9]),sum+=Rp[_j3];sum-=Rp[_i9],Rp[_i9]=R[_i9*n+_i9],sum+=Rp[_i9];for(var _j4=0;_j4<n;_j4++)A[_j4*n+_i9]=(1-opts.damping)*Math.min(0,sum-Rp[_j4])+opts.damping*old[_j4];A[_i9*n+_i9]=(1-opts.damping)*(sum-Rp[_i9])+opts.damping*old[_i9]}for(var K=0,_i10=0;_i10<n;_i10++){var E=A[_i10*n+_i10]+R[_i10*n+_i10]>0?1:0;e[iter%opts.minIterations*n+_i10]=E,K+=E}if(K>0&&(iter>=opts.minIterations-1||iter==opts.maxIterations-1)){for(var _sum=0,_i11=0;_i11<n;_i11++){se[_i11]=0;for(var _j5=0;_j5<opts.minIterations;_j5++)se[_i11]+=e[_j5*n+_i11];0!==se[_i11]&&se[_i11]!==opts.minIterations||_sum++}if(_sum===n)break}}for(var exemplarsIndices=function findExemplars(n,R,A){for(var indices=[],i=0;i<n;i++)R[i*n+i]+A[i*n+i]>0&&indices.push(i);return indices}(n,R,A),clusterIndices=function assign(n,S,exemplars){for(var clusters=assignClusters(n,S,exemplars),ei=0;ei<exemplars.length;ei++){for(var ii=[],c=0;c<clusters.length;c++)clusters[c]===exemplars[ei]&&ii.push(c);for(var maxI=-1,maxSum=-1/0,i=0;i<ii.length;i++){for(var sum=0,j=0;j<ii.length;j++)sum+=S[ii[j]*n+ii[i]];sum>maxSum&&(maxI=i,maxSum=sum)}exemplars[ei]=ii[maxI]}return clusters=assignClusters(n,S,exemplars)}(n,S,exemplarsIndices),clusters={},c=0;c<exemplarsIndices.length;c++)clusters[exemplarsIndices[c]]=[];for(var _i12=0;_i12<nodes.length;_i12++){var clusterIndex=clusterIndices[id2position[nodes[_i12].id()]];null!=clusterIndex&&clusters[clusterIndex].push(nodes[_i12])}for(var retClusters=new Array(exemplarsIndices.length),_c=0;_c<exemplarsIndices.length;_c++)retClusters[_c]=cy.collection(clusters[exemplarsIndices[_c]]);return retClusters},affinityPropagation$1={affinityPropagation:affinityPropagation,ap:affinityPropagation},hierholzerDefaults=defaults({root:void 0,directed:!1}),hopcroftTarjanBiconnected=function hopcroftTarjanBiconnected(){var eles=this,nodes={},id=0,edgeCount=0,components=[],stack=[],visitedEdges={},biconnectedSearch=function biconnectedSearch(root,currentNode,parent){root===parent&&(edgeCount+=1),nodes[currentNode]={id:id,low:id++,cutVertex:!1};var sourceId,targetId,otherNodeId,edgeId,edges=eles.getElementById(currentNode).connectedEdges().intersection(eles);0===edges.size()?components.push(eles.spawn(eles.getElementById(currentNode))):edges.forEach((function(edge){sourceId=edge.source().id(),targetId=edge.target().id(),(otherNodeId=sourceId===currentNode?targetId:sourceId)!==parent&&(edgeId=edge.id(),visitedEdges[edgeId]||(visitedEdges[edgeId]=!0,stack.push({x:currentNode,y:otherNodeId,edge:edge})),otherNodeId in nodes?nodes[currentNode].low=Math.min(nodes[currentNode].low,nodes[otherNodeId].id):(biconnectedSearch(root,otherNodeId,currentNode),nodes[currentNode].low=Math.min(nodes[currentNode].low,nodes[otherNodeId].low),nodes[currentNode].id<=nodes[otherNodeId].low&&(nodes[currentNode].cutVertex=!0,function buildComponent(x,y){for(var i=stack.length-1,cutset=[],component=eles.spawn();stack[i].x!=x||stack[i].y!=y;)cutset.push(stack.pop().edge),i--;cutset.push(stack.pop().edge),cutset.forEach((function(edge){var connectedNodes=edge.connectedNodes().intersection(eles);component.merge(edge),connectedNodes.forEach((function(node){var nodeId=node.id(),connectedEdges=node.connectedEdges().intersection(eles);component.merge(node),nodes[nodeId].cutVertex?component.merge(connectedEdges.filter((function(edge){return edge.isLoop()}))):component.merge(connectedEdges)}))})),components.push(component)}(currentNode,otherNodeId))))}))};eles.forEach((function(ele){if(ele.isNode()){var nodeId=ele.id();nodeId in nodes||(edgeCount=0,biconnectedSearch(nodeId,nodeId),nodes[nodeId].cutVertex=edgeCount>1)}}));var cutVertices=Object.keys(nodes).filter((function(id){return nodes[id].cutVertex})).map((function(id){return eles.getElementById(id)}));return{cut:eles.spawn(cutVertices),components:components}},tarjanStronglyConnected=function tarjanStronglyConnected(){var eles=this,nodes={},index=0,components=[],stack=[],cut=eles.spawn(eles);return eles.forEach((function(ele){if(ele.isNode()){var nodeId=ele.id();nodeId in nodes||function stronglyConnectedSearch(sourceNodeId){if(stack.push(sourceNodeId),nodes[sourceNodeId]={index:index,low:index++,explored:!1},eles.getElementById(sourceNodeId).connectedEdges().intersection(eles).forEach((function(edge){var targetNodeId=edge.target().id();targetNodeId!==sourceNodeId&&(targetNodeId in nodes||stronglyConnectedSearch(targetNodeId),nodes[targetNodeId].explored||(nodes[sourceNodeId].low=Math.min(nodes[sourceNodeId].low,nodes[targetNodeId].low)))})),nodes[sourceNodeId].index===nodes[sourceNodeId].low){for(var componentNodes=eles.spawn();;){var nodeId=stack.pop();if(componentNodes.merge(eles.getElementById(nodeId)),nodes[nodeId].low=nodes[sourceNodeId].index,nodes[nodeId].explored=!0,nodeId===sourceNodeId)break}var componentEdges=componentNodes.edgesWith(componentNodes),component=componentNodes.merge(componentEdges);components.push(component),cut=cut.difference(component)}}(nodeId)}})),{cut:cut,components:components}},elesfn$c={};[elesfn,elesfn$1,elesfn$2,elesfn$3,elesfn$4,elesfn$5,elesfn$6,elesfn$7,elesfn$8,elesfn$9,elesfn$a,markovClustering$1,kClustering,hierarchicalClustering$1,affinityPropagation$1,{hierholzer:function hierholzer(options){if(!plainObject(options)){var args=arguments;options={root:args[0],directed:args[1]}}var oddIn,oddOut,startVertex,_hierholzerDefaults=hierholzerDefaults(options),root=_hierholzerDefaults.root,directed=_hierholzerDefaults.directed,eles=this,dflag=!1;root&&(startVertex=string(root)?this.filter(root)[0].id():root[0].id());var nodes={},edges={};directed?eles.forEach((function(ele){var id=ele.id();if(ele.isNode()){var ind=ele.indegree(!0),outd=ele.outdegree(!0),d1=ind-outd,d2=outd-ind;1==d1?oddIn?dflag=!0:oddIn=id:1==d2?oddOut?dflag=!0:oddOut=id:(d2>1||d1>1)&&(dflag=!0),nodes[id]=[],ele.outgoers().forEach((function(e){e.isEdge()&&nodes[id].push(e.id())}))}else edges[id]=[void 0,ele.target().id()]})):eles.forEach((function(ele){var id=ele.id();ele.isNode()?(ele.degree(!0)%2&&(oddIn?oddOut?dflag=!0:oddOut=id:oddIn=id),nodes[id]=[],ele.connectedEdges().forEach((function(e){return nodes[id].push(e.id())}))):edges[id]=[ele.source().id(),ele.target().id()]}));var result={found:!1,trail:void 0};if(dflag)return result;if(oddOut&&oddIn)if(directed){if(startVertex&&oddOut!=startVertex)return result;startVertex=oddOut}else{if(startVertex&&oddOut!=startVertex&&oddIn!=startVertex)return result;startVertex||(startVertex=oddOut)}else startVertex||(startVertex=eles[0].id());var walk=function walk(v){for(var adj,adjTail,adjHead,currentNode=v,subtour=[v];nodes[currentNode].length;)adj=nodes[currentNode].shift(),adjTail=edges[adj][0],currentNode!=(adjHead=edges[adj][1])?(nodes[adjHead]=nodes[adjHead].filter((function(e){return e!=adj})),currentNode=adjHead):directed||currentNode==adjTail||(nodes[adjTail]=nodes[adjTail].filter((function(e){return e!=adj})),currentNode=adjTail),subtour.unshift(adj),subtour.unshift(currentNode);return subtour},trail=[],subtour=[];for(subtour=walk(startVertex);1!=subtour.length;)0==nodes[subtour[0]].length?(trail.unshift(eles.getElementById(subtour.shift())),trail.unshift(eles.getElementById(subtour.shift()))):subtour=walk(subtour.shift()).concat(subtour);for(var d in trail.unshift(eles.getElementById(subtour.shift())),nodes)if(nodes[d].length)return result;return result.found=!0,result.trail=this.spawn(trail,!0),result}},{hopcroftTarjanBiconnected:hopcroftTarjanBiconnected,htbc:hopcroftTarjanBiconnected,htb:hopcroftTarjanBiconnected,hopcroftTarjanBiconnectedComponents:hopcroftTarjanBiconnected},{tarjanStronglyConnected:tarjanStronglyConnected,tsc:tarjanStronglyConnected,tscc:tarjanStronglyConnected,tarjanStronglyConnectedComponents:tarjanStronglyConnected}].forEach((function(props){extend(elesfn$c,props)}));var api=function api(executor){if(!(this instanceof api))return new api(executor);this.id="Thenable/1.0.7",this.state=0,this.fulfillValue=void 0,this.rejectReason=void 0,this.onFulfilled=[],this.onRejected=[],this.proxy={then:this.then.bind(this)},"function"==typeof executor&&executor.call(this,this.fulfill.bind(this),this.reject.bind(this))};api.prototype={fulfill:function fulfill(value){return deliver(this,1,"fulfillValue",value)},reject:function reject(value){return deliver(this,2,"rejectReason",value)},then:function then(onFulfilled,onRejected){var next=new api;return this.onFulfilled.push(resolver(onFulfilled,next,"fulfill")),this.onRejected.push(resolver(onRejected,next,"reject")),execute(this),next.proxy}};var deliver=function deliver(curr,state,name,value){return 0===curr.state&&(curr.state=state,curr[name]=value,execute(curr)),curr},execute=function execute(curr){1===curr.state?execute_handlers(curr,"onFulfilled",curr.fulfillValue):2===curr.state&&execute_handlers(curr,"onRejected",curr.rejectReason)},execute_handlers=function execute_handlers(curr,name,value){if(0!==curr[name].length){var handlers=curr[name];curr[name]=[];var func=function func(){for(var i=0;i<handlers.length;i++)handlers[i](value)};"function"==typeof setImmediate?setImmediate(func):setTimeout(func,0)}},resolver=function resolver(cb,next,method){return function(value){if("function"!=typeof cb)next[method].call(next,value);else{var result;try{result=cb(value)}catch(e){return void next.reject(e)}resolve(next,result)}}},resolve=function resolve(promise,x){if(promise!==x&&promise.proxy!==x){var then;if("object"===_typeof(x)&&null!==x||"function"==typeof x)try{then=x.then}catch(e){return void promise.reject(e)}if("function"!=typeof then)promise.fulfill(x);else{var resolved=!1;try{then.call(x,(function(y){resolved||(resolved=!0,y===x?promise.reject(new TypeError("circular thenable chain")):resolve(promise,y))}),(function(r){resolved||(resolved=!0,promise.reject(r))}))}catch(e){resolved||promise.reject(e)}}}else promise.reject(new TypeError("cannot resolve promise with itself"))};api.all=function(ps){return new api((function(resolveAll,rejectAll){for(var vals=new Array(ps.length),doneCount=0,fulfill=function fulfill(i,val){vals[i]=val,++doneCount===ps.length&&resolveAll(vals)},i=0;i<ps.length;i++)!function(i){var p=ps[i];null!=p&&null!=p.then?p.then((function(val){fulfill(i,val)}),(function(err){rejectAll(err)})):fulfill(i,p)}(i)}))},api.resolve=function(val){return new api((function(resolve,reject){resolve(val)}))},api.reject=function(val){return new api((function(resolve,reject){reject(val)}))};var Promise$1="undefined"!=typeof Promise?Promise:api,Animation=function Animation(target,opts,opts2){var isCore=core(target),isEle=!isCore,_p=this._private=extend({duration:1e3},opts,opts2);if(_p.target=target,_p.style=_p.style||_p.css,_p.started=!1,_p.playing=!1,_p.hooked=!1,_p.applying=!1,_p.progress=0,_p.completes=[],_p.frames=[],_p.complete&&fn(_p.complete)&&_p.completes.push(_p.complete),isEle){var pos=target.position();_p.startPosition=_p.startPosition||{x:pos.x,y:pos.y},_p.startStyle=_p.startStyle||target.cy().style().getAnimationStartStyle(target,_p.style)}if(isCore){var pan=target.pan();_p.startPan={x:pan.x,y:pan.y},_p.startZoom=target.zoom()}this.length=1,this[0]=this},anifn=Animation.prototype;extend(anifn,{instanceString:function instanceString(){return"animation"},hook:function hook(){var _p=this._private;if(!_p.hooked){var tAni=_p.target._private.animation;(_p.queue?tAni.queue:tAni.current).push(this),elementOrCollection(_p.target)&&_p.target.cy().addToAnimationPool(_p.target),_p.hooked=!0}return this},play:function play(){var _p=this._private;return 1===_p.progress&&(_p.progress=0),_p.playing=!0,_p.started=!1,_p.stopped=!1,this.hook(),this},playing:function playing(){return this._private.playing},apply:function apply(){var _p=this._private;return _p.applying=!0,_p.started=!1,_p.stopped=!1,this.hook(),this},applying:function applying(){return this._private.applying},pause:function pause(){var _p=this._private;return _p.playing=!1,_p.started=!1,this},stop:function stop(){var _p=this._private;return _p.playing=!1,_p.started=!1,_p.stopped=!0,this},rewind:function rewind(){return this.progress(0)},fastforward:function fastforward(){return this.progress(1)},time:function time(t){var _p=this._private;return void 0===t?_p.progress*_p.duration:this.progress(t/_p.duration)},progress:function progress(p){var _p=this._private,wasPlaying=_p.playing;return void 0===p?_p.progress:(wasPlaying&&this.pause(),_p.progress=p,_p.started=!1,wasPlaying&&this.play(),this)},completed:function completed(){return 1===this._private.progress},reverse:function reverse(){var _p=this._private,wasPlaying=_p.playing;wasPlaying&&this.pause(),_p.progress=1-_p.progress,_p.started=!1;var swap=function swap(a,b){var _pa=_p[a];null!=_pa&&(_p[a]=_p[b],_p[b]=_pa)};if(swap("zoom","startZoom"),swap("pan","startPan"),swap("position","startPosition"),_p.style)for(var i=0;i<_p.style.length;i++){var prop=_p.style[i],name=prop.name,startStyleProp=_p.startStyle[name];_p.startStyle[name]=prop,_p.style[i]=startStyleProp}return wasPlaying&&this.play(),this},promise:function promise(type){var arr,_p=this._private;switch(type){case"frame":arr=_p.frames;break;default:case"complete":case"completed":arr=_p.completes}return new Promise$1((function(resolve,reject){arr.push((function(){resolve()}))}))}}),anifn.complete=anifn.completed,anifn.run=anifn.play,anifn.running=anifn.playing;var define$3={};[{animated:function animated(){return function animatedImpl(){var all=void 0!==this.length?this:[this];if(!(this._private.cy||this).styleEnabled())return!1;var ele=all[0];return ele?ele._private.animation.current.length>0:void 0}},clearQueue:function clearQueue(){return function clearQueueImpl(){var all=void 0!==this.length?this:[this];if(!(this._private.cy||this).styleEnabled())return this;for(var i=0;i<all.length;i++){all[i]._private.animation.queue=[]}return this}},delay:function delay(){return function delayImpl(time,complete){return(this._private.cy||this).styleEnabled()?this.animate({delay:time,duration:time,complete:complete}):this}},delayAnimation:function delayAnimation(){return function delayAnimationImpl(time,complete){return(this._private.cy||this).styleEnabled()?this.animation({delay:time,duration:time,complete:complete}):this}},animation:function animation(){return function animationImpl(properties,params){var selfIsArrayLike=void 0!==this.length,all=selfIsArrayLike?this:[this],cy=this._private.cy||this,isCore=!selfIsArrayLike,isEles=!isCore;if(!cy.styleEnabled())return this;var style=cy.style();if(properties=extend({},properties,params),0===Object.keys(properties).length)return new Animation(all[0],properties);switch(void 0===properties.duration&&(properties.duration=400),properties.duration){case"slow":properties.duration=600;break;case"fast":properties.duration=200}if(isEles&&(properties.style=style.getPropsList(properties.style||properties.css),properties.css=void 0),isEles&&null!=properties.renderedPosition){var rpos=properties.renderedPosition,pan=cy.pan(),zoom=cy.zoom();properties.position=renderedToModelPosition(rpos,zoom,pan)}if(isCore&&null!=properties.panBy){var panBy=properties.panBy,cyPan=cy.pan();properties.pan={x:cyPan.x+panBy.x,y:cyPan.y+panBy.y}}var center=properties.center||properties.centre;if(isCore&&null!=center){var centerPan=cy.getCenterPan(center.eles,properties.zoom);null!=centerPan&&(properties.pan=centerPan)}if(isCore&&null!=properties.fit){var fit=properties.fit,fitVp=cy.getFitViewport(fit.eles||fit.boundingBox,fit.padding);null!=fitVp&&(properties.pan=fitVp.pan,properties.zoom=fitVp.zoom)}if(isCore&&plainObject(properties.zoom)){var vp=cy.getZoomedViewport(properties.zoom);null!=vp?(vp.zoomed&&(properties.zoom=vp.zoom),vp.panned&&(properties.pan=vp.pan)):properties.zoom=null}return new Animation(all[0],properties)}},animate:function animate(){return function animateImpl(properties,params){var all=void 0!==this.length?this:[this];if(!(this._private.cy||this).styleEnabled())return this;params&&(properties=extend({},properties,params));for(var i=0;i<all.length;i++){var ele=all[i],queue=ele.animated()&&(void 0===properties.queue||properties.queue);ele.animation(properties,queue?{queue:!0}:void 0).play()}return this}},stop:function stop(){return function stopImpl(clearQueue,jumpToEnd){var all=void 0!==this.length?this:[this],cy=this._private.cy||this;if(!cy.styleEnabled())return this;for(var i=0;i<all.length;i++){for(var _p=all[i]._private,anis=_p.animation.current,j=0;j<anis.length;j++){var ani_p=anis[j]._private;jumpToEnd&&(ani_p.duration=0)}clearQueue&&(_p.animation.queue=[]),jumpToEnd||(_p.animation.current=[])}return cy.notify("draw"),this}}},{data:function data(params){return params=extend({},{field:"data",bindingEvent:"data",allowBinding:!1,allowSetting:!1,allowGetting:!1,settingEvent:"data",settingTriggersEvent:!1,triggerFnName:"trigger",immutableKeys:{},updateStyle:!1,beforeGet:function beforeGet(self){},beforeSet:function beforeSet(self,obj){},onSet:function onSet(self){},canSet:function canSet(self){return!0}},params),function dataImpl(name,value){var p=params,selfIsArrayLike=void 0!==this.length,all=selfIsArrayLike?this:[this],single=selfIsArrayLike?this[0]:this;if(string(name)){var ret;if(p.allowGetting&&void 0===value)return single&&(p.beforeGet(single),ret=single._private[p.field][name]),ret;if(p.allowSetting&&void 0!==value&&!p.immutableKeys[name]){var change=_defineProperty({},name,value);p.beforeSet(this,change);for(var i=0,l=all.length;i<l;i++){var ele=all[i];p.canSet(ele)&&(ele._private[p.field][name]=value)}p.updateStyle&&this.updateStyle(),p.onSet(this),p.settingTriggersEvent&&this[p.triggerFnName](p.settingEvent)}}else if(p.allowSetting&&plainObject(name)){var k,v,obj=name,keys=Object.keys(obj);p.beforeSet(this,obj);for(var _i=0;_i<keys.length;_i++){if(v=obj[k=keys[_i]],!p.immutableKeys[k])for(var j=0;j<all.length;j++){var _ele=all[j];p.canSet(_ele)&&(_ele._private[p.field][k]=v)}}p.updateStyle&&this.updateStyle(),p.onSet(this),p.settingTriggersEvent&&this[p.triggerFnName](p.settingEvent)}else if(p.allowBinding&&fn(name)){var fn$1=name;this.on(p.bindingEvent,fn$1)}else if(p.allowGetting&&void 0===name){var _ret;return single&&(p.beforeGet(single),_ret=single._private[p.field]),_ret}return this}},removeData:function removeData(params){return params=extend({},{field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!1,immutableKeys:{}},params),function removeDataImpl(names){var p=params,all=void 0!==this.length?this:[this];if(string(names)){for(var keys=names.split(/\s+/),l=keys.length,i=0;i<l;i++){var key=keys[i];if(!emptyString(key))if(!p.immutableKeys[key])for(var i_a=0,l_a=all.length;i_a<l_a;i_a++)all[i_a]._private[p.field][key]=void 0}p.triggerEvent&&this[p.triggerFnName](p.event)}else if(void 0===names){for(var _i_a=0,_l_a=all.length;_i_a<_l_a;_i_a++)for(var _privateFields=all[_i_a]._private[p.field],_keys=Object.keys(_privateFields),_i2=0;_i2<_keys.length;_i2++){var _key=_keys[_i2];!p.immutableKeys[_key]&&(_privateFields[_key]=void 0)}p.triggerEvent&&this[p.triggerFnName](p.event)}return this}}},{eventAliasesOn:function eventAliasesOn(proto){var p=proto;p.addListener=p.listen=p.bind=p.on,p.unlisten=p.unbind=p.off=p.removeListener,p.trigger=p.emit,p.pon=p.promiseOn=function(events,selector){var self=this,args=Array.prototype.slice.call(arguments,0);return new Promise$1((function(resolve,reject){var onArgs=args.concat([function callback(e){self.off.apply(self,offArgs),resolve(e)}]),offArgs=onArgs.concat([]);self.on.apply(self,onArgs)}))}}}].forEach((function(m){extend(define$3,m)}));var elesfn$d={animate:define$3.animate(),animation:define$3.animation(),animated:define$3.animated(),clearQueue:define$3.clearQueue(),delay:define$3.delay(),delayAnimation:define$3.delayAnimation(),stop:define$3.stop()},elesfn$e={classes:function classes(_classes){if(void 0===_classes){var ret=[];return this[0]._private.classes.forEach((function(cls){return ret.push(cls)})),ret}array(_classes)||(_classes=(_classes||"").match(/\S+/g)||[]);for(var changed=[],classesSet=new Set$1(_classes),j=0;j<this.length;j++){for(var ele=this[j],_p=ele._private,eleClasses=_p.classes,changedEle=!1,i=0;i<_classes.length;i++){var cls=_classes[i];if(!eleClasses.has(cls)){changedEle=!0;break}}changedEle||(changedEle=eleClasses.size!==_classes.length),changedEle&&(_p.classes=classesSet,changed.push(ele))}return changed.length>0&&this.spawn(changed).updateStyle().emit("class"),this},addClass:function addClass(classes){return this.toggleClass(classes,!0)},hasClass:function hasClass(className){var ele=this[0];return null!=ele&&ele._private.classes.has(className)},toggleClass:function toggleClass(classes,toggle){array(classes)||(classes=classes.match(/\S+/g)||[]);for(var toggleUndefd=void 0===toggle,changed=[],i=0,il=this.length;i<il;i++)for(var ele=this[i],eleClasses=ele._private.classes,changedEle=!1,j=0;j<classes.length;j++){var cls=classes[j],hasClass=eleClasses.has(cls),changedNow=!1;toggle||toggleUndefd&&!hasClass?(eleClasses.add(cls),changedNow=!0):(!toggle||toggleUndefd&&hasClass)&&(eleClasses.delete(cls),changedNow=!0),!changedEle&&changedNow&&(changed.push(ele),changedEle=!0)}return changed.length>0&&this.spawn(changed).updateStyle().emit("class"),this},removeClass:function removeClass(classes){return this.toggleClass(classes,!1)},flashClass:function flashClass(classes,duration){var self=this;if(null==duration)duration=250;else if(0===duration)return self;return self.addClass(classes),setTimeout((function(){self.removeClass(classes)}),duration),self}};elesfn$e.className=elesfn$e.classNames=elesfn$e.classes;var tokens={metaChar:"[\\!\\\"\\#\\$\\%\\&\\'\\(\\)\\*\\+\\,\\.\\/\\:\\;\\<\\=\\>\\?\\@\\[\\]\\^\\`\\{\\|\\}\\~]",comparatorOp:"=|\\!=|>|>=|<|<=|\\$=|\\^=|\\*=",boolOp:"\\?|\\!|\\^",string:"\"(?:\\\\\"|[^\"])*\"|'(?:\\\\'|[^'])*'",number:number$1,meta:"degree|indegree|outdegree",separator:"\\s*,\\s*",descendant:"\\s+",child:"\\s+>\\s+",subject:"\\$",group:"node|edge|\\*",directedEdge:"\\s+->\\s+",undirectedEdge:"\\s+<->\\s+"};tokens.variable="(?:[\\w-]|(?:\\\\"+tokens.metaChar+"))+",tokens.value=tokens.string+"|"+tokens.number,tokens.className=tokens.variable,tokens.id=tokens.variable,function(){var ops,op,i;for(ops=tokens.comparatorOp.split("|"),i=0;i<ops.length;i++)op=ops[i],tokens.comparatorOp+="|@"+op;for(ops=tokens.comparatorOp.split("|"),i=0;i<ops.length;i++)(op=ops[i]).indexOf("!")>=0||"="!==op&&(tokens.comparatorOp+="|\\!"+op)}();var Type_GROUP=0,Type_COLLECTION=1,Type_FILTER=2,Type_DATA_COMPARE=3,Type_DATA_EXIST=4,Type_DATA_BOOL=5,Type_META_COMPARE=6,Type_STATE=7,Type_ID=8,Type_CLASS=9,Type_UNDIRECTED_EDGE=10,Type_DIRECTED_EDGE=11,Type_NODE_SOURCE=12,Type_NODE_TARGET=13,Type_NODE_NEIGHBOR=14,Type_CHILD=15,Type_DESCENDANT=16,Type_PARENT=17,Type_ANCESTOR=18,Type_COMPOUND_SPLIT=19,Type_TRUE=20,stateSelectors=[{selector:":selected",matches:function matches(ele){return ele.selected()}},{selector:":unselected",matches:function matches(ele){return!ele.selected()}},{selector:":selectable",matches:function matches(ele){return ele.selectable()}},{selector:":unselectable",matches:function matches(ele){return!ele.selectable()}},{selector:":locked",matches:function matches(ele){return ele.locked()}},{selector:":unlocked",matches:function matches(ele){return!ele.locked()}},{selector:":visible",matches:function matches(ele){return ele.visible()}},{selector:":hidden",matches:function matches(ele){return!ele.visible()}},{selector:":transparent",matches:function matches(ele){return ele.transparent()}},{selector:":grabbed",matches:function matches(ele){return ele.grabbed()}},{selector:":free",matches:function matches(ele){return!ele.grabbed()}},{selector:":removed",matches:function matches(ele){return ele.removed()}},{selector:":inside",matches:function matches(ele){return!ele.removed()}},{selector:":grabbable",matches:function matches(ele){return ele.grabbable()}},{selector:":ungrabbable",matches:function matches(ele){return!ele.grabbable()}},{selector:":animated",matches:function matches(ele){return ele.animated()}},{selector:":unanimated",matches:function matches(ele){return!ele.animated()}},{selector:":parent",matches:function matches(ele){return ele.isParent()}},{selector:":childless",matches:function matches(ele){return ele.isChildless()}},{selector:":child",matches:function matches(ele){return ele.isChild()}},{selector:":orphan",matches:function matches(ele){return ele.isOrphan()}},{selector:":nonorphan",matches:function matches(ele){return ele.isChild()}},{selector:":compound",matches:function matches(ele){return ele.isNode()?ele.isParent():ele.source().isParent()||ele.target().isParent()}},{selector:":loop",matches:function matches(ele){return ele.isLoop()}},{selector:":simple",matches:function matches(ele){return ele.isSimple()}},{selector:":active",matches:function matches(ele){return ele.active()}},{selector:":inactive",matches:function matches(ele){return!ele.active()}},{selector:":backgrounding",matches:function matches(ele){return ele.backgrounding()}},{selector:":nonbackgrounding",matches:function matches(ele){return!ele.backgrounding()}}].sort((function(a,b){return function descending(a,b){return-1*ascending(a,b)}(a.selector,b.selector)})),lookup=function(){for(var s,selToFn={},i=0;i<stateSelectors.length;i++)selToFn[(s=stateSelectors[i]).selector]=s.matches;return selToFn}(),stateSelectorRegex="("+stateSelectors.map((function(s){return s.selector})).join("|")+")",cleanMetaChars=function cleanMetaChars(str){return str.replace(new RegExp("\\\\("+tokens.metaChar+")","g"),(function(match,$1){return $1}))},replaceLastQuery=function replaceLastQuery(selector,examiningQuery,replacementQuery){selector[selector.length-1]=replacementQuery},exprs=[{name:"group",query:!0,regex:"("+tokens.group+")",populate:function populate(selector,query,_ref){var group=_slicedToArray(_ref,1)[0];query.checks.push({type:Type_GROUP,value:"*"===group?group:group+"s"})}},{name:"state",query:!0,regex:stateSelectorRegex,populate:function populate(selector,query,_ref3){var state=_slicedToArray(_ref3,1)[0];query.checks.push({type:Type_STATE,value:state})}},{name:"id",query:!0,regex:"\\#("+tokens.id+")",populate:function populate(selector,query,_ref5){var id=_slicedToArray(_ref5,1)[0];query.checks.push({type:Type_ID,value:cleanMetaChars(id)})}},{name:"className",query:!0,regex:"\\.("+tokens.className+")",populate:function populate(selector,query,_ref7){var className=_slicedToArray(_ref7,1)[0];query.checks.push({type:Type_CLASS,value:cleanMetaChars(className)})}},{name:"dataExists",query:!0,regex:"\\[\\s*("+tokens.variable+")\\s*\\]",populate:function populate(selector,query,_ref9){var variable=_slicedToArray(_ref9,1)[0];query.checks.push({type:Type_DATA_EXIST,field:cleanMetaChars(variable)})}},{name:"dataCompare",query:!0,regex:"\\[\\s*("+tokens.variable+")\\s*("+tokens.comparatorOp+")\\s*("+tokens.value+")\\s*\\]",populate:function populate(selector,query,_ref11){var _ref12=_slicedToArray(_ref11,3),variable=_ref12[0],comparatorOp=_ref12[1],value=_ref12[2];value=null!=new RegExp("^"+tokens.string+"$").exec(value)?value.substring(1,value.length-1):parseFloat(value),query.checks.push({type:Type_DATA_COMPARE,field:cleanMetaChars(variable),operator:comparatorOp,value:value})}},{name:"dataBool",query:!0,regex:"\\[\\s*("+tokens.boolOp+")\\s*("+tokens.variable+")\\s*\\]",populate:function populate(selector,query,_ref13){var _ref14=_slicedToArray(_ref13,2),boolOp=_ref14[0],variable=_ref14[1];query.checks.push({type:Type_DATA_BOOL,field:cleanMetaChars(variable),operator:boolOp})}},{name:"metaCompare",query:!0,regex:"\\[\\[\\s*("+tokens.meta+")\\s*("+tokens.comparatorOp+")\\s*("+tokens.number+")\\s*\\]\\]",populate:function populate(selector,query,_ref15){var _ref16=_slicedToArray(_ref15,3),meta=_ref16[0],comparatorOp=_ref16[1],number=_ref16[2];query.checks.push({type:Type_META_COMPARE,field:cleanMetaChars(meta),operator:comparatorOp,value:parseFloat(number)})}},{name:"nextQuery",separator:!0,regex:tokens.separator,populate:function populate(selector,query){var currentSubject=selector.currentSubject,edgeCount=selector.edgeCount,compoundCount=selector.compoundCount,lastQ=selector[selector.length-1];return null!=currentSubject&&(lastQ.subject=currentSubject,selector.currentSubject=null),lastQ.edgeCount=edgeCount,lastQ.compoundCount=compoundCount,selector.edgeCount=0,selector.compoundCount=0,selector[selector.length++]={checks:[]}}},{name:"directedEdge",separator:!0,regex:tokens.directedEdge,populate:function populate(selector,query){if(null==selector.currentSubject){var edgeQuery={checks:[]},source=query,target={checks:[]};return edgeQuery.checks.push({type:Type_DIRECTED_EDGE,source:source,target:target}),replaceLastQuery(selector,0,edgeQuery),selector.edgeCount++,target}var srcTgtQ={checks:[]},_source=query,_target={checks:[]};return srcTgtQ.checks.push({type:Type_NODE_SOURCE,source:_source,target:_target}),replaceLastQuery(selector,0,srcTgtQ),selector.edgeCount++,_target}},{name:"undirectedEdge",separator:!0,regex:tokens.undirectedEdge,populate:function populate(selector,query){if(null==selector.currentSubject){var edgeQuery={checks:[]},source=query,target={checks:[]};return edgeQuery.checks.push({type:Type_UNDIRECTED_EDGE,nodes:[source,target]}),replaceLastQuery(selector,0,edgeQuery),selector.edgeCount++,target}var nhoodQ={checks:[]},node=query,neighbor={checks:[]};return nhoodQ.checks.push({type:Type_NODE_NEIGHBOR,node:node,neighbor:neighbor}),replaceLastQuery(selector,0,nhoodQ),neighbor}},{name:"child",separator:!0,regex:tokens.child,populate:function populate(selector,query){if(null==selector.currentSubject){var parentChildQuery={checks:[]},child={checks:[]},parent=selector[selector.length-1];return parentChildQuery.checks.push({type:Type_CHILD,parent:parent,child:child}),replaceLastQuery(selector,0,parentChildQuery),selector.compoundCount++,child}if(selector.currentSubject===query){var compound={checks:[]},left=selector[selector.length-1],right={checks:[]},subject={checks:[]},_child={checks:[]},_parent={checks:[]};return compound.checks.push({type:Type_COMPOUND_SPLIT,left:left,right:right,subject:subject}),subject.checks=query.checks,query.checks=[{type:Type_TRUE}],_parent.checks.push({type:Type_TRUE}),right.checks.push({type:Type_PARENT,parent:_parent,child:_child}),replaceLastQuery(selector,0,compound),selector.currentSubject=subject,selector.compoundCount++,_child}var _parent2={checks:[]},_child2={checks:[]},pcQChecks=[{type:Type_PARENT,parent:_parent2,child:_child2}];return _parent2.checks=query.checks,query.checks=pcQChecks,selector.compoundCount++,_child2}},{name:"descendant",separator:!0,regex:tokens.descendant,populate:function populate(selector,query){if(null==selector.currentSubject){var ancChQuery={checks:[]},descendant={checks:[]},ancestor=selector[selector.length-1];return ancChQuery.checks.push({type:Type_DESCENDANT,ancestor:ancestor,descendant:descendant}),replaceLastQuery(selector,0,ancChQuery),selector.compoundCount++,descendant}if(selector.currentSubject===query){var compound={checks:[]},left=selector[selector.length-1],right={checks:[]},subject={checks:[]},_descendant={checks:[]},_ancestor={checks:[]};return compound.checks.push({type:Type_COMPOUND_SPLIT,left:left,right:right,subject:subject}),subject.checks=query.checks,query.checks=[{type:Type_TRUE}],_ancestor.checks.push({type:Type_TRUE}),right.checks.push({type:Type_ANCESTOR,ancestor:_ancestor,descendant:_descendant}),replaceLastQuery(selector,0,compound),selector.currentSubject=subject,selector.compoundCount++,_descendant}var _ancestor2={checks:[]},_descendant2={checks:[]},adQChecks=[{type:Type_ANCESTOR,ancestor:_ancestor2,descendant:_descendant2}];return _ancestor2.checks=query.checks,query.checks=adQChecks,selector.compoundCount++,_descendant2}},{name:"subject",modifier:!0,regex:tokens.subject,populate:function populate(selector,query){if(null!=selector.currentSubject&&selector.currentSubject!==query)return warn("Redefinition of subject in selector `"+selector.toString()+"`"),!1;selector.currentSubject=query;var topChk=selector[selector.length-1].checks[0],topType=null==topChk?null:topChk.type;topType===Type_DIRECTED_EDGE?topChk.type=Type_NODE_TARGET:topType===Type_UNDIRECTED_EDGE&&(topChk.type=Type_NODE_NEIGHBOR,topChk.node=topChk.nodes[1],topChk.neighbor=topChk.nodes[0],topChk.nodes=null)}}];exprs.forEach((function(e){return e.regexObj=new RegExp("^"+e.regex)}));var consumeExpr=function consumeExpr(remaining){for(var expr,match,name,j=0;j<exprs.length;j++){var e=exprs[j],n=e.name,m=remaining.match(e.regexObj);if(null!=m){match=m,expr=e,name=n;var consumed=m[0];remaining=remaining.substring(consumed.length);break}}return{expr:expr,match:match,name:name,remaining:remaining}},parse$1={parse:function parse(selector){var remaining=this.inputText=selector,currentQuery=this[0]={checks:[]};for(this.length=1,remaining=function consumeWhitespace(remaining){var match=remaining.match(/^\s+/);if(match){var consumed=match[0];remaining=remaining.substring(consumed.length)}return remaining}(remaining);;){var exprInfo=consumeExpr(remaining);if(null==exprInfo.expr)return warn("The selector `"+selector+"`is invalid"),!1;var args=exprInfo.match.slice(1),ret=exprInfo.expr.populate(this,currentQuery,args);if(!1===ret)return!1;if(null!=ret&&(currentQuery=ret),(remaining=exprInfo.remaining).match(/^\s*$/))break}var lastQ=this[this.length-1];null!=this.currentSubject&&(lastQ.subject=this.currentSubject),lastQ.edgeCount=this.edgeCount,lastQ.compoundCount=this.compoundCount;for(var i=0;i<this.length;i++){var q=this[i];if(q.compoundCount>0&&q.edgeCount>0)return warn("The selector `"+selector+"` is invalid because it uses both a compound selector and an edge selector"),!1;if(q.edgeCount>1)return warn("The selector `"+selector+"` is invalid because it uses multiple edge selectors"),!1;1===q.edgeCount&&warn("The selector `"+selector+"` is deprecated.  Edge selectors do not take effect on changes to source and target nodes after an edge is added, for performance reasons.  Use a class or data selector on edges instead, updating the class or data of an edge when your app detects a change in source or target nodes.")}return!0},toString:function toString(){if(null!=this.toStringCache)return this.toStringCache;for(var clean=function clean(obj){return null==obj?"":obj},cleanVal=function cleanVal(val){return string(val)?'"'+val+'"':clean(val)},space=function space(val){return" "+val+" "},checkToString=function checkToString(check,subject){var type=check.type,value=check.value;switch(type){case Type_GROUP:var group=clean(value);return group.substring(0,group.length-1);case Type_DATA_COMPARE:var field=check.field,operator=check.operator;return"["+field+space(clean(operator))+cleanVal(value)+"]";case Type_DATA_BOOL:var _operator=check.operator,_field=check.field;return"["+clean(_operator)+_field+"]";case Type_DATA_EXIST:return"["+check.field+"]";case Type_META_COMPARE:var _operator2=check.operator;return"[["+check.field+space(clean(_operator2))+cleanVal(value)+"]]";case Type_STATE:return value;case Type_ID:return"#"+value;case Type_CLASS:return"."+value;case Type_PARENT:case Type_CHILD:return queryToString(check.parent,subject)+space(">")+queryToString(check.child,subject);case Type_ANCESTOR:case Type_DESCENDANT:return queryToString(check.ancestor,subject)+" "+queryToString(check.descendant,subject);case Type_COMPOUND_SPLIT:var lhs=queryToString(check.left,subject),sub=queryToString(check.subject,subject),rhs=queryToString(check.right,subject);return lhs+(lhs.length>0?" ":"")+sub+rhs;case Type_TRUE:return""}},queryToString=function queryToString(query,subject){return query.checks.reduce((function(str,chk,i){return str+(subject===query&&0===i?"$":"")+checkToString(chk,subject)}),"")},str="",i=0;i<this.length;i++){var query=this[i];str+=queryToString(query,query.subject),this.length>1&&i<this.length-1&&(str+=", ")}return this.toStringCache=str,str}},valCmp=function valCmp(fieldVal,operator,value){var matches,fieldStr,valStr,isFieldStr=string(fieldVal),isFieldNum=number(fieldVal),isValStr=string(value),caseInsensitive=!1,notExpr=!1,isIneqCmp=!1;switch(operator.indexOf("!")>=0&&(operator=operator.replace("!",""),notExpr=!0),operator.indexOf("@")>=0&&(operator=operator.replace("@",""),caseInsensitive=!0),(isFieldStr||isValStr||caseInsensitive)&&(fieldStr=isFieldStr||isFieldNum?""+fieldVal:"",valStr=""+value),caseInsensitive&&(fieldVal=fieldStr=fieldStr.toLowerCase(),value=valStr=valStr.toLowerCase()),operator){case"*=":matches=fieldStr.indexOf(valStr)>=0;break;case"$=":matches=fieldStr.indexOf(valStr,fieldStr.length-valStr.length)>=0;break;case"^=":matches=0===fieldStr.indexOf(valStr);break;case"=":matches=fieldVal===value;break;case">":isIneqCmp=!0,matches=fieldVal>value;break;case">=":isIneqCmp=!0,matches=fieldVal>=value;break;case"<":isIneqCmp=!0,matches=fieldVal<value;break;case"<=":isIneqCmp=!0,matches=fieldVal<=value;break;default:matches=!1}return!notExpr||null==fieldVal&&isIneqCmp||(matches=!matches),matches},data=function data(ele,field){return ele.data(field)},match=[],matches=function matches(query,ele){return query.checks.every((function(chk){return match[chk.type](chk,ele)}))};match[Type_GROUP]=function(check,ele){var group=check.value;return"*"===group||group===ele.group()},match[Type_STATE]=function(check,ele){return function stateSelectorMatches(sel,ele){return lookup[sel](ele)}(check.value,ele)},match[Type_ID]=function(check,ele){var id=check.value;return ele.id()===id},match[Type_CLASS]=function(check,ele){var cls=check.value;return ele.hasClass(cls)},match[Type_META_COMPARE]=function(check,ele){var field=check.field,operator=check.operator,value=check.value;return valCmp(function meta(ele,field){return ele[field]()}(ele,field),operator,value)},match[Type_DATA_COMPARE]=function(check,ele){var field=check.field,operator=check.operator,value=check.value;return valCmp(data(ele,field),operator,value)},match[Type_DATA_BOOL]=function(check,ele){var field=check.field,operator=check.operator;return function boolCmp(fieldVal,operator){switch(operator){case"?":return!!fieldVal;case"!":return!fieldVal;case"^":return void 0===fieldVal}}(data(ele,field),operator)},match[Type_DATA_EXIST]=function(check,ele){var field=check.field;return check.operator,function existCmp(fieldVal){return void 0!==fieldVal}(data(ele,field))},match[Type_UNDIRECTED_EDGE]=function(check,ele){var qA=check.nodes[0],qB=check.nodes[1],src=ele.source(),tgt=ele.target();return matches(qA,src)&&matches(qB,tgt)||matches(qB,src)&&matches(qA,tgt)},match[Type_NODE_NEIGHBOR]=function(check,ele){return matches(check.node,ele)&&ele.neighborhood().some((function(n){return n.isNode()&&matches(check.neighbor,n)}))},match[Type_DIRECTED_EDGE]=function(check,ele){return matches(check.source,ele.source())&&matches(check.target,ele.target())},match[Type_NODE_SOURCE]=function(check,ele){return matches(check.source,ele)&&ele.outgoers().some((function(n){return n.isNode()&&matches(check.target,n)}))},match[Type_NODE_TARGET]=function(check,ele){return matches(check.target,ele)&&ele.incomers().some((function(n){return n.isNode()&&matches(check.source,n)}))},match[Type_CHILD]=function(check,ele){return matches(check.child,ele)&&matches(check.parent,ele.parent())},match[Type_PARENT]=function(check,ele){return matches(check.parent,ele)&&ele.children().some((function(c){return matches(check.child,c)}))},match[Type_DESCENDANT]=function(check,ele){return matches(check.descendant,ele)&&ele.ancestors().some((function(a){return matches(check.ancestor,a)}))},match[Type_ANCESTOR]=function(check,ele){return matches(check.ancestor,ele)&&ele.descendants().some((function(d){return matches(check.descendant,d)}))},match[Type_COMPOUND_SPLIT]=function(check,ele){return matches(check.subject,ele)&&matches(check.left,ele)&&matches(check.right,ele)},match[Type_TRUE]=function(){return!0},match[Type_COLLECTION]=function(check,ele){return check.value.has(ele)},match[Type_FILTER]=function(check,ele){return(0,check.value)(ele)};var Selector=function Selector(selector){this.inputText=selector,this.currentSubject=null,this.compoundCount=0,this.edgeCount=0,this.length=0,null==selector||string(selector)&&selector.match(/^\s*$/)||(elementOrCollection(selector)?this.addQuery({checks:[{type:Type_COLLECTION,value:selector.collection()}]}):fn(selector)?this.addQuery({checks:[{type:Type_FILTER,value:selector}]}):string(selector)?this.parse(selector)||(this.invalid=!0):error("A selector must be created from a string; found "))},selfn=Selector.prototype;[parse$1,{matches:function matches$1(ele){for(var j=0;j<this.length;j++){var query=this[j];if(matches(query,ele))return!0}return!1},filter:function filter(collection){var self=this;if(1===self.length&&1===self[0].checks.length&&self[0].checks[0].type===Type_ID)return collection.getElementById(self[0].checks[0].value).collection();var selectorFunction=function selectorFunction(element){for(var j=0;j<self.length;j++){var query=self[j];if(matches(query,element))return!0}return!1};return null==self.text()&&(selectorFunction=function selectorFunction(){return!0}),collection.filter(selectorFunction)}}].forEach((function(p){return extend(selfn,p)})),selfn.text=function(){return this.inputText},selfn.size=function(){return this.length},selfn.eq=function(i){return this[i]},selfn.sameText=function(otherSel){return!this.invalid&&!otherSel.invalid&&this.text()===otherSel.text()},selfn.addQuery=function(q){this[this.length++]=q},selfn.selector=selfn.toString;var elesfn$f={allAre:function allAre(selector){var selObj=new Selector(selector);return this.every((function(ele){return selObj.matches(ele)}))},is:function is(selector){var selObj=new Selector(selector);return this.some((function(ele){return selObj.matches(ele)}))},some:function some(fn,thisArg){for(var i=0;i<this.length;i++){if(thisArg?fn.apply(thisArg,[this[i],i,this]):fn(this[i],i,this))return!0}return!1},every:function every(fn,thisArg){for(var i=0;i<this.length;i++){if(!(thisArg?fn.apply(thisArg,[this[i],i,this]):fn(this[i],i,this)))return!1}return!0},same:function same(collection){if(this===collection)return!0;collection=this.cy().collection(collection);var thisLength=this.length;return thisLength===collection.length&&(1===thisLength?this[0]===collection[0]:this.every((function(ele){return collection.hasElementWithId(ele.id())})))},anySame:function anySame(collection){return collection=this.cy().collection(collection),this.some((function(ele){return collection.hasElementWithId(ele.id())}))},allAreNeighbors:function allAreNeighbors(collection){collection=this.cy().collection(collection);var nhood=this.neighborhood();return collection.every((function(ele){return nhood.hasElementWithId(ele.id())}))},contains:function contains(collection){collection=this.cy().collection(collection);var self=this;return collection.every((function(ele){return self.hasElementWithId(ele.id())}))}};elesfn$f.allAreNeighbours=elesfn$f.allAreNeighbors,elesfn$f.has=elesfn$f.contains,elesfn$f.equal=elesfn$f.equals=elesfn$f.same;var fn$1,elesfn$h,cache=function cache(fn,name){return function traversalCache(arg1,arg2,arg3,arg4){var key,selectorOrEles=arg1;if(null==selectorOrEles?key="":elementOrCollection(selectorOrEles)&&1===selectorOrEles.length&&(key=selectorOrEles.id()),1===this.length&&key){var _p=this[0]._private,tch=_p.traversalCache=_p.traversalCache||{},ch=tch[name]=tch[name]||[],hash=hashString(key),cacheHit=ch[hash];return cacheHit||(ch[hash]=fn.call(this,arg1,arg2,arg3,arg4))}return fn.call(this,arg1,arg2,arg3,arg4)}},elesfn$g={parent:function parent(selector){var parents=[];if(1===this.length){var parent=this[0]._private.parent;if(parent)return parent}for(var i=0;i<this.length;i++){var _parent=this[i]._private.parent;_parent&&parents.push(_parent)}return this.spawn(parents,!0).filter(selector)},parents:function parents(selector){for(var parents=[],eles=this.parent();eles.nonempty();){for(var i=0;i<eles.length;i++){var ele=eles[i];parents.push(ele)}eles=eles.parent()}return this.spawn(parents,!0).filter(selector)},commonAncestors:function commonAncestors(selector){for(var ancestors,i=0;i<this.length;i++){var parents=this[i].parents();ancestors=(ancestors=ancestors||parents).intersect(parents)}return ancestors.filter(selector)},orphans:function orphans(selector){return this.stdFilter((function(ele){return ele.isOrphan()})).filter(selector)},nonorphans:function nonorphans(selector){return this.stdFilter((function(ele){return ele.isChild()})).filter(selector)},children:cache((function(selector){for(var children=[],i=0;i<this.length;i++)for(var eleChildren=this[i]._private.children,j=0;j<eleChildren.length;j++)children.push(eleChildren[j]);return this.spawn(children,!0).filter(selector)}),"children"),siblings:function siblings(selector){return this.parent().children().not(this).filter(selector)},isParent:function isParent(){var ele=this[0];if(ele)return ele.isNode()&&0!==ele._private.children.length},isChildless:function isChildless(){var ele=this[0];if(ele)return ele.isNode()&&0===ele._private.children.length},isChild:function isChild(){var ele=this[0];if(ele)return ele.isNode()&&null!=ele._private.parent},isOrphan:function isOrphan(){var ele=this[0];if(ele)return ele.isNode()&&null==ele._private.parent},descendants:function descendants(selector){var elements=[];return function add(eles){for(var i=0;i<eles.length;i++){var ele=eles[i];elements.push(ele),ele.children().nonempty()&&add(ele.children())}}(this.children()),this.spawn(elements,!0).filter(selector)}};function forEachCompound(eles,fn,includeSelf,recursiveStep){for(var q=[],did=new Set$1,hasCompounds=eles.cy().hasCompoundNodes(),i=0;i<eles.length;i++){var ele=eles[i];includeSelf?q.push(ele):hasCompounds&&recursiveStep(q,did,ele)}for(;q.length>0;){var _ele=q.shift();fn(_ele),did.add(_ele.id()),hasCompounds&&recursiveStep(q,did,_ele)}return eles}function addChildren(q,did,ele){if(ele.isParent())for(var children=ele._private.children,i=0;i<children.length;i++){var child=children[i];did.has(child.id())||q.push(child)}}function addParent(q,did,ele){if(ele.isChild()){var parent=ele._private.parent;did.has(parent.id())||q.push(parent)}}function addParentAndChildren(q,did,ele){addParent(q,did,ele),addChildren(q,did,ele)}elesfn$g.forEachDown=function(fn){var includeSelf=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return forEachCompound(this,fn,includeSelf,addChildren)},elesfn$g.forEachUp=function(fn){var includeSelf=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return forEachCompound(this,fn,includeSelf,addParent)},elesfn$g.forEachUpAndDown=function(fn){var includeSelf=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return forEachCompound(this,fn,includeSelf,addParentAndChildren)},elesfn$g.ancestors=elesfn$g.parents,(fn$1=elesfn$h={data:define$3.data({field:"data",bindingEvent:"data",allowBinding:!0,allowSetting:!0,settingEvent:"data",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,immutableKeys:{id:!0,source:!0,target:!0,parent:!0},updateStyle:!0}),removeData:define$3.removeData({field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!0,immutableKeys:{id:!0,source:!0,target:!0,parent:!0},updateStyle:!0}),scratch:define$3.data({field:"scratch",bindingEvent:"scratch",allowBinding:!0,allowSetting:!0,settingEvent:"scratch",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeScratch:define$3.removeData({field:"scratch",event:"scratch",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0}),rscratch:define$3.data({field:"rscratch",allowBinding:!1,allowSetting:!0,settingTriggersEvent:!1,allowGetting:!0}),removeRscratch:define$3.removeData({field:"rscratch",triggerEvent:!1}),id:function id(){var ele=this[0];if(ele)return ele._private.data.id}}).attr=fn$1.data,fn$1.removeAttr=fn$1.removeData;var fn$2,elesfn$j,data$1=elesfn$h,elesfn$i={};function defineDegreeFunction(callback){return function(includeLoops){if(void 0===includeLoops&&(includeLoops=!0),0!==this.length&&this.isNode()&&!this.removed()){for(var degree=0,node=this[0],connectedEdges=node._private.edges,i=0;i<connectedEdges.length;i++){var edge=connectedEdges[i];!includeLoops&&edge.isLoop()||(degree+=callback(node,edge))}return degree}}}function defineDegreeBoundsFunction(degreeFn,callback){return function(includeLoops){for(var ret,nodes=this.nodes(),i=0;i<nodes.length;i++){var degree=nodes[i][degreeFn](includeLoops);void 0===degree||void 0!==ret&&!callback(degree,ret)||(ret=degree)}return ret}}extend(elesfn$i,{degree:defineDegreeFunction((function(node,edge){return edge.source().same(edge.target())?2:1})),indegree:defineDegreeFunction((function(node,edge){return edge.target().same(node)?1:0})),outdegree:defineDegreeFunction((function(node,edge){return edge.source().same(node)?1:0}))}),extend(elesfn$i,{minDegree:defineDegreeBoundsFunction("degree",(function(degree,min){return degree<min})),maxDegree:defineDegreeBoundsFunction("degree",(function(degree,max){return degree>max})),minIndegree:defineDegreeBoundsFunction("indegree",(function(degree,min){return degree<min})),maxIndegree:defineDegreeBoundsFunction("indegree",(function(degree,max){return degree>max})),minOutdegree:defineDegreeBoundsFunction("outdegree",(function(degree,min){return degree<min})),maxOutdegree:defineDegreeBoundsFunction("outdegree",(function(degree,max){return degree>max}))}),extend(elesfn$i,{totalDegree:function totalDegree(includeLoops){for(var total=0,nodes=this.nodes(),i=0;i<nodes.length;i++)total+=nodes[i].degree(includeLoops);return total}});var beforePositionSet=function beforePositionSet(eles,newPos,silent){for(var i=0;i<eles.length;i++){var ele=eles[i];if(!ele.locked()){var oldPos=ele._private.position,delta={x:null!=newPos.x?newPos.x-oldPos.x:0,y:null!=newPos.y?newPos.y-oldPos.y:0};!ele.isParent()||0===delta.x&&0===delta.y||ele.children().shift(delta,silent),ele.dirtyBoundingBoxCache()}}},positionDef={field:"position",bindingEvent:"position",allowBinding:!0,allowSetting:!0,settingEvent:"position",settingTriggersEvent:!0,triggerFnName:"emitAndNotify",allowGetting:!0,validKeys:["x","y"],beforeGet:function beforeGet(ele){ele.updateCompoundBounds()},beforeSet:function beforeSet(eles,newPos){beforePositionSet(eles,newPos,!1)},onSet:function onSet(eles){eles.dirtyCompoundBoundsCache()},canSet:function canSet(ele){return!ele.locked()}};(fn$2=elesfn$j={position:define$3.data(positionDef),silentPosition:define$3.data(extend({},positionDef,{allowBinding:!1,allowSetting:!0,settingTriggersEvent:!1,allowGetting:!1,beforeSet:function beforeSet(eles,newPos){beforePositionSet(eles,newPos,!0)},onSet:function onSet(eles){eles.dirtyCompoundBoundsCache()}})),positions:function positions(pos,silent){if(plainObject(pos))silent?this.silentPosition(pos):this.position(pos);else if(fn(pos)){var _fn=pos,cy=this.cy();cy.startBatch();for(var i=0;i<this.length;i++){var _pos,ele=this[i];(_pos=_fn(ele,i))&&(silent?ele.silentPosition(_pos):ele.position(_pos))}cy.endBatch()}return this},silentPositions:function silentPositions(pos){return this.positions(pos,!0)},shift:function shift(dim,val,silent){var delta;if(plainObject(dim)?(delta={x:number(dim.x)?dim.x:0,y:number(dim.y)?dim.y:0},silent=val):string(dim)&&number(val)&&((delta={x:0,y:0})[dim]=val),null!=delta){var cy=this.cy();cy.startBatch();for(var i=0;i<this.length;i++){var ele=this[i],pos=ele.position(),newPos={x:pos.x+delta.x,y:pos.y+delta.y};silent?ele.silentPosition(newPos):ele.position(newPos)}cy.endBatch()}return this},silentShift:function silentShift(dim,val){return plainObject(dim)?this.shift(dim,!0):string(dim)&&number(val)&&this.shift(dim,val,!0),this},renderedPosition:function renderedPosition(dim,val){var ele=this[0],cy=this.cy(),zoom=cy.zoom(),pan=cy.pan(),rpos=plainObject(dim)?dim:void 0,setting=void 0!==rpos||void 0!==val&&string(dim);if(ele&&ele.isNode()){if(!setting){var pos=ele.position();return rpos=modelToRenderedPosition(pos,zoom,pan),void 0===dim?rpos:rpos[dim]}for(var i=0;i<this.length;i++){var _ele=this[i];void 0!==val?_ele.position(dim,(val-pan[dim])/zoom):void 0!==rpos&&_ele.position(renderedToModelPosition(rpos,zoom,pan))}}else if(!setting)return;return this},relativePosition:function relativePosition(dim,val){var ele=this[0],cy=this.cy(),ppos=plainObject(dim)?dim:void 0,setting=void 0!==ppos||void 0!==val&&string(dim),hasCompoundNodes=cy.hasCompoundNodes();if(ele&&ele.isNode()){if(!setting){var pos=ele.position(),_parent=hasCompoundNodes?ele.parent():null,_hasParent=_parent&&_parent.length>0,_relativeToParent=_hasParent;_hasParent&&(_parent=_parent[0]);var _origin=_relativeToParent?_parent.position():{x:0,y:0};return ppos={x:pos.x-_origin.x,y:pos.y-_origin.y},void 0===dim?ppos:ppos[dim]}for(var i=0;i<this.length;i++){var _ele2=this[i],parent=hasCompoundNodes?_ele2.parent():null,hasParent=parent&&parent.length>0,relativeToParent=hasParent;hasParent&&(parent=parent[0]);var origin=relativeToParent?parent.position():{x:0,y:0};void 0!==val?_ele2.position(dim,val+origin[dim]):void 0!==ppos&&_ele2.position({x:ppos.x+origin.x,y:ppos.y+origin.y})}}else if(!setting)return;return this}}).modelPosition=fn$2.point=fn$2.position,fn$2.modelPositions=fn$2.points=fn$2.positions,fn$2.renderedPoint=fn$2.renderedPosition,fn$2.relativePoint=fn$2.relativePosition;var fn$3,elesfn$k,position=elesfn$j;fn$3=elesfn$k={},elesfn$k.renderedBoundingBox=function(options){var bb=this.boundingBox(options),cy=this.cy(),zoom=cy.zoom(),pan=cy.pan(),x1=bb.x1*zoom+pan.x,x2=bb.x2*zoom+pan.x,y1=bb.y1*zoom+pan.y,y2=bb.y2*zoom+pan.y;return{x1:x1,x2:x2,y1:y1,y2:y2,w:x2-x1,h:y2-y1}},elesfn$k.dirtyCompoundBoundsCache=function(){var silent=arguments.length>0&&void 0!==arguments[0]&&arguments[0],cy=this.cy();return cy.styleEnabled()&&cy.hasCompoundNodes()?(this.forEachUp((function(ele){if(ele.isParent()){var _p=ele._private;_p.compoundBoundsClean=!1,_p.bbCache=null,silent||ele.emitAndNotify("bounds")}})),this):this},elesfn$k.updateCompoundBounds=function(){var force=arguments.length>0&&void 0!==arguments[0]&&arguments[0],cy=this.cy();if(!cy.styleEnabled()||!cy.hasCompoundNodes())return this;if(!force&&cy.batching())return this;function update(parent){if(parent.isParent()){var _p=parent._private,children=parent.children(),includeLabels="include"===parent.pstyle("compound-sizing-wrt-labels").value,min={width:{val:parent.pstyle("min-width").pfValue,left:parent.pstyle("min-width-bias-left"),right:parent.pstyle("min-width-bias-right")},height:{val:parent.pstyle("min-height").pfValue,top:parent.pstyle("min-height-bias-top"),bottom:parent.pstyle("min-height-bias-bottom")}},bb=children.boundingBox({includeLabels:includeLabels,includeOverlays:!1,useCache:!1}),pos=_p.position;0!==bb.w&&0!==bb.h||((bb={w:parent.pstyle("width").pfValue,h:parent.pstyle("height").pfValue}).x1=pos.x-bb.w/2,bb.x2=pos.x+bb.w/2,bb.y1=pos.y-bb.h/2,bb.y2=pos.y+bb.h/2);var leftVal=min.width.left.value;"px"===min.width.left.units&&min.width.val>0&&(leftVal=100*leftVal/min.width.val);var rightVal=min.width.right.value;"px"===min.width.right.units&&min.width.val>0&&(rightVal=100*rightVal/min.width.val);var topVal=min.height.top.value;"px"===min.height.top.units&&min.height.val>0&&(topVal=100*topVal/min.height.val);var bottomVal=min.height.bottom.value;"px"===min.height.bottom.units&&min.height.val>0&&(bottomVal=100*bottomVal/min.height.val);var widthBiasDiffs=computeBiasValues(min.width.val-bb.w,leftVal,rightVal),diffLeft=widthBiasDiffs.biasDiff,diffRight=widthBiasDiffs.biasComplementDiff,heightBiasDiffs=computeBiasValues(min.height.val-bb.h,topVal,bottomVal),diffTop=heightBiasDiffs.biasDiff,diffBottom=heightBiasDiffs.biasComplementDiff;_p.autoPadding=function computePaddingValues(width,height,paddingObject,relativeTo){if("%"!==paddingObject.units)return"px"===paddingObject.units?paddingObject.pfValue:0;switch(relativeTo){case"width":return width>0?paddingObject.pfValue*width:0;case"height":return height>0?paddingObject.pfValue*height:0;case"average":return width>0&&height>0?paddingObject.pfValue*(width+height)/2:0;case"min":return width>0&&height>0?width>height?paddingObject.pfValue*height:paddingObject.pfValue*width:0;case"max":return width>0&&height>0?width>height?paddingObject.pfValue*width:paddingObject.pfValue*height:0;default:return 0}}(bb.w,bb.h,parent.pstyle("padding"),parent.pstyle("padding-relative-to").value),_p.autoWidth=Math.max(bb.w,min.width.val),pos.x=(-diffLeft+bb.x1+bb.x2+diffRight)/2,_p.autoHeight=Math.max(bb.h,min.height.val),pos.y=(-diffTop+bb.y1+bb.y2+diffBottom)/2}function computeBiasValues(propDiff,propBias,propBiasComplement){var biasDiff=0,biasComplementDiff=0,biasTotal=propBias+propBiasComplement;return propDiff>0&&biasTotal>0&&(biasDiff=propBias/biasTotal*propDiff,biasComplementDiff=propBiasComplement/biasTotal*propDiff),{biasDiff:biasDiff,biasComplementDiff:biasComplementDiff}}}for(var i=0;i<this.length;i++){var ele=this[i],_p=ele._private;_p.compoundBoundsClean&&!force||(update(ele),cy.batching()||(_p.compoundBoundsClean=!0))}return this};var noninf=function noninf(x){return x===1/0||x===-1/0?0:x},updateBounds=function updateBounds(b,x1,y1,x2,y2){x2-x1!=0&&y2-y1!=0&&null!=x1&&null!=y1&&null!=x2&&null!=y2&&(b.x1=x1<b.x1?x1:b.x1,b.x2=x2>b.x2?x2:b.x2,b.y1=y1<b.y1?y1:b.y1,b.y2=y2>b.y2?y2:b.y2,b.w=b.x2-b.x1,b.h=b.y2-b.y1)},updateBoundsFromBox=function updateBoundsFromBox(b,b2){return null==b2?b:updateBounds(b,b2.x1,b2.y1,b2.x2,b2.y2)},prefixedProperty=function prefixedProperty(obj,field,prefix){return getPrefixedProperty(obj,field,prefix)},updateBoundsFromArrow=function updateBoundsFromArrow(bounds,ele,prefix){if(!ele.cy().headless()){var x,y,_p=ele._private,rstyle=_p.rstyle,halfArW=rstyle.arrowWidth/2;if("none"!==ele.pstyle(prefix+"-arrow-shape").value){"source"===prefix?(x=rstyle.srcX,y=rstyle.srcY):"target"===prefix?(x=rstyle.tgtX,y=rstyle.tgtY):(x=rstyle.midX,y=rstyle.midY);var bbs=_p.arrowBounds=_p.arrowBounds||{},bb=bbs[prefix]=bbs[prefix]||{};bb.x1=x-halfArW,bb.y1=y-halfArW,bb.x2=x+halfArW,bb.y2=y+halfArW,bb.w=bb.x2-bb.x1,bb.h=bb.y2-bb.y1,expandBoundingBox(bb,1),updateBounds(bounds,bb.x1,bb.y1,bb.x2,bb.y2)}}},updateBoundsFromLabel=function updateBoundsFromLabel(bounds,ele,prefix){if(!ele.cy().headless()){var prefixDash;prefixDash=prefix?prefix+"-":"";var _p=ele._private,rstyle=_p.rstyle;if(ele.pstyle(prefixDash+"label").strValue){var lx1,lx2,ly1,ly2,halign=ele.pstyle("text-halign"),valign=ele.pstyle("text-valign"),labelWidth=prefixedProperty(rstyle,"labelWidth",prefix),labelHeight=prefixedProperty(rstyle,"labelHeight",prefix),labelX=prefixedProperty(rstyle,"labelX",prefix),labelY=prefixedProperty(rstyle,"labelY",prefix),marginX=ele.pstyle(prefixDash+"text-margin-x").pfValue,marginY=ele.pstyle(prefixDash+"text-margin-y").pfValue,isEdge=ele.isEdge(),rotation=ele.pstyle(prefixDash+"text-rotation"),outlineWidth=ele.pstyle("text-outline-width").pfValue,halfBorderWidth=ele.pstyle("text-border-width").pfValue/2,padding=ele.pstyle("text-background-padding").pfValue,lh=labelHeight,lw=labelWidth,lw_2=lw/2,lh_2=lh/2;if(isEdge)lx1=labelX-lw_2,lx2=labelX+lw_2,ly1=labelY-lh_2,ly2=labelY+lh_2;else{switch(halign.value){case"left":lx1=labelX-lw,lx2=labelX;break;case"center":lx1=labelX-lw_2,lx2=labelX+lw_2;break;case"right":lx1=labelX,lx2=labelX+lw}switch(valign.value){case"top":ly1=labelY-lh,ly2=labelY;break;case"center":ly1=labelY-lh_2,ly2=labelY+lh_2;break;case"bottom":ly1=labelY,ly2=labelY+lh}}lx1+=marginX-Math.max(outlineWidth,halfBorderWidth)-padding-2,lx2+=marginX+Math.max(outlineWidth,halfBorderWidth)+padding+2,ly1+=marginY-Math.max(outlineWidth,halfBorderWidth)-padding-2,ly2+=marginY+Math.max(outlineWidth,halfBorderWidth)+padding+2;var bbPrefix=prefix||"main",bbs=_p.labelBounds,bb=bbs[bbPrefix]=bbs[bbPrefix]||{};bb.x1=lx1,bb.y1=ly1,bb.x2=lx2,bb.y2=ly2,bb.w=lx2-lx1,bb.h=ly2-ly1;var isAutorotate=isEdge&&"autorotate"===rotation.strValue,isPfValue=null!=rotation.pfValue&&0!==rotation.pfValue;if(isAutorotate||isPfValue){var theta=isAutorotate?prefixedProperty(_p.rstyle,"labelAngle",prefix):rotation.pfValue,cos=Math.cos(theta),sin=Math.sin(theta),xo=(lx1+lx2)/2,yo=(ly1+ly2)/2;if(!isEdge){switch(halign.value){case"left":xo=lx2;break;case"right":xo=lx1}switch(valign.value){case"top":yo=ly2;break;case"bottom":yo=ly1}}var rotate=function rotate(x,y){return{x:(x-=xo)*cos-(y-=yo)*sin+xo,y:x*sin+y*cos+yo}},px1y1=rotate(lx1,ly1),px1y2=rotate(lx1,ly2),px2y1=rotate(lx2,ly1),px2y2=rotate(lx2,ly2);lx1=Math.min(px1y1.x,px1y2.x,px2y1.x,px2y2.x),lx2=Math.max(px1y1.x,px1y2.x,px2y1.x,px2y2.x),ly1=Math.min(px1y1.y,px1y2.y,px2y1.y,px2y2.y),ly2=Math.max(px1y1.y,px1y2.y,px2y1.y,px2y2.y)}var bbPrefixRot=bbPrefix+"Rot",bbRot=bbs[bbPrefixRot]=bbs[bbPrefixRot]||{};bbRot.x1=lx1,bbRot.y1=ly1,bbRot.x2=lx2,bbRot.y2=ly2,bbRot.w=lx2-lx1,bbRot.h=ly2-ly1,updateBounds(bounds,lx1,ly1,lx2,ly2),updateBounds(_p.labelBounds.all,lx1,ly1,lx2,ly2)}return bounds}},getKey=function getKey(opts){var i=0,tf=function tf(val){return(val?1:0)<<i++},key=0;return key+=tf(opts.incudeNodes),key+=tf(opts.includeEdges),key+=tf(opts.includeLabels),key+=tf(opts.includeMainLabels),key+=tf(opts.includeSourceLabels),key+=tf(opts.includeTargetLabels),key+=tf(opts.includeOverlays)},getBoundingBoxPosKey=function getBoundingBoxPosKey(ele){if(ele.isEdge()){var p1=ele.source().position(),p2=ele.target().position(),r=function r(x){return Math.round(x)};return function hashIntsArray(ints,seed){var entry={value:0,done:!1},i=0,length=ints.length;return hashIterableInts({next:function next(){return i<length?entry.value=ints[i++]:entry.done=!0,entry}},seed)}([r(p1.x),r(p1.y),r(p2.x),r(p2.y)])}return 0},cachedBoundingBoxImpl=function cachedBoundingBoxImpl(ele,opts){var bb,_p=ele._private,isEdge=ele.isEdge(),usingDefOpts=(null==opts?defBbOptsKey:getKey(opts))===defBbOptsKey,currPosKey=getBoundingBoxPosKey(ele),isPosKeySame=_p.bbCachePosKey===currPosKey,useCache=opts.useCache&&isPosKeySame,isDirty=function isDirty(ele){return null==ele._private.bbCache||ele._private.styleDirty};if(!useCache||isDirty(ele)||isEdge&&isDirty(ele.source())||isDirty(ele.target())?(isPosKeySame||ele.recalculateRenderedStyle(useCache),bb=function boundingBoxImpl(ele,options){var ex1,ex2,ey1,ey2,x,y,cy=ele._private.cy,styleEnabled=cy.styleEnabled(),headless=cy.headless(),bounds=makeBoundingBox(),_p=ele._private,isNode=ele.isNode(),isEdge=ele.isEdge(),rstyle=_p.rstyle,manualExpansion=isNode&&styleEnabled?ele.pstyle("bounds-expansion").pfValue:[0],isDisplayed=function isDisplayed(ele){return"none"!==ele.pstyle("display").value},displayed=!styleEnabled||isDisplayed(ele)&&(!isEdge||isDisplayed(ele.source())&&isDisplayed(ele.target()));if(displayed){var overlayPadding=0;styleEnabled&&options.includeOverlays&&0!==ele.pstyle("overlay-opacity").value&&(overlayPadding=ele.pstyle("overlay-padding").value);var wHalf=0;if(styleEnabled&&(wHalf=ele.pstyle("width").pfValue/2),isNode&&options.includeNodes){var pos=ele.position();x=pos.x,y=pos.y;var halfW=ele.outerWidth()/2,halfH=ele.outerHeight()/2;updateBounds(bounds,ex1=x-halfW,ey1=y-halfH,ex2=x+halfW,ey2=y+halfH)}else if(isEdge&&options.includeEdges)if(styleEnabled&&!headless){var curveStyle=ele.pstyle("curve-style").strValue;if(ex1=Math.min(rstyle.srcX,rstyle.midX,rstyle.tgtX),ex2=Math.max(rstyle.srcX,rstyle.midX,rstyle.tgtX),ey1=Math.min(rstyle.srcY,rstyle.midY,rstyle.tgtY),ey2=Math.max(rstyle.srcY,rstyle.midY,rstyle.tgtY),updateBounds(bounds,ex1-=wHalf,ey1-=wHalf,ex2+=wHalf,ey2+=wHalf),"haystack"===curveStyle){var hpts=rstyle.haystackPts;if(hpts&&2===hpts.length){if(ex1=hpts[0].x,ey1=hpts[0].y,ex1>(ex2=hpts[1].x)){var temp=ex1;ex1=ex2,ex2=temp}if(ey1>(ey2=hpts[1].y)){var _temp=ey1;ey1=ey2,ey2=_temp}updateBounds(bounds,ex1-wHalf,ey1-wHalf,ex2+wHalf,ey2+wHalf)}}else if("bezier"===curveStyle||"unbundled-bezier"===curveStyle||"segments"===curveStyle||"taxi"===curveStyle){var pts;switch(curveStyle){case"bezier":case"unbundled-bezier":pts=rstyle.bezierPts;break;case"segments":case"taxi":pts=rstyle.linePts}if(null!=pts)for(var j=0;j<pts.length;j++){var pt=pts[j];ex1=pt.x-wHalf,ex2=pt.x+wHalf,ey1=pt.y-wHalf,ey2=pt.y+wHalf,updateBounds(bounds,ex1,ey1,ex2,ey2)}}}else{var n1pos=ele.source().position(),n2pos=ele.target().position();if((ex1=n1pos.x)>(ex2=n2pos.x)){var _temp2=ex1;ex1=ex2,ex2=_temp2}if((ey1=n1pos.y)>(ey2=n2pos.y)){var _temp3=ey1;ey1=ey2,ey2=_temp3}updateBounds(bounds,ex1-=wHalf,ey1-=wHalf,ex2+=wHalf,ey2+=wHalf)}if(styleEnabled&&options.includeEdges&&isEdge&&(updateBoundsFromArrow(bounds,ele,"mid-source"),updateBoundsFromArrow(bounds,ele,"mid-target"),updateBoundsFromArrow(bounds,ele,"source"),updateBoundsFromArrow(bounds,ele,"target")),styleEnabled)if("yes"===ele.pstyle("ghost").value){var gx=ele.pstyle("ghost-offset-x").pfValue,gy=ele.pstyle("ghost-offset-y").pfValue;updateBounds(bounds,bounds.x1+gx,bounds.y1+gy,bounds.x2+gx,bounds.y2+gy)}var bbBody=_p.bodyBounds=_p.bodyBounds||{};assignBoundingBox(bbBody,bounds),expandBoundingBoxSides(bbBody,manualExpansion),expandBoundingBox(bbBody,1),styleEnabled&&(ex1=bounds.x1,ex2=bounds.x2,ey1=bounds.y1,ey2=bounds.y2,updateBounds(bounds,ex1-overlayPadding,ey1-overlayPadding,ex2+overlayPadding,ey2+overlayPadding));var bbOverlay=_p.overlayBounds=_p.overlayBounds||{};assignBoundingBox(bbOverlay,bounds),expandBoundingBoxSides(bbOverlay,manualExpansion),expandBoundingBox(bbOverlay,1);var bbLabels=_p.labelBounds=_p.labelBounds||{};null!=bbLabels.all?function clearBoundingBox(bb){bb.x1=1/0,bb.y1=1/0,bb.x2=-1/0,bb.y2=-1/0,bb.w=0,bb.h=0}(bbLabels.all):bbLabels.all=makeBoundingBox(),styleEnabled&&options.includeLabels&&(options.includeMainLabels&&updateBoundsFromLabel(bounds,ele,null),isEdge&&(options.includeSourceLabels&&updateBoundsFromLabel(bounds,ele,"source"),options.includeTargetLabels&&updateBoundsFromLabel(bounds,ele,"target")))}return bounds.x1=noninf(bounds.x1),bounds.y1=noninf(bounds.y1),bounds.x2=noninf(bounds.x2),bounds.y2=noninf(bounds.y2),bounds.w=noninf(bounds.x2-bounds.x1),bounds.h=noninf(bounds.y2-bounds.y1),bounds.w>0&&bounds.h>0&&displayed&&(expandBoundingBoxSides(bounds,manualExpansion),expandBoundingBox(bounds,1)),bounds}(ele,defBbOpts),_p.bbCache=bb,_p.bbCachePosKey=currPosKey):bb=_p.bbCache,!usingDefOpts){var isNode=ele.isNode();bb=makeBoundingBox(),(opts.includeNodes&&isNode||opts.includeEdges&&!isNode)&&(opts.includeOverlays?updateBoundsFromBox(bb,_p.overlayBounds):updateBoundsFromBox(bb,_p.bodyBounds)),opts.includeLabels&&(opts.includeMainLabels&&(!isEdge||opts.includeSourceLabels&&opts.includeTargetLabels)?updateBoundsFromBox(bb,_p.labelBounds.all):(opts.includeMainLabels&&updateBoundsFromBox(bb,_p.labelBounds.mainRot),opts.includeSourceLabels&&updateBoundsFromBox(bb,_p.labelBounds.sourceRot),opts.includeTargetLabels&&updateBoundsFromBox(bb,_p.labelBounds.targetRot))),bb.w=bb.x2-bb.x1,bb.h=bb.y2-bb.y1}return bb},defBbOpts={includeNodes:!0,includeEdges:!0,includeLabels:!0,includeMainLabels:!0,includeSourceLabels:!0,includeTargetLabels:!0,includeOverlays:!0,useCache:!0},defBbOptsKey=getKey(defBbOpts),filledBbOpts=defaults(defBbOpts);elesfn$k.boundingBox=function(options){var bounds;if(1!==this.length||null==this[0]._private.bbCache||this[0]._private.styleDirty||void 0!==options&&void 0!==options.useCache&&!0!==options.useCache){bounds=makeBoundingBox();var opts=filledBbOpts(options=options||defBbOpts);if(this.cy().styleEnabled())for(var i=0;i<this.length;i++){var ele=this[i],_p=ele._private,currPosKey=getBoundingBoxPosKey(ele),isPosKeySame=_p.bbCachePosKey===currPosKey,useCache=opts.useCache&&isPosKeySame&&!_p.styleDirty;ele.recalculateRenderedStyle(useCache)}this.updateCompoundBounds(!options.useCache);for(var _i=0;_i<this.length;_i++){var _ele=this[_i];updateBoundsFromBox(bounds,cachedBoundingBoxImpl(_ele,opts))}}else options=void 0===options?defBbOpts:filledBbOpts(options),bounds=cachedBoundingBoxImpl(this[0],options);return bounds.x1=noninf(bounds.x1),bounds.y1=noninf(bounds.y1),bounds.x2=noninf(bounds.x2),bounds.y2=noninf(bounds.y2),bounds.w=noninf(bounds.x2-bounds.x1),bounds.h=noninf(bounds.y2-bounds.y1),bounds},elesfn$k.dirtyBoundingBoxCache=function(){for(var i=0;i<this.length;i++){var _p=this[i]._private;_p.bbCache=null,_p.bbCachePosKey=null,_p.bodyBounds=null,_p.overlayBounds=null,_p.labelBounds.all=null,_p.labelBounds.source=null,_p.labelBounds.target=null,_p.labelBounds.main=null,_p.labelBounds.sourceRot=null,_p.labelBounds.targetRot=null,_p.labelBounds.mainRot=null,_p.arrowBounds.source=null,_p.arrowBounds.target=null,_p.arrowBounds["mid-source"]=null,_p.arrowBounds["mid-target"]=null}return this.emitAndNotify("bounds"),this},elesfn$k.boundingBoxAt=function(fn){var nodes=this.nodes(),cy=this.cy(),hasCompoundNodes=cy.hasCompoundNodes(),parents=cy.collection();if(hasCompoundNodes&&(parents=nodes.filter((function(node){return node.isParent()})),nodes=nodes.not(parents)),plainObject(fn)){var obj=fn;fn=function fn(){return obj}}cy.startBatch(),nodes.forEach((function storeOldPos(node,i){return node._private.bbAtOldPos=fn(node,i)})).silentPositions(fn),hasCompoundNodes&&(parents.dirtyCompoundBoundsCache(),parents.dirtyBoundingBoxCache(),parents.updateCompoundBounds(!0));var bb=function copyBoundingBox(bb){return{x1:bb.x1,x2:bb.x2,w:bb.w,y1:bb.y1,y2:bb.y2,h:bb.h}}(this.boundingBox({useCache:!1}));return nodes.silentPositions((function getOldPos(node){return node._private.bbAtOldPos})),hasCompoundNodes&&(parents.dirtyCompoundBoundsCache(),parents.dirtyBoundingBoxCache(),parents.updateCompoundBounds(!0)),cy.endBatch(),bb},fn$3.boundingbox=fn$3.bb=fn$3.boundingBox,fn$3.renderedBoundingbox=fn$3.renderedBoundingBox;var fn$4,elesfn$l,bounds=elesfn$k;fn$4=elesfn$l={};var defineDimFns=function defineDimFns(opts){opts.uppercaseName=capitalize(opts.name),opts.autoName="auto"+opts.uppercaseName,opts.labelName="label"+opts.uppercaseName,opts.outerName="outer"+opts.uppercaseName,opts.uppercaseOuterName=capitalize(opts.outerName),fn$4[opts.name]=function dimImpl(){var ele=this[0],_p=ele._private,styleEnabled=_p.cy._private.styleEnabled;if(ele){if(!styleEnabled)return 1;if(ele.isParent())return ele.updateCompoundBounds(),_p[opts.autoName]||0;var d=ele.pstyle(opts.name);switch(d.strValue){case"label":return ele.recalculateRenderedStyle(),_p.rstyle[opts.labelName]||0;default:return d.pfValue}}},fn$4["outer"+opts.uppercaseName]=function outerDimImpl(){var ele=this[0],styleEnabled=ele._private.cy._private.styleEnabled;if(ele)return styleEnabled?ele[opts.name]()+ele.pstyle("border-width").pfValue+2*ele.padding():1},fn$4["rendered"+opts.uppercaseName]=function renderedDimImpl(){var ele=this[0];if(ele)return ele[opts.name]()*this.cy().zoom()},fn$4["rendered"+opts.uppercaseOuterName]=function renderedOuterDimImpl(){var ele=this[0];if(ele)return ele[opts.outerName]()*this.cy().zoom()}};defineDimFns({name:"width"}),defineDimFns({name:"height"}),elesfn$l.padding=function(){var ele=this[0],_p=ele._private;return ele.isParent()?(ele.updateCompoundBounds(),void 0!==_p.autoPadding?_p.autoPadding:ele.pstyle("padding").pfValue):ele.pstyle("padding").pfValue},elesfn$l.paddedHeight=function(){var ele=this[0];return ele.height()+2*ele.padding()},elesfn$l.paddedWidth=function(){var ele=this[0];return ele.width()+2*ele.padding()};var widthHeight=elesfn$l,pts={controlPoints:{get:function controlPoints(ele){return ele.renderer().getControlPoints(ele)},mult:!0},segmentPoints:{get:function segmentPoints(ele){return ele.renderer().getSegmentPoints(ele)},mult:!0},sourceEndpoint:{get:function sourceEndpoint(ele){return ele.renderer().getSourceEndpoint(ele)}},targetEndpoint:{get:function targetEndpoint(ele){return ele.renderer().getTargetEndpoint(ele)}},midpoint:{get:function midpoint(ele){return ele.renderer().getEdgeMidpoint(ele)}}},edgePoints=Object.keys(pts).reduce((function(obj,name){var spec=pts[name],rName=function renderedName(name){return"rendered"+name[0].toUpperCase()+name.substr(1)}(name);return obj[name]=function(){return function ifEdge(ele,getValue){if(ele.isEdge())return getValue(ele)}(this,spec.get)},spec.mult?obj[rName]=function(){return function ifEdgeRenderedPositions(ele,getPoints){if(ele.isEdge()){var cy=ele.cy(),pan=cy.pan(),zoom=cy.zoom();return getPoints(ele).map((function(p){return modelToRenderedPosition(p,zoom,pan)}))}}(this,spec.get)}:obj[rName]=function(){return function ifEdgeRenderedPosition(ele,getPoint){if(ele.isEdge()){var cy=ele.cy();return modelToRenderedPosition(getPoint(ele),cy.zoom(),cy.pan())}}(this,spec.get)},obj}),{}),dimensions=extend({},position,bounds,widthHeight,edgePoints),Event=function Event(src,props){this.recycle(src,props)};function returnFalse(){return!1}function returnTrue(){return!0}Event.prototype={instanceString:function instanceString(){return"event"},recycle:function recycle(src,props){if(this.isImmediatePropagationStopped=this.isPropagationStopped=this.isDefaultPrevented=returnFalse,null!=src&&src.preventDefault?(this.type=src.type,this.isDefaultPrevented=src.defaultPrevented?returnTrue:returnFalse):null!=src&&src.type?props=src:this.type=src,null!=props&&(this.originalEvent=props.originalEvent,this.type=null!=props.type?props.type:this.type,this.cy=props.cy,this.target=props.target,this.position=props.position,this.renderedPosition=props.renderedPosition,this.namespace=props.namespace,this.layout=props.layout),null!=this.cy&&null!=this.position&&null==this.renderedPosition){var pos=this.position,zoom=this.cy.zoom(),pan=this.cy.pan();this.renderedPosition={x:pos.x*zoom+pan.x,y:pos.y*zoom+pan.y}}this.timeStamp=src&&src.timeStamp||Date.now()},preventDefault:function preventDefault(){this.isDefaultPrevented=returnTrue;var e=this.originalEvent;e&&e.preventDefault&&e.preventDefault()},stopPropagation:function stopPropagation(){this.isPropagationStopped=returnTrue;var e=this.originalEvent;e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function stopImmediatePropagation(){this.isImmediatePropagationStopped=returnTrue,this.stopPropagation()},isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse};var eventRegex=/^([^.]+)(\.(?:[^.]+))?$/,defaults$8={qualifierCompare:function qualifierCompare(q1,q2){return q1===q2},eventMatches:function eventMatches(){return!0},addEventFields:function addEventFields(){},callbackContext:function callbackContext(context){return context},beforeEmit:function beforeEmit(){},afterEmit:function afterEmit(){},bubble:function bubble(){return!1},parent:function parent(){return null},context:null},defaultsKeys=Object.keys(defaults$8),emptyOpts={};function Emitter(){for(var opts=arguments.length>0&&void 0!==arguments[0]?arguments[0]:emptyOpts,context=arguments.length>1?arguments[1]:void 0,i=0;i<defaultsKeys.length;i++){var key=defaultsKeys[i];this[key]=opts[key]||defaults$8[key]}this.context=context||this.context,this.listeners=[],this.emitting=0}var p=Emitter.prototype,forEachEvent=function forEachEvent(self,handler,events,qualifier,callback,conf,confOverrides){fn(qualifier)&&(callback=qualifier,qualifier=null),confOverrides&&(conf=null==conf?confOverrides:extend({},conf,confOverrides));for(var eventList=array(events)?events:events.split(/\s+/),i=0;i<eventList.length;i++){var evt=eventList[i];if(!emptyString(evt)){var match=evt.match(eventRegex);if(match)if(!1===handler(self,evt,match[1],match[2]?match[2]:null,qualifier,callback,conf))break}}},makeEventObj=function makeEventObj(self,obj){return self.addEventFields(self.context,obj),new Event(obj.type,obj)},forEachEventObj=function forEachEventObj(self,handler,events){if(function event(obj){return"event"===instanceStr(obj)}(events))handler(self,events);else if(plainObject(events))handler(self,makeEventObj(self,events));else for(var eventList=array(events)?events:events.split(/\s+/),i=0;i<eventList.length;i++){var evt=eventList[i];if(!emptyString(evt)){var match=evt.match(eventRegex);if(match){var type=match[1],namespace=match[2]?match[2]:null;handler(self,makeEventObj(self,{type:type,namespace:namespace,target:self.context}))}}}};p.on=p.addListener=function(events,qualifier,callback,conf,confOverrides){return forEachEvent(this,(function(self,event,type,namespace,qualifier,callback,conf){fn(callback)&&self.listeners.push({event:event,callback:callback,type:type,namespace:namespace,qualifier:qualifier,conf:conf})}),events,qualifier,callback,conf,confOverrides),this},p.one=function(events,qualifier,callback,conf){return this.on(events,qualifier,callback,conf,{one:!0})},p.removeListener=p.off=function(events,qualifier,callback,conf){var _this=this;0!==this.emitting&&(this.listeners=function copyArray(arr){return arr.slice()}(this.listeners));for(var listeners=this.listeners,_loop=function _loop(i){var listener=listeners[i];forEachEvent(_this,(function(self,event,type,namespace,qualifier,callback){if((listener.type===type||"*"===events)&&(!namespace&&".*"!==listener.namespace||listener.namespace===namespace)&&(!qualifier||self.qualifierCompare(listener.qualifier,qualifier))&&(!callback||listener.callback===callback))return listeners.splice(i,1),!1}),events,qualifier,callback,conf)},i=listeners.length-1;i>=0;i--)_loop(i);return this},p.removeAllListeners=function(){return this.removeListener("*")},p.emit=p.trigger=function(events,extraParams,manualCallback){var listeners=this.listeners,numListenersBeforeEmit=listeners.length;return this.emitting++,array(extraParams)||(extraParams=[extraParams]),forEachEventObj(this,(function(self,eventObj){null!=manualCallback&&(listeners=[{event:eventObj.event,type:eventObj.type,namespace:eventObj.namespace,callback:manualCallback}],numListenersBeforeEmit=listeners.length);for(var _loop2=function _loop2(i){var listener=listeners[i];if(listener.type===eventObj.type&&(!listener.namespace||listener.namespace===eventObj.namespace||".*"===listener.namespace)&&self.eventMatches(self.context,listener,eventObj)){var args=[eventObj];null!=extraParams&&function push(arr,otherArr){for(var i=0;i<otherArr.length;i++){var el=otherArr[i];arr.push(el)}}(args,extraParams),self.beforeEmit(self.context,listener,eventObj),listener.conf&&listener.conf.one&&(self.listeners=self.listeners.filter((function(l){return l!==listener})));var context=self.callbackContext(self.context,listener,eventObj),ret=listener.callback.apply(context,args);self.afterEmit(self.context,listener,eventObj),!1===ret&&(eventObj.stopPropagation(),eventObj.preventDefault())}},i=0;i<numListenersBeforeEmit;i++)_loop2(i);self.bubble(self.context)&&!eventObj.isPropagationStopped()&&self.parent(self.context).emit(eventObj,extraParams)}),events),this.emitting--,this};var emitterOptions={qualifierCompare:function qualifierCompare(selector1,selector2){return null==selector1||null==selector2?null==selector1&&null==selector2:selector1.sameText(selector2)},eventMatches:function eventMatches(ele,listener,eventObj){var selector=listener.qualifier;return null==selector||ele!==eventObj.target&&element(eventObj.target)&&selector.matches(eventObj.target)},addEventFields:function addEventFields(ele,evt){evt.cy=ele.cy(),evt.target=ele},callbackContext:function callbackContext(ele,listener,eventObj){return null!=listener.qualifier?eventObj.target:ele},beforeEmit:function beforeEmit(context,listener){listener.conf&&listener.conf.once&&listener.conf.onceCollection.removeListener(listener.event,listener.qualifier,listener.callback)},bubble:function bubble(){return!0},parent:function parent(ele){return ele.isChild()?ele.parent():ele.cy()}},argSelector=function argSelector(arg){return string(arg)?new Selector(arg):arg},elesfn$m={createEmitter:function createEmitter(){for(var i=0;i<this.length;i++){var ele=this[i],_p=ele._private;_p.emitter||(_p.emitter=new Emitter(emitterOptions,ele))}return this},emitter:function emitter(){return this._private.emitter},on:function on(events,selector,callback){for(var argSel=argSelector(selector),i=0;i<this.length;i++){this[i].emitter().on(events,argSel,callback)}return this},removeListener:function removeListener(events,selector,callback){for(var argSel=argSelector(selector),i=0;i<this.length;i++){this[i].emitter().removeListener(events,argSel,callback)}return this},removeAllListeners:function removeAllListeners(){for(var i=0;i<this.length;i++){this[i].emitter().removeAllListeners()}return this},one:function one(events,selector,callback){for(var argSel=argSelector(selector),i=0;i<this.length;i++){this[i].emitter().one(events,argSel,callback)}return this},once:function once(events,selector,callback){for(var argSel=argSelector(selector),i=0;i<this.length;i++){this[i].emitter().on(events,argSel,callback,{once:!0,onceCollection:this})}},emit:function emit(events,extraParams){for(var i=0;i<this.length;i++){this[i].emitter().emit(events,extraParams)}return this},emitAndNotify:function emitAndNotify(event,extraParams){if(0!==this.length)return this.cy().notify(event,this),this.emit(event,extraParams),this}};define$3.eventAliasesOn(elesfn$m);var elesfn$n={nodes:function nodes(selector){return this.filter((function(ele){return ele.isNode()})).filter(selector)},edges:function edges(selector){return this.filter((function(ele){return ele.isEdge()})).filter(selector)},byGroup:function byGroup(){for(var nodes=this.spawn(),edges=this.spawn(),i=0;i<this.length;i++){var ele=this[i];ele.isNode()?nodes.push(ele):edges.push(ele)}return{nodes:nodes,edges:edges}},filter:function filter(_filter,thisArg){if(void 0===_filter)return this;if(string(_filter)||elementOrCollection(_filter))return new Selector(_filter).filter(this);if(fn(_filter)){for(var filterEles=this.spawn(),i=0;i<this.length;i++){var ele=this[i];(thisArg?_filter.apply(thisArg,[ele,i,this]):_filter(ele,i,this))&&filterEles.push(ele)}return filterEles}return this.spawn()},not:function not(toRemove){if(toRemove){string(toRemove)&&(toRemove=this.filter(toRemove));for(var elements=this.spawn(),i=0;i<this.length;i++){var element=this[i];toRemove.has(element)||elements.push(element)}return elements}return this},absoluteComplement:function absoluteComplement(){return this.cy().mutableElements().not(this)},intersect:function intersect(other){if(string(other)){var selector=other;return this.filter(selector)}for(var elements=this.spawn(),col2=other,col1Smaller=this.length<other.length,colS=col1Smaller?this:col2,colL=col1Smaller?col2:this,i=0;i<colS.length;i++){var ele=colS[i];colL.has(ele)&&elements.push(ele)}return elements},xor:function xor(other){var cy=this._private.cy;string(other)&&(other=cy.$(other));var elements=this.spawn(),col2=other,add=function add(col,other){for(var i=0;i<col.length;i++){var ele=col[i],id=ele._private.data.id;other.hasElementWithId(id)||elements.push(ele)}};return add(this,col2),add(col2,this),elements},diff:function diff(other){var cy=this._private.cy;string(other)&&(other=cy.$(other));var left=this.spawn(),right=this.spawn(),both=this.spawn(),col2=other,add=function add(col,other,retEles){for(var i=0;i<col.length;i++){var ele=col[i],id=ele._private.data.id;other.hasElementWithId(id)?both.merge(ele):retEles.push(ele)}};return add(this,col2,left),add(col2,this,right),{left:left,right:right,both:both}},add:function add(toAdd){var cy=this._private.cy;if(!toAdd)return this;if(string(toAdd)){var selector=toAdd;toAdd=cy.mutableElements().filter(selector)}for(var elements=this.spawnSelf(),i=0;i<toAdd.length;i++){var ele=toAdd[i],add=!this.has(ele);add&&elements.push(ele)}return elements},merge:function merge(toAdd){var _p=this._private,cy=_p.cy;if(!toAdd)return this;if(toAdd&&string(toAdd)){var selector=toAdd;toAdd=cy.mutableElements().filter(selector)}for(var map=_p.map,i=0;i<toAdd.length;i++){var toAddEle=toAdd[i],id=toAddEle._private.data.id;if(!map.has(id)){var index=this.length++;this[index]=toAddEle,map.set(id,{ele:toAddEle,index:index})}}return this},unmergeAt:function unmergeAt(i){var id=this[i].id(),map=this._private.map;this[i]=void 0,map.delete(id);var unmergedLastEle=i===this.length-1;if(this.length>1&&!unmergedLastEle){var lastEleI=this.length-1,lastEle=this[lastEleI],lastEleId=lastEle._private.data.id;this[lastEleI]=void 0,this[i]=lastEle,map.set(lastEleId,{ele:lastEle,index:i})}return this.length--,this},unmergeOne:function unmergeOne(ele){ele=ele[0];var _p=this._private,id=ele._private.data.id,entry=_p.map.get(id);if(!entry)return this;var i=entry.index;return this.unmergeAt(i),this},unmerge:function unmerge(toRemove){var cy=this._private.cy;if(!toRemove)return this;if(toRemove&&string(toRemove)){var selector=toRemove;toRemove=cy.mutableElements().filter(selector)}for(var i=0;i<toRemove.length;i++)this.unmergeOne(toRemove[i]);return this},unmergeBy:function unmergeBy(toRmFn){for(var i=this.length-1;i>=0;i--){toRmFn(this[i])&&this.unmergeAt(i)}return this},map:function map(mapFn,thisArg){for(var arr=[],i=0;i<this.length;i++){var ele=this[i],ret=thisArg?mapFn.apply(thisArg,[ele,i,this]):mapFn(ele,i,this);arr.push(ret)}return arr},reduce:function reduce(fn,initialValue){for(var val=initialValue,i=0;i<this.length;i++)val=fn(val,this[i],i,this);return val},max:function max(valFn,thisArg){for(var maxEle,max=-1/0,i=0;i<this.length;i++){var ele=this[i],val=thisArg?valFn.apply(thisArg,[ele,i,this]):valFn(ele,i,this);val>max&&(max=val,maxEle=ele)}return{value:max,ele:maxEle}},min:function min(valFn,thisArg){for(var minEle,min=1/0,i=0;i<this.length;i++){var ele=this[i],val=thisArg?valFn.apply(thisArg,[ele,i,this]):valFn(ele,i,this);val<min&&(min=val,minEle=ele)}return{value:min,ele:minEle}}},fn$5=elesfn$n;fn$5.u=fn$5["|"]=fn$5["+"]=fn$5.union=fn$5.or=fn$5.add,fn$5["\\"]=fn$5["!"]=fn$5["-"]=fn$5.difference=fn$5.relativeComplement=fn$5.subtract=fn$5.not,fn$5.n=fn$5["&"]=fn$5["."]=fn$5.and=fn$5.intersection=fn$5.intersect,fn$5["^"]=fn$5["(+)"]=fn$5["(-)"]=fn$5.symmetricDifference=fn$5.symdiff=fn$5.xor,fn$5.fnFilter=fn$5.filterFn=fn$5.stdFilter=fn$5.filter,fn$5.complement=fn$5.abscomp=fn$5.absoluteComplement;var zIndexSort=function zIndexSort(a,b){var hasCompoundNodes=a.cy().hasCompoundNodes();function getDepth(ele){var style=ele.pstyle("z-compound-depth");return"auto"===style.value?hasCompoundNodes?ele.zDepth():0:"bottom"===style.value?-1:"top"===style.value?MAX_INT:0}var depthDiff=getDepth(a)-getDepth(b);if(0!==depthDiff)return depthDiff;function getEleDepth(ele){return"auto"===ele.pstyle("z-index-compare").value&&ele.isNode()?1:0}var eleDiff=getEleDepth(a)-getEleDepth(b);if(0!==eleDiff)return eleDiff;var zDiff=a.pstyle("z-index").value-b.pstyle("z-index").value;return 0!==zDiff?zDiff:a.poolIndex()-b.poolIndex()},elesfn$p={forEach:function forEach(fn$1,thisArg){if(fn(fn$1))for(var N=this.length,i=0;i<N;i++){var ele=this[i];if(!1===(thisArg?fn$1.apply(thisArg,[ele,i,this]):fn$1(ele,i,this)))break}return this},toArray:function toArray(){for(var array=[],i=0;i<this.length;i++)array.push(this[i]);return array},slice:function slice(start,end){var array=[],thisSize=this.length;null==end&&(end=thisSize),null==start&&(start=0),start<0&&(start=thisSize+start),end<0&&(end=thisSize+end);for(var i=start;i>=0&&i<end&&i<thisSize;i++)array.push(this[i]);return this.spawn(array)},size:function size(){return this.length},eq:function eq(i){return this[i]||this.spawn()},first:function first(){return this[0]||this.spawn()},last:function last(){return this[this.length-1]||this.spawn()},empty:function empty(){return 0===this.length},nonempty:function nonempty(){return!this.empty()},sort:function sort(sortFn){if(!fn(sortFn))return this;var sorted=this.toArray().sort(sortFn);return this.spawn(sorted)},sortByZIndex:function sortByZIndex(){return this.sort(zIndexSort)},zDepth:function zDepth(){var ele=this[0];if(ele){var _p=ele._private;if("nodes"===_p.group){var depth=_p.data.parent?ele.parents().size():0;return ele.isParent()?depth:MAX_INT-1}var src=_p.source,tgt=_p.target,srcDepth=src.zDepth(),tgtDepth=tgt.zDepth();return Math.max(srcDepth,tgtDepth,0)}}};elesfn$p.each=elesfn$p.forEach;!function defineSymbolIterator(){"undefined"!=("undefined"==typeof Symbol?"undefined":_typeof(Symbol))&&"undefined"!=_typeof(Symbol.iterator)&&(elesfn$p[Symbol.iterator]=function(){var _this=this,entry={value:void 0,done:!1},i=0,length=this.length;return _defineProperty({next:function next(){return i<length?entry.value=_this[i++]:(entry.value=void 0,entry.done=!0),entry}},Symbol.iterator,(function(){return this}))})}();var getLayoutDimensionOptions=defaults({nodeDimensionsIncludeLabels:!1}),elesfn$q={layoutDimensions:function layoutDimensions(options){var dims;if(options=getLayoutDimensionOptions(options),this.takesUpSpace())if(options.nodeDimensionsIncludeLabels){var bbDim=this.boundingBox();dims={w:bbDim.w,h:bbDim.h}}else dims={w:this.outerWidth(),h:this.outerHeight()};else dims={w:0,h:0};return 0!==dims.w&&0!==dims.h||(dims.w=dims.h=1),dims},layoutPositions:function layoutPositions(layout,options,fn){var nodes=this.nodes().filter((function(n){return!n.isParent()})),cy=this.cy(),layoutEles=options.eles,getMemoizeKey=function getMemoizeKey(node){return node.id()},fnMem=memoize(fn,getMemoizeKey);layout.emit({type:"layoutstart",layout:layout}),layout.animations=[];var useSpacingFactor=options.spacingFactor&&1!==options.spacingFactor,bb=function spacingBb(){if(!useSpacingFactor)return null;for(var bb=makeBoundingBox(),i=0;i<nodes.length;i++){var node=nodes[i],pos=fnMem(node,i);expandBoundingBoxByPoint(bb,pos.x,pos.y)}return bb}(),getFinalPos=memoize((function(node,i){var newPos=fnMem(node,i);useSpacingFactor&&(newPos=function calculateSpacing(spacing,nodesBb,pos){var center_x=nodesBb.x1+nodesBb.w/2,center_y=nodesBb.y1+nodesBb.h/2;return{x:center_x+(pos.x-center_x)*spacing,y:center_y+(pos.y-center_y)*spacing}}(Math.abs(options.spacingFactor),bb,newPos));return null!=options.transform&&(newPos=options.transform(node,newPos)),newPos}),getMemoizeKey);if(options.animate){for(var i=0;i<nodes.length;i++){var node=nodes[i],newPos=getFinalPos(node,i);if(null==options.animateFilter||options.animateFilter(node,i)){var ani=node.animation({position:newPos,duration:options.animationDuration,easing:options.animationEasing});layout.animations.push(ani)}else node.position(newPos)}if(options.fit){var fitAni=cy.animation({fit:{boundingBox:layoutEles.boundingBoxAt(getFinalPos),padding:options.padding},duration:options.animationDuration,easing:options.animationEasing});layout.animations.push(fitAni)}else if(void 0!==options.zoom&&void 0!==options.pan){var zoomPanAni=cy.animation({zoom:options.zoom,pan:options.pan,duration:options.animationDuration,easing:options.animationEasing});layout.animations.push(zoomPanAni)}layout.animations.forEach((function(ani){return ani.play()})),layout.one("layoutready",options.ready),layout.emit({type:"layoutready",layout:layout}),Promise$1.all(layout.animations.map((function(ani){return ani.promise()}))).then((function(){layout.one("layoutstop",options.stop),layout.emit({type:"layoutstop",layout:layout})}))}else nodes.positions(getFinalPos),options.fit&&cy.fit(options.eles,options.padding),null!=options.zoom&&cy.zoom(options.zoom),options.pan&&cy.pan(options.pan),layout.one("layoutready",options.ready),layout.emit({type:"layoutready",layout:layout}),layout.one("layoutstop",options.stop),layout.emit({type:"layoutstop",layout:layout});return this},layout:function layout(options){return this.cy().makeLayout(extend({},options,{eles:this}))}};function styleCache(key,fn,ele){var val,_p=ele._private,cache=_p.styleCache=_p.styleCache||[];return null!=(val=cache[key])?val:val=cache[key]=fn(ele)}function cacheStyleFunction(key,fn){return key=hashString(key),function cachedStyleFunction(ele){return styleCache(key,fn,ele)}}function cachePrototypeStyleFunction(key,fn){key=hashString(key);var selfFn=function selfFn(ele){return fn.call(ele)};return function cachedPrototypeStyleFunction(){var ele=this[0];if(ele)return styleCache(key,selfFn,ele)}}elesfn$q.createLayout=elesfn$q.makeLayout=elesfn$q.layout;var elesfn$r={recalculateRenderedStyle:function recalculateRenderedStyle(useCache){var cy=this.cy(),renderer=cy.renderer(),styleEnabled=cy.styleEnabled();return renderer&&styleEnabled&&renderer.recalculateRenderedStyle(this,useCache),this},dirtyStyleCache:function dirtyStyleCache(){var eles,cy=this.cy(),dirty=function dirty(ele){return ele._private.styleCache=null};cy.hasCompoundNodes()?((eles=this.spawnSelf().merge(this.descendants()).merge(this.parents())).merge(eles.connectedEdges()),eles.forEach(dirty)):this.forEach((function(ele){dirty(ele),ele.connectedEdges().forEach(dirty)}));return this},updateStyle:function updateStyle(notifyRenderer){var cy=this._private.cy;if(!cy.styleEnabled())return this;if(cy.batching())return cy._private.batchStyleEles.merge(this),this;var updatedEles=this;notifyRenderer=!(!notifyRenderer&&void 0!==notifyRenderer),cy.hasCompoundNodes()&&(updatedEles=this.spawnSelf().merge(this.descendants()).merge(this.parents()));var changedEles=updatedEles;return notifyRenderer?changedEles.emitAndNotify("style"):changedEles.emit("style"),updatedEles.forEach((function(ele){return ele._private.styleDirty=!0})),this},cleanStyle:function cleanStyle(){var cy=this.cy();if(cy.styleEnabled())for(var i=0;i<this.length;i++){var ele=this[i];ele._private.styleDirty&&(ele._private.styleDirty=!1,cy.style().apply(ele))}},parsedStyle:function parsedStyle(property){var includeNonDefault=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],ele=this[0],cy=ele.cy();if(cy.styleEnabled()&&ele){this.cleanStyle();var overriddenStyle=ele._private.style[property];return null!=overriddenStyle?overriddenStyle:includeNonDefault?cy.style().getDefaultProperty(property):null}},numericStyle:function numericStyle(property){var ele=this[0];if(ele.cy().styleEnabled()&&ele){var pstyle=ele.pstyle(property);return void 0!==pstyle.pfValue?pstyle.pfValue:pstyle.value}},numericStyleUnits:function numericStyleUnits(property){var ele=this[0];if(ele.cy().styleEnabled())return ele?ele.pstyle(property).units:void 0},renderedStyle:function renderedStyle(property){var cy=this.cy();if(!cy.styleEnabled())return this;var ele=this[0];return ele?cy.style().getRenderedStyle(ele,property):void 0},style:function style(name,value){var cy=this.cy();if(!cy.styleEnabled())return this;var style=cy.style();if(plainObject(name)){var props=name;style.applyBypass(this,props,!1),this.emitAndNotify("style")}else if(string(name)){if(void 0===value){var ele=this[0];return ele?style.getStylePropertyValue(ele,name):void 0}style.applyBypass(this,name,value,!1),this.emitAndNotify("style")}else if(void 0===name){var _ele=this[0];return _ele?style.getRawStyle(_ele):void 0}return this},removeStyle:function removeStyle(names){var cy=this.cy();if(!cy.styleEnabled())return this;var style=cy.style();if(void 0===names)for(var i=0;i<this.length;i++){var ele=this[i];style.removeAllBypasses(ele,!1)}else{names=names.split(/\s+/);for(var _i=0;_i<this.length;_i++){var _ele2=this[_i];style.removeBypasses(_ele2,names,!1)}}return this.emitAndNotify("style"),this},show:function show(){return this.css("display","element"),this},hide:function hide(){return this.css("display","none"),this},effectiveOpacity:function effectiveOpacity(){var cy=this.cy();if(!cy.styleEnabled())return 1;var hasCompoundNodes=cy.hasCompoundNodes(),ele=this[0];if(ele){var _p=ele._private,parentOpacity=ele.pstyle("opacity").value;if(!hasCompoundNodes)return parentOpacity;var parents=_p.data.parent?ele.parents():null;if(parents)for(var i=0;i<parents.length;i++){parentOpacity*=parents[i].pstyle("opacity").value}return parentOpacity}},transparent:function transparent(){if(!this.cy().styleEnabled())return!1;var ele=this[0],hasCompoundNodes=ele.cy().hasCompoundNodes();return ele?hasCompoundNodes?0===ele.effectiveOpacity():0===ele.pstyle("opacity").value:void 0},backgrounding:function backgrounding(){return!!this.cy().styleEnabled()&&!!this[0]._private.backgrounding}};function checkCompound(ele,parentOk){var parents=ele._private.data.parent?ele.parents():null;if(parents)for(var i=0;i<parents.length;i++){if(!parentOk(parents[i]))return!1}return!0}function defineDerivedStateFunction(specs){var ok=specs.ok,edgeOkViaNode=specs.edgeOkViaNode||specs.ok,parentOk=specs.parentOk||specs.ok;return function(){var cy=this.cy();if(!cy.styleEnabled())return!0;var ele=this[0],hasCompoundNodes=cy.hasCompoundNodes();if(ele){var _p=ele._private;if(!ok(ele))return!1;if(ele.isNode())return!hasCompoundNodes||checkCompound(ele,parentOk);var src=_p.source,tgt=_p.target;return edgeOkViaNode(src)&&(!hasCompoundNodes||checkCompound(src,edgeOkViaNode))&&(src===tgt||edgeOkViaNode(tgt)&&(!hasCompoundNodes||checkCompound(tgt,edgeOkViaNode)))}}}var eleTakesUpSpace=cacheStyleFunction("eleTakesUpSpace",(function(ele){return"element"===ele.pstyle("display").value&&0!==ele.width()&&(!ele.isNode()||0!==ele.height())}));elesfn$r.takesUpSpace=cachePrototypeStyleFunction("takesUpSpace",defineDerivedStateFunction({ok:eleTakesUpSpace}));var eleInteractive=cacheStyleFunction("eleInteractive",(function(ele){return"yes"===ele.pstyle("events").value&&"visible"===ele.pstyle("visibility").value&&eleTakesUpSpace(ele)})),parentInteractive=cacheStyleFunction("parentInteractive",(function(parent){return"visible"===parent.pstyle("visibility").value&&eleTakesUpSpace(parent)}));elesfn$r.interactive=cachePrototypeStyleFunction("interactive",defineDerivedStateFunction({ok:eleInteractive,parentOk:parentInteractive,edgeOkViaNode:eleTakesUpSpace})),elesfn$r.noninteractive=function(){var ele=this[0];if(ele)return!ele.interactive()};var eleVisible=cacheStyleFunction("eleVisible",(function(ele){return"visible"===ele.pstyle("visibility").value&&0!==ele.pstyle("opacity").pfValue&&eleTakesUpSpace(ele)})),edgeVisibleViaNode=eleTakesUpSpace;elesfn$r.visible=cachePrototypeStyleFunction("visible",defineDerivedStateFunction({ok:eleVisible,edgeOkViaNode:edgeVisibleViaNode})),elesfn$r.hidden=function(){var ele=this[0];if(ele)return!ele.visible()},elesfn$r.isBundledBezier=cachePrototypeStyleFunction("isBundledBezier",(function(){return!!this.cy().styleEnabled()&&(!this.removed()&&"bezier"===this.pstyle("curve-style").value&&this.takesUpSpace())})),elesfn$r.bypass=elesfn$r.css=elesfn$r.style,elesfn$r.renderedCss=elesfn$r.renderedStyle,elesfn$r.removeBypass=elesfn$r.removeCss=elesfn$r.removeStyle,elesfn$r.pstyle=elesfn$r.parsedStyle;var elesfn$s={};function defineSwitchFunction(params){return function(){var args=arguments,changedEles=[];if(2===args.length){var data=args[0],handler=args[1];this.on(params.event,data,handler)}else if(1===args.length&&fn(args[0])){var _handler=args[0];this.on(params.event,_handler)}else if(0===args.length||1===args.length&&array(args[0])){for(var addlEvents=1===args.length?args[0]:null,i=0;i<this.length;i++){var ele=this[i],able=!params.ableField||ele._private[params.ableField],changed=ele._private[params.field]!=params.value;if(params.overrideAble){var overrideAble=params.overrideAble(ele);if(void 0!==overrideAble&&(able=overrideAble,!overrideAble))return this}able&&(ele._private[params.field]=params.value,changed&&changedEles.push(ele))}var changedColl=this.spawn(changedEles);changedColl.updateStyle(),changedColl.emit(params.event),addlEvents&&changedColl.emit(addlEvents)}return this}}function defineSwitchSet(params){elesfn$s[params.field]=function(){var ele=this[0];if(ele){if(params.overrideField){var val=params.overrideField(ele);if(void 0!==val)return val}return ele._private[params.field]}},elesfn$s[params.on]=defineSwitchFunction({event:params.on,field:params.field,ableField:params.ableField,overrideAble:params.overrideAble,value:!0}),elesfn$s[params.off]=defineSwitchFunction({event:params.off,field:params.field,ableField:params.ableField,overrideAble:params.overrideAble,value:!1})}defineSwitchSet({field:"locked",overrideField:function overrideField(ele){return!!ele.cy().autolock()||void 0},on:"lock",off:"unlock"}),defineSwitchSet({field:"grabbable",overrideField:function overrideField(ele){return!ele.cy().autoungrabify()&&!ele.pannable()&&void 0},on:"grabify",off:"ungrabify"}),defineSwitchSet({field:"selected",ableField:"selectable",overrideAble:function overrideAble(ele){return!ele.cy().autounselectify()&&void 0},on:"select",off:"unselect"}),defineSwitchSet({field:"selectable",overrideField:function overrideField(ele){return!ele.cy().autounselectify()&&void 0},on:"selectify",off:"unselectify"}),elesfn$s.deselect=elesfn$s.unselect,elesfn$s.grabbed=function(){var ele=this[0];if(ele)return ele._private.grabbed},defineSwitchSet({field:"active",on:"activate",off:"unactivate"}),defineSwitchSet({field:"pannable",on:"panify",off:"unpanify"}),elesfn$s.inactive=function(){var ele=this[0];if(ele)return!ele._private.active};var elesfn$t={},defineDagExtremity=function defineDagExtremity(params){return function dagExtremityImpl(selector){for(var ret=[],i=0;i<this.length;i++){var ele=this[i];if(ele.isNode()){for(var disqualified=!1,edges=ele.connectedEdges(),j=0;j<edges.length;j++){var edge=edges[j],src=edge.source(),tgt=edge.target();if(params.noIncomingEdges&&tgt===ele&&src!==ele||params.noOutgoingEdges&&src===ele&&tgt!==ele){disqualified=!0;break}}disqualified||ret.push(ele)}}return this.spawn(ret,!0).filter(selector)}},defineDagOneHop=function defineDagOneHop(params){return function(selector){for(var oEles=[],i=0;i<this.length;i++){var ele=this[i];if(ele.isNode())for(var edges=ele.connectedEdges(),j=0;j<edges.length;j++){var edge=edges[j],src=edge.source(),tgt=edge.target();params.outgoing&&src===ele?(oEles.push(edge),oEles.push(tgt)):params.incoming&&tgt===ele&&(oEles.push(edge),oEles.push(src))}}return this.spawn(oEles,!0).filter(selector)}},defineDagAllHops=function defineDagAllHops(params){return function(selector){for(var eles=this,sEles=[],sElesIds={};;){var next=params.outgoing?eles.outgoers():eles.incomers();if(0===next.length)break;for(var newNext=!1,i=0;i<next.length;i++){var n=next[i],nid=n.id();sElesIds[nid]||(sElesIds[nid]=!0,sEles.push(n),newNext=!0)}if(!newNext)break;eles=next}return this.spawn(sEles,!0).filter(selector)}};function defineSourceFunction(params){return function sourceImpl(selector){for(var sources=[],i=0;i<this.length;i++){var src=this[i]._private[params.attr];src&&sources.push(src)}return this.spawn(sources,!0).filter(selector)}}function defineEdgesWithFunction(params){return function edgesWithImpl(otherNodes){var elements=[],cy=this._private.cy,p=params||{};string(otherNodes)&&(otherNodes=cy.$(otherNodes));for(var h=0;h<otherNodes.length;h++)for(var edges=otherNodes[h]._private.edges,i=0;i<edges.length;i++){var edge=edges[i],edgeData=edge._private.data,thisToOther=this.hasElementWithId(edgeData.source)&&otherNodes.hasElementWithId(edgeData.target),otherToThis=otherNodes.hasElementWithId(edgeData.source)&&this.hasElementWithId(edgeData.target);if(thisToOther||otherToThis){if(p.thisIsSrc||p.thisIsTgt){if(p.thisIsSrc&&!thisToOther)continue;if(p.thisIsTgt&&!otherToThis)continue}elements.push(edge)}}return this.spawn(elements,!0)}}function defineParallelEdgesFunction(params){return params=extend({},{codirected:!1},params),function parallelEdgesImpl(selector){for(var elements=[],edges=this.edges(),p=params,i=0;i<edges.length;i++)for(var edge1_p=edges[i]._private,src1=edge1_p.source,srcid1=src1._private.data.id,tgtid1=edge1_p.data.target,srcEdges1=src1._private.edges,j=0;j<srcEdges1.length;j++){var edge2=srcEdges1[j],edge2data=edge2._private.data,tgtid2=edge2data.target,srcid2=edge2data.source,codirected=tgtid2===tgtid1&&srcid2===srcid1,oppdirected=srcid1===tgtid2&&tgtid1===srcid2;(p.codirected&&codirected||!p.codirected&&(codirected||oppdirected))&&elements.push(edge2)}return this.spawn(elements,!0).filter(selector)}}elesfn$t.clearTraversalCache=function(){for(var i=0;i<this.length;i++)this[i]._private.traversalCache=null},extend(elesfn$t,{roots:defineDagExtremity({noIncomingEdges:!0}),leaves:defineDagExtremity({noOutgoingEdges:!0}),outgoers:cache(defineDagOneHop({outgoing:!0}),"outgoers"),successors:defineDagAllHops({outgoing:!0}),incomers:cache(defineDagOneHop({incoming:!0}),"incomers"),predecessors:defineDagAllHops({incoming:!0})}),extend(elesfn$t,{neighborhood:cache((function(selector){for(var elements=[],nodes=this.nodes(),i=0;i<nodes.length;i++)for(var node=nodes[i],connectedEdges=node.connectedEdges(),j=0;j<connectedEdges.length;j++){var edge=connectedEdges[j],src=edge.source(),tgt=edge.target(),otherNode=node===src?tgt:src;otherNode.length>0&&elements.push(otherNode[0]),elements.push(edge[0])}return this.spawn(elements,!0).filter(selector)}),"neighborhood"),closedNeighborhood:function closedNeighborhood(selector){return this.neighborhood().add(this).filter(selector)},openNeighborhood:function openNeighborhood(selector){return this.neighborhood(selector)}}),elesfn$t.neighbourhood=elesfn$t.neighborhood,elesfn$t.closedNeighbourhood=elesfn$t.closedNeighborhood,elesfn$t.openNeighbourhood=elesfn$t.openNeighborhood,extend(elesfn$t,{source:cache((function sourceImpl(selector){var src,ele=this[0];return ele&&(src=ele._private.source||ele.cy().collection()),src&&selector?src.filter(selector):src}),"source"),target:cache((function targetImpl(selector){var tgt,ele=this[0];return ele&&(tgt=ele._private.target||ele.cy().collection()),tgt&&selector?tgt.filter(selector):tgt}),"target"),sources:defineSourceFunction({attr:"source"}),targets:defineSourceFunction({attr:"target"})}),extend(elesfn$t,{edgesWith:cache(defineEdgesWithFunction(),"edgesWith"),edgesTo:cache(defineEdgesWithFunction({thisIsSrc:!0}),"edgesTo")}),extend(elesfn$t,{connectedEdges:cache((function(selector){for(var retEles=[],i=0;i<this.length;i++){var node=this[i];if(node.isNode())for(var edges=node._private.edges,j=0;j<edges.length;j++){var edge=edges[j];retEles.push(edge)}}return this.spawn(retEles,!0).filter(selector)}),"connectedEdges"),connectedNodes:cache((function(selector){for(var retEles=[],i=0;i<this.length;i++){var edge=this[i];edge.isEdge()&&(retEles.push(edge.source()[0]),retEles.push(edge.target()[0]))}return this.spawn(retEles,!0).filter(selector)}),"connectedNodes"),parallelEdges:cache(defineParallelEdgesFunction(),"parallelEdges"),codirectedEdges:cache(defineParallelEdgesFunction({codirected:!0}),"codirectedEdges")}),extend(elesfn$t,{components:function components(root){var self=this,cy=self.cy(),visited=cy.collection(),unvisited=null==root?self.nodes():root.nodes(),components=[];null!=root&&unvisited.empty()&&(unvisited=root.sources());var visitInComponent=function visitInComponent(node,component){visited.merge(node),unvisited.unmerge(node),component.merge(node)};if(unvisited.empty())return self.spawn();var _loop=function _loop(){var cmpt=cy.collection();components.push(cmpt);var root=unvisited[0];visitInComponent(root,cmpt),self.bfs({directed:!1,roots:root,visit:function visit(v){return visitInComponent(v,cmpt)}}),cmpt.forEach((function(node){node.connectedEdges().forEach((function(e){self.has(e)&&cmpt.has(e.source())&&cmpt.has(e.target())&&cmpt.merge(e)}))}))};do{_loop()}while(unvisited.length>0);return components},component:function component(){var ele=this[0];return ele.cy().mutableElements().components(ele)[0]}}),elesfn$t.componentsOf=elesfn$t.components;var Collection=function Collection(cy,elements){var unique=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(void 0!==cy){var map=new Map$1,createdElements=!1;if(elements){if(elements.length>0&&plainObject(elements[0])&&!element(elements[0])){createdElements=!0;for(var eles=[],elesIds=new Set$1,i=0,l=elements.length;i<l;i++){var json=elements[i];null==json.data&&(json.data={});var _data=json.data;if(null==_data.id)_data.id=uuid();else if(cy.hasElementWithId(_data.id)||elesIds.has(_data.id))continue;var ele=new Element$1(cy,json,!1);eles.push(ele),elesIds.add(_data.id)}elements=eles}}else elements=[];this.length=0;for(var _i=0,_l=elements.length;_i<_l;_i++){var element$1=elements[_i][0];if(null!=element$1){var id=element$1._private.data.id;unique&&map.has(id)||(unique&&map.set(id,{index:this.length,ele:element$1}),this[this.length]=element$1,this.length++)}}this._private={eles:this,cy:cy,get map(){return null==this.lazyMap&&this.rebuildMap(),this.lazyMap},set map(m){this.lazyMap=m},rebuildMap:function rebuildMap(){for(var m=this.lazyMap=new Map$1,eles=this.eles,_i2=0;_i2<eles.length;_i2++){var _ele=eles[_i2];m.set(_ele.id(),{index:_i2,ele:_ele})}}},unique&&(this._private.map=map),createdElements&&this.restore()}else error("A collection must have a reference to the core")},elesfn$u=Element$1.prototype=Collection.prototype=Object.create(Array.prototype);elesfn$u.instanceString=function(){return"collection"},elesfn$u.spawn=function(eles,unique){return new Collection(this.cy(),eles,unique)},elesfn$u.spawnSelf=function(){return this.spawn(this)},elesfn$u.cy=function(){return this._private.cy},elesfn$u.renderer=function(){return this._private.cy.renderer()},elesfn$u.element=function(){return this[0]},elesfn$u.collection=function(){return collection(this)?this:new Collection(this._private.cy,[this])},elesfn$u.unique=function(){return new Collection(this._private.cy,this,!0)},elesfn$u.hasElementWithId=function(id){return id=""+id,this._private.map.has(id)},elesfn$u.getElementById=function(id){id=""+id;var cy=this._private.cy,entry=this._private.map.get(id);return entry?entry.ele:new Collection(cy)},elesfn$u.$id=elesfn$u.getElementById,elesfn$u.poolIndex=function(){var eles=this._private.cy._private.elements,id=this[0]._private.data.id;return eles._private.map.get(id).index},elesfn$u.indexOf=function(ele){var id=ele[0]._private.data.id;return this._private.map.get(id).index},elesfn$u.indexOfId=function(id){return id=""+id,this._private.map.get(id).index},elesfn$u.json=function(obj){var ele=this.element(),cy=this.cy();if(null==ele&&obj)return this;if(null!=ele){var p=ele._private;if(plainObject(obj)){if(cy.startBatch(),obj.data){ele.data(obj.data);var _data2=p.data;if(ele.isEdge()){var move=!1,spec={},src=obj.data.source,tgt=obj.data.target;null!=src&&src!=_data2.source&&(spec.source=""+src,move=!0),null!=tgt&&tgt!=_data2.target&&(spec.target=""+tgt,move=!0),move&&(ele=ele.move(spec))}else{var newParentValSpecd="parent"in obj.data,parent=obj.data.parent;!newParentValSpecd||null==parent&&null==_data2.parent||parent==_data2.parent||(void 0===parent&&(parent=null),null!=parent&&(parent=""+parent),ele=ele.move({parent:parent}))}}obj.position&&ele.position(obj.position);var checkSwitch=function checkSwitch(k,trueFnName,falseFnName){var obj_k=obj[k];null!=obj_k&&obj_k!==p[k]&&(obj_k?ele[trueFnName]():ele[falseFnName]())};return checkSwitch("removed","remove","restore"),checkSwitch("selected","select","unselect"),checkSwitch("selectable","selectify","unselectify"),checkSwitch("locked","lock","unlock"),checkSwitch("grabbable","grabify","ungrabify"),checkSwitch("pannable","panify","unpanify"),null!=obj.classes&&ele.classes(obj.classes),cy.endBatch(),this}if(void 0===obj){var json={data:copy(p.data),position:copy(p.position),group:p.group,removed:p.removed,selected:p.selected,selectable:p.selectable,locked:p.locked,grabbable:p.grabbable,pannable:p.pannable,classes:null};json.classes="";var i=0;return p.classes.forEach((function(cls){return json.classes+=0==i++?cls:" "+cls})),json}}},elesfn$u.jsons=function(){for(var jsons=[],i=0;i<this.length;i++){var json=this[i].json();jsons.push(json)}return jsons},elesfn$u.clone=function(){for(var cy=this.cy(),elesArr=[],i=0;i<this.length;i++){var json=this[i].json(),clone=new Element$1(cy,json,!1);elesArr.push(clone)}return new Collection(cy,elesArr)},elesfn$u.copy=elesfn$u.clone,elesfn$u.restore=function(){for(var elements,i,notifyRenderer=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],addToPool=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],self=this,cy=self.cy(),cy_p=cy._private,nodes=[],edges=[],_i3=0,l=self.length;_i3<l;_i3++){var ele=self[_i3];addToPool&&!ele.removed()||(ele.isNode()?nodes.push(ele):edges.push(ele))}elements=nodes.concat(edges);var removeFromElements=function removeFromElements(){elements.splice(i,1),i--};for(i=0;i<elements.length;i++){var _ele2=elements[i],_private=_ele2._private,_data3=_private.data;if(_ele2.clearTraversalCache(),addToPool||_private.removed)if(void 0===_data3.id)_data3.id=uuid();else if(number(_data3.id))_data3.id=""+_data3.id;else{if(emptyString(_data3.id)||!string(_data3.id)){error("Can not create element with invalid string ID `"+_data3.id+"`"),removeFromElements();continue}if(cy.hasElementWithId(_data3.id)){error("Can not create second element with ID `"+_data3.id+"`"),removeFromElements();continue}}else;var id=_data3.id;if(_ele2.isNode()){var pos=_private.position;null==pos.x&&(pos.x=0),null==pos.y&&(pos.y=0)}if(_ele2.isEdge()){for(var edge=_ele2,fields=["source","target"],fieldsLength=fields.length,badSourceOrTarget=!1,j=0;j<fieldsLength;j++){var field=fields[j],val=_data3[field];number(val)&&(val=_data3[field]=""+_data3[field]),null==val||""===val?(error("Can not create edge `"+id+"` with unspecified "+field),badSourceOrTarget=!0):cy.hasElementWithId(val)||(error("Can not create edge `"+id+"` with nonexistant "+field+" `"+val+"`"),badSourceOrTarget=!0)}if(badSourceOrTarget){removeFromElements();continue}var src=cy.getElementById(_data3.source),tgt=cy.getElementById(_data3.target);src.same(tgt)?src._private.edges.push(edge):(src._private.edges.push(edge),tgt._private.edges.push(edge)),edge._private.source=src,edge._private.target=tgt}_private.map=new Map$1,_private.map.set(id,{ele:_ele2,index:0}),_private.removed=!1,addToPool&&cy.addToPool(_ele2)}for(var _i4=0;_i4<nodes.length;_i4++){var node=nodes[_i4],_data4=node._private.data;number(_data4.parent)&&(_data4.parent=""+_data4.parent);var parentId=_data4.parent,specifiedParent=null!=parentId;if(specifiedParent){var parent=cy.getElementById(parentId);if(parent.empty())_data4.parent=void 0;else{for(var selfAsParent=!1,ancestor=parent;!ancestor.empty();){if(node.same(ancestor)){selfAsParent=!0,_data4.parent=void 0;break}ancestor=ancestor.parent()}selfAsParent||(parent[0]._private.children.push(node),node._private.parent=parent[0],cy_p.hasCompoundNodes=!0)}}}if(elements.length>0){for(var restored=elements.length===self.length?self:new Collection(cy,elements),_i5=0;_i5<restored.length;_i5++){var _ele3=restored[_i5];_ele3.isNode()||(_ele3.parallelEdges().clearTraversalCache(),_ele3.source().clearTraversalCache(),_ele3.target().clearTraversalCache())}(cy_p.hasCompoundNodes?cy.collection().merge(restored).merge(restored.connectedNodes()).merge(restored.parent()):restored).dirtyCompoundBoundsCache().dirtyBoundingBoxCache().updateStyle(notifyRenderer),notifyRenderer?restored.emitAndNotify("add"):addToPool&&restored.emit("add")}return self},elesfn$u.removed=function(){var ele=this[0];return ele&&ele._private.removed},elesfn$u.inside=function(){var ele=this[0];return ele&&!ele._private.removed},elesfn$u.remove=function(){var notifyRenderer=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],removeFromPool=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],self=this,elesToRemove=[],elesToRemoveIds={},cy=self._private.cy;function addConnectedEdges(node){for(var edges=node._private.edges,i=0;i<edges.length;i++)add(edges[i])}function addChildren(node){for(var children=node._private.children,i=0;i<children.length;i++)add(children[i])}function add(ele){var alreadyAdded=elesToRemoveIds[ele.id()];removeFromPool&&ele.removed()||alreadyAdded||(elesToRemoveIds[ele.id()]=!0,ele.isNode()?(elesToRemove.push(ele),addConnectedEdges(ele),addChildren(ele)):elesToRemove.unshift(ele))}for(var i=0,l=self.length;i<l;i++){var ele=self[i];add(ele)}function removeEdgeRef(node,edge){var connectedEdges=node._private.edges;removeFromArray(connectedEdges,edge),node.clearTraversalCache()}function removeParallelRef(pllEdge){pllEdge.clearTraversalCache()}var alteredParents=[];function removeChildRef(parent,ele){ele=ele[0];var children=(parent=parent[0])._private.children,pid=parent.id();removeFromArray(children,ele),ele._private.parent=null,alteredParents.ids[pid]||(alteredParents.ids[pid]=!0,alteredParents.push(parent))}alteredParents.ids={},self.dirtyCompoundBoundsCache(),removeFromPool&&cy.removeFromPool(elesToRemove);for(var _i6=0;_i6<elesToRemove.length;_i6++){var _ele4=elesToRemove[_i6];if(_ele4.isEdge()){var src=_ele4.source()[0],tgt=_ele4.target()[0];removeEdgeRef(src,_ele4),removeEdgeRef(tgt,_ele4);for(var pllEdges=_ele4.parallelEdges(),j=0;j<pllEdges.length;j++){var pllEdge=pllEdges[j];removeParallelRef(pllEdge),pllEdge.isBundledBezier()&&pllEdge.dirtyBoundingBoxCache()}}else{var parent=_ele4.parent();0!==parent.length&&removeChildRef(parent,_ele4)}removeFromPool&&(_ele4._private.removed=!0)}var elesStillInside=cy._private.elements;cy._private.hasCompoundNodes=!1;for(var _i7=0;_i7<elesStillInside.length;_i7++){var _ele5=elesStillInside[_i7];if(_ele5.isParent()){cy._private.hasCompoundNodes=!0;break}}var removedElements=new Collection(this.cy(),elesToRemove);removedElements.size()>0&&(notifyRenderer?removedElements.emitAndNotify("remove"):removeFromPool&&removedElements.emit("remove"));for(var _i8=0;_i8<alteredParents.length;_i8++){var _ele6=alteredParents[_i8];removeFromPool&&_ele6.removed()||_ele6.updateStyle()}return removedElements},elesfn$u.move=function(struct){var cy=this._private.cy,eles=this,toString=function toString(id){return null==id?id:""+id};if(void 0!==struct.source||void 0!==struct.target){var srcId=toString(struct.source),tgtId=toString(struct.target),srcExists=null!=srcId&&cy.hasElementWithId(srcId),tgtExists=null!=tgtId&&cy.hasElementWithId(tgtId);(srcExists||tgtExists)&&(cy.batch((function(){eles.remove(!1,!1),eles.emitAndNotify("moveout");for(var i=0;i<eles.length;i++){var ele=eles[i],_data5=ele._private.data;ele.isEdge()&&(srcExists&&(_data5.source=srcId),tgtExists&&(_data5.target=tgtId))}eles.restore(!1,!1)})),eles.emitAndNotify("move"))}else if(void 0!==struct.parent){var parentId=toString(struct.parent);if(null===parentId||cy.hasElementWithId(parentId)){var pidToAssign=null===parentId?void 0:parentId;cy.batch((function(){var updated=eles.remove(!1,!1);updated.emitAndNotify("moveout");for(var i=0;i<eles.length;i++){var ele=eles[i],_data6=ele._private.data;ele.isNode()&&(_data6.parent=pidToAssign)}updated.restore(!1,!1)})),eles.emitAndNotify("move")}}return this},[elesfn$c,elesfn$d,elesfn$e,elesfn$f,elesfn$g,data$1,elesfn$i,dimensions,elesfn$m,elesfn$n,{isNode:function isNode(){return"nodes"===this.group()},isEdge:function isEdge(){return"edges"===this.group()},isLoop:function isLoop(){return this.isEdge()&&this.source()[0]===this.target()[0]},isSimple:function isSimple(){return this.isEdge()&&this.source()[0]!==this.target()[0]},group:function group(){var ele=this[0];if(ele)return ele._private.group}},elesfn$p,elesfn$q,elesfn$r,elesfn$s,elesfn$t].forEach((function(props){extend(elesfn$u,props)}));var corefn={add:function add(opts){var elements,cy=this;if(elementOrCollection(opts)){var eles=opts;if(eles._private.cy===cy)elements=eles.restore();else{for(var jsons=[],i=0;i<eles.length;i++){var ele=eles[i];jsons.push(ele.json())}elements=new Collection(cy,jsons)}}else if(array(opts)){elements=new Collection(cy,opts)}else if(plainObject(opts)&&(array(opts.nodes)||array(opts.edges))){for(var elesByGroup=opts,_jsons2=[],grs=["nodes","edges"],_i=0,il=grs.length;_i<il;_i++){var group=grs[_i],elesArray=elesByGroup[group];if(array(elesArray))for(var j=0,jl=elesArray.length;j<jl;j++){var json=extend({group:group},elesArray[j]);_jsons2.push(json)}}elements=new Collection(cy,_jsons2)}else{elements=new Element$1(cy,opts).collection()}return elements},remove:function remove(collection){if(elementOrCollection(collection));else if(string(collection)){var selector=collection;collection=this.$(selector)}return collection.remove()}};var generateSpringRK4=function(){function springAccelerationForState(state){return-state.tension*state.x-state.friction*state.v}function springEvaluateStateWithDerivative(initialState,dt,derivative){var state={x:initialState.x+derivative.dx*dt,v:initialState.v+derivative.dv*dt,tension:initialState.tension,friction:initialState.friction};return{dx:state.v,dv:springAccelerationForState(state)}}function springIntegrateState(state,dt){var a={dx:state.v,dv:springAccelerationForState(state)},b=springEvaluateStateWithDerivative(state,.5*dt,a),c=springEvaluateStateWithDerivative(state,.5*dt,b),d=springEvaluateStateWithDerivative(state,dt,c),dxdt=1/6*(a.dx+2*(b.dx+c.dx)+d.dx),dvdt=1/6*(a.dv+2*(b.dv+c.dv)+d.dv);return state.x=state.x+dxdt*dt,state.v=state.v+dvdt*dt,state}return function springRK4Factory(tension,friction,duration){var have_duration,dt,last_state,initState={x:-1,v:0,tension:null,friction:null},path=[0],time_lapsed=0;for(tension=parseFloat(tension)||500,friction=parseFloat(friction)||20,duration=duration||null,initState.tension=tension,initState.friction=friction,dt=(have_duration=null!==duration)?(time_lapsed=springRK4Factory(tension,friction))/duration*.016:.016;last_state=springIntegrateState(last_state||initState,dt),path.push(1+last_state.x),time_lapsed+=16,Math.abs(last_state.x)>1e-4&&Math.abs(last_state.v)>1e-4;);return have_duration?function(percentComplete){return path[percentComplete*(path.length-1)|0]}:time_lapsed}}(),cubicBezier=function cubicBezier(t1,p1,t2,p2){var bezier=function generateCubicBezier(mX1,mY1,mX2,mY2){var NEWTON_ITERATIONS=4,NEWTON_MIN_SLOPE=.001,SUBDIVISION_PRECISION=1e-7,SUBDIVISION_MAX_ITERATIONS=10,kSplineTableSize=11,kSampleStepSize=1/(kSplineTableSize-1),float32ArraySupported="undefined"!=typeof Float32Array;if(4!==arguments.length)return!1;for(var i=0;i<4;++i)if("number"!=typeof arguments[i]||isNaN(arguments[i])||!isFinite(arguments[i]))return!1;mX1=Math.min(mX1,1),mX2=Math.min(mX2,1),mX1=Math.max(mX1,0),mX2=Math.max(mX2,0);var mSampleValues=float32ArraySupported?new Float32Array(kSplineTableSize):new Array(kSplineTableSize);function A(aA1,aA2){return 1-3*aA2+3*aA1}function B(aA1,aA2){return 3*aA2-6*aA1}function C(aA1){return 3*aA1}function calcBezier(aT,aA1,aA2){return((A(aA1,aA2)*aT+B(aA1,aA2))*aT+C(aA1))*aT}function getSlope(aT,aA1,aA2){return 3*A(aA1,aA2)*aT*aT+2*B(aA1,aA2)*aT+C(aA1)}function newtonRaphsonIterate(aX,aGuessT){for(var _i=0;_i<NEWTON_ITERATIONS;++_i){var currentSlope=getSlope(aGuessT,mX1,mX2);if(0===currentSlope)return aGuessT;aGuessT-=(calcBezier(aGuessT,mX1,mX2)-aX)/currentSlope}return aGuessT}function calcSampleValues(){for(var _i2=0;_i2<kSplineTableSize;++_i2)mSampleValues[_i2]=calcBezier(_i2*kSampleStepSize,mX1,mX2)}function binarySubdivide(aX,aA,aB){var currentX,currentT,i=0;do{(currentX=calcBezier(currentT=aA+(aB-aA)/2,mX1,mX2)-aX)>0?aB=currentT:aA=currentT}while(Math.abs(currentX)>SUBDIVISION_PRECISION&&++i<SUBDIVISION_MAX_ITERATIONS);return currentT}function getTForX(aX){for(var intervalStart=0,currentSample=1,lastSample=kSplineTableSize-1;currentSample!==lastSample&&mSampleValues[currentSample]<=aX;++currentSample)intervalStart+=kSampleStepSize;--currentSample;var guessForT=intervalStart+(aX-mSampleValues[currentSample])/(mSampleValues[currentSample+1]-mSampleValues[currentSample])*kSampleStepSize,initialSlope=getSlope(guessForT,mX1,mX2);return initialSlope>=NEWTON_MIN_SLOPE?newtonRaphsonIterate(aX,guessForT):0===initialSlope?guessForT:binarySubdivide(aX,intervalStart,intervalStart+kSampleStepSize)}var _precomputed=!1;function precompute(){_precomputed=!0,mX1===mY1&&mX2===mY2||calcSampleValues()}var f=function f(aX){return _precomputed||precompute(),mX1===mY1&&mX2===mY2?aX:0===aX?0:1===aX?1:calcBezier(getTForX(aX),mY1,mY2)};f.getControlPoints=function(){return[{x:mX1,y:mY1},{x:mX2,y:mY2}]};var str="generateBezier("+[mX1,mY1,mX2,mY2]+")";return f.toString=function(){return str},f}(t1,p1,t2,p2);return function(start,end,percent){return start+(end-start)*bezier(percent)}},easings={linear:function linear(start,end,percent){return start+(end-start)*percent},ease:cubicBezier(.25,.1,.25,1),"ease-in":cubicBezier(.42,0,1,1),"ease-out":cubicBezier(0,0,.58,1),"ease-in-out":cubicBezier(.42,0,.58,1),"ease-in-sine":cubicBezier(.47,0,.745,.715),"ease-out-sine":cubicBezier(.39,.575,.565,1),"ease-in-out-sine":cubicBezier(.445,.05,.55,.95),"ease-in-quad":cubicBezier(.55,.085,.68,.53),"ease-out-quad":cubicBezier(.25,.46,.45,.94),"ease-in-out-quad":cubicBezier(.455,.03,.515,.955),"ease-in-cubic":cubicBezier(.55,.055,.675,.19),"ease-out-cubic":cubicBezier(.215,.61,.355,1),"ease-in-out-cubic":cubicBezier(.645,.045,.355,1),"ease-in-quart":cubicBezier(.895,.03,.685,.22),"ease-out-quart":cubicBezier(.165,.84,.44,1),"ease-in-out-quart":cubicBezier(.77,0,.175,1),"ease-in-quint":cubicBezier(.755,.05,.855,.06),"ease-out-quint":cubicBezier(.23,1,.32,1),"ease-in-out-quint":cubicBezier(.86,0,.07,1),"ease-in-expo":cubicBezier(.95,.05,.795,.035),"ease-out-expo":cubicBezier(.19,1,.22,1),"ease-in-out-expo":cubicBezier(1,0,0,1),"ease-in-circ":cubicBezier(.6,.04,.98,.335),"ease-out-circ":cubicBezier(.075,.82,.165,1),"ease-in-out-circ":cubicBezier(.785,.135,.15,.86),spring:function spring(tension,friction,duration){if(0===duration)return easings.linear;var spring=generateSpringRK4(tension,friction,duration);return function(start,end,percent){return start+(end-start)*spring(percent)}},"cubic-bezier":cubicBezier};function getEasedValue(type,start,end,percent,easingFn){if(1===percent)return end;if(start===end)return end;var val=easingFn(start,end,percent);return null==type||((type.roundValue||type.color)&&(val=Math.round(val)),void 0!==type.min&&(val=Math.max(val,type.min)),void 0!==type.max&&(val=Math.min(val,type.max))),val}function getValue(prop,spec){return null!=prop.pfValue||null!=prop.value?null==prop.pfValue||null!=spec&&"%"===spec.type.units?prop.value:prop.pfValue:prop}function ease(startProp,endProp,percent,easingFn,propSpec){var type=null!=propSpec?propSpec.type:null;percent<0?percent=0:percent>1&&(percent=1);var start=getValue(startProp,propSpec),end=getValue(endProp,propSpec);if(number(start)&&number(end))return getEasedValue(type,start,end,percent,easingFn);if(array(start)&&array(end)){for(var easedArr=[],i=0;i<end.length;i++){var si=start[i],ei=end[i];if(null!=si&&null!=ei){var val=getEasedValue(type,si,ei,percent,easingFn);easedArr.push(val)}else easedArr.push(ei)}return easedArr}}function step(self,ani,now,isCore){var isEles=!isCore,_p=self._private,ani_p=ani._private,pEasing=ani_p.easing,startTime=ani_p.startTime,style=(isCore?self:self.cy()).style();if(!ani_p.easingImpl)if(null==pEasing)ani_p.easingImpl=easings.linear;else{var easingVals,name,args;if(string(pEasing))easingVals=style.parse("transition-timing-function",pEasing).value;else easingVals=pEasing;string(easingVals)?(name=easingVals,args=[]):(name=easingVals[1],args=easingVals.slice(2).map((function(n){return+n}))),args.length>0?("spring"===name&&args.push(ani_p.duration),ani_p.easingImpl=easings[name].apply(null,args)):ani_p.easingImpl=easings[name]}var percent,easing=ani_p.easingImpl;if(percent=0===ani_p.duration?1:(now-startTime)/ani_p.duration,ani_p.applying&&(percent=ani_p.progress),percent<0?percent=0:percent>1&&(percent=1),null==ani_p.delay){var startPos=ani_p.startPosition,endPos=ani_p.position;if(endPos&&isEles&&!self.locked()){var newPos={};valid(startPos.x,endPos.x)&&(newPos.x=ease(startPos.x,endPos.x,percent,easing)),valid(startPos.y,endPos.y)&&(newPos.y=ease(startPos.y,endPos.y,percent,easing)),self.position(newPos)}var startPan=ani_p.startPan,endPan=ani_p.pan,pan=_p.pan,animatingPan=null!=endPan&&isCore;animatingPan&&(valid(startPan.x,endPan.x)&&(pan.x=ease(startPan.x,endPan.x,percent,easing)),valid(startPan.y,endPan.y)&&(pan.y=ease(startPan.y,endPan.y,percent,easing)),self.emit("pan"));var startZoom=ani_p.startZoom,endZoom=ani_p.zoom,animatingZoom=null!=endZoom&&isCore;animatingZoom&&(valid(startZoom,endZoom)&&(_p.zoom=bound(_p.minZoom,ease(startZoom,endZoom,percent,easing),_p.maxZoom)),self.emit("zoom")),(animatingPan||animatingZoom)&&self.emit("viewport");var props=ani_p.style;if(props&&props.length>0&&isEles){for(var i=0;i<props.length;i++){var prop=props[i],_name=prop.name,end=prop,start=ani_p.startStyle[_name],easedVal=ease(start,end,percent,easing,style.properties[start.name]);style.overrideBypass(self,_name,easedVal)}self.emit("style")}}return ani_p.progress=percent,percent}function valid(start,end){return null!=start&&null!=end&&(!(!number(start)||!number(end))||!(!start||!end))}function startAnimation(self,ani,now,isCore){var ani_p=ani._private;ani_p.started=!0,ani_p.startTime=now-ani_p.progress*ani_p.duration}function stepAll(now,cy){var eles=cy._private.aniEles,doneEles=[];function stepOne(ele,isCore){var _p=ele._private,current=_p.animation.current,queue=_p.animation.queue,ranAnis=!1;if(0===current.length){var next=queue.shift();next&&current.push(next)}for(var callbacks=function callbacks(_callbacks){for(var j=_callbacks.length-1;j>=0;j--){(0,_callbacks[j])()}_callbacks.splice(0,_callbacks.length)},i=current.length-1;i>=0;i--){var ani=current[i],ani_p=ani._private;ani_p.stopped?(current.splice(i,1),ani_p.hooked=!1,ani_p.playing=!1,ani_p.started=!1,callbacks(ani_p.frames)):(ani_p.playing||ani_p.applying)&&(ani_p.playing&&ani_p.applying&&(ani_p.applying=!1),ani_p.started||startAnimation(0,ani,now),step(ele,ani,now,isCore),ani_p.applying&&(ani_p.applying=!1),callbacks(ani_p.frames),null!=ani_p.step&&ani_p.step(now),ani.completed()&&(current.splice(i,1),ani_p.hooked=!1,ani_p.playing=!1,ani_p.started=!1,callbacks(ani_p.completes)),ranAnis=!0)}return isCore||0!==current.length||0!==queue.length||doneEles.push(ele),ranAnis}for(var ranEleAni=!1,e=0;e<eles.length;e++){var handledThisEle=stepOne(eles[e]);ranEleAni=ranEleAni||handledThisEle}var ranCoreAni=stepOne(cy,!0);(ranEleAni||ranCoreAni)&&(eles.length>0?cy.notify("draw",eles):cy.notify("draw")),eles.unmerge(doneEles),cy.emit("step")}var corefn$1={animate:define$3.animate(),animation:define$3.animation(),animated:define$3.animated(),clearQueue:define$3.clearQueue(),delay:define$3.delay(),delayAnimation:define$3.delayAnimation(),stop:define$3.stop(),addToAnimationPool:function addToAnimationPool(eles){this.styleEnabled()&&this._private.aniEles.merge(eles)},stopAnimationLoop:function stopAnimationLoop(){this._private.animationsRunning=!1},startAnimationLoop:function startAnimationLoop(){var cy=this;if(cy._private.animationsRunning=!0,cy.styleEnabled()){var renderer=cy.renderer();renderer&&renderer.beforeRender?renderer.beforeRender((function rendererAnimationStep(willDraw,now){stepAll(now,cy)}),renderer.beforeRenderPriorities.animations):function headlessStep(){cy._private.animationsRunning&&requestAnimationFrame((function animationStep(now){stepAll(now,cy),headlessStep()}))}()}}},emitterOptions$1={qualifierCompare:function qualifierCompare(selector1,selector2){return null==selector1||null==selector2?null==selector1&&null==selector2:selector1.sameText(selector2)},eventMatches:function eventMatches(cy,listener,eventObj){var selector=listener.qualifier;return null==selector||cy!==eventObj.target&&element(eventObj.target)&&selector.matches(eventObj.target)},addEventFields:function addEventFields(cy,evt){evt.cy=cy,evt.target=cy},callbackContext:function callbackContext(cy,listener,eventObj){return null!=listener.qualifier?eventObj.target:cy}},argSelector$1=function argSelector(arg){return string(arg)?new Selector(arg):arg},elesfn$v={createEmitter:function createEmitter(){var _p=this._private;return _p.emitter||(_p.emitter=new Emitter(emitterOptions$1,this)),this},emitter:function emitter(){return this._private.emitter},on:function on(events,selector,callback){return this.emitter().on(events,argSelector$1(selector),callback),this},removeListener:function removeListener(events,selector,callback){return this.emitter().removeListener(events,argSelector$1(selector),callback),this},removeAllListeners:function removeAllListeners(){return this.emitter().removeAllListeners(),this},one:function one(events,selector,callback){return this.emitter().one(events,argSelector$1(selector),callback),this},once:function once(events,selector,callback){return this.emitter().one(events,argSelector$1(selector),callback),this},emit:function emit(events,extraParams){return this.emitter().emit(events,extraParams),this},emitAndNotify:function emitAndNotify(event,eles){return this.emit(event),this.notify(event,eles),this}};define$3.eventAliasesOn(elesfn$v);var corefn$2={png:function png(options){return options=options||{},this._private.renderer.png(options)},jpg:function jpg(options){var renderer=this._private.renderer;return(options=options||{}).bg=options.bg||"#fff",renderer.jpg(options)}};corefn$2.jpeg=corefn$2.jpg;var corefn$3={layout:function layout(options){if(null!=options)if(null!=options.name){var name=options.name,Layout=this.extension("layout",name);if(null!=Layout){var eles;eles=string(options.eles)?this.$(options.eles):null!=options.eles?options.eles:this.$();var layout=new Layout(extend({},options,{cy:this,eles:eles}));return layout}error("No such layout `"+name+"` found.  Did you forget to import it and `cytoscape.use()` it?")}else error("A `name` must be specified to make a layout");else error("Layout options must be specified to make a layout")}};corefn$3.createLayout=corefn$3.makeLayout=corefn$3.layout;var corefn$4={notify:function notify(eventName,eventEles){var _p=this._private;if(this.batching()){_p.batchNotifications=_p.batchNotifications||{};var eles=_p.batchNotifications[eventName]=_p.batchNotifications[eventName]||this.collection();null!=eventEles&&eles.merge(eventEles)}else if(_p.notificationsEnabled){var renderer=this.renderer();!this.destroyed()&&renderer&&renderer.notify(eventName,eventEles)}},notifications:function notifications(bool){var p=this._private;return void 0===bool?p.notificationsEnabled:(p.notificationsEnabled=!!bool,this)},noNotifications:function noNotifications(callback){this.notifications(!1),callback(),this.notifications(!0)},batching:function batching(){return this._private.batchCount>0},startBatch:function startBatch(){var _p=this._private;return null==_p.batchCount&&(_p.batchCount=0),0===_p.batchCount&&(_p.batchStyleEles=this.collection(),_p.batchNotifications={}),_p.batchCount++,this},endBatch:function endBatch(){var _p=this._private;if(0===_p.batchCount)return this;if(_p.batchCount--,0===_p.batchCount){_p.batchStyleEles.updateStyle();var renderer=this.renderer();Object.keys(_p.batchNotifications).forEach((function(eventName){var eles=_p.batchNotifications[eventName];eles.empty()?renderer.notify(eventName):renderer.notify(eventName,eles)}))}return this},batch:function batch(callback){return this.startBatch(),callback(),this.endBatch(),this},batchData:function batchData(map){var cy=this;return this.batch((function(){for(var ids=Object.keys(map),i=0;i<ids.length;i++){var id=ids[i],data=map[id];cy.getElementById(id).data(data)}}))}},rendererDefaults=defaults({hideEdgesOnViewport:!1,textureOnViewport:!1,motionBlur:!1,motionBlurOpacity:.05,pixelRatio:void 0,desktopTapThreshold:4,touchTapThreshold:8,wheelSensitivity:1,debug:!1,showFps:!1}),corefn$5={renderTo:function renderTo(context,zoom,pan,pxRatio){return this._private.renderer.renderTo(context,zoom,pan,pxRatio),this},renderer:function renderer(){return this._private.renderer},forceRender:function forceRender(){return this.notify("draw"),this},resize:function resize(){return this.invalidateSize(),this.emitAndNotify("resize"),this},initRenderer:function initRenderer(options){var RendererProto=this.extension("renderer",options.name);if(null!=RendererProto){void 0!==options.wheelSensitivity&&warn("You have set a custom wheel sensitivity.  This will make your app zoom unnaturally when using mainstream mice.  You should change this value from the default only if you can guarantee that all your users will use the same hardware and OS configuration as your current machine.");var rOpts=rendererDefaults(options);rOpts.cy=this,this._private.renderer=new RendererProto(rOpts),this.notify("init")}else error("Can not initialise: No such renderer `".concat(options.name,"` found. Did you forget to import it and `cytoscape.use()` it?"))},destroyRenderer:function destroyRenderer(){this.notify("destroy");var domEle=this.container();if(domEle)for(domEle._cyreg=null;domEle.childNodes.length>0;)domEle.removeChild(domEle.childNodes[0]);this._private.renderer=null,this.mutableElements().forEach((function(ele){var _p=ele._private;_p.rscratch={},_p.rstyle={},_p.animation.current=[],_p.animation.queue=[]}))},onRender:function onRender(fn){return this.on("render",fn)},offRender:function offRender(fn){return this.off("render",fn)}};corefn$5.invalidateDimensions=corefn$5.resize;var corefn$6={collection:function collection(eles,opts){return string(eles)?this.$(eles):elementOrCollection(eles)?eles.collection():array(eles)?new Collection(this,eles,opts):new Collection(this)},nodes:function nodes(selector){var nodes=this.$((function(ele){return ele.isNode()}));return selector?nodes.filter(selector):nodes},edges:function edges(selector){var edges=this.$((function(ele){return ele.isEdge()}));return selector?edges.filter(selector):edges},$:function $(selector){var eles=this._private.elements;return selector?eles.filter(selector):eles.spawnSelf()},mutableElements:function mutableElements(){return this._private.elements}};corefn$6.elements=corefn$6.filter=corefn$6.$;var styfn={};styfn.apply=function(eles){for(var updatedEles=this._private.cy.collection(),ie=0;ie<eles.length;ie++){var ele=eles[ie],cxtMeta=this.getContextMeta(ele);if(!cxtMeta.empty){var cxtStyle=this.getContextStyle(cxtMeta),app=this.applyContextStyle(cxtMeta,cxtStyle,ele);ele._private.appliedInitStyle?this.updateTransitions(ele,app.diffProps):ele._private.appliedInitStyle=!0,this.updateStyleHints(ele)&&updatedEles.push(ele)}}return updatedEles},styfn.getPropertiesDiff=function(oldCxtKey,newCxtKey){var cache=this._private.propDiffs=this._private.propDiffs||{},dualCxtKey=oldCxtKey+"-"+newCxtKey,cachedVal=cache[dualCxtKey];if(cachedVal)return cachedVal;for(var diffProps=[],addedProp={},i=0;i<this.length;i++){var cxt=this[i],oldHasCxt="t"===oldCxtKey[i],newHasCxt="t"===newCxtKey[i],cxtHasDiffed=oldHasCxt!==newHasCxt,cxtHasMappedProps=cxt.mappedProperties.length>0;if(cxtHasDiffed||newHasCxt&&cxtHasMappedProps){var props=void 0;cxtHasDiffed&&cxtHasMappedProps||cxtHasDiffed?props=cxt.properties:cxtHasMappedProps&&(props=cxt.mappedProperties);for(var j=0;j<props.length;j++){for(var prop=props[j],name=prop.name,laterCxtOverrides=!1,k=i+1;k<this.length;k++){var laterCxt=this[k];if("t"===newCxtKey[k]&&(laterCxtOverrides=null!=laterCxt.properties[prop.name]))break}addedProp[name]||laterCxtOverrides||(addedProp[name]=!0,diffProps.push(name))}}}return cache[dualCxtKey]=diffProps,diffProps},styfn.getContextMeta=function(ele){for(var diffProps,cxtKey="",prevKey=ele._private.styleCxtKey||"",i=0;i<this.length;i++){var context=this[i];cxtKey+=context.selector&&context.selector.matches(ele)?"t":"f"}return diffProps=this.getPropertiesDiff(prevKey,cxtKey),ele._private.styleCxtKey=cxtKey,{key:cxtKey,diffPropNames:diffProps,empty:0===diffProps.length}},styfn.getContextStyle=function(cxtMeta){var cxtKey=cxtMeta.key,cxtStyles=this._private.contextStyles=this._private.contextStyles||{};if(cxtStyles[cxtKey])return cxtStyles[cxtKey];for(var style={_private:{key:cxtKey}},i=0;i<this.length;i++){var cxt=this[i];if("t"===cxtKey[i])for(var j=0;j<cxt.properties.length;j++){var prop=cxt.properties[j];style[prop.name]=prop}}return cxtStyles[cxtKey]=style,style},styfn.applyContextStyle=function(cxtMeta,cxtStyle,ele){for(var diffProps=cxtMeta.diffPropNames,retDiffProps={},types=this.types,i=0;i<diffProps.length;i++){var diffPropName=diffProps[i],cxtProp=cxtStyle[diffPropName],eleProp=ele.pstyle(diffPropName);if(!cxtProp){if(!eleProp)continue;cxtProp=eleProp.bypass?{name:diffPropName,deleteBypassed:!0}:{name:diffPropName,delete:!0}}if(eleProp!==cxtProp){if(cxtProp.mapped===types.fn&&null!=eleProp&&null!=eleProp.mapping&&eleProp.mapping.value===cxtProp.value){var mapping=eleProp.mapping;if((mapping.fnValue=cxtProp.value(ele))===mapping.prevFnValue)continue}var retDiffProp=retDiffProps[diffPropName]={prev:eleProp};this.applyParsedProperty(ele,cxtProp),retDiffProp.next=ele.pstyle(diffPropName),retDiffProp.next&&retDiffProp.next.bypass&&(retDiffProp.next=retDiffProp.next.bypassed)}}return{diffProps:retDiffProps}},styfn.updateStyleHints=function(ele){var _p=ele._private,self=this,propNames=self.propertyGroupNames,propGrKeys=self.propertyGroupKeys,propHash=function propHash(ele,propNames,seedKey){return self.getPropertiesHash(ele,propNames,seedKey)},oldStyleKey=_p.styleKey;if(ele.removed())return!1;var isNode="nodes"===_p.group,overriddenStyles=ele._private.style;propNames=Object.keys(overriddenStyles);for(var i=0;i<propGrKeys.length;i++){var grKey=propGrKeys[i];_p.styleKeys[grKey]=[9261,5381]}for(var updateGrKey1=function updateGrKey1(val,grKey){return _p.styleKeys[grKey][0]=hashInt(val,_p.styleKeys[grKey][0])},updateGrKey2=function updateGrKey2(val,grKey){return _p.styleKeys[grKey][1]=hashIntAlt(val,_p.styleKeys[grKey][1])},updateGrKey=function updateGrKey(val,grKey){updateGrKey1(val,grKey),updateGrKey2(val,grKey)},updateGrKeyWStr=function updateGrKeyWStr(strVal,grKey){for(var j=0;j<strVal.length;j++){var ch=strVal.charCodeAt(j);updateGrKey1(ch,grKey),updateGrKey2(ch,grKey)}},cleanNum=function cleanNum(val){return-128<val&&val<128&&Math.floor(val)!==val?2e9-(1024*val|0):val},_i=0;_i<propNames.length;_i++){var name=propNames[_i],parsedProp=overriddenStyles[name];if(null!=parsedProp){var propInfo=this.properties[name],type=propInfo.type,_grKey=propInfo.groupKey,normalizedNumberVal=void 0;null!=propInfo.hashOverride?normalizedNumberVal=propInfo.hashOverride(ele,parsedProp):null!=parsedProp.pfValue&&(normalizedNumberVal=parsedProp.pfValue);var numberVal=null==propInfo.enums?parsedProp.value:null,haveNormNum=null!=normalizedNumberVal,haveNum=haveNormNum||null!=numberVal,units=parsedProp.units;if(type.number&&haveNum&&!type.multiple)updateGrKey(cleanNum(haveNormNum?normalizedNumberVal:numberVal),_grKey),haveNormNum||null==units||updateGrKeyWStr(units,_grKey);else updateGrKeyWStr(parsedProp.strValue,_grKey)}}for(var hash=[9261,5381],_i2=0;_i2<propGrKeys.length;_i2++){var _grKey2=propGrKeys[_i2],grHash=_p.styleKeys[_grKey2];hash[0]=hashInt(grHash[0],hash[0]),hash[1]=hashIntAlt(grHash[1],hash[1])}_p.styleKey=function combineHashes(hash1,hash2){return 2097152*hash1+hash2}(hash[0],hash[1]);var sk=_p.styleKeys;_p.labelDimsKey=combineHashesArray(sk.labelDimensions);var labelKeys=propHash(ele,["label"],sk.labelDimensions);if(_p.labelKey=combineHashesArray(labelKeys),_p.labelStyleKey=combineHashesArray(hashArrays(sk.commonLabel,labelKeys)),!isNode){var sourceLabelKeys=propHash(ele,["source-label"],sk.labelDimensions);_p.sourceLabelKey=combineHashesArray(sourceLabelKeys),_p.sourceLabelStyleKey=combineHashesArray(hashArrays(sk.commonLabel,sourceLabelKeys));var targetLabelKeys=propHash(ele,["target-label"],sk.labelDimensions);_p.targetLabelKey=combineHashesArray(targetLabelKeys),_p.targetLabelStyleKey=combineHashesArray(hashArrays(sk.commonLabel,targetLabelKeys))}if(isNode){var _p$styleKeys=_p.styleKeys,nodeBody=_p$styleKeys.nodeBody,nodeBorder=_p$styleKeys.nodeBorder,backgroundImage=_p$styleKeys.backgroundImage,compound=_p$styleKeys.compound,pie=_p$styleKeys.pie,nodeKeys=[nodeBody,nodeBorder,backgroundImage,compound,pie].filter((function(k){return null!=k})).reduce(hashArrays,[9261,5381]);_p.nodeKey=combineHashesArray(nodeKeys),_p.hasPie=null!=pie&&9261!==pie[0]&&5381!==pie[1]}return oldStyleKey!==_p.styleKey},styfn.clearStyleHints=function(ele){var _p=ele._private;_p.styleCxtKey="",_p.styleKeys={},_p.styleKey=null,_p.labelKey=null,_p.labelStyleKey=null,_p.sourceLabelKey=null,_p.sourceLabelStyleKey=null,_p.targetLabelKey=null,_p.targetLabelStyleKey=null,_p.nodeKey=null,_p.hasPie=null},styfn.applyParsedProperty=function(ele,parsedProp){var flatProp,self=this,prop=parsedProp,style=ele._private.style,types=self.types,type=self.properties[prop.name].type,propIsBypass=prop.bypass,origProp=style[prop.name],origPropIsBypass=origProp&&origProp.bypass,_p=ele._private,getVal=function getVal(p){return null==p?null:null!=p.pfValue?p.pfValue:p.value},checkTriggers=function checkTriggers(){var fromVal=getVal(origProp),toVal=getVal(prop);self.checkTriggers(ele,prop.name,fromVal,toVal)};if(prop&&"pie"===prop.name.substr(0,3)&&warn("The pie style properties are deprecated.  Create charts using background images instead."),"curve-style"===parsedProp.name&&ele.isEdge()&&("bezier"!==parsedProp.value&&ele.isLoop()||"haystack"===parsedProp.value&&(ele.source().isParent()||ele.target().isParent()))&&(prop=parsedProp=this.parse(parsedProp.name,"bezier",propIsBypass)),prop.delete)return style[prop.name]=void 0,checkTriggers(),!0;if(prop.deleteBypassed)return origProp?!!origProp.bypass&&(origProp.bypassed=void 0,checkTriggers(),!0):(checkTriggers(),!0);if(prop.deleteBypass)return origProp?!!origProp.bypass&&(style[prop.name]=origProp.bypassed,checkTriggers(),!0):(checkTriggers(),!0);var printMappingErr=function printMappingErr(){warn("Do not assign mappings to elements without corresponding data (i.e. ele `"+ele.id()+"` has no mapping for property `"+prop.name+"` with data field `"+prop.field+"`); try a `["+prop.field+"]` selector to limit scope to elements with `"+prop.field+"` defined")};switch(prop.mapped){case types.mapData:for(var percent,fields=prop.field.split("."),fieldVal=_p.data,i=0;i<fields.length&&fieldVal;i++){fieldVal=fieldVal[fields[i]]}if(null==fieldVal)return printMappingErr(),!1;if(!number(fieldVal))return warn("Do not use continuous mappers without specifying numeric data (i.e. `"+prop.field+": "+fieldVal+"` for `"+ele.id()+"` is non-numeric)"),!1;var fieldWidth=prop.fieldMax-prop.fieldMin;if((percent=0===fieldWidth?0:(fieldVal-prop.fieldMin)/fieldWidth)<0?percent=0:percent>1&&(percent=1),type.color){var r1=prop.valueMin[0],r2=prop.valueMax[0],g1=prop.valueMin[1],g2=prop.valueMax[1],b1=prop.valueMin[2],b2=prop.valueMax[2],a1=null==prop.valueMin[3]?1:prop.valueMin[3],a2=null==prop.valueMax[3]?1:prop.valueMax[3],clr=[Math.round(r1+(r2-r1)*percent),Math.round(g1+(g2-g1)*percent),Math.round(b1+(b2-b1)*percent),Math.round(a1+(a2-a1)*percent)];flatProp={bypass:prop.bypass,name:prop.name,value:clr,strValue:"rgb("+clr[0]+", "+clr[1]+", "+clr[2]+")"}}else{if(!type.number)return!1;var calcValue=prop.valueMin+(prop.valueMax-prop.valueMin)*percent;flatProp=this.parse(prop.name,calcValue,prop.bypass,"mapping")}if(!flatProp)return printMappingErr(),!1;flatProp.mapping=prop,prop=flatProp;break;case types.data:for(var _fields=prop.field.split("."),_fieldVal=_p.data,_i3=0;_i3<_fields.length&&_fieldVal;_i3++){_fieldVal=_fieldVal[_fields[_i3]]}if(null!=_fieldVal&&(flatProp=this.parse(prop.name,_fieldVal,prop.bypass,"mapping")),!flatProp)return printMappingErr(),!1;flatProp.mapping=prop,prop=flatProp;break;case types.fn:var fn=prop.value,fnRetVal=null!=prop.fnValue?prop.fnValue:fn(ele);if(prop.prevFnValue=fnRetVal,null==fnRetVal)return warn("Custom function mappers may not return null (i.e. `"+prop.name+"` for ele `"+ele.id()+"` is null)"),!1;if(!(flatProp=this.parse(prop.name,fnRetVal,prop.bypass,"mapping")))return warn("Custom function mappers may not return invalid values for the property type (i.e. `"+prop.name+"` for ele `"+ele.id()+"` is invalid)"),!1;flatProp.mapping=copy(prop),prop=flatProp;break;case void 0:break;default:return!1}return propIsBypass?(prop.bypassed=origPropIsBypass?origProp.bypassed:origProp,style[prop.name]=prop):origPropIsBypass?origProp.bypassed=prop:style[prop.name]=prop,checkTriggers(),!0},styfn.cleanElements=function(eles,keepBypasses){for(var i=0;i<eles.length;i++){var ele=eles[i];if(this.clearStyleHints(ele),ele.dirtyCompoundBoundsCache(),ele.dirtyBoundingBoxCache(),keepBypasses)for(var style=ele._private.style,propNames=Object.keys(style),j=0;j<propNames.length;j++){var propName=propNames[j],eleProp=style[propName];null!=eleProp&&(eleProp.bypass?eleProp.bypassed=null:style[propName]=null)}else ele._private.style={}}},styfn.update=function(){this._private.cy.mutableElements().updateStyle()},styfn.updateTransitions=function(ele,diffProps){var self=this,_p=ele._private,props=ele.pstyle("transition-property").value,duration=ele.pstyle("transition-duration").pfValue,delay=ele.pstyle("transition-delay").pfValue;if(props.length>0&&duration>0){for(var style={},anyPrev=!1,i=0;i<props.length;i++){var prop=props[i],styProp=ele.pstyle(prop),diffProp=diffProps[prop];if(diffProp){var fromProp=diffProp.prev,toProp=null!=diffProp.next?diffProp.next:styProp,diff=!1,initVal=void 0;fromProp&&(number(fromProp.pfValue)&&number(toProp.pfValue)?(diff=toProp.pfValue-fromProp.pfValue,initVal=fromProp.pfValue+1e-6*diff):number(fromProp.value)&&number(toProp.value)?(diff=toProp.value-fromProp.value,initVal=fromProp.value+1e-6*diff):array(fromProp.value)&&array(toProp.value)&&(diff=fromProp.value[0]!==toProp.value[0]||fromProp.value[1]!==toProp.value[1]||fromProp.value[2]!==toProp.value[2],initVal=fromProp.strValue),diff&&(style[prop]=toProp.strValue,this.applyBypass(ele,prop,initVal),anyPrev=!0))}}if(!anyPrev)return;_p.transitioning=!0,new Promise$1((function(resolve){delay>0?ele.delayAnimation(delay).play().promise().then(resolve):resolve()})).then((function(){return ele.animation({style:style,duration:duration,easing:ele.pstyle("transition-timing-function").value,queue:!1}).play().promise()})).then((function(){self.removeBypasses(ele,props),ele.emitAndNotify("style"),_p.transitioning=!1}))}else _p.transitioning&&(this.removeBypasses(ele,props),ele.emitAndNotify("style"),_p.transitioning=!1)},styfn.checkTrigger=function(ele,name,fromValue,toValue,getTrigger,onTrigger){var prop=this.properties[name],triggerCheck=getTrigger(prop);null!=triggerCheck&&triggerCheck(fromValue,toValue)&&onTrigger(prop)},styfn.checkZOrderTrigger=function(ele,name,fromValue,toValue){var _this=this;this.checkTrigger(ele,name,fromValue,toValue,(function(prop){return prop.triggersZOrder}),(function(){_this._private.cy.notify("zorder",ele)}))},styfn.checkBoundsTrigger=function(ele,name,fromValue,toValue){this.checkTrigger(ele,name,fromValue,toValue,(function(prop){return prop.triggersBounds}),(function(prop){ele.dirtyCompoundBoundsCache(),ele.dirtyBoundingBoxCache(),"curve-style"!==name||"bezier"!==fromValue&&"bezier"!==toValue||!prop.triggersBoundsOfParallelBeziers||ele.parallelEdges().forEach((function(pllEdge){pllEdge.isBundledBezier()&&pllEdge.dirtyBoundingBoxCache()}))}))},styfn.checkTriggers=function(ele,name,fromValue,toValue){ele.dirtyStyleCache(),this.checkZOrderTrigger(ele,name,fromValue,toValue),this.checkBoundsTrigger(ele,name,fromValue,toValue)};var styfn$1={applyBypass:function(eles,name,value,updateTransitions){var props=[];if("*"===name||"**"===name){if(void 0!==value)for(var i=0;i<this.properties.length;i++){var _name=this.properties[i].name,parsedProp=this.parse(_name,value,!0);parsedProp&&props.push(parsedProp)}}else if(string(name)){var _parsedProp=this.parse(name,value,!0);_parsedProp&&props.push(_parsedProp)}else{if(!plainObject(name))return!1;var specifiedProps=name;updateTransitions=value;for(var names=Object.keys(specifiedProps),_i=0;_i<names.length;_i++){var _name2=names[_i],_value=specifiedProps[_name2];if(void 0===_value&&(_value=specifiedProps[dash2camel(_name2)]),void 0!==_value){var _parsedProp2=this.parse(_name2,_value,!0);_parsedProp2&&props.push(_parsedProp2)}}}if(0===props.length)return!1;for(var ret=!1,_i2=0;_i2<eles.length;_i2++){for(var ele=eles[_i2],diffProps={},diffProp=void 0,j=0;j<props.length;j++){var _prop=props[j];if(updateTransitions){var prevProp=ele.pstyle(_prop.name);diffProp=diffProps[_prop.name]={prev:prevProp}}ret=this.applyParsedProperty(ele,copy(_prop))||ret,updateTransitions&&(diffProp.next=ele.pstyle(_prop.name))}ret&&this.updateStyleHints(ele),updateTransitions&&this.updateTransitions(ele,diffProps,!0)}return ret},overrideBypass:function(eles,name,value){name=camel2dash(name);for(var i=0;i<eles.length;i++){var ele=eles[i],prop=ele._private.style[name],type=this.properties[name].type,isColor=type.color,isMulti=type.mutiple,oldValue=prop?null!=prop.pfValue?prop.pfValue:prop.value:null;prop&&prop.bypass?(prop.value=value,null!=prop.pfValue&&(prop.pfValue=value),prop.strValue=isColor?"rgb("+value.join(",")+")":isMulti?value.join(" "):""+value,this.updateStyleHints(ele)):this.applyBypass(ele,name,value),this.checkTriggers(ele,name,oldValue,value)}},removeAllBypasses:function(eles,updateTransitions){return this.removeBypasses(eles,this.propertyNames,updateTransitions)},removeBypasses:function(eles,props,updateTransitions){for(var j=0;j<eles.length;j++){for(var ele=eles[j],diffProps={},i=0;i<props.length;i++){var name=props[i],prop=this.properties[name],prevProp=ele.pstyle(prop.name);if(prevProp&&prevProp.bypass){var parsedProp=this.parse(name,"",!0),diffProp=diffProps[prop.name]={prev:prevProp};this.applyParsedProperty(ele,parsedProp),diffProp.next=ele.pstyle(prop.name)}}this.updateStyleHints(ele),updateTransitions&&this.updateTransitions(ele,diffProps,!0)}}},styfn$2={getEmSizeInPixels:function(){var px=this.containerCss("font-size");return null!=px?parseFloat(px):1},containerCss:function(propName){var domElement=this._private.cy.container();if(window$1&&domElement&&window$1.getComputedStyle)return window$1.getComputedStyle(domElement).getPropertyValue(propName)}},styfn$3={getRenderedStyle:function(ele,prop){return prop?this.getStylePropertyValue(ele,prop,!0):this.getRawStyle(ele,!0)},getRawStyle:function(ele,isRenderedVal){if(ele=ele[0]){for(var rstyle={},i=0;i<this.properties.length;i++){var prop=this.properties[i],val=this.getStylePropertyValue(ele,prop.name,isRenderedVal);null!=val&&(rstyle[prop.name]=val,rstyle[dash2camel(prop.name)]=val)}return rstyle}},getIndexedStyle:function(ele,property,subproperty,index){var pstyle=ele.pstyle(property)[subproperty][index];return null!=pstyle?pstyle:ele.cy().style().getDefaultProperty(property)[subproperty][0]},getStylePropertyValue:function(ele,propName,isRenderedVal){if(ele=ele[0]){var prop=this.properties[propName];prop.alias&&(prop=prop.pointsTo);var type=prop.type,styleProp=ele.pstyle(prop.name);if(styleProp){var value=styleProp.value,units=styleProp.units,strValue=styleProp.strValue;if(isRenderedVal&&type.number&&null!=value&&number(value)){var zoom=ele.cy().zoom(),getRenderedValue=function getRenderedValue(val){return val*zoom},getValueStringWithUnits=function getValueStringWithUnits(val,units){return getRenderedValue(val)+units},isArrayValue=array(value);return(isArrayValue?units.every((function(u){return null!=u})):null!=units)?isArrayValue?value.map((function(v,i){return getValueStringWithUnits(v,units[i])})).join(" "):getValueStringWithUnits(value,units):isArrayValue?value.map((function(v){return string(v)?v:""+getRenderedValue(v)})).join(" "):""+getRenderedValue(value)}if(null!=strValue)return strValue}return null}},getAnimationStartStyle:function(ele,aniProps){for(var rstyle={},i=0;i<aniProps.length;i++){var name=aniProps[i].name,styleProp=ele.pstyle(name);void 0!==styleProp&&(styleProp=plainObject(styleProp)?this.parse(name,styleProp.strValue):this.parse(name,styleProp)),styleProp&&(rstyle[name]=styleProp)}return rstyle},getPropsList:function(propsObj){var rstyle=[],style=propsObj,props=this.properties;if(style)for(var names=Object.keys(style),i=0;i<names.length;i++){var name=names[i],val=style[name],prop=props[name]||props[camel2dash(name)],styleProp=this.parse(prop.name,val);styleProp&&rstyle.push(styleProp)}return rstyle},getNonDefaultPropertiesHash:function(ele,propNames,seed){var name,val,strVal,chVal,i,j,hash=seed.slice();for(i=0;i<propNames.length;i++)if(name=propNames[i],null!=(val=ele.pstyle(name,!1)))if(null!=val.pfValue)hash[0]=hashInt(chVal,hash[0]),hash[1]=hashIntAlt(chVal,hash[1]);else for(strVal=val.strValue,j=0;j<strVal.length;j++)chVal=strVal.charCodeAt(j),hash[0]=hashInt(chVal,hash[0]),hash[1]=hashIntAlt(chVal,hash[1]);return hash}};styfn$3.getPropertiesHash=styfn$3.getNonDefaultPropertiesHash;var styfn$4={appendFromJson:function(json){for(var i=0;i<json.length;i++){var context=json[i],selector=context.selector,props=context.style||context.css,names=Object.keys(props);this.selector(selector);for(var j=0;j<names.length;j++){var name=names[j],value=props[name];this.css(name,value)}}return this},fromJson:function(json){return this.resetToDefault(),this.appendFromJson(json),this},json:function(){for(var json=[],i=this.defaultLength;i<this.length;i++){for(var cxt=this[i],selector=cxt.selector,props=cxt.properties,css={},j=0;j<props.length;j++){var prop=props[j];css[prop.name]=prop.strValue}json.push({selector:selector?selector.toString():"core",style:css})}return json}},styfn$5={appendFromString:function(string){var selAndBlockStr,blockRem,propAndValStr,remaining=""+string;function removeSelAndBlockFromRemaining(){remaining=remaining.length>selAndBlockStr.length?remaining.substr(selAndBlockStr.length):""}function removePropAndValFromRem(){blockRem=blockRem.length>propAndValStr.length?blockRem.substr(propAndValStr.length):""}for(remaining=remaining.replace(/[/][*](\s|.)+?[*][/]/g,"");;){if(remaining.match(/^\s*$/))break;var selAndBlock=remaining.match(/^\s*((?:.|\s)+?)\s*\{((?:.|\s)+?)\}/);if(!selAndBlock){warn("Halting stylesheet parsing: String stylesheet contains more to parse but no selector and block found in: "+remaining);break}selAndBlockStr=selAndBlock[0];var selectorStr=selAndBlock[1];if("core"!==selectorStr)if(new Selector(selectorStr).invalid){warn("Skipping parsing of block: Invalid selector found in string stylesheet: "+selectorStr),removeSelAndBlockFromRemaining();continue}var blockStr=selAndBlock[2],invalidBlock=!1;blockRem=blockStr;for(var props=[];;){if(blockRem.match(/^\s*$/))break;var propAndVal=blockRem.match(/^\s*(.+?)\s*:\s*(.+?)\s*;/);if(!propAndVal){warn("Skipping parsing of block: Invalid formatting of style property and value definitions found in:"+blockStr),invalidBlock=!0;break}propAndValStr=propAndVal[0];var propStr=propAndVal[1],valStr=propAndVal[2];if(this.properties[propStr])this.parse(propStr,valStr)?(props.push({name:propStr,val:valStr}),removePropAndValFromRem()):(warn("Skipping property: Invalid property definition in: "+propAndValStr),removePropAndValFromRem());else warn("Skipping property: Invalid property name in: "+propAndValStr),removePropAndValFromRem()}if(invalidBlock){removeSelAndBlockFromRemaining();break}this.selector(selectorStr);for(var i=0;i<props.length;i++){var _prop=props[i];this.css(_prop.name,_prop.val)}removeSelAndBlockFromRemaining()}return this},fromString:function(string){return this.resetToDefault(),this.appendFromString(string),this}},styfn$6={};!function(){var number=number$1,data=function data(prefix){return"^"+prefix+"\\s*\\(\\s*([\\w\\.]+)\\s*\\)$"},mapData=function mapData(prefix){var mapArg=number+"|\\w+|rgb[a]?\\((?:(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%]?)\\s*,\\s*(?:(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%]?)\\s*,\\s*(?:(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%]?)(?:\\s*,\\s*(?:(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))))?\\)|hsl[a]?\\((?:(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?)))\\s*,\\s*(?:(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%])\\s*,\\s*(?:(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%])(?:\\s*,\\s*(?:(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))))?\\)|\\#[0-9a-fA-F]{3}|\\#[0-9a-fA-F]{6}";return"^"+prefix+"\\s*\\(([\\w\\.]+)\\s*\\,\\s*("+number+")\\s*\\,\\s*("+number+")\\s*,\\s*("+mapArg+")\\s*\\,\\s*("+mapArg+")\\)$"},urlRegexes=["^url\\s*\\(\\s*['\"]?(.+?)['\"]?\\s*\\)$","^(none)$","^(.+)$"];styfn$6.types={time:{number:!0,min:0,units:"s|ms",implicitUnits:"ms"},percent:{number:!0,min:0,max:100,units:"%",implicitUnits:"%"},percentages:{number:!0,min:0,max:100,units:"%",implicitUnits:"%",multiple:!0},zeroOneNumber:{number:!0,min:0,max:1,unitless:!0},zeroOneNumbers:{number:!0,min:0,max:1,unitless:!0,multiple:!0},nOneOneNumber:{number:!0,min:-1,max:1,unitless:!0},nonNegativeInt:{number:!0,min:0,integer:!0,unitless:!0},position:{enums:["parent","origin"]},nodeSize:{number:!0,min:0,enums:["label"]},number:{number:!0,unitless:!0},numbers:{number:!0,unitless:!0,multiple:!0},positiveNumber:{number:!0,unitless:!0,min:0,strictMin:!0},size:{number:!0,min:0},bidirectionalSize:{number:!0},bidirectionalSizeMaybePercent:{number:!0,allowPercent:!0},bidirectionalSizes:{number:!0,multiple:!0},sizeMaybePercent:{number:!0,min:0,allowPercent:!0},axisDirection:{enums:["horizontal","leftward","rightward","vertical","upward","downward","auto"]},paddingRelativeTo:{enums:["width","height","average","min","max"]},bgWH:{number:!0,min:0,allowPercent:!0,enums:["auto"],multiple:!0},bgPos:{number:!0,allowPercent:!0,multiple:!0},bgRelativeTo:{enums:["inner","include-padding"],multiple:!0},bgRepeat:{enums:["repeat","repeat-x","repeat-y","no-repeat"],multiple:!0},bgFit:{enums:["none","contain","cover"],multiple:!0},bgCrossOrigin:{enums:["anonymous","use-credentials"],multiple:!0},bgClip:{enums:["none","node"],multiple:!0},bgContainment:{enums:["inside","over"],multiple:!0},color:{color:!0},colors:{color:!0,multiple:!0},fill:{enums:["solid","linear-gradient","radial-gradient"]},bool:{enums:["yes","no"]},bools:{enums:["yes","no"],multiple:!0},lineStyle:{enums:["solid","dotted","dashed"]},lineCap:{enums:["butt","round","square"]},borderStyle:{enums:["solid","dotted","dashed","double"]},curveStyle:{enums:["bezier","unbundled-bezier","haystack","segments","straight","taxi"]},fontFamily:{regex:'^([\\w- \\"]+(?:\\s*,\\s*[\\w- \\"]+)*)$'},fontStyle:{enums:["italic","normal","oblique"]},fontWeight:{enums:["normal","bold","bolder","lighter","100","200","300","400","500","600","800","900",100,200,300,400,500,600,700,800,900]},textDecoration:{enums:["none","underline","overline","line-through"]},textTransform:{enums:["none","uppercase","lowercase"]},textWrap:{enums:["none","wrap","ellipsis"]},textOverflowWrap:{enums:["whitespace","anywhere"]},textBackgroundShape:{enums:["rectangle","roundrectangle","round-rectangle"]},nodeShape:{enums:["rectangle","roundrectangle","round-rectangle","cutrectangle","cut-rectangle","bottomroundrectangle","bottom-round-rectangle","barrel","ellipse","triangle","round-triangle","square","pentagon","round-pentagon","hexagon","round-hexagon","concavehexagon","concave-hexagon","heptagon","round-heptagon","octagon","round-octagon","tag","round-tag","star","diamond","round-diamond","vee","rhomboid","polygon"]},compoundIncludeLabels:{enums:["include","exclude"]},arrowShape:{enums:["tee","triangle","triangle-tee","circle-triangle","triangle-cross","triangle-backcurve","vee","square","circle","diamond","chevron","none"]},arrowFill:{enums:["filled","hollow"]},display:{enums:["element","none"]},visibility:{enums:["hidden","visible"]},zCompoundDepth:{enums:["bottom","orphan","auto","top"]},zIndexCompare:{enums:["auto","manual"]},valign:{enums:["top","center","bottom"]},halign:{enums:["left","center","right"]},justification:{enums:["left","center","right","auto"]},text:{string:!0},data:{mapping:!0,regex:data("data")},layoutData:{mapping:!0,regex:data("layoutData")},scratch:{mapping:!0,regex:data("scratch")},mapData:{mapping:!0,regex:mapData("mapData")},mapLayoutData:{mapping:!0,regex:mapData("mapLayoutData")},mapScratch:{mapping:!0,regex:mapData("mapScratch")},fn:{mapping:!0,fn:!0},url:{regexes:urlRegexes,singleRegexMatchValue:!0},urls:{regexes:urlRegexes,singleRegexMatchValue:!0,multiple:!0},propList:{propList:!0},angle:{number:!0,units:"deg|rad",implicitUnits:"rad"},textRotation:{number:!0,units:"deg|rad",implicitUnits:"rad",enums:["none","autorotate"]},polygonPointList:{number:!0,multiple:!0,evenMultiple:!0,min:-1,max:1,unitless:!0},edgeDistances:{enums:["intersection","node-position"]},edgeEndpoint:{number:!0,multiple:!0,units:"%|px|em|deg|rad",implicitUnits:"px",enums:["inside-to-node","outside-to-node","outside-to-node-or-label","outside-to-line","outside-to-line-or-label"],singleEnum:!0,validate:function validate(valArr,unitsArr){switch(valArr.length){case 2:return"deg"!==unitsArr[0]&&"rad"!==unitsArr[0]&&"deg"!==unitsArr[1]&&"rad"!==unitsArr[1];case 1:return string(valArr[0])||"deg"===unitsArr[0]||"rad"===unitsArr[0];default:return!1}}},easing:{regexes:["^(spring)\\s*\\(\\s*("+number+")\\s*,\\s*("+number+")\\s*\\)$","^(cubic-bezier)\\s*\\(\\s*("+number+")\\s*,\\s*("+number+")\\s*,\\s*("+number+")\\s*,\\s*("+number+")\\s*\\)$"],enums:["linear","ease","ease-in","ease-out","ease-in-out","ease-in-sine","ease-out-sine","ease-in-out-sine","ease-in-quad","ease-out-quad","ease-in-out-quad","ease-in-cubic","ease-out-cubic","ease-in-out-cubic","ease-in-quart","ease-out-quart","ease-in-out-quart","ease-in-quint","ease-out-quint","ease-in-out-quint","ease-in-expo","ease-out-expo","ease-in-out-expo","ease-in-circ","ease-out-circ","ease-in-out-circ"]},gradientDirection:{enums:["to-bottom","to-top","to-left","to-right","to-bottom-right","to-bottom-left","to-top-right","to-top-left","to-right-bottom","to-left-bottom","to-right-top","to-left-top"]},boundsExpansion:{number:!0,multiple:!0,min:0,validate:function validate(valArr){var length=valArr.length;return 1===length||2===length||4===length}}};var diff={zeroNonZero:function zeroNonZero(val1,val2){return(null==val1||null==val2)&&val1!==val2||(0==val1&&0!=val2||0!=val1&&0==val2)},any:function any(val1,val2){return val1!=val2},emptyNonEmpty:function emptyNonEmpty(str1,str2){var empty1=emptyString(str1),empty2=emptyString(str2);return empty1&&!empty2||!empty1&&empty2}},t=styfn$6.types,mainLabel=[{name:"label",type:t.text,triggersBounds:diff.any,triggersZOrder:diff.emptyNonEmpty},{name:"text-rotation",type:t.textRotation,triggersBounds:diff.any},{name:"text-margin-x",type:t.bidirectionalSize,triggersBounds:diff.any},{name:"text-margin-y",type:t.bidirectionalSize,triggersBounds:diff.any}],sourceLabel=[{name:"source-label",type:t.text,triggersBounds:diff.any},{name:"source-text-rotation",type:t.textRotation,triggersBounds:diff.any},{name:"source-text-margin-x",type:t.bidirectionalSize,triggersBounds:diff.any},{name:"source-text-margin-y",type:t.bidirectionalSize,triggersBounds:diff.any},{name:"source-text-offset",type:t.size,triggersBounds:diff.any}],targetLabel=[{name:"target-label",type:t.text,triggersBounds:diff.any},{name:"target-text-rotation",type:t.textRotation,triggersBounds:diff.any},{name:"target-text-margin-x",type:t.bidirectionalSize,triggersBounds:diff.any},{name:"target-text-margin-y",type:t.bidirectionalSize,triggersBounds:diff.any},{name:"target-text-offset",type:t.size,triggersBounds:diff.any}],labelDimensions=[{name:"font-family",type:t.fontFamily,triggersBounds:diff.any},{name:"font-style",type:t.fontStyle,triggersBounds:diff.any},{name:"font-weight",type:t.fontWeight,triggersBounds:diff.any},{name:"font-size",type:t.size,triggersBounds:diff.any},{name:"text-transform",type:t.textTransform,triggersBounds:diff.any},{name:"text-wrap",type:t.textWrap,triggersBounds:diff.any},{name:"text-overflow-wrap",type:t.textOverflowWrap,triggersBounds:diff.any},{name:"text-max-width",type:t.size,triggersBounds:diff.any},{name:"text-outline-width",type:t.size,triggersBounds:diff.any},{name:"line-height",type:t.positiveNumber,triggersBounds:diff.any}],commonLabel=[{name:"text-valign",type:t.valign,triggersBounds:diff.any},{name:"text-halign",type:t.halign,triggersBounds:diff.any},{name:"color",type:t.color},{name:"text-outline-color",type:t.color},{name:"text-outline-opacity",type:t.zeroOneNumber},{name:"text-background-color",type:t.color},{name:"text-background-opacity",type:t.zeroOneNumber},{name:"text-background-padding",type:t.size,triggersBounds:diff.any},{name:"text-border-opacity",type:t.zeroOneNumber},{name:"text-border-color",type:t.color},{name:"text-border-width",type:t.size,triggersBounds:diff.any},{name:"text-border-style",type:t.borderStyle,triggersBounds:diff.any},{name:"text-background-shape",type:t.textBackgroundShape,triggersBounds:diff.any},{name:"text-justification",type:t.justification}],behavior=[{name:"events",type:t.bool},{name:"text-events",type:t.bool}],visibility=[{name:"display",type:t.display,triggersZOrder:diff.any,triggersBounds:diff.any,triggersBoundsOfParallelBeziers:!0},{name:"visibility",type:t.visibility,triggersZOrder:diff.any},{name:"opacity",type:t.zeroOneNumber,triggersZOrder:diff.zeroNonZero},{name:"text-opacity",type:t.zeroOneNumber},{name:"min-zoomed-font-size",type:t.size},{name:"z-compound-depth",type:t.zCompoundDepth,triggersZOrder:diff.any},{name:"z-index-compare",type:t.zIndexCompare,triggersZOrder:diff.any},{name:"z-index",type:t.nonNegativeInt,triggersZOrder:diff.any}],overlay=[{name:"overlay-padding",type:t.size,triggersBounds:diff.any},{name:"overlay-color",type:t.color},{name:"overlay-opacity",type:t.zeroOneNumber,triggersBounds:diff.zeroNonZero}],transition=[{name:"transition-property",type:t.propList},{name:"transition-duration",type:t.time},{name:"transition-delay",type:t.time},{name:"transition-timing-function",type:t.easing}],nodeSizeHashOverride=function nodeSizeHashOverride(ele,parsedProp){return"label"===parsedProp.value?-ele.poolIndex():parsedProp.pfValue},nodeBody=[{name:"height",type:t.nodeSize,triggersBounds:diff.any,hashOverride:nodeSizeHashOverride},{name:"width",type:t.nodeSize,triggersBounds:diff.any,hashOverride:nodeSizeHashOverride},{name:"shape",type:t.nodeShape,triggersBounds:diff.any},{name:"shape-polygon-points",type:t.polygonPointList,triggersBounds:diff.any},{name:"background-color",type:t.color},{name:"background-fill",type:t.fill},{name:"background-opacity",type:t.zeroOneNumber},{name:"background-blacken",type:t.nOneOneNumber},{name:"background-gradient-stop-colors",type:t.colors},{name:"background-gradient-stop-positions",type:t.percentages},{name:"background-gradient-direction",type:t.gradientDirection},{name:"padding",type:t.sizeMaybePercent,triggersBounds:diff.any},{name:"padding-relative-to",type:t.paddingRelativeTo,triggersBounds:diff.any},{name:"bounds-expansion",type:t.boundsExpansion,triggersBounds:diff.any}],nodeBorder=[{name:"border-color",type:t.color},{name:"border-opacity",type:t.zeroOneNumber},{name:"border-width",type:t.size,triggersBounds:diff.any},{name:"border-style",type:t.borderStyle}],backgroundImage=[{name:"background-image",type:t.urls},{name:"background-image-crossorigin",type:t.bgCrossOrigin},{name:"background-image-opacity",type:t.zeroOneNumbers},{name:"background-image-containment",type:t.bgContainment},{name:"background-image-smoothing",type:t.bools},{name:"background-position-x",type:t.bgPos},{name:"background-position-y",type:t.bgPos},{name:"background-width-relative-to",type:t.bgRelativeTo},{name:"background-height-relative-to",type:t.bgRelativeTo},{name:"background-repeat",type:t.bgRepeat},{name:"background-fit",type:t.bgFit},{name:"background-clip",type:t.bgClip},{name:"background-width",type:t.bgWH},{name:"background-height",type:t.bgWH},{name:"background-offset-x",type:t.bgPos},{name:"background-offset-y",type:t.bgPos}],compound=[{name:"position",type:t.position,triggersBounds:diff.any},{name:"compound-sizing-wrt-labels",type:t.compoundIncludeLabels,triggersBounds:diff.any},{name:"min-width",type:t.size,triggersBounds:diff.any},{name:"min-width-bias-left",type:t.sizeMaybePercent,triggersBounds:diff.any},{name:"min-width-bias-right",type:t.sizeMaybePercent,triggersBounds:diff.any},{name:"min-height",type:t.size,triggersBounds:diff.any},{name:"min-height-bias-top",type:t.sizeMaybePercent,triggersBounds:diff.any},{name:"min-height-bias-bottom",type:t.sizeMaybePercent,triggersBounds:diff.any}],edgeLine=[{name:"line-style",type:t.lineStyle},{name:"line-color",type:t.color},{name:"line-fill",type:t.fill},{name:"line-cap",type:t.lineCap},{name:"line-opacity",type:t.zeroOneNumber},{name:"line-dash-pattern",type:t.numbers},{name:"line-dash-offset",type:t.number},{name:"line-gradient-stop-colors",type:t.colors},{name:"line-gradient-stop-positions",type:t.percentages},{name:"curve-style",type:t.curveStyle,triggersBounds:diff.any,triggersBoundsOfParallelBeziers:!0},{name:"haystack-radius",type:t.zeroOneNumber,triggersBounds:diff.any},{name:"source-endpoint",type:t.edgeEndpoint,triggersBounds:diff.any},{name:"target-endpoint",type:t.edgeEndpoint,triggersBounds:diff.any},{name:"control-point-step-size",type:t.size,triggersBounds:diff.any},{name:"control-point-distances",type:t.bidirectionalSizes,triggersBounds:diff.any},{name:"control-point-weights",type:t.numbers,triggersBounds:diff.any},{name:"segment-distances",type:t.bidirectionalSizes,triggersBounds:diff.any},{name:"segment-weights",type:t.numbers,triggersBounds:diff.any},{name:"taxi-turn",type:t.bidirectionalSizeMaybePercent,triggersBounds:diff.any},{name:"taxi-turn-min-distance",type:t.size,triggersBounds:diff.any},{name:"taxi-direction",type:t.axisDirection,triggersBounds:diff.any},{name:"edge-distances",type:t.edgeDistances,triggersBounds:diff.any},{name:"arrow-scale",type:t.positiveNumber,triggersBounds:diff.any},{name:"loop-direction",type:t.angle,triggersBounds:diff.any},{name:"loop-sweep",type:t.angle,triggersBounds:diff.any},{name:"source-distance-from-node",type:t.size,triggersBounds:diff.any},{name:"target-distance-from-node",type:t.size,triggersBounds:diff.any}],ghost=[{name:"ghost",type:t.bool,triggersBounds:diff.any},{name:"ghost-offset-x",type:t.bidirectionalSize,triggersBounds:diff.any},{name:"ghost-offset-y",type:t.bidirectionalSize,triggersBounds:diff.any},{name:"ghost-opacity",type:t.zeroOneNumber}],core=[{name:"selection-box-color",type:t.color},{name:"selection-box-opacity",type:t.zeroOneNumber},{name:"selection-box-border-color",type:t.color},{name:"selection-box-border-width",type:t.size},{name:"active-bg-color",type:t.color},{name:"active-bg-opacity",type:t.zeroOneNumber},{name:"active-bg-size",type:t.size},{name:"outside-texture-bg-color",type:t.color},{name:"outside-texture-bg-opacity",type:t.zeroOneNumber}],pie=[];styfn$6.pieBackgroundN=16,pie.push({name:"pie-size",type:t.sizeMaybePercent});for(var i=1;i<=styfn$6.pieBackgroundN;i++)pie.push({name:"pie-"+i+"-background-color",type:t.color}),pie.push({name:"pie-"+i+"-background-size",type:t.percent}),pie.push({name:"pie-"+i+"-background-opacity",type:t.zeroOneNumber});var edgeArrow=[],arrowPrefixes=styfn$6.arrowPrefixes=["source","mid-source","target","mid-target"];[{name:"arrow-shape",type:t.arrowShape,triggersBounds:diff.any},{name:"arrow-color",type:t.color},{name:"arrow-fill",type:t.arrowFill}].forEach((function(prop){arrowPrefixes.forEach((function(prefix){var name=prefix+"-"+prop.name,type=prop.type,triggersBounds=prop.triggersBounds;edgeArrow.push({name:name,type:type,triggersBounds:triggersBounds})}))}),{});var props=styfn$6.properties=[].concat(behavior,transition,visibility,overlay,ghost,commonLabel,labelDimensions,mainLabel,sourceLabel,targetLabel,nodeBody,nodeBorder,backgroundImage,pie,compound,edgeLine,edgeArrow,core),propGroups=styfn$6.propertyGroups={behavior:behavior,transition:transition,visibility:visibility,overlay:overlay,ghost:ghost,commonLabel:commonLabel,labelDimensions:labelDimensions,mainLabel:mainLabel,sourceLabel:sourceLabel,targetLabel:targetLabel,nodeBody:nodeBody,nodeBorder:nodeBorder,backgroundImage:backgroundImage,pie:pie,compound:compound,edgeLine:edgeLine,edgeArrow:edgeArrow,core:core},propGroupNames=styfn$6.propertyGroupNames={};(styfn$6.propertyGroupKeys=Object.keys(propGroups)).forEach((function(key){propGroupNames[key]=propGroups[key].map((function(prop){return prop.name})),propGroups[key].forEach((function(prop){return prop.groupKey=key}))}));var aliases=styfn$6.aliases=[{name:"content",pointsTo:"label"},{name:"control-point-distance",pointsTo:"control-point-distances"},{name:"control-point-weight",pointsTo:"control-point-weights"},{name:"edge-text-rotation",pointsTo:"text-rotation"},{name:"padding-left",pointsTo:"padding"},{name:"padding-right",pointsTo:"padding"},{name:"padding-top",pointsTo:"padding"},{name:"padding-bottom",pointsTo:"padding"}];styfn$6.propertyNames=props.map((function(p){return p.name}));for(var _i=0;_i<props.length;_i++){var prop=props[_i];props[prop.name]=prop}for(var _i2=0;_i2<aliases.length;_i2++){var alias=aliases[_i2],pointsToProp=props[alias.pointsTo],aliasProp={name:alias.name,alias:!0,pointsTo:pointsToProp};props.push(aliasProp),props[alias.name]=aliasProp}}(),styfn$6.getDefaultProperty=function(name){return this.getDefaultProperties()[name]},styfn$6.getDefaultProperties=function(){var _p=this._private;if(null!=_p.defaultProperties)return _p.defaultProperties;for(var rawProps=extend({"selection-box-color":"#ddd","selection-box-opacity":.65,"selection-box-border-color":"#aaa","selection-box-border-width":1,"active-bg-color":"black","active-bg-opacity":.15,"active-bg-size":30,"outside-texture-bg-color":"#000","outside-texture-bg-opacity":.125,events:"yes","text-events":"no","text-valign":"top","text-halign":"center","text-justification":"auto","line-height":1,color:"#000","text-outline-color":"#000","text-outline-width":0,"text-outline-opacity":1,"text-opacity":1,"text-decoration":"none","text-transform":"none","text-wrap":"none","text-overflow-wrap":"whitespace","text-max-width":9999,"text-background-color":"#000","text-background-opacity":0,"text-background-shape":"rectangle","text-background-padding":0,"text-border-opacity":0,"text-border-width":0,"text-border-style":"solid","text-border-color":"#000","font-family":"Helvetica Neue, Helvetica, sans-serif","font-style":"normal","font-weight":"normal","font-size":16,"min-zoomed-font-size":0,"text-rotation":"none","source-text-rotation":"none","target-text-rotation":"none",visibility:"visible",display:"element",opacity:1,"z-compound-depth":"auto","z-index-compare":"auto","z-index":0,label:"","text-margin-x":0,"text-margin-y":0,"source-label":"","source-text-offset":0,"source-text-margin-x":0,"source-text-margin-y":0,"target-label":"","target-text-offset":0,"target-text-margin-x":0,"target-text-margin-y":0,"overlay-opacity":0,"overlay-color":"#000","overlay-padding":10,"transition-property":"none","transition-duration":0,"transition-delay":0,"transition-timing-function":"linear","background-blacken":0,"background-color":"#999","background-fill":"solid","background-opacity":1,"background-image":"none","background-image-crossorigin":"anonymous","background-image-opacity":1,"background-image-containment":"inside","background-image-smoothing":"yes","background-position-x":"50%","background-position-y":"50%","background-offset-x":0,"background-offset-y":0,"background-width-relative-to":"include-padding","background-height-relative-to":"include-padding","background-repeat":"no-repeat","background-fit":"none","background-clip":"node","background-width":"auto","background-height":"auto","border-color":"#000","border-opacity":1,"border-width":0,"border-style":"solid",height:30,width:30,shape:"ellipse","shape-polygon-points":"-1, -1,   1, -1,   1, 1,   -1, 1","bounds-expansion":0,"background-gradient-direction":"to-bottom","background-gradient-stop-colors":"#999","background-gradient-stop-positions":"0%",ghost:"no","ghost-offset-y":0,"ghost-offset-x":0,"ghost-opacity":0,padding:0,"padding-relative-to":"width",position:"origin","compound-sizing-wrt-labels":"include","min-width":0,"min-width-bias-left":0,"min-width-bias-right":0,"min-height":0,"min-height-bias-top":0,"min-height-bias-bottom":0},{"pie-size":"100%"},[{name:"pie-{{i}}-background-color",value:"black"},{name:"pie-{{i}}-background-size",value:"0%"},{name:"pie-{{i}}-background-opacity",value:1}].reduce((function(css,prop){for(var i=1;i<=styfn$6.pieBackgroundN;i++){var name=prop.name.replace("{{i}}",i),val=prop.value;css[name]=val}return css}),{}),{"line-style":"solid","line-color":"#999","line-fill":"solid","line-cap":"butt","line-opacity":1,"line-gradient-stop-colors":"#999","line-gradient-stop-positions":"0%","control-point-step-size":40,"control-point-weights":.5,"segment-weights":.5,"segment-distances":20,"taxi-turn":"50%","taxi-turn-min-distance":10,"taxi-direction":"auto","edge-distances":"intersection","curve-style":"haystack","haystack-radius":0,"arrow-scale":1,"loop-direction":"-45deg","loop-sweep":"-90deg","source-distance-from-node":0,"target-distance-from-node":0,"source-endpoint":"outside-to-node","target-endpoint":"outside-to-node","line-dash-pattern":[6,3],"line-dash-offset":0},[{name:"arrow-shape",value:"none"},{name:"arrow-color",value:"#999"},{name:"arrow-fill",value:"filled"}].reduce((function(css,prop){return styfn$6.arrowPrefixes.forEach((function(prefix){var name=prefix+"-"+prop.name,val=prop.value;css[name]=val})),css}),{})),parsedProps={},i=0;i<this.properties.length;i++){var prop=this.properties[i];if(!prop.pointsTo){var name=prop.name,val=rawProps[name],parsedProp=this.parse(name,val);parsedProps[name]=parsedProp}}return _p.defaultProperties=parsedProps,_p.defaultProperties},styfn$6.addDefaultStylesheet=function(){this.selector(":parent").css({shape:"rectangle",padding:10,"background-color":"#eee","border-color":"#ccc","border-width":1}).selector("edge").css({width:3}).selector(":loop").css({"curve-style":"bezier"}).selector("edge:compound").css({"curve-style":"bezier","source-endpoint":"outside-to-line","target-endpoint":"outside-to-line"}).selector(":selected").css({"background-color":"#0169D9","line-color":"#0169D9","source-arrow-color":"#0169D9","target-arrow-color":"#0169D9","mid-source-arrow-color":"#0169D9","mid-target-arrow-color":"#0169D9"}).selector(":parent:selected").css({"background-color":"#CCE1F9","border-color":"#aec8e5"}).selector(":active").css({"overlay-color":"black","overlay-padding":10,"overlay-opacity":.25}),this.defaultLength=this.length};var styfn$7={parse:function(name,value,propIsBypass,propIsFlat){if(fn(value))return this.parseImplWarn(name,value,propIsBypass,propIsFlat);var ret,argHash=hashStrings(name,""+value,propIsBypass?"t":"f","mapping"===propIsFlat||!0===propIsFlat||!1===propIsFlat||null==propIsFlat?"dontcare":propIsFlat),propCache=this.propCache=this.propCache||[];return(ret=propCache[argHash])||(ret=propCache[argHash]=this.parseImplWarn(name,value,propIsBypass,propIsFlat)),(propIsBypass||"mapping"===propIsFlat)&&(ret=copy(ret))&&(ret.value=copy(ret.value)),ret},parseImplWarn:function(name,value,propIsBypass,propIsFlat){var prop=this.parseImpl(name,value,propIsBypass,propIsFlat);return prop||null==value||warn("The style property `".concat(name,": ").concat(value,"` is invalid")),!prop||"width"!==prop.name&&"height"!==prop.name||"label"!==value||warn("The style value of `label` is deprecated for `"+prop.name+"`"),prop}};styfn$7.parseImpl=function(name,value,propIsBypass,propIsFlat){name=camel2dash(name);var property=this.properties[name],passedValue=value,types=this.types;if(!property)return null;if(void 0===value)return null;property.alias&&(property=property.pointsTo,name=property.name);var valueIsString=string(value);valueIsString&&(value=value.trim());var data,mapData,type=property.type;if(!type)return null;if(propIsBypass&&(""===value||null===value))return{name:name,value:value,bypass:!0,deleteBypass:!0};if(fn(value))return{name:name,value:value,strValue:"fn",mapped:types.fn,bypass:propIsBypass};if(!valueIsString||propIsFlat||value.length<7||"a"!==value[1]);else{if(value.length>=7&&"d"===value[0]&&(data=new RegExp(types.data.regex).exec(value))){if(propIsBypass)return!1;var mapped=types.data;return{name:name,value:data,strValue:""+value,mapped:mapped,field:data[1],bypass:propIsBypass}}if(value.length>=10&&"m"===value[0]&&(mapData=new RegExp(types.mapData.regex).exec(value))){if(propIsBypass)return!1;if(type.multiple)return!1;var _mapped=types.mapData;if(!type.color&&!type.number)return!1;var valueMin=this.parse(name,mapData[4]);if(!valueMin||valueMin.mapped)return!1;var valueMax=this.parse(name,mapData[5]);if(!valueMax||valueMax.mapped)return!1;if(valueMin.pfValue===valueMax.pfValue||valueMin.strValue===valueMax.strValue)return warn("`"+name+": "+value+"` is not a valid mapper because the output range is zero; converting to `"+name+": "+valueMin.strValue+"`"),this.parse(name,valueMin.strValue);if(type.color){var c1=valueMin.value,c2=valueMax.value;if(!(c1[0]!==c2[0]||c1[1]!==c2[1]||c1[2]!==c2[2]||c1[3]!==c2[3]&&(null!=c1[3]&&1!==c1[3]||null!=c2[3]&&1!==c2[3])))return!1}return{name:name,value:mapData,strValue:""+value,mapped:_mapped,field:mapData[1],fieldMin:parseFloat(mapData[2]),fieldMax:parseFloat(mapData[3]),valueMin:valueMin.value,valueMax:valueMax.value,bypass:propIsBypass}}}if(type.multiple&&"multiple"!==propIsFlat){var vals;if(vals=valueIsString?value.split(/\s+/):array(value)?value:[value],type.evenMultiple&&vals.length%2!=0)return null;for(var valArr=[],unitsArr=[],pfValArr=[],strVal="",hasEnum=!1,i=0;i<vals.length;i++){var p=this.parse(name,vals[i],propIsBypass,"multiple");hasEnum=hasEnum||string(p.value),valArr.push(p.value),pfValArr.push(null!=p.pfValue?p.pfValue:p.value),unitsArr.push(p.units),strVal+=(i>0?" ":"")+p.strValue}return type.validate&&!type.validate(valArr,unitsArr)?null:type.singleEnum&&hasEnum?1===valArr.length&&string(valArr[0])?{name:name,value:valArr[0],strValue:valArr[0],bypass:propIsBypass}:null:{name:name,value:valArr,pfValue:pfValArr,strValue:strVal,bypass:propIsBypass,units:unitsArr}}var checkEnums=function checkEnums(){for(var _i=0;_i<type.enums.length;_i++){if(type.enums[_i]===value)return{name:name,value:value,strValue:""+value,bypass:propIsBypass}}return null};if(type.number){var units,implicitUnits="px";if(type.units&&(units=type.units),type.implicitUnits&&(implicitUnits=type.implicitUnits),!type.unitless)if(valueIsString){var unitsRegex="px|em"+(type.allowPercent?"|\\%":"");units&&(unitsRegex=units);var match=value.match("^("+number$1+")("+unitsRegex+")?$");match&&(value=match[1],units=match[2]||implicitUnits)}else units&&!type.implicitUnits||(units=implicitUnits);if(value=parseFloat(value),isNaN(value)&&void 0===type.enums)return null;if(isNaN(value)&&void 0!==type.enums)return value=passedValue,checkEnums();if(type.integer&&!function integer(obj){return number(obj)&&Math.floor(obj)===obj}(value))return null;if(void 0!==type.min&&(value<type.min||type.strictMin&&value===type.min)||void 0!==type.max&&(value>type.max||type.strictMax&&value===type.max))return null;var ret={name:name,value:value,strValue:""+value+(units||""),units:units,bypass:propIsBypass};return type.unitless||"px"!==units&&"em"!==units?ret.pfValue=value:ret.pfValue="px"!==units&&units?this.getEmSizeInPixels()*value:value,"ms"!==units&&"s"!==units||(ret.pfValue="ms"===units?value:1e3*value),"deg"!==units&&"rad"!==units||(ret.pfValue="rad"===units?value:function deg2rad(deg){return Math.PI*deg/180}(value)),"%"===units&&(ret.pfValue=value/100),ret}if(type.propList){var props=[],propsStr=""+value;if("none"===propsStr);else{for(var propsSplit=propsStr.split(/\s*,\s*|\s+/),_i2=0;_i2<propsSplit.length;_i2++){var propName=propsSplit[_i2].trim();this.properties[propName]?props.push(propName):warn("`"+propName+"` is not a valid property name")}if(0===props.length)return null}return{name:name,value:props,strValue:0===props.length?"none":props.join(" "),bypass:propIsBypass}}if(type.color){var tuple=color2tuple(value);return tuple?{name:name,value:tuple,pfValue:tuple,strValue:"rgb("+tuple[0]+","+tuple[1]+","+tuple[2]+")",bypass:propIsBypass}:null}if(type.regex||type.regexes){if(type.enums){var enumProp=checkEnums();if(enumProp)return enumProp}for(var regexes=type.regexes?type.regexes:[type.regex],_i3=0;_i3<regexes.length;_i3++){var m=new RegExp(regexes[_i3]).exec(value);if(m)return{name:name,value:type.singleRegexMatchValue?m[1]:m,strValue:""+value,bypass:propIsBypass}}return null}return type.string?{name:name,value:""+value,strValue:""+value,bypass:propIsBypass}:type.enums?checkEnums():null};var Style=function Style(cy){if(!(this instanceof Style))return new Style(cy);core(cy)?(this._private={cy:cy,coreStyle:{}},this.length=0,this.resetToDefault()):error("A style must have a core reference")},styfn$8=Style.prototype;styfn$8.instanceString=function(){return"style"},styfn$8.clear=function(){for(var _p=this._private,eles=_p.cy.elements(),i=0;i<this.length;i++)this[i]=void 0;return this.length=0,_p.contextStyles={},_p.propDiffs={},this.cleanElements(eles,!0),eles.forEach((function(ele){var ele_p=ele[0]._private;ele_p.styleDirty=!0,ele_p.appliedInitStyle=!1})),this},styfn$8.resetToDefault=function(){return this.clear(),this.addDefaultStylesheet(),this},styfn$8.core=function(propName){return this._private.coreStyle[propName]||this.getDefaultProperty(propName)},styfn$8.selector=function(selectorStr){var selector="core"===selectorStr?null:new Selector(selectorStr),i=this.length++;return this[i]={selector:selector,properties:[],mappedProperties:[],index:i},this},styfn$8.css=function(){var self=this,args=arguments;if(1===args.length)for(var map=args[0],i=0;i<self.properties.length;i++){var prop=self.properties[i],mapVal=map[prop.name];void 0===mapVal&&(mapVal=map[dash2camel(prop.name)]),void 0!==mapVal&&this.cssRule(prop.name,mapVal)}else 2===args.length&&this.cssRule(args[0],args[1]);return this},styfn$8.style=styfn$8.css,styfn$8.cssRule=function(name,value){var property=this.parse(name,value);if(property){var i=this.length-1;this[i].properties.push(property),this[i].properties[property.name]=property,property.name.match(/pie-(\d+)-background-size/)&&property.value&&(this._private.hasPie=!0),property.mapped&&this[i].mappedProperties.push(property),!this[i].selector&&(this._private.coreStyle[property.name]=property)}return this},styfn$8.append=function(style){return stylesheet(style)?style.appendToStyle(this):array(style)?this.appendFromJson(style):string(style)&&this.appendFromString(style),this},Style.fromJson=function(cy,json){var style=new Style(cy);return style.fromJson(json),style},Style.fromString=function(cy,string){return new Style(cy).fromString(string)},[styfn,styfn$1,styfn$2,styfn$3,styfn$4,styfn$5,styfn$6,styfn$7].forEach((function(props){extend(styfn$8,props)})),Style.types=styfn$8.types,Style.properties=styfn$8.properties,Style.propertyGroups=styfn$8.propertyGroups,Style.propertyGroupNames=styfn$8.propertyGroupNames,Style.propertyGroupKeys=styfn$8.propertyGroupKeys;var corefn$7={style:function style(newStyle){newStyle&&this.setStyle(newStyle).update();return this._private.style},setStyle:function setStyle(style){var _p=this._private;return stylesheet(style)?_p.style=style.generateStyle(this):array(style)?_p.style=Style.fromJson(this,style):string(style)?_p.style=Style.fromString(this,style):_p.style=Style(this),_p.style},updateStyle:function updateStyle(){this.mutableElements().updateStyle()}},corefn$8={autolock:function autolock(bool){return void 0===bool?this._private.autolock:(this._private.autolock=!!bool,this)},autoungrabify:function autoungrabify(bool){return void 0===bool?this._private.autoungrabify:(this._private.autoungrabify=!!bool,this)},autounselectify:function autounselectify(bool){return void 0===bool?this._private.autounselectify:(this._private.autounselectify=!!bool,this)},selectionType:function selectionType(selType){var _p=this._private;return null==_p.selectionType&&(_p.selectionType="single"),void 0===selType?_p.selectionType:("additive"!==selType&&"single"!==selType||(_p.selectionType=selType),this)},panningEnabled:function panningEnabled(bool){return void 0===bool?this._private.panningEnabled:(this._private.panningEnabled=!!bool,this)},userPanningEnabled:function userPanningEnabled(bool){return void 0===bool?this._private.userPanningEnabled:(this._private.userPanningEnabled=!!bool,this)},zoomingEnabled:function zoomingEnabled(bool){return void 0===bool?this._private.zoomingEnabled:(this._private.zoomingEnabled=!!bool,this)},userZoomingEnabled:function userZoomingEnabled(bool){return void 0===bool?this._private.userZoomingEnabled:(this._private.userZoomingEnabled=!!bool,this)},boxSelectionEnabled:function boxSelectionEnabled(bool){return void 0===bool?this._private.boxSelectionEnabled:(this._private.boxSelectionEnabled=!!bool,this)},pan:function pan(){var dim,val,dims,x,y,args=arguments,pan=this._private.pan;switch(args.length){case 0:return pan;case 1:if(string(args[0]))return pan[dim=args[0]];if(plainObject(args[0])){if(!this._private.panningEnabled)return this;x=(dims=args[0]).x,y=dims.y,number(x)&&(pan.x=x),number(y)&&(pan.y=y),this.emit("pan viewport")}break;case 2:if(!this._private.panningEnabled)return this;dim=args[0],val=args[1],"x"!==dim&&"y"!==dim||!number(val)||(pan[dim]=val),this.emit("pan viewport")}return this.notify("viewport"),this},panBy:function panBy(arg0,arg1){var dim,val,dims,x,y,args=arguments,pan=this._private.pan;if(!this._private.panningEnabled)return this;switch(args.length){case 1:plainObject(arg0)&&(x=(dims=args[0]).x,y=dims.y,number(x)&&(pan.x+=x),number(y)&&(pan.y+=y),this.emit("pan viewport"));break;case 2:val=arg1,"x"!==(dim=arg0)&&"y"!==dim||!number(val)||(pan[dim]+=val),this.emit("pan viewport")}return this.notify("viewport"),this},fit:function fit(elements,padding){var viewportState=this.getFitViewport(elements,padding);if(viewportState){var _p=this._private;_p.zoom=viewportState.zoom,_p.pan=viewportState.pan,this.emit("pan zoom viewport"),this.notify("viewport")}return this},getFitViewport:function getFitViewport(elements,padding){if(number(elements)&&void 0===padding&&(padding=elements,elements=void 0),this._private.panningEnabled&&this._private.zoomingEnabled){var bb;if(string(elements)){var sel=elements;elements=this.$(sel)}else if(function boundingBox(obj){return plainObject(obj)&&number(obj.x1)&&number(obj.x2)&&number(obj.y1)&&number(obj.y2)}(elements)){var bbe=elements;(bb={x1:bbe.x1,y1:bbe.y1,x2:bbe.x2,y2:bbe.y2}).w=bb.x2-bb.x1,bb.h=bb.y2-bb.y1}else elementOrCollection(elements)||(elements=this.mutableElements());if(!elementOrCollection(elements)||!elements.empty()){bb=bb||elements.boundingBox();var zoom,w=this.width(),h=this.height();if(padding=number(padding)?padding:0,!isNaN(w)&&!isNaN(h)&&w>0&&h>0&&!isNaN(bb.w)&&!isNaN(bb.h)&&bb.w>0&&bb.h>0)return{zoom:zoom=(zoom=(zoom=Math.min((w-2*padding)/bb.w,(h-2*padding)/bb.h))>this._private.maxZoom?this._private.maxZoom:zoom)<this._private.minZoom?this._private.minZoom:zoom,pan:{x:(w-zoom*(bb.x1+bb.x2))/2,y:(h-zoom*(bb.y1+bb.y2))/2}}}}},zoomRange:function zoomRange(min,max){var _p=this._private;if(null==max){var opts=min;min=opts.min,max=opts.max}return number(min)&&number(max)&&min<=max?(_p.minZoom=min,_p.maxZoom=max):number(min)&&void 0===max&&min<=_p.maxZoom?_p.minZoom=min:number(max)&&void 0===min&&max>=_p.minZoom&&(_p.maxZoom=max),this},minZoom:function minZoom(zoom){return void 0===zoom?this._private.minZoom:this.zoomRange({min:zoom})},maxZoom:function maxZoom(zoom){return void 0===zoom?this._private.maxZoom:this.zoomRange({max:zoom})},getZoomedViewport:function getZoomedViewport(params){var pos,zoom,_p=this._private,currentPan=_p.pan,currentZoom=_p.zoom,bail=!1;if(_p.zoomingEnabled||(bail=!0),number(params)?zoom=params:plainObject(params)&&(zoom=params.level,null!=params.position?pos=modelToRenderedPosition(params.position,currentZoom,currentPan):null!=params.renderedPosition&&(pos=params.renderedPosition),null==pos||_p.panningEnabled||(bail=!0)),zoom=(zoom=zoom>_p.maxZoom?_p.maxZoom:zoom)<_p.minZoom?_p.minZoom:zoom,bail||!number(zoom)||zoom===currentZoom||null!=pos&&(!number(pos.x)||!number(pos.y)))return null;if(null!=pos){var pan1=currentPan,zoom1=currentZoom,zoom2=zoom;return{zoomed:!0,panned:!0,zoom:zoom2,pan:{x:-zoom2/zoom1*(pos.x-pan1.x)+pos.x,y:-zoom2/zoom1*(pos.y-pan1.y)+pos.y}}}return{zoomed:!0,panned:!1,zoom:zoom,pan:currentPan}},zoom:function zoom(params){if(void 0===params)return this._private.zoom;var vp=this.getZoomedViewport(params),_p=this._private;return null!=vp&&vp.zoomed?(_p.zoom=vp.zoom,vp.panned&&(_p.pan.x=vp.pan.x,_p.pan.y=vp.pan.y),this.emit("zoom"+(vp.panned?" pan":"")+" viewport"),this.notify("viewport"),this):this},viewport:function viewport(opts){var _p=this._private,zoomDefd=!0,panDefd=!0,events=[],zoomFailed=!1,panFailed=!1;if(!opts)return this;if(number(opts.zoom)||(zoomDefd=!1),plainObject(opts.pan)||(panDefd=!1),!zoomDefd&&!panDefd)return this;if(zoomDefd){var z=opts.zoom;z<_p.minZoom||z>_p.maxZoom||!_p.zoomingEnabled?zoomFailed=!0:(_p.zoom=z,events.push("zoom"))}if(panDefd&&(!zoomFailed||!opts.cancelOnFailedZoom)&&_p.panningEnabled){var p=opts.pan;number(p.x)&&(_p.pan.x=p.x,panFailed=!1),number(p.y)&&(_p.pan.y=p.y,panFailed=!1),panFailed||events.push("pan")}return events.length>0&&(events.push("viewport"),this.emit(events.join(" ")),this.notify("viewport")),this},center:function center(elements){var pan=this.getCenterPan(elements);return pan&&(this._private.pan=pan,this.emit("pan viewport"),this.notify("viewport")),this},getCenterPan:function getCenterPan(elements,zoom){if(this._private.panningEnabled){if(string(elements)){var selector=elements;elements=this.mutableElements().filter(selector)}else elementOrCollection(elements)||(elements=this.mutableElements());if(0!==elements.length){var bb=elements.boundingBox(),w=this.width(),h=this.height();return{x:(w-(zoom=void 0===zoom?this._private.zoom:zoom)*(bb.x1+bb.x2))/2,y:(h-zoom*(bb.y1+bb.y2))/2}}}},reset:function reset(){return this._private.panningEnabled&&this._private.zoomingEnabled?(this.viewport({pan:{x:0,y:0},zoom:1}),this):this},invalidateSize:function invalidateSize(){this._private.sizeCache=null},size:function size(){var style,val,_p=this._private,container=_p.container;return _p.sizeCache=_p.sizeCache||(container?(style=window$1.getComputedStyle(container),val=function val(name){return parseFloat(style.getPropertyValue(name))},{width:container.clientWidth-val("padding-left")-val("padding-right"),height:container.clientHeight-val("padding-top")-val("padding-bottom")}):{width:1,height:1})},width:function width(){return this.size().width},height:function height(){return this.size().height},extent:function extent(){var pan=this._private.pan,zoom=this._private.zoom,rb=this.renderedExtent(),b={x1:(rb.x1-pan.x)/zoom,x2:(rb.x2-pan.x)/zoom,y1:(rb.y1-pan.y)/zoom,y2:(rb.y2-pan.y)/zoom};return b.w=b.x2-b.x1,b.h=b.y2-b.y1,b},renderedExtent:function renderedExtent(){var width=this.width(),height=this.height();return{x1:0,y1:0,x2:width,y2:height,w:width,h:height}}};corefn$8.centre=corefn$8.center,corefn$8.autolockNodes=corefn$8.autolock,corefn$8.autoungrabifyNodes=corefn$8.autoungrabify;var fn$6={data:define$3.data({field:"data",bindingEvent:"data",allowBinding:!0,allowSetting:!0,settingEvent:"data",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeData:define$3.removeData({field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0}),scratch:define$3.data({field:"scratch",bindingEvent:"scratch",allowBinding:!0,allowSetting:!0,settingEvent:"scratch",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeScratch:define$3.removeData({field:"scratch",event:"scratch",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0})};fn$6.attr=fn$6.data,fn$6.removeAttr=fn$6.removeData;var Core=function Core(opts){var cy=this,container=(opts=extend({},opts)).container;container&&!htmlElement(container)&&htmlElement(container[0])&&(container=container[0]);var reg=container?container._cyreg:null;(reg=reg||{})&&reg.cy&&(reg.cy.destroy(),reg={});var readies=reg.readies=reg.readies||[];container&&(container._cyreg=reg),reg.cy=cy;var head=void 0!==window$1&&void 0!==container&&!opts.headless,options=opts;options.layout=extend({name:head?"grid":"null"},options.layout),options.renderer=extend({name:head?"canvas":"null"},options.renderer);var defVal=function defVal(def,val,altVal){return void 0!==val?val:void 0!==altVal?altVal:def},_p=this._private={container:container,ready:!1,options:options,elements:new Collection(this),listeners:[],aniEles:new Collection(this),data:options.data||{},scratch:{},layout:null,renderer:null,destroyed:!1,notificationsEnabled:!0,minZoom:1e-50,maxZoom:1e50,zoomingEnabled:defVal(!0,options.zoomingEnabled),userZoomingEnabled:defVal(!0,options.userZoomingEnabled),panningEnabled:defVal(!0,options.panningEnabled),userPanningEnabled:defVal(!0,options.userPanningEnabled),boxSelectionEnabled:defVal(!0,options.boxSelectionEnabled),autolock:defVal(!1,options.autolock,options.autolockNodes),autoungrabify:defVal(!1,options.autoungrabify,options.autoungrabifyNodes),autounselectify:defVal(!1,options.autounselectify),styleEnabled:void 0===options.styleEnabled?head:options.styleEnabled,zoom:number(options.zoom)?options.zoom:1,pan:{x:plainObject(options.pan)&&number(options.pan.x)?options.pan.x:0,y:plainObject(options.pan)&&number(options.pan.y)?options.pan.y:0},animation:{current:[],queue:[]},hasCompoundNodes:!1};this.createEmitter(),this.selectionType(options.selectionType),this.zoomRange({min:options.minZoom,max:options.maxZoom});_p.styleEnabled&&cy.setStyle([]);var rendererOptions=extend({},options,options.renderer);cy.initRenderer(rendererOptions);!function loadExtData(extData,next){if(extData.some(promise))return Promise$1.all(extData).then(next);next(extData)}([options.style,options.elements],(function(thens){var initStyle=thens[0],initEles=thens[1];_p.styleEnabled&&cy.style().append(initStyle),function setElesAndLayout(elements,onload,ondone){cy.notifications(!1);var oldEles=cy.mutableElements();oldEles.length>0&&oldEles.remove(),null!=elements&&(plainObject(elements)||array(elements))&&cy.add(elements),cy.one("layoutready",(function(e){cy.notifications(!0),cy.emit(e),cy.one("load",onload),cy.emitAndNotify("load")})).one("layoutstop",(function(){cy.one("done",ondone),cy.emit("done")}));var layoutOpts=extend({},cy._private.options.layout);layoutOpts.eles=cy.elements(),cy.layout(layoutOpts).run()}(initEles,(function(){cy.startAnimationLoop(),_p.ready=!0,fn(options.ready)&&cy.on("ready",options.ready);for(var i=0;i<readies.length;i++){var fn$1=readies[i];cy.on("ready",fn$1)}reg&&(reg.readies=[]),cy.emit("ready")}),options.done)}))},corefn$9=Core.prototype;extend(corefn$9,{instanceString:function instanceString(){return"core"},isReady:function isReady(){return this._private.ready},destroyed:function destroyed(){return this._private.destroyed},ready:function ready(fn){return this.isReady()?this.emitter().emit("ready",[],fn):this.on("ready",fn),this},destroy:function destroy(){var cy=this;if(!cy.destroyed())return cy.stopAnimationLoop(),cy.destroyRenderer(),this.emit("destroy"),cy._private.destroyed=!0,cy},hasElementWithId:function hasElementWithId(id){return this._private.elements.hasElementWithId(id)},getElementById:function getElementById(id){return this._private.elements.getElementById(id)},hasCompoundNodes:function hasCompoundNodes(){return this._private.hasCompoundNodes},headless:function headless(){return this._private.renderer.isHeadless()},styleEnabled:function styleEnabled(){return this._private.styleEnabled},addToPool:function addToPool(eles){return this._private.elements.merge(eles),this},removeFromPool:function removeFromPool(eles){return this._private.elements.unmerge(eles),this},container:function container(){return this._private.container||null},mount:function mount(container){if(null!=container){var cy=this,_p=cy._private,options=_p.options;return!htmlElement(container)&&htmlElement(container[0])&&(container=container[0]),cy.stopAnimationLoop(),cy.destroyRenderer(),_p.container=container,_p.styleEnabled=!0,cy.invalidateSize(),cy.initRenderer(extend({},options,options.renderer,{name:"null"===options.renderer.name?"canvas":options.renderer.name})),cy.startAnimationLoop(),cy.style(options.style),cy.emit("mount"),cy}},unmount:function unmount(){var cy=this;return cy.stopAnimationLoop(),cy.destroyRenderer(),cy.initRenderer({name:"null"}),cy.emit("unmount"),cy},options:function options(){return copy(this._private.options)},json:function json(obj){var cy=this,_p=cy._private,eles=cy.mutableElements();if(plainObject(obj)){if(cy.startBatch(),obj.elements){var idInJson={},updateEles=function updateEles(jsons,gr){for(var toAdd=[],toMod=[],i=0;i<jsons.length;i++){var json=jsons[i];if(json.data.id){var id=""+json.data.id,ele=cy.getElementById(id);idInJson[id]=!0,0!==ele.length?toMod.push({ele:ele,json:json}):gr?(json.group=gr,toAdd.push(json)):toAdd.push(json)}else warn("cy.json() cannot handle elements without an ID attribute")}cy.add(toAdd);for(var _i=0;_i<toMod.length;_i++){var _toMod$_i=toMod[_i],_ele=_toMod$_i.ele,_json=_toMod$_i.json;_ele.json(_json)}};if(array(obj.elements))updateEles(obj.elements);else for(var grs=["nodes","edges"],i=0;i<grs.length;i++){var gr=grs[i],elements=obj.elements[gr];array(elements)&&updateEles(elements,gr)}var parentsToRemove=cy.collection();eles.filter((function(ele){return!idInJson[ele.id()]})).forEach((function(ele){ele.isParent()?parentsToRemove.merge(ele):ele.remove()})),parentsToRemove.forEach((function(ele){return ele.children().move({parent:null})})),parentsToRemove.forEach((function(ele){return function getFreshRef(ele){return cy.getElementById(ele.id())}(ele).remove()}))}obj.style&&cy.style(obj.style),null!=obj.zoom&&obj.zoom!==_p.zoom&&cy.zoom(obj.zoom),obj.pan&&(obj.pan.x===_p.pan.x&&obj.pan.y===_p.pan.y||cy.pan(obj.pan)),obj.data&&cy.data(obj.data);for(var fields=["minZoom","maxZoom","zoomingEnabled","userZoomingEnabled","panningEnabled","userPanningEnabled","boxSelectionEnabled","autolock","autoungrabify","autounselectify"],_i2=0;_i2<fields.length;_i2++){var f=fields[_i2];null!=obj[f]&&cy[f](obj[f])}return cy.endBatch(),this}var json={};!!obj?json.elements=this.elements().map((function(ele){return ele.json()})):(json.elements={},eles.forEach((function(ele){var group=ele.group();json.elements[group]||(json.elements[group]=[]),json.elements[group].push(ele.json())}))),this._private.styleEnabled&&(json.style=cy.style().json()),json.data=copy(cy.data());var options=_p.options;return json.zoomingEnabled=_p.zoomingEnabled,json.userZoomingEnabled=_p.userZoomingEnabled,json.zoom=_p.zoom,json.minZoom=_p.minZoom,json.maxZoom=_p.maxZoom,json.panningEnabled=_p.panningEnabled,json.userPanningEnabled=_p.userPanningEnabled,json.pan=copy(_p.pan),json.boxSelectionEnabled=_p.boxSelectionEnabled,json.renderer=copy(options.renderer),json.hideEdgesOnViewport=options.hideEdgesOnViewport,json.textureOnViewport=options.textureOnViewport,json.wheelSensitivity=options.wheelSensitivity,json.motionBlur=options.motionBlur,json}}),corefn$9.$id=corefn$9.getElementById,[corefn,corefn$1,elesfn$v,corefn$2,corefn$3,corefn$4,corefn$5,corefn$6,corefn$7,corefn$8,fn$6].forEach((function(props){extend(corefn$9,props)}));var defaults$9={fit:!0,directed:!1,padding:30,circle:!1,grid:!1,spacingFactor:1.75,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,roots:void 0,maximal:!1,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function animateFilter(node,i){return!0},ready:void 0,stop:void 0,transform:function transform(node,position){return position}},getInfo=function getInfo(ele){return ele.scratch("breadthfirst")},setInfo=function setInfo(ele,obj){return ele.scratch("breadthfirst",obj)};function BreadthFirstLayout(options){this.options=extend({},defaults$9,options)}BreadthFirstLayout.prototype.run=function(){var roots,params=this.options,options=params,cy=params.cy,eles=options.eles,nodes=eles.nodes().filter((function(n){return!n.isParent()})),graph=eles,directed=options.directed,maximal=options.maximal||options.maximalAdjustments>0,bb=makeBoundingBox(options.boundingBox?options.boundingBox:{x1:0,y1:0,w:cy.width(),h:cy.height()});if(elementOrCollection(options.roots))roots=options.roots;else if(array(options.roots)){for(var rootsArray=[],i=0;i<options.roots.length;i++){var id=options.roots[i],ele=cy.getElementById(id);rootsArray.push(ele)}roots=cy.collection(rootsArray)}else if(string(options.roots))roots=cy.$(options.roots);else if(directed)roots=nodes.roots();else{var components=eles.components();roots=cy.collection();for(var _loop=function _loop(_i){var comp=components[_i],maxDegree=comp.maxDegree(!1),compRoots=comp.filter((function(ele){return ele.degree(!1)===maxDegree}));roots=roots.add(compRoots)},_i=0;_i<components.length;_i++)_loop(_i)}var depths=[],foundByBfs={},addToDepth=function addToDepth(ele,d){null==depths[d]&&(depths[d]=[]);var i=depths[d].length;depths[d].push(ele),setInfo(ele,{index:i,depth:d})};graph.bfs({roots:roots,directed:options.directed,visit:function visit(node,edge,pNode,i,depth){var ele=node[0],id=ele.id();addToDepth(ele,depth),foundByBfs[id]=!0}});for(var orphanNodes=[],_i2=0;_i2<nodes.length;_i2++){var _ele=nodes[_i2];foundByBfs[_ele.id()]||orphanNodes.push(_ele)}var assignDepthsAt=function assignDepthsAt(i){for(var eles=depths[i],j=0;j<eles.length;j++){var _ele2=eles[j];null!=_ele2?setInfo(_ele2,{depth:i,index:j}):(eles.splice(j,1),j--)}},assignDepths=function assignDepths(){for(var _i3=0;_i3<depths.length;_i3++)assignDepthsAt(_i3)},adjustMaximally=function adjustMaximally(ele,shifted){for(var eInfo=getInfo(ele),incomers=ele.incomers().filter((function(el){return el.isNode()&&eles.has(el)})),maxDepth=-1,id=ele.id(),k=0;k<incomers.length;k++){var incmr=incomers[k],iInfo=getInfo(incmr);maxDepth=Math.max(maxDepth,iInfo.depth)}return eInfo.depth<=maxDepth&&(shifted[id]?null:(function changeDepth(ele,newDepth){var _getInfo=getInfo(ele),depth=_getInfo.depth,index=_getInfo.index;depths[depth][index]=null,addToDepth(ele,newDepth)}(ele,maxDepth+1),shifted[id]=!0,!0))};if(directed&&maximal){var Q=[],shifted={},enqueue=function enqueue(n){return Q.push(n)},dequeue=function dequeue(){return Q.shift()};for(nodes.forEach((function(n){return Q.push(n)}));Q.length>0;){var _ele3=dequeue(),didShift=adjustMaximally(_ele3,shifted);if(didShift)_ele3.outgoers().filter((function(el){return el.isNode()&&eles.has(el)})).forEach(enqueue);else if(null===didShift){warn("Detected double maximal shift for node `"+_ele3.id()+"`.  Bailing maximal adjustment due to cycle.  Use `options.maximal: true` only on DAGs.");break}}}assignDepths();var minDistance=0;if(options.avoidOverlap)for(var _i4=0;_i4<nodes.length;_i4++){var nbb=nodes[_i4].layoutDimensions(options),w=nbb.w,h=nbb.h;minDistance=Math.max(minDistance,w,h)}for(var cachedWeightedPercent={},getWeightedPercent=function getWeightedPercent(ele){if(cachedWeightedPercent[ele.id()])return cachedWeightedPercent[ele.id()];for(var eleDepth=getInfo(ele).depth,neighbors=ele.neighborhood(),percent=0,samples=0,_i5=0;_i5<neighbors.length;_i5++){var neighbor=neighbors[_i5];if(!neighbor.isEdge()&&!neighbor.isParent()&&nodes.has(neighbor)){var bf=getInfo(neighbor);if(null!=bf){var index=bf.index,depth=bf.depth;if(null!=index&&null!=depth){var nDepth=depths[depth].length;depth<eleDepth&&(percent+=index/nDepth,samples++)}}}}return percent/=samples=Math.max(1,samples),0===samples&&(percent=0),cachedWeightedPercent[ele.id()]=percent,percent},sortFn=function sortFn(a,b){var diff=getWeightedPercent(a)-getWeightedPercent(b);return 0===diff?ascending(a.id(),b.id()):diff},_i6=0;_i6<depths.length;_i6++)depths[_i6].sort(sortFn),assignDepthsAt(_i6);for(var orphanDepth=[],_i7=0;_i7<orphanNodes.length;_i7++)orphanDepth.push(orphanNodes[_i7]);depths.unshift(orphanDepth),assignDepths();for(var biggestDepthSize=0,_i8=0;_i8<depths.length;_i8++)biggestDepthSize=Math.max(depths[_i8].length,biggestDepthSize);var center_x=bb.x1+bb.w/2,center_y=bb.x1+bb.h/2,maxDepthSize=depths.reduce((function(max,eles){return Math.max(max,eles.length)}),0);return eles.nodes().layoutPositions(this,options,(function getPosition(ele){var _getInfo2=getInfo(ele),depth=_getInfo2.depth,index=_getInfo2.index,depthSize=depths[depth].length,distanceX=Math.max(bb.w/((options.grid?maxDepthSize:depthSize)+1),minDistance),distanceY=Math.max(bb.h/(depths.length+1),minDistance),radiusStepSize=Math.min(bb.w/2/depths.length,bb.h/2/depths.length);if(radiusStepSize=Math.max(radiusStepSize,minDistance),options.circle){var radius=radiusStepSize*depth+radiusStepSize-(depths.length>0&&depths[0].length<=3?radiusStepSize/2:0),theta=2*Math.PI/depths[depth].length*index;return 0===depth&&1===depths[0].length&&(radius=1),{x:center_x+radius*Math.cos(theta),y:center_y+radius*Math.sin(theta)}}return{x:center_x+(index+1-(depthSize+1)/2)*distanceX,y:(depth+1)*distanceY}})),this};var defaults$a={fit:!0,padding:30,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,spacingFactor:void 0,radius:void 0,startAngle:1.5*Math.PI,sweep:void 0,clockwise:!0,sort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function animateFilter(node,i){return!0},ready:void 0,stop:void 0,transform:function transform(node,position){return position}};function CircleLayout(options){this.options=extend({},defaults$a,options)}CircleLayout.prototype.run=function(){var params=this.options,options=params,cy=params.cy,eles=options.eles,clockwise=void 0!==options.counterclockwise?!options.counterclockwise:options.clockwise,nodes=eles.nodes().not(":parent");options.sort&&(nodes=nodes.sort(options.sort));for(var r,bb=makeBoundingBox(options.boundingBox?options.boundingBox:{x1:0,y1:0,w:cy.width(),h:cy.height()}),center_x=bb.x1+bb.w/2,center_y=bb.y1+bb.h/2,dTheta=(void 0===options.sweep?2*Math.PI-2*Math.PI/nodes.length:options.sweep)/Math.max(1,nodes.length-1),minDistance=0,i=0;i<nodes.length;i++){var nbb=nodes[i].layoutDimensions(options),w=nbb.w,h=nbb.h;minDistance=Math.max(minDistance,w,h)}if(r=number(options.radius)?options.radius:nodes.length<=1?0:Math.min(bb.h,bb.w)/2-minDistance,nodes.length>1&&options.avoidOverlap){minDistance*=1.75;var dcos=Math.cos(dTheta)-Math.cos(0),dsin=Math.sin(dTheta)-Math.sin(0),rMin=Math.sqrt(minDistance*minDistance/(dcos*dcos+dsin*dsin));r=Math.max(rMin,r)}return eles.nodes().layoutPositions(this,options,(function getPos(ele,i){var theta=options.startAngle+i*dTheta*(clockwise?1:-1),rx=r*Math.cos(theta),ry=r*Math.sin(theta);return{x:center_x+rx,y:center_y+ry}})),this};var DEBUG,defaults$b={fit:!0,padding:30,startAngle:1.5*Math.PI,sweep:void 0,clockwise:!0,equidistant:!1,minNodeSpacing:10,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,height:void 0,width:void 0,spacingFactor:void 0,concentric:function concentric(node){return node.degree()},levelWidth:function levelWidth(nodes){return nodes.maxDegree()/4},animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function animateFilter(node,i){return!0},ready:void 0,stop:void 0,transform:function transform(node,position){return position}};function ConcentricLayout(options){this.options=extend({},defaults$b,options)}ConcentricLayout.prototype.run=function(){for(var params=this.options,options=params,clockwise=void 0!==options.counterclockwise?!options.counterclockwise:options.clockwise,cy=params.cy,eles=options.eles,nodes=eles.nodes().not(":parent"),bb=makeBoundingBox(options.boundingBox?options.boundingBox:{x1:0,y1:0,w:cy.width(),h:cy.height()}),center_x=bb.x1+bb.w/2,center_y=bb.y1+bb.h/2,nodeValues=[],maxNodeSize=0,i=0;i<nodes.length;i++){var value,node=nodes[i];value=options.concentric(node),nodeValues.push({value:value,node:node}),node._private.scratch.concentric=value}nodes.updateStyle();for(var _i=0;_i<nodes.length;_i++){var nbb=nodes[_i].layoutDimensions(options);maxNodeSize=Math.max(maxNodeSize,nbb.w,nbb.h)}nodeValues.sort((function(a,b){return b.value-a.value}));for(var levelWidth=options.levelWidth(nodes),levels=[[]],currentLevel=levels[0],_i2=0;_i2<nodeValues.length;_i2++){var val=nodeValues[_i2];if(currentLevel.length>0)Math.abs(currentLevel[0].value-val.value)>=levelWidth&&(currentLevel=[],levels.push(currentLevel));currentLevel.push(val)}var minDist=maxNodeSize+options.minNodeSpacing;if(!options.avoidOverlap){var firstLvlHasMulti=levels.length>0&&levels[0].length>1,rStep=(Math.min(bb.w,bb.h)/2-minDist)/(levels.length+firstLvlHasMulti?1:0);minDist=Math.min(minDist,rStep)}for(var r=0,_i3=0;_i3<levels.length;_i3++){var level=levels[_i3],sweep=void 0===options.sweep?2*Math.PI-2*Math.PI/level.length:options.sweep,dTheta=level.dTheta=sweep/Math.max(1,level.length-1);if(level.length>1&&options.avoidOverlap){var dcos=Math.cos(dTheta)-Math.cos(0),dsin=Math.sin(dTheta)-Math.sin(0),rMin=Math.sqrt(minDist*minDist/(dcos*dcos+dsin*dsin));r=Math.max(rMin,r)}level.r=r,r+=minDist}if(options.equidistant){for(var rDeltaMax=0,_r=0,_i4=0;_i4<levels.length;_i4++){var rDelta=levels[_i4].r-_r;rDeltaMax=Math.max(rDeltaMax,rDelta)}_r=0;for(var _i5=0;_i5<levels.length;_i5++){var _level2=levels[_i5];0===_i5&&(_r=_level2.r),_level2.r=_r,_r+=rDeltaMax}}for(var pos={},_i6=0;_i6<levels.length;_i6++)for(var _level3=levels[_i6],_dTheta=_level3.dTheta,_r2=_level3.r,j=0;j<_level3.length;j++){var _val=_level3[j],theta=options.startAngle+(clockwise?1:-1)*_dTheta*j,p={x:center_x+_r2*Math.cos(theta),y:center_y+_r2*Math.sin(theta)};pos[_val.node.id()]=p}return eles.nodes().layoutPositions(this,options,(function(ele){var id=ele.id();return pos[id]})),this};var defaults$c={ready:function ready(){},stop:function stop(){},animate:!0,animationEasing:void 0,animationDuration:void 0,animateFilter:function animateFilter(node,i){return!0},animationThreshold:250,refresh:20,fit:!0,padding:30,boundingBox:void 0,nodeDimensionsIncludeLabels:!1,randomize:!1,componentSpacing:40,nodeRepulsion:function nodeRepulsion(node){return 2048},nodeOverlap:4,idealEdgeLength:function idealEdgeLength(edge){return 32},edgeElasticity:function edgeElasticity(edge){return 32},nestingFactor:1.2,gravity:1,numIter:1e3,initialTemp:1e3,coolingFactor:.99,minTemp:1};function CoseLayout(options){this.options=extend({},defaults$c,options),this.options.layout=this}CoseLayout.prototype.run=function(){var options=this.options,cy=options.cy,layout=this;layout.stopped=!1,!0!==options.animate&&!1!==options.animate||layout.emit({type:"layoutstart",layout:layout}),DEBUG=!0===options.debug;var layoutInfo=createLayoutInfo(cy,layout,options);DEBUG&&(void 0)(layoutInfo),options.randomize&&randomizePositions(layoutInfo);var startTime=performanceNow(),refresh=function refresh(){refreshPositions(layoutInfo,cy,options),!0===options.fit&&cy.fit(options.padding)},mainLoop=function mainLoop(i){return!(layout.stopped||i>=options.numIter)&&(step$1(layoutInfo,options),layoutInfo.temperature=layoutInfo.temperature*options.coolingFactor,!(layoutInfo.temperature<options.minTemp))},done=function done(){if(!0===options.animate||!1===options.animate)refresh(),layout.one("layoutstop",options.stop),layout.emit({type:"layoutstop",layout:layout});else{var nodes=options.eles.nodes(),getScaledPos=getScaleInBoundsFn(layoutInfo,options,nodes);nodes.layoutPositions(layout,options,getScaledPos)}},i=0,loopRet=!0;if(!0===options.animate){!function frame(){for(var f=0;loopRet&&f<options.refresh;)loopRet=mainLoop(i),i++,f++;loopRet?(performanceNow()-startTime>=options.animationThreshold&&refresh(),requestAnimationFrame(frame)):(separateComponents(layoutInfo,options),done())}()}else{for(;loopRet;)loopRet=mainLoop(i),i++;separateComponents(layoutInfo,options),done()}return this},CoseLayout.prototype.stop=function(){return this.stopped=!0,this.thread&&this.thread.stop(),this.emit("layoutstop"),this},CoseLayout.prototype.destroy=function(){return this.thread&&this.thread.stop(),this};var createLayoutInfo=function createLayoutInfo(cy,layout,options){for(var edges=options.eles.edges(),nodes=options.eles.nodes(),layoutInfo={isCompound:cy.hasCompoundNodes(),layoutNodes:[],idToIndex:{},nodeSize:nodes.size(),graphSet:[],indexToGraph:[],layoutEdges:[],edgeSize:edges.size(),temperature:options.initialTemp,clientWidth:cy.width(),clientHeight:cy.width(),boundingBox:makeBoundingBox(options.boundingBox?options.boundingBox:{x1:0,y1:0,w:cy.width(),h:cy.height()})},components=options.eles.components(),id2cmptId={},i=0;i<components.length;i++)for(var component=components[i],j=0;j<component.length;j++){id2cmptId[component[j].id()]=i}for(i=0;i<layoutInfo.nodeSize;i++){var nbb=(n=nodes[i]).layoutDimensions(options);(tempNode={}).isLocked=n.locked(),tempNode.id=n.data("id"),tempNode.parentId=n.data("parent"),tempNode.cmptId=id2cmptId[n.id()],tempNode.children=[],tempNode.positionX=n.position("x"),tempNode.positionY=n.position("y"),tempNode.offsetX=0,tempNode.offsetY=0,tempNode.height=nbb.w,tempNode.width=nbb.h,tempNode.maxX=tempNode.positionX+tempNode.width/2,tempNode.minX=tempNode.positionX-tempNode.width/2,tempNode.maxY=tempNode.positionY+tempNode.height/2,tempNode.minY=tempNode.positionY-tempNode.height/2,tempNode.padLeft=parseFloat(n.style("padding")),tempNode.padRight=parseFloat(n.style("padding")),tempNode.padTop=parseFloat(n.style("padding")),tempNode.padBottom=parseFloat(n.style("padding")),tempNode.nodeRepulsion=fn(options.nodeRepulsion)?options.nodeRepulsion(n):options.nodeRepulsion,layoutInfo.layoutNodes.push(tempNode),layoutInfo.idToIndex[tempNode.id]=i}var queue=[],start=0,end=-1,tempGraph=[];for(i=0;i<layoutInfo.nodeSize;i++){var n,p_id=(n=layoutInfo.layoutNodes[i]).parentId;null!=p_id?layoutInfo.layoutNodes[layoutInfo.idToIndex[p_id]].children.push(n.id):(queue[++end]=n.id,tempGraph.push(n.id))}for(layoutInfo.graphSet.push(tempGraph);start<=end;){var node_id=queue[start++],node_ix=layoutInfo.idToIndex[node_id],children=layoutInfo.layoutNodes[node_ix].children;if(children.length>0){layoutInfo.graphSet.push(children);for(i=0;i<children.length;i++)queue[++end]=children[i]}}for(i=0;i<layoutInfo.graphSet.length;i++){var graph=layoutInfo.graphSet[i];for(j=0;j<graph.length;j++){var index=layoutInfo.idToIndex[graph[j]];layoutInfo.indexToGraph[index]=i}}for(i=0;i<layoutInfo.edgeSize;i++){var e=edges[i],tempEdge={};tempEdge.id=e.data("id"),tempEdge.sourceId=e.data("source"),tempEdge.targetId=e.data("target");var idealLength=fn(options.idealEdgeLength)?options.idealEdgeLength(e):options.idealEdgeLength,elasticity=fn(options.edgeElasticity)?options.edgeElasticity(e):options.edgeElasticity,sourceIx=layoutInfo.idToIndex[tempEdge.sourceId],targetIx=layoutInfo.idToIndex[tempEdge.targetId];if(layoutInfo.indexToGraph[sourceIx]!=layoutInfo.indexToGraph[targetIx]){for(var lca=findLCA(tempEdge.sourceId,tempEdge.targetId,layoutInfo),lcaGraph=layoutInfo.graphSet[lca],depth=0,tempNode=layoutInfo.layoutNodes[sourceIx];-1===lcaGraph.indexOf(tempNode.id);)tempNode=layoutInfo.layoutNodes[layoutInfo.idToIndex[tempNode.parentId]],depth++;for(tempNode=layoutInfo.layoutNodes[targetIx];-1===lcaGraph.indexOf(tempNode.id);)tempNode=layoutInfo.layoutNodes[layoutInfo.idToIndex[tempNode.parentId]],depth++;idealLength*=depth*options.nestingFactor}tempEdge.idealLength=idealLength,tempEdge.elasticity=elasticity,layoutInfo.layoutEdges.push(tempEdge)}return layoutInfo},findLCA=function findLCA(node1,node2,layoutInfo){var res=findLCA_aux(node1,node2,0,layoutInfo);return 2>res.count?0:res.graph},findLCA_aux=function findLCA_aux(node1,node2,graphIx,layoutInfo){var graph=layoutInfo.graphSet[graphIx];if(-1<graph.indexOf(node1)&&-1<graph.indexOf(node2))return{count:2,graph:graphIx};for(var c=0,i=0;i<graph.length;i++){var nodeId=graph[i],nodeIx=layoutInfo.idToIndex[nodeId],children=layoutInfo.layoutNodes[nodeIx].children;if(0!==children.length){var result=findLCA_aux(node1,node2,layoutInfo.indexToGraph[layoutInfo.idToIndex[children[0]]],layoutInfo);if(0!==result.count){if(1!==result.count)return result;if(2===++c)break}}}return{count:c,graph:graphIx}},randomizePositions=function randomizePositions(layoutInfo,cy){for(var width=layoutInfo.clientWidth,height=layoutInfo.clientHeight,i=0;i<layoutInfo.nodeSize;i++){var n=layoutInfo.layoutNodes[i];0!==n.children.length||n.isLocked||(n.positionX=Math.random()*width,n.positionY=Math.random()*height)}},getScaleInBoundsFn=function getScaleInBoundsFn(layoutInfo,options,nodes){var bb=layoutInfo.boundingBox,coseBB={x1:1/0,x2:-1/0,y1:1/0,y2:-1/0};return options.boundingBox&&(nodes.forEach((function(node){var lnode=layoutInfo.layoutNodes[layoutInfo.idToIndex[node.data("id")]];coseBB.x1=Math.min(coseBB.x1,lnode.positionX),coseBB.x2=Math.max(coseBB.x2,lnode.positionX),coseBB.y1=Math.min(coseBB.y1,lnode.positionY),coseBB.y2=Math.max(coseBB.y2,lnode.positionY)})),coseBB.w=coseBB.x2-coseBB.x1,coseBB.h=coseBB.y2-coseBB.y1),function(ele,i){var lnode=layoutInfo.layoutNodes[layoutInfo.idToIndex[ele.data("id")]];if(options.boundingBox){var pctX=(lnode.positionX-coseBB.x1)/coseBB.w,pctY=(lnode.positionY-coseBB.y1)/coseBB.h;return{x:bb.x1+pctX*bb.w,y:bb.y1+pctY*bb.h}}return{x:lnode.positionX,y:lnode.positionY}}},refreshPositions=function refreshPositions(layoutInfo,cy,options){var layout=options.layout,nodes=options.eles.nodes(),getScaledPos=getScaleInBoundsFn(layoutInfo,options,nodes);nodes.positions(getScaledPos),!0!==layoutInfo.ready&&(layoutInfo.ready=!0,layout.one("layoutready",options.ready),layout.emit({type:"layoutready",layout:this}))},step$1=function step(layoutInfo,options,_step){calculateNodeForces(layoutInfo,options),calculateEdgeForces(layoutInfo),calculateGravityForces(layoutInfo,options),propagateForces(layoutInfo),updatePositions(layoutInfo)},calculateNodeForces=function calculateNodeForces(layoutInfo,options){for(var i=0;i<layoutInfo.graphSet.length;i++)for(var graph=layoutInfo.graphSet[i],numNodes=graph.length,j=0;j<numNodes;j++)for(var node1=layoutInfo.layoutNodes[layoutInfo.idToIndex[graph[j]]],k=j+1;k<numNodes;k++){var node2=layoutInfo.layoutNodes[layoutInfo.idToIndex[graph[k]]];nodeRepulsion(node1,node2,layoutInfo,options)}},randomDistance=function randomDistance(max){return-max+2*max*Math.random()},nodeRepulsion=function nodeRepulsion(node1,node2,layoutInfo,options){if(node1.cmptId===node2.cmptId||layoutInfo.isCompound){var directionX=node2.positionX-node1.positionX,directionY=node2.positionY-node1.positionY;0===directionX&&0===directionY&&(directionX=randomDistance(1),directionY=randomDistance(1));var overlap=nodesOverlap(node1,node2,directionX,directionY);if(overlap>0)var forceX=(force=options.nodeOverlap*overlap)*directionX/(distance=Math.sqrt(directionX*directionX+directionY*directionY)),forceY=force*directionY/distance;else{var force,point1=findClippingPoint(node1,directionX,directionY),point2=findClippingPoint(node2,-1*directionX,-1*directionY),distanceX=point2.x-point1.x,distanceY=point2.y-point1.y,distanceSqr=distanceX*distanceX+distanceY*distanceY,distance=Math.sqrt(distanceSqr);forceX=(force=(node1.nodeRepulsion+node2.nodeRepulsion)/distanceSqr)*distanceX/distance,forceY=force*distanceY/distance}node1.isLocked||(node1.offsetX-=forceX,node1.offsetY-=forceY),node2.isLocked||(node2.offsetX+=forceX,node2.offsetY+=forceY)}},nodesOverlap=function nodesOverlap(node1,node2,dX,dY){if(dX>0)var overlapX=node1.maxX-node2.minX;else overlapX=node2.maxX-node1.minX;if(dY>0)var overlapY=node1.maxY-node2.minY;else overlapY=node2.maxY-node1.minY;return overlapX>=0&&overlapY>=0?Math.sqrt(overlapX*overlapX+overlapY*overlapY):0},findClippingPoint=function findClippingPoint(node,dX,dY){var X=node.positionX,Y=node.positionY,H=node.height||1,W=node.width||1,dirSlope=dY/dX,nodeSlope=H/W,res={};return 0===dX&&0<dY||0===dX&&0>dY?(res.x=X,res.y=Y+H/2,res):0<dX&&-1*nodeSlope<=dirSlope&&dirSlope<=nodeSlope?(res.x=X+W/2,res.y=Y+W*dY/2/dX,res):0>dX&&-1*nodeSlope<=dirSlope&&dirSlope<=nodeSlope?(res.x=X-W/2,res.y=Y-W*dY/2/dX,res):0<dY&&(dirSlope<=-1*nodeSlope||dirSlope>=nodeSlope)?(res.x=X+H*dX/2/dY,res.y=Y+H/2,res):0>dY&&(dirSlope<=-1*nodeSlope||dirSlope>=nodeSlope)?(res.x=X-H*dX/2/dY,res.y=Y-H/2,res):res},calculateEdgeForces=function calculateEdgeForces(layoutInfo,options){for(var i=0;i<layoutInfo.edgeSize;i++){var edge=layoutInfo.layoutEdges[i],sourceIx=layoutInfo.idToIndex[edge.sourceId],source=layoutInfo.layoutNodes[sourceIx],targetIx=layoutInfo.idToIndex[edge.targetId],target=layoutInfo.layoutNodes[targetIx],directionX=target.positionX-source.positionX,directionY=target.positionY-source.positionY;if(0!==directionX||0!==directionY){var point1=findClippingPoint(source,directionX,directionY),point2=findClippingPoint(target,-1*directionX,-1*directionY),lx=point2.x-point1.x,ly=point2.y-point1.y,l=Math.sqrt(lx*lx+ly*ly),force=Math.pow(edge.idealLength-l,2)/edge.elasticity;if(0!==l)var forceX=force*lx/l,forceY=force*ly/l;else forceX=0,forceY=0;source.isLocked||(source.offsetX+=forceX,source.offsetY+=forceY),target.isLocked||(target.offsetX-=forceX,target.offsetY-=forceY)}}},calculateGravityForces=function calculateGravityForces(layoutInfo,options){for(var i=0;i<layoutInfo.graphSet.length;i++){var graph=layoutInfo.graphSet[i],numNodes=graph.length;if(0===i)var centerX=layoutInfo.clientHeight/2,centerY=layoutInfo.clientWidth/2;else{var temp=layoutInfo.layoutNodes[layoutInfo.idToIndex[graph[0]]],parent=layoutInfo.layoutNodes[layoutInfo.idToIndex[temp.parentId]];centerX=parent.positionX,centerY=parent.positionY}for(var j=0;j<numNodes;j++){var node=layoutInfo.layoutNodes[layoutInfo.idToIndex[graph[j]]];if(!node.isLocked){var dx=centerX-node.positionX,dy=centerY-node.positionY,d=Math.sqrt(dx*dx+dy*dy);if(d>1){var fx=options.gravity*dx/d,fy=options.gravity*dy/d;node.offsetX+=fx,node.offsetY+=fy}}}}},propagateForces=function propagateForces(layoutInfo,options){var queue=[],start=0,end=-1;for(queue.push.apply(queue,layoutInfo.graphSet[0]),end+=layoutInfo.graphSet[0].length;start<=end;){var nodeId=queue[start++],nodeIndex=layoutInfo.idToIndex[nodeId],node=layoutInfo.layoutNodes[nodeIndex],children=node.children;if(0<children.length&&!node.isLocked){for(var offX=node.offsetX,offY=node.offsetY,i=0;i<children.length;i++){var childNode=layoutInfo.layoutNodes[layoutInfo.idToIndex[children[i]]];childNode.offsetX+=offX,childNode.offsetY+=offY,queue[++end]=children[i]}node.offsetX=0,node.offsetY=0}}},updatePositions=function updatePositions(layoutInfo,options){for(var i=0;i<layoutInfo.nodeSize;i++){0<(n=layoutInfo.layoutNodes[i]).children.length&&(n.maxX=void 0,n.minX=void 0,n.maxY=void 0,n.minY=void 0)}for(i=0;i<layoutInfo.nodeSize;i++){if(!(0<(n=layoutInfo.layoutNodes[i]).children.length||n.isLocked)){var tempForce=limitForce(n.offsetX,n.offsetY,layoutInfo.temperature);n.positionX+=tempForce.x,n.positionY+=tempForce.y,n.offsetX=0,n.offsetY=0,n.minX=n.positionX-n.width,n.maxX=n.positionX+n.width,n.minY=n.positionY-n.height,n.maxY=n.positionY+n.height,updateAncestryBoundaries(n,layoutInfo)}}for(i=0;i<layoutInfo.nodeSize;i++){var n;0<(n=layoutInfo.layoutNodes[i]).children.length&&!n.isLocked&&(n.positionX=(n.maxX+n.minX)/2,n.positionY=(n.maxY+n.minY)/2,n.width=n.maxX-n.minX,n.height=n.maxY-n.minY)}},limitForce=function limitForce(forceX,forceY,max){var force=Math.sqrt(forceX*forceX+forceY*forceY);if(force>max)var res={x:max*forceX/force,y:max*forceY/force};else res={x:forceX,y:forceY};return res},updateAncestryBoundaries=function updateAncestryBoundaries(node,layoutInfo){var parentId=node.parentId;if(null!=parentId){var p=layoutInfo.layoutNodes[layoutInfo.idToIndex[parentId]],flag=!1;return(null==p.maxX||node.maxX+p.padRight>p.maxX)&&(p.maxX=node.maxX+p.padRight,flag=!0),(null==p.minX||node.minX-p.padLeft<p.minX)&&(p.minX=node.minX-p.padLeft,flag=!0),(null==p.maxY||node.maxY+p.padBottom>p.maxY)&&(p.maxY=node.maxY+p.padBottom,flag=!0),(null==p.minY||node.minY-p.padTop<p.minY)&&(p.minY=node.minY-p.padTop,flag=!0),flag?updateAncestryBoundaries(p,layoutInfo):void 0}},separateComponents=function separateComponents(layoutInfo,options){for(var nodes=layoutInfo.layoutNodes,components=[],i=0;i<nodes.length;i++){var node=nodes[i],cid=node.cmptId;(components[cid]=components[cid]||[]).push(node)}var totalA=0;for(i=0;i<components.length;i++){if(c=components[i]){c.x1=1/0,c.x2=-1/0,c.y1=1/0,c.y2=-1/0;for(var j=0;j<c.length;j++){var n=c[j];c.x1=Math.min(c.x1,n.positionX-n.width/2),c.x2=Math.max(c.x2,n.positionX+n.width/2),c.y1=Math.min(c.y1,n.positionY-n.height/2),c.y2=Math.max(c.y2,n.positionY+n.height/2)}c.w=c.x2-c.x1,c.h=c.y2-c.y1,totalA+=c.w*c.h}}components.sort((function(c1,c2){return c2.w*c2.h-c1.w*c1.h}));var x=0,y=0,usedW=0,rowH=0,maxRowW=Math.sqrt(totalA)*layoutInfo.clientWidth/layoutInfo.clientHeight;for(i=0;i<components.length;i++){var c;if(c=components[i]){for(j=0;j<c.length;j++){(n=c[j]).isLocked||(n.positionX+=x-c.x1,n.positionY+=y-c.y1)}x+=c.w+options.componentSpacing,usedW+=c.w+options.componentSpacing,rowH=Math.max(rowH,c.h),usedW>maxRowW&&(y+=rowH+options.componentSpacing,x=0,usedW=0,rowH=0)}}},defaults$d={fit:!0,padding:30,boundingBox:void 0,avoidOverlap:!0,avoidOverlapPadding:10,nodeDimensionsIncludeLabels:!1,spacingFactor:void 0,condense:!1,rows:void 0,cols:void 0,position:function position(node){},sort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function animateFilter(node,i){return!0},ready:void 0,stop:void 0,transform:function transform(node,position){return position}};function GridLayout(options){this.options=extend({},defaults$d,options)}GridLayout.prototype.run=function(){var params=this.options,options=params,cy=params.cy,eles=options.eles,nodes=eles.nodes().not(":parent");options.sort&&(nodes=nodes.sort(options.sort));var bb=makeBoundingBox(options.boundingBox?options.boundingBox:{x1:0,y1:0,w:cy.width(),h:cy.height()});if(0===bb.h||0===bb.w)eles.nodes().layoutPositions(this,options,(function(ele){return{x:bb.x1,y:bb.y1}}));else{var cells=nodes.size(),splits=Math.sqrt(cells*bb.h/bb.w),rows=Math.round(splits),cols=Math.round(bb.w/bb.h*splits),small=function small(val){if(null==val)return Math.min(rows,cols);Math.min(rows,cols)==rows?rows=val:cols=val},large=function large(val){if(null==val)return Math.max(rows,cols);Math.max(rows,cols)==rows?rows=val:cols=val},oRows=options.rows,oCols=null!=options.cols?options.cols:options.columns;if(null!=oRows&&null!=oCols)rows=oRows,cols=oCols;else if(null!=oRows&&null==oCols)rows=oRows,cols=Math.ceil(cells/rows);else if(null==oRows&&null!=oCols)cols=oCols,rows=Math.ceil(cells/cols);else if(cols*rows>cells){var sm=small(),lg=large();(sm-1)*lg>=cells?small(sm-1):(lg-1)*sm>=cells&&large(lg-1)}else for(;cols*rows<cells;){var _sm=small(),_lg=large();(_lg+1)*_sm>=cells?large(_lg+1):small(_sm+1)}var cellWidth=bb.w/cols,cellHeight=bb.h/rows;if(options.condense&&(cellWidth=0,cellHeight=0),options.avoidOverlap)for(var i=0;i<nodes.length;i++){var node=nodes[i],pos=node._private.position;null!=pos.x&&null!=pos.y||(pos.x=0,pos.y=0);var nbb=node.layoutDimensions(options),p=options.avoidOverlapPadding,w=nbb.w+p,h=nbb.h+p;cellWidth=Math.max(cellWidth,w),cellHeight=Math.max(cellHeight,h)}for(var cellUsed={},used=function used(row,col){return!!cellUsed["c-"+row+"-"+col]},use=function use(row,col){cellUsed["c-"+row+"-"+col]=!0},row=0,col=0,moveToNextCell=function moveToNextCell(){++col>=cols&&(col=0,row++)},id2manPos={},_i=0;_i<nodes.length;_i++){var _node=nodes[_i],rcPos=options.position(_node);if(rcPos&&(void 0!==rcPos.row||void 0!==rcPos.col)){var _pos={row:rcPos.row,col:rcPos.col};if(void 0===_pos.col)for(_pos.col=0;used(_pos.row,_pos.col);)_pos.col++;else if(void 0===_pos.row)for(_pos.row=0;used(_pos.row,_pos.col);)_pos.row++;id2manPos[_node.id()]=_pos,use(_pos.row,_pos.col)}}nodes.layoutPositions(this,options,(function getPos(element,i){var x,y;if(element.locked()||element.isParent())return!1;var rcPos=id2manPos[element.id()];if(rcPos)x=rcPos.col*cellWidth+cellWidth/2+bb.x1,y=rcPos.row*cellHeight+cellHeight/2+bb.y1;else{for(;used(row,col);)moveToNextCell();x=col*cellWidth+cellWidth/2+bb.x1,y=row*cellHeight+cellHeight/2+bb.y1,use(row,col),moveToNextCell()}return{x:x,y:y}}))}return this};var defaults$e={ready:function ready(){},stop:function stop(){}};function NullLayout(options){this.options=extend({},defaults$e,options)}NullLayout.prototype.run=function(){var options=this.options,eles=options.eles;return options.cy,this.emit("layoutstart"),eles.nodes().positions((function(){return{x:0,y:0}})),this.one("layoutready",options.ready),this.emit("layoutready"),this.one("layoutstop",options.stop),this.emit("layoutstop"),this},NullLayout.prototype.stop=function(){return this};var defaults$f={positions:void 0,zoom:void 0,pan:void 0,fit:!0,padding:30,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function animateFilter(node,i){return!0},ready:void 0,stop:void 0,transform:function transform(node,position){return position}};function PresetLayout(options){this.options=extend({},defaults$f,options)}PresetLayout.prototype.run=function(){var options=this.options,nodes=options.eles.nodes(),posIsFn=fn(options.positions);return nodes.layoutPositions(this,options,(function(node,i){var position=function getPosition(node){if(null==options.positions)return function copyPosition(p){return{x:p.x,y:p.y}}(node.position());if(posIsFn)return options.positions(node);var pos=options.positions[node._private.data.id];return null==pos?null:pos}(node);return!node.locked()&&null!=position&&position})),this};var defaults$g={fit:!0,padding:30,boundingBox:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function animateFilter(node,i){return!0},ready:void 0,stop:void 0,transform:function transform(node,position){return position}};function RandomLayout(options){this.options=extend({},defaults$g,options)}RandomLayout.prototype.run=function(){var options=this.options,cy=options.cy,eles=options.eles,bb=makeBoundingBox(options.boundingBox?options.boundingBox:{x1:0,y1:0,w:cy.width(),h:cy.height()});return eles.nodes().layoutPositions(this,options,(function getPos(node,i){return{x:bb.x1+Math.round(Math.random()*bb.w),y:bb.y1+Math.round(Math.random()*bb.h)}})),this};var layout=[{name:"breadthfirst",impl:BreadthFirstLayout},{name:"circle",impl:CircleLayout},{name:"concentric",impl:ConcentricLayout},{name:"cose",impl:CoseLayout},{name:"grid",impl:GridLayout},{name:"null",impl:NullLayout},{name:"preset",impl:PresetLayout},{name:"random",impl:RandomLayout}];function NullRenderer(options){this.options=options,this.notifications=0}var noop$1=function noop(){},throwImgErr=function throwImgErr(){throw new Error("A headless instance can not render images")};NullRenderer.prototype={recalculateRenderedStyle:noop$1,notify:function notify(){this.notifications++},init:noop$1,isHeadless:function isHeadless(){return!0},png:throwImgErr,jpg:throwImgErr};var BRp={arrowShapeWidth:.3,registerArrowShapes:function(){var arrowShapes=this.arrowShapes={},renderer=this,bbCollide=function bbCollide(x,y,size,angle,translation,edgeWidth,padding){var x1=translation.x-size/2-padding,x2=translation.x+size/2+padding,y1=translation.y-size/2-padding,y2=translation.y+size/2+padding;return x1<=x&&x<=x2&&y1<=y&&y<=y2},transform=function transform(x,y,size,angle,translation){var xRotated=x*Math.cos(angle)-y*Math.sin(angle),yScaled=(x*Math.sin(angle)+y*Math.cos(angle))*size;return{x:xRotated*size+translation.x,y:yScaled+translation.y}},transformPoints=function transformPoints(pts,size,angle,translation){for(var retPts=[],i=0;i<pts.length;i+=2){var x=pts[i],y=pts[i+1];retPts.push(transform(x,y,size,angle,translation))}return retPts},pointsToArr=function pointsToArr(pts){for(var ret=[],i=0;i<pts.length;i++){var p=pts[i];ret.push(p.x,p.y)}return ret},standardGap=function standardGap(edge){return edge.pstyle("width").pfValue*edge.pstyle("arrow-scale").pfValue*2},defineArrowShape=function defineArrowShape(name,defn){string(defn)&&(defn=arrowShapes[defn]),arrowShapes[name]=extend({name:name,points:[-.15,-.3,.15,-.3,.15,.3,-.15,.3],collide:function collide(x,y,size,angle,translation,padding){var points=pointsToArr(transformPoints(this.points,size+2*padding,angle,translation));return pointInsidePolygonPoints(x,y,points)},roughCollide:bbCollide,draw:function draw(context,size,angle,translation){var points=transformPoints(this.points,size,angle,translation);renderer.arrowShapeImpl("polygon")(context,points)},spacing:function spacing(edge){return 0},gap:standardGap},defn)};defineArrowShape("none",{collide:falsify,roughCollide:falsify,draw:noop,spacing:zeroify,gap:zeroify}),defineArrowShape("triangle",{points:[-.15,-.3,0,0,.15,-.3]}),defineArrowShape("arrow","triangle"),defineArrowShape("triangle-backcurve",{points:arrowShapes.triangle.points,controlPoint:[0,-.15],roughCollide:bbCollide,draw:function draw(context,size,angle,translation,edgeWidth){var ptsTrans=transformPoints(this.points,size,angle,translation),ctrlPt=this.controlPoint,ctrlPtTrans=transform(ctrlPt[0],ctrlPt[1],size,angle,translation);renderer.arrowShapeImpl(this.name)(context,ptsTrans,ctrlPtTrans)},gap:function gap(edge){return.8*standardGap(edge)}}),defineArrowShape("triangle-tee",{points:[0,0,.15,-.3,-.15,-.3,0,0],pointsTee:[-.15,-.4,-.15,-.5,.15,-.5,.15,-.4],collide:function collide(x,y,size,angle,translation,edgeWidth,padding){var triPts=pointsToArr(transformPoints(this.points,size+2*padding,angle,translation)),teePts=pointsToArr(transformPoints(this.pointsTee,size+2*padding,angle,translation));return pointInsidePolygonPoints(x,y,triPts)||pointInsidePolygonPoints(x,y,teePts)},draw:function draw(context,size,angle,translation,edgeWidth){var triPts=transformPoints(this.points,size,angle,translation),teePts=transformPoints(this.pointsTee,size,angle,translation);renderer.arrowShapeImpl(this.name)(context,triPts,teePts)}}),defineArrowShape("circle-triangle",{radius:.15,pointsTr:[0,-.15,.15,-.45,-.15,-.45,0,-.15],collide:function collide(x,y,size,angle,translation,edgeWidth,padding){var t=translation,circleInside=Math.pow(t.x-x,2)+Math.pow(t.y-y,2)<=Math.pow((size+2*padding)*this.radius,2),triPts=pointsToArr(transformPoints(this.points,size+2*padding,angle,translation));return pointInsidePolygonPoints(x,y,triPts)||circleInside},draw:function draw(context,size,angle,translation,edgeWidth){var triPts=transformPoints(this.pointsTr,size,angle,translation);renderer.arrowShapeImpl(this.name)(context,triPts,translation.x,translation.y,this.radius*size)},spacing:function spacing(edge){return renderer.getArrowWidth(edge.pstyle("width").pfValue,edge.pstyle("arrow-scale").value)*this.radius}}),defineArrowShape("triangle-cross",{points:[0,0,.15,-.3,-.15,-.3,0,0],baseCrossLinePts:[-.15,-.4,-.15,-.4,.15,-.4,.15,-.4],crossLinePts:function crossLinePts(size,edgeWidth){var p=this.baseCrossLinePts.slice(),shiftFactor=edgeWidth/size;return p[3]=p[3]-shiftFactor,p[5]=p[5]-shiftFactor,p},collide:function collide(x,y,size,angle,translation,edgeWidth,padding){var triPts=pointsToArr(transformPoints(this.points,size+2*padding,angle,translation)),teePts=pointsToArr(transformPoints(this.crossLinePts(size,edgeWidth),size+2*padding,angle,translation));return pointInsidePolygonPoints(x,y,triPts)||pointInsidePolygonPoints(x,y,teePts)},draw:function draw(context,size,angle,translation,edgeWidth){var triPts=transformPoints(this.points,size,angle,translation),crossLinePts=transformPoints(this.crossLinePts(size,edgeWidth),size,angle,translation);renderer.arrowShapeImpl(this.name)(context,triPts,crossLinePts)}}),defineArrowShape("vee",{points:[-.15,-.3,0,0,.15,-.3,0,-.15],gap:function gap(edge){return.525*standardGap(edge)}}),defineArrowShape("circle",{radius:.15,collide:function collide(x,y,size,angle,translation,edgeWidth,padding){var t=translation;return Math.pow(t.x-x,2)+Math.pow(t.y-y,2)<=Math.pow((size+2*padding)*this.radius,2)},draw:function draw(context,size,angle,translation,edgeWidth){renderer.arrowShapeImpl(this.name)(context,translation.x,translation.y,this.radius*size)},spacing:function spacing(edge){return renderer.getArrowWidth(edge.pstyle("width").pfValue,edge.pstyle("arrow-scale").value)*this.radius}}),defineArrowShape("tee",{points:[-.15,0,-.15,-.1,.15,-.1,.15,0],spacing:function spacing(edge){return 1},gap:function gap(edge){return 1}}),defineArrowShape("square",{points:[-.15,0,.15,0,.15,-.3,-.15,-.3]}),defineArrowShape("diamond",{points:[-.15,-.15,0,-.3,.15,-.15,0,0],gap:function gap(edge){return edge.pstyle("width").pfValue*edge.pstyle("arrow-scale").value}}),defineArrowShape("chevron",{points:[0,0,-.15,-.15,-.1,-.2,0,-.1,.1,-.2,.15,-.15],gap:function gap(edge){return.95*edge.pstyle("width").pfValue*edge.pstyle("arrow-scale").value}})}},BRp$1={projectIntoViewport:function(clientX,clientY){var cy=this.cy,offsets=this.findContainerClientCoords(),offsetLeft=offsets[0],offsetTop=offsets[1],scale=offsets[4],pan=cy.pan(),zoom=cy.zoom();return[((clientX-offsetLeft)/scale-pan.x)/zoom,((clientY-offsetTop)/scale-pan.y)/zoom]},findContainerClientCoords:function(){if(this.containerBB)return this.containerBB;var container=this.container,rect=container.getBoundingClientRect(),style=window$1.getComputedStyle(container),styleValue=function styleValue(name){return parseFloat(style.getPropertyValue(name))},padding_left=styleValue("padding-left"),padding_right=styleValue("padding-right"),padding_top=styleValue("padding-top"),padding_bottom=styleValue("padding-bottom"),border_left=styleValue("border-left-width"),border_right=styleValue("border-right-width"),border_top=styleValue("border-top-width"),clientWidth=(styleValue("border-bottom-width"),container.clientWidth),clientHeight=container.clientHeight,paddingHor=padding_left+padding_right,paddingVer=padding_top+padding_bottom,borderHor=border_left+border_right,scale=rect.width/(clientWidth+borderHor),unscaledW=clientWidth-paddingHor,unscaledH=clientHeight-paddingVer,left=rect.left+padding_left+border_left,top=rect.top+padding_top+border_top;return this.containerBB=[left,top,unscaledW,unscaledH,scale]},invalidateContainerClientCoordsCache:function(){this.containerBB=null},findNearestElement:function(x,y,interactiveElementsOnly,isTouch){return this.findNearestElements(x,y,interactiveElementsOnly,isTouch)[0]},findNearestElements:function(x,y,interactiveElementsOnly,isTouch){var nearEdge,nearNode,self=this,r=this,eles=r.getCachedZSortedEles(),near=[],zoom=r.cy.zoom(),hasCompounds=r.cy.hasCompoundNodes(),edgeThreshold=(isTouch?24:8)/zoom,nodeThreshold=(isTouch?8:2)/zoom,labelThreshold=(isTouch?8:2)/zoom,minSqDist=1/0;function addEle(ele,sqDist){if(ele.isNode()){if(nearNode)return;nearNode=ele,near.push(ele)}if(ele.isEdge()&&(null==sqDist||sqDist<minSqDist))if(nearEdge){if(nearEdge.pstyle("z-compound-depth").value===ele.pstyle("z-compound-depth").value&&nearEdge.pstyle("z-compound-depth").value===ele.pstyle("z-compound-depth").value)for(var i=0;i<near.length;i++)if(near[i].isEdge()){near[i]=ele,nearEdge=ele,minSqDist=null!=sqDist?sqDist:minSqDist;break}}else near.push(ele),nearEdge=ele,minSqDist=null!=sqDist?sqDist:minSqDist}function checkNode(node){var width=node.outerWidth()+2*nodeThreshold,height=node.outerHeight()+2*nodeThreshold,hw=width/2,hh=height/2,pos=node.position();if(pos.x-hw<=x&&x<=pos.x+hw&&pos.y-hh<=y&&y<=pos.y+hh&&r.nodeShapes[self.getNodeShape(node)].checkPoint(x,y,0,width,height,pos.x,pos.y))return addEle(node,0),!0}function checkEdge(edge){var sqDist,_p=edge._private,rs=_p.rscratch,styleWidth=edge.pstyle("width").pfValue,scale=edge.pstyle("arrow-scale").value,width=styleWidth/2+edgeThreshold,widthSq=width*width,width2=2*width,src=_p.source,tgt=_p.target;if("segments"===rs.edgeType||"straight"===rs.edgeType||"haystack"===rs.edgeType){for(var pts=rs.allpts,i=0;i+3<pts.length;i+=2)if(inLineVicinity(x,y,pts[i],pts[i+1],pts[i+2],pts[i+3],width2)&&widthSq>(sqDist=sqdistToFiniteLine(x,y,pts[i],pts[i+1],pts[i+2],pts[i+3])))return addEle(edge,sqDist),!0}else if("bezier"===rs.edgeType||"multibezier"===rs.edgeType||"self"===rs.edgeType||"compound"===rs.edgeType)for(pts=rs.allpts,i=0;i+5<rs.allpts.length;i+=4)if(inBezierVicinity(x,y,pts[i],pts[i+1],pts[i+2],pts[i+3],pts[i+4],pts[i+5],width2)&&widthSq>(sqDist=sqdistToQuadraticBezier(x,y,pts[i],pts[i+1],pts[i+2],pts[i+3],pts[i+4],pts[i+5])))return addEle(edge,sqDist),!0;src=src||_p.source,tgt=tgt||_p.target;var arSize=self.getArrowWidth(styleWidth,scale),arrows=[{name:"source",x:rs.arrowStartX,y:rs.arrowStartY,angle:rs.srcArrowAngle},{name:"target",x:rs.arrowEndX,y:rs.arrowEndY,angle:rs.tgtArrowAngle},{name:"mid-source",x:rs.midX,y:rs.midY,angle:rs.midsrcArrowAngle},{name:"mid-target",x:rs.midX,y:rs.midY,angle:rs.midtgtArrowAngle}];for(i=0;i<arrows.length;i++){var ar=arrows[i],shape=r.arrowShapes[edge.pstyle(ar.name+"-arrow-shape").value],edgeWidth=edge.pstyle("width").pfValue;if(shape.roughCollide(x,y,arSize,ar.angle,{x:ar.x,y:ar.y},edgeWidth,edgeThreshold)&&shape.collide(x,y,arSize,ar.angle,{x:ar.x,y:ar.y},edgeWidth,edgeThreshold))return addEle(edge),!0}hasCompounds&&near.length>0&&(checkNode(src),checkNode(tgt))}function preprop(obj,name,pre){return getPrefixedProperty(obj,name,pre)}function checkLabel(ele,prefix){var prefixDash,_p=ele._private,th=labelThreshold;prefixDash=prefix?prefix+"-":"",ele.boundingBox();var bb=_p.labelBounds[prefix||"main"],text=ele.pstyle(prefixDash+"label").value;if("yes"===ele.pstyle("text-events").strValue&&text){var lx=preprop(_p.rscratch,"labelX",prefix),ly=preprop(_p.rscratch,"labelY",prefix),theta=preprop(_p.rscratch,"labelAngle",prefix),ox=ele.pstyle(prefixDash+"text-margin-x").pfValue,oy=ele.pstyle(prefixDash+"text-margin-y").pfValue,lx1=bb.x1-th-ox,lx2=bb.x2+th-ox,ly1=bb.y1-th-oy,ly2=bb.y2+th-oy;if(theta){var cos=Math.cos(theta),sin=Math.sin(theta),rotate=function rotate(x,y){return{x:(x-=lx)*cos-(y-=ly)*sin+lx,y:x*sin+y*cos+ly}},px1y1=rotate(lx1,ly1),px1y2=rotate(lx1,ly2),px2y1=rotate(lx2,ly1),px2y2=rotate(lx2,ly2),points=[px1y1.x+ox,px1y1.y+oy,px2y1.x+ox,px2y1.y+oy,px2y2.x+ox,px2y2.y+oy,px1y2.x+ox,px1y2.y+oy];if(pointInsidePolygonPoints(x,y,points))return addEle(ele),!0}else if(inBoundingBox(bb,x,y))return addEle(ele),!0}}interactiveElementsOnly&&(eles=eles.interactive);for(var i=eles.length-1;i>=0;i--){var ele=eles[i];ele.isNode()?checkNode(ele)||checkLabel(ele):checkEdge(ele)||checkLabel(ele)||checkLabel(ele,"source")||checkLabel(ele,"target")}return near},getAllInBox:function(x1,y1,x2,y2){for(var eles=this.getCachedZSortedEles().interactive,box=[],x1c=Math.min(x1,x2),x2c=Math.max(x1,x2),y1c=Math.min(y1,y2),y2c=Math.max(y1,y2),boxBb=makeBoundingBox({x1:x1=x1c,y1:y1=y1c,x2:x2=x2c,y2:y2=y2c}),e=0;e<eles.length;e++){var ele=eles[e];if(ele.isNode()){var node=ele,nodeBb=node.boundingBox({includeNodes:!0,includeEdges:!1,includeLabels:!1});boundingBoxesIntersect(boxBb,nodeBb)&&!boundingBoxInBoundingBox(nodeBb,boxBb)&&box.push(node)}else{var edge=ele,_p=edge._private,rs=_p.rscratch;if(null!=rs.startX&&null!=rs.startY&&!inBoundingBox(boxBb,rs.startX,rs.startY))continue;if(null!=rs.endX&&null!=rs.endY&&!inBoundingBox(boxBb,rs.endX,rs.endY))continue;if("bezier"===rs.edgeType||"multibezier"===rs.edgeType||"self"===rs.edgeType||"compound"===rs.edgeType||"segments"===rs.edgeType||"haystack"===rs.edgeType){for(var pts=_p.rstyle.bezierPts||_p.rstyle.linePts||_p.rstyle.haystackPts,allInside=!0,i=0;i<pts.length;i++)if(!pointInBoundingBox(boxBb,pts[i])){allInside=!1;break}allInside&&box.push(edge)}else"haystack"!==rs.edgeType&&"straight"!==rs.edgeType||box.push(edge)}}return box}},BRp$2={calculateArrowAngles:function(edge){var dispX,dispY,startX,startY,endX,endY,rs=edge._private.rscratch,isHaystack="haystack"===rs.edgeType,isBezier="bezier"===rs.edgeType,isMultibezier="multibezier"===rs.edgeType,isSegments="segments"===rs.edgeType,isCompound="compound"===rs.edgeType,isSelf="self"===rs.edgeType;if(isHaystack?(startX=rs.haystackPts[0],startY=rs.haystackPts[1],endX=rs.haystackPts[2],endY=rs.haystackPts[3]):(startX=rs.arrowStartX,startY=rs.arrowStartY,endX=rs.arrowEndX,endY=rs.arrowEndY),midX=rs.midX,midY=rs.midY,isSegments)dispX=startX-rs.segpts[0],dispY=startY-rs.segpts[1];else if(isMultibezier||isCompound||isSelf||isBezier){var pts=rs.allpts;dispX=startX-qbezierAt(pts[0],pts[2],pts[4],.1),dispY=startY-qbezierAt(pts[1],pts[3],pts[5],.1)}else dispX=startX-midX,dispY=startY-midY;rs.srcArrowAngle=getAngleFromDisp(dispX,dispY);var midX=rs.midX,midY=rs.midY;if(isHaystack&&(midX=(startX+endX)/2,midY=(startY+endY)/2),dispX=endX-startX,dispY=endY-startY,isSegments)if((pts=rs.allpts).length/2%2==0){var i1=(i2=pts.length/2)-2;dispX=pts[i2]-pts[i1],dispY=pts[i2+1]-pts[i1+1]}else{i1=(i2=pts.length/2-1)-2;var i2,i3=i2+2;dispX=pts[i2]-pts[i1],dispY=pts[i2+1]-pts[i1+1]}else if(isMultibezier||isCompound||isSelf){var bp0x,bp0y,bp1x,bp1y,pts=rs.allpts;if(rs.ctrlpts.length/2%2==0){var p1=(ic=(p0=pts.length/2-1)+2)+2;bp0x=qbezierAt(pts[p0],pts[ic],pts[p1],0),bp0y=qbezierAt(pts[p0+1],pts[ic+1],pts[p1+1],0),bp1x=qbezierAt(pts[p0],pts[ic],pts[p1],1e-4),bp1y=qbezierAt(pts[p0+1],pts[ic+1],pts[p1+1],1e-4)}else{var ic,p0;p1=(ic=pts.length/2-1)+2;bp0x=qbezierAt(pts[p0=ic-2],pts[ic],pts[p1],.4999),bp0y=qbezierAt(pts[p0+1],pts[ic+1],pts[p1+1],.4999),bp1x=qbezierAt(pts[p0],pts[ic],pts[p1],.5),bp1y=qbezierAt(pts[p0+1],pts[ic+1],pts[p1+1],.5)}dispX=bp1x-bp0x,dispY=bp1y-bp0y}(rs.midtgtArrowAngle=getAngleFromDisp(dispX,dispY),rs.midDispX=dispX,rs.midDispY=dispY,dispX*=-1,dispY*=-1,isSegments)&&((pts=rs.allpts).length/2%2==0||(dispX=-(pts[i3=(i2=pts.length/2-1)+2]-pts[i2]),dispY=-(pts[i3+1]-pts[i2+1])));if(rs.midsrcArrowAngle=getAngleFromDisp(dispX,dispY),isSegments)dispX=endX-rs.segpts[rs.segpts.length-2],dispY=endY-rs.segpts[rs.segpts.length-1];else if(isMultibezier||isCompound||isSelf||isBezier){var l=(pts=rs.allpts).length;dispX=endX-qbezierAt(pts[l-6],pts[l-4],pts[l-2],.9),dispY=endY-qbezierAt(pts[l-5],pts[l-3],pts[l-1],.9)}else dispX=endX-midX,dispY=endY-midY;rs.tgtArrowAngle=getAngleFromDisp(dispX,dispY)}};BRp$2.getArrowWidth=BRp$2.getArrowHeight=function(edgeWidth,scale){var cache=this.arrowWidthCache=this.arrowWidthCache||{},cachedVal=cache[edgeWidth+", "+scale];return cachedVal||(cachedVal=Math.max(Math.pow(13.37*edgeWidth,.9),29)*scale,cache[edgeWidth+", "+scale]=cachedVal,cachedVal)};var BRp$3={};function getPts(pts){var retPts=[];if(null!=pts){for(var i=0;i<pts.length;i+=2){var x=pts[i],y=pts[i+1];retPts.push({x:x,y:y})}return retPts}}BRp$3.findHaystackPoints=function(edges){for(var i=0;i<edges.length;i++){var edge=edges[i],_p=edge._private,rs=_p.rscratch;if(!rs.haystack){var angle=2*Math.random()*Math.PI;rs.source={x:Math.cos(angle),y:Math.sin(angle)},angle=2*Math.random()*Math.PI,rs.target={x:Math.cos(angle),y:Math.sin(angle)}}var src=_p.source,tgt=_p.target,srcPos=src.position(),tgtPos=tgt.position(),srcW=src.width(),tgtW=tgt.width(),srcH=src.height(),tgtH=tgt.height(),halfRadius=edge.pstyle("haystack-radius").value/2;rs.haystackPts=rs.allpts=[rs.source.x*srcW*halfRadius+srcPos.x,rs.source.y*srcH*halfRadius+srcPos.y,rs.target.x*tgtW*halfRadius+tgtPos.x,rs.target.y*tgtH*halfRadius+tgtPos.y],rs.midX=(rs.allpts[0]+rs.allpts[2])/2,rs.midY=(rs.allpts[1]+rs.allpts[3])/2,rs.edgeType="haystack",rs.haystack=!0,this.storeEdgeProjections(edge),this.calculateArrowAngles(edge),this.recalculateEdgeLabelProjections(edge),this.calculateLabelAngles(edge)}},BRp$3.findSegmentsPoints=function(edge,pairInfo){var rs=edge._private.rscratch,posPts=pairInfo.posPts,intersectionPts=pairInfo.intersectionPts,vectorNormInverse=pairInfo.vectorNormInverse,edgeDistances=edge.pstyle("edge-distances").value,segmentWs=edge.pstyle("segment-weights"),segmentDs=edge.pstyle("segment-distances"),segmentsN=Math.min(segmentWs.pfValue.length,segmentDs.pfValue.length);rs.edgeType="segments",rs.segpts=[];for(var s=0;s<segmentsN;s++){var w=segmentWs.pfValue[s],d=segmentDs.pfValue[s],w1=1-w,w2=w,midptPts="node-position"===edgeDistances?posPts:intersectionPts,adjustedMidpt={x:midptPts.x1*w1+midptPts.x2*w2,y:midptPts.y1*w1+midptPts.y2*w2};rs.segpts.push(adjustedMidpt.x+vectorNormInverse.x*d,adjustedMidpt.y+vectorNormInverse.y*d)}},BRp$3.findLoopPoints=function(edge,pairInfo,i,edgeIsUnbundled){var rs=edge._private.rscratch,dirCounts=pairInfo.dirCounts,srcPos=pairInfo.srcPos,ctrlptDists=edge.pstyle("control-point-distances"),ctrlptDist=ctrlptDists?ctrlptDists.pfValue[0]:void 0,loopDir=edge.pstyle("loop-direction").pfValue,loopSwp=edge.pstyle("loop-sweep").pfValue,stepSize=edge.pstyle("control-point-step-size").pfValue;rs.edgeType="self";var j=i,loopDist=stepSize;edgeIsUnbundled&&(j=0,loopDist=ctrlptDist);var loopAngle=loopDir-Math.PI/2,outAngle=loopAngle-loopSwp/2,inAngle=loopAngle+loopSwp/2,dc=String(loopDir+"_"+loopSwp);j=void 0===dirCounts[dc]?dirCounts[dc]=0:++dirCounts[dc],rs.ctrlpts=[srcPos.x+1.4*Math.cos(outAngle)*loopDist*(j/3+1),srcPos.y+1.4*Math.sin(outAngle)*loopDist*(j/3+1),srcPos.x+1.4*Math.cos(inAngle)*loopDist*(j/3+1),srcPos.y+1.4*Math.sin(inAngle)*loopDist*(j/3+1)]},BRp$3.findCompoundLoopPoints=function(edge,pairInfo,i,edgeIsUnbundled){var rs=edge._private.rscratch;rs.edgeType="compound";var srcPos=pairInfo.srcPos,tgtPos=pairInfo.tgtPos,srcW=pairInfo.srcW,srcH=pairInfo.srcH,tgtW=pairInfo.tgtW,tgtH=pairInfo.tgtH,stepSize=edge.pstyle("control-point-step-size").pfValue,ctrlptDists=edge.pstyle("control-point-distances"),ctrlptDist=ctrlptDists?ctrlptDists.pfValue[0]:void 0,j=i,loopDist=stepSize;edgeIsUnbundled&&(j=0,loopDist=ctrlptDist);var loopaPos={x:srcPos.x-srcW/2,y:srcPos.y-srcH/2},loopbPos={x:tgtPos.x-tgtW/2,y:tgtPos.y-tgtH/2},loopPos={x:Math.min(loopaPos.x,loopbPos.x),y:Math.min(loopaPos.y,loopbPos.y)},compoundStretchA=Math.max(.5,Math.log(.01*srcW)),compoundStretchB=Math.max(.5,Math.log(.01*tgtW));rs.ctrlpts=[loopPos.x,loopPos.y-(1+Math.pow(50,1.12)/100)*loopDist*(j/3+1)*compoundStretchA,loopPos.x-(1+Math.pow(50,1.12)/100)*loopDist*(j/3+1)*compoundStretchB,loopPos.y]},BRp$3.findStraightEdgePoints=function(edge){edge._private.rscratch.edgeType="straight"},BRp$3.findBezierPoints=function(edge,pairInfo,i,edgeIsUnbundled,edgeIsSwapped){var rs=edge._private.rscratch,vectorNormInverse=pairInfo.vectorNormInverse,posPts=pairInfo.posPts,intersectionPts=pairInfo.intersectionPts,edgeDistances=edge.pstyle("edge-distances").value,stepSize=edge.pstyle("control-point-step-size").pfValue,ctrlptDists=edge.pstyle("control-point-distances"),ctrlptWs=edge.pstyle("control-point-weights"),bezierN=ctrlptDists&&ctrlptWs?Math.min(ctrlptDists.value.length,ctrlptWs.value.length):1,ctrlptDist=ctrlptDists?ctrlptDists.pfValue[0]:void 0,ctrlptWeight=ctrlptWs.value[0],multi=edgeIsUnbundled;rs.edgeType=multi?"multibezier":"bezier",rs.ctrlpts=[];for(var b=0;b<bezierN;b++){var normctrlptDist=(.5-pairInfo.eles.length/2+i)*stepSize*(edgeIsSwapped?-1:1),manctrlptDist=void 0,sign=signum(normctrlptDist);multi&&(ctrlptDist=ctrlptDists?ctrlptDists.pfValue[b]:stepSize,ctrlptWeight=ctrlptWs.value[b]);var distanceFromMidpoint=void 0!==(manctrlptDist=edgeIsUnbundled?ctrlptDist:void 0!==ctrlptDist?sign*ctrlptDist:void 0)?manctrlptDist:normctrlptDist,w1=1-ctrlptWeight,w2=ctrlptWeight,midptPts="node-position"===edgeDistances?posPts:intersectionPts,adjustedMidpt={x:midptPts.x1*w1+midptPts.x2*w2,y:midptPts.y1*w1+midptPts.y2*w2};rs.ctrlpts.push(adjustedMidpt.x+vectorNormInverse.x*distanceFromMidpoint,adjustedMidpt.y+vectorNormInverse.y*distanceFromMidpoint)}},BRp$3.findTaxiPoints=function(edge,pairInfo){var rs=edge._private.rscratch;rs.edgeType="segments";var posPts=pairInfo.posPts,srcW=pairInfo.srcW,srcH=pairInfo.srcH,tgtW=pairInfo.tgtW,tgtH=pairInfo.tgtH,dIncludesNodeBody="node-position"!==edge.pstyle("edge-distances").value,taxiDir=edge.pstyle("taxi-direction").value,rawTaxiDir=taxiDir,taxiTurn=edge.pstyle("taxi-turn"),turnIsPercent="%"===taxiTurn.units,taxiTurnPfVal=taxiTurn.pfValue,turnIsNegative=taxiTurnPfVal<0,minD=edge.pstyle("taxi-turn-min-distance").pfValue,dw=dIncludesNodeBody?(srcW+tgtW)/2:0,dh=dIncludesNodeBody?(srcH+tgtH)/2:0,pdx=posPts.x2-posPts.x1,pdy=posPts.y2-posPts.y1,subDWH=function subDWH(dxy,dwh){return dxy>0?Math.max(dxy-dwh,0):Math.min(dxy+dwh,0)},dx=subDWH(pdx,dw),dy=subDWH(pdy,dh),isExplicitDir=!1;"auto"===rawTaxiDir?taxiDir=Math.abs(dx)>Math.abs(dy)?"horizontal":"vertical":"upward"===rawTaxiDir||"downward"===rawTaxiDir?(taxiDir="vertical",isExplicitDir=!0):"leftward"!==rawTaxiDir&&"rightward"!==rawTaxiDir||(taxiDir="horizontal",isExplicitDir=!0);var d,isVert="vertical"===taxiDir,l=isVert?dy:dx,pl=isVert?pdy:pdx,sgnL=signum(pl),forcedDir=!1;(isExplicitDir&&(turnIsPercent||turnIsNegative)||!("downward"===rawTaxiDir&&pl<0||"upward"===rawTaxiDir&&pl>0||"leftward"===rawTaxiDir&&pl>0||"rightward"===rawTaxiDir&&pl<0)||(l=(sgnL*=-1)*Math.abs(l),forcedDir=!0),turnIsPercent)?d=(taxiTurnPfVal<0?1+taxiTurnPfVal:taxiTurnPfVal)*l:d=(taxiTurnPfVal<0?l:0)+taxiTurnPfVal*sgnL;var getIsTooClose=function getIsTooClose(d){return Math.abs(d)<minD||Math.abs(d)>=Math.abs(l)},isTooCloseSrc=getIsTooClose(d),isTooCloseTgt=getIsTooClose(Math.abs(l)-Math.abs(d));if((isTooCloseSrc||isTooCloseTgt)&&!forcedDir)if(isVert){var lShapeInsideSrc=Math.abs(pl)<=srcH/2,lShapeInsideTgt=Math.abs(pdx)<=tgtW/2;if(lShapeInsideSrc){var x=(posPts.x1+posPts.x2)/2,y1=posPts.y1,y2=posPts.y2;rs.segpts=[x,y1,x,y2]}else if(lShapeInsideTgt){var y=(posPts.y1+posPts.y2)/2,x1=posPts.x1,x2=posPts.x2;rs.segpts=[x1,y,x2,y]}else rs.segpts=[posPts.x1,posPts.y2]}else{var _lShapeInsideSrc=Math.abs(pl)<=srcW/2,_lShapeInsideTgt=Math.abs(pdy)<=tgtH/2;if(_lShapeInsideSrc){var _y=(posPts.y1+posPts.y2)/2,_x=posPts.x1,_x2=posPts.x2;rs.segpts=[_x,_y,_x2,_y]}else if(_lShapeInsideTgt){var _x3=(posPts.x1+posPts.x2)/2,_y2=posPts.y1,_y3=posPts.y2;rs.segpts=[_x3,_y2,_x3,_y3]}else rs.segpts=[posPts.x2,posPts.y1]}else if(isVert){var _y4=posPts.y1+d+(dIncludesNodeBody?srcH/2*sgnL:0),_x4=posPts.x1,_x5=posPts.x2;rs.segpts=[_x4,_y4,_x5,_y4]}else{var _x6=posPts.x1+d+(dIncludesNodeBody?srcW/2*sgnL:0),_y5=posPts.y1,_y6=posPts.y2;rs.segpts=[_x6,_y5,_x6,_y6]}},BRp$3.tryToCorrectInvalidPoints=function(edge,pairInfo){var rs=edge._private.rscratch;if("bezier"===rs.edgeType){var srcPos=pairInfo.srcPos,tgtPos=pairInfo.tgtPos,srcW=pairInfo.srcW,srcH=pairInfo.srcH,tgtW=pairInfo.tgtW,tgtH=pairInfo.tgtH,srcShape=pairInfo.srcShape,tgtShape=pairInfo.tgtShape,badStart=!number(rs.startX)||!number(rs.startY),badAStart=!number(rs.arrowStartX)||!number(rs.arrowStartY),badEnd=!number(rs.endX)||!number(rs.endY),badAEnd=!number(rs.arrowEndX)||!number(rs.arrowEndY),minCpADist=3*(this.getArrowWidth(edge.pstyle("width").pfValue,edge.pstyle("arrow-scale").value)*this.arrowShapeWidth),startACpDist=dist({x:rs.ctrlpts[0],y:rs.ctrlpts[1]},{x:rs.startX,y:rs.startY}),closeStartACp=startACpDist<minCpADist,endACpDist=dist({x:rs.ctrlpts[0],y:rs.ctrlpts[1]},{x:rs.endX,y:rs.endY}),closeEndACp=endACpDist<minCpADist,overlapping=!1;if(badStart||badAStart||closeStartACp){overlapping=!0;var cpD={x:rs.ctrlpts[0]-srcPos.x,y:rs.ctrlpts[1]-srcPos.y},cpL=Math.sqrt(cpD.x*cpD.x+cpD.y*cpD.y),cpM={x:cpD.x/cpL,y:cpD.y/cpL},radius=Math.max(srcW,srcH),cpProj={x:rs.ctrlpts[0]+2*cpM.x*radius,y:rs.ctrlpts[1]+2*cpM.y*radius},srcCtrlPtIntn=srcShape.intersectLine(srcPos.x,srcPos.y,srcW,srcH,cpProj.x,cpProj.y,0);closeStartACp?(rs.ctrlpts[0]=rs.ctrlpts[0]+cpM.x*(minCpADist-startACpDist),rs.ctrlpts[1]=rs.ctrlpts[1]+cpM.y*(minCpADist-startACpDist)):(rs.ctrlpts[0]=srcCtrlPtIntn[0]+cpM.x*minCpADist,rs.ctrlpts[1]=srcCtrlPtIntn[1]+cpM.y*minCpADist)}if(badEnd||badAEnd||closeEndACp){overlapping=!0;var _cpD={x:rs.ctrlpts[0]-tgtPos.x,y:rs.ctrlpts[1]-tgtPos.y},_cpL=Math.sqrt(_cpD.x*_cpD.x+_cpD.y*_cpD.y),_cpM={x:_cpD.x/_cpL,y:_cpD.y/_cpL},_radius=Math.max(srcW,srcH),_cpProj={x:rs.ctrlpts[0]+2*_cpM.x*_radius,y:rs.ctrlpts[1]+2*_cpM.y*_radius},tgtCtrlPtIntn=tgtShape.intersectLine(tgtPos.x,tgtPos.y,tgtW,tgtH,_cpProj.x,_cpProj.y,0);closeEndACp?(rs.ctrlpts[0]=rs.ctrlpts[0]+_cpM.x*(minCpADist-endACpDist),rs.ctrlpts[1]=rs.ctrlpts[1]+_cpM.y*(minCpADist-endACpDist)):(rs.ctrlpts[0]=tgtCtrlPtIntn[0]+_cpM.x*minCpADist,rs.ctrlpts[1]=tgtCtrlPtIntn[1]+_cpM.y*minCpADist)}overlapping&&this.findEndpoints(edge)}},BRp$3.storeAllpts=function(edge){var rs=edge._private.rscratch;if("multibezier"===rs.edgeType||"bezier"===rs.edgeType||"self"===rs.edgeType||"compound"===rs.edgeType){rs.allpts=[],rs.allpts.push(rs.startX,rs.startY);for(var b=0;b+1<rs.ctrlpts.length;b+=2)rs.allpts.push(rs.ctrlpts[b],rs.ctrlpts[b+1]),b+3<rs.ctrlpts.length&&rs.allpts.push((rs.ctrlpts[b]+rs.ctrlpts[b+2])/2,(rs.ctrlpts[b+1]+rs.ctrlpts[b+3])/2);var m;rs.allpts.push(rs.endX,rs.endY),rs.ctrlpts.length/2%2==0?(m=rs.allpts.length/2-1,rs.midX=rs.allpts[m],rs.midY=rs.allpts[m+1]):(m=rs.allpts.length/2-3,.5,rs.midX=qbezierAt(rs.allpts[m],rs.allpts[m+2],rs.allpts[m+4],.5),rs.midY=qbezierAt(rs.allpts[m+1],rs.allpts[m+3],rs.allpts[m+5],.5))}else if("straight"===rs.edgeType)rs.allpts=[rs.startX,rs.startY,rs.endX,rs.endY],rs.midX=(rs.startX+rs.endX+rs.arrowStartX+rs.arrowEndX)/4,rs.midY=(rs.startY+rs.endY+rs.arrowStartY+rs.arrowEndY)/4;else if("segments"===rs.edgeType)if(rs.allpts=[],rs.allpts.push(rs.startX,rs.startY),rs.allpts.push.apply(rs.allpts,rs.segpts),rs.allpts.push(rs.endX,rs.endY),rs.segpts.length%4==0){var i2=rs.segpts.length/2,i1=i2-2;rs.midX=(rs.segpts[i1]+rs.segpts[i2])/2,rs.midY=(rs.segpts[i1+1]+rs.segpts[i2+1])/2}else{var _i=rs.segpts.length/2-1;rs.midX=rs.segpts[_i],rs.midY=rs.segpts[_i+1]}},BRp$3.checkForInvalidEdgeWarning=function(edge){var rs=edge[0]._private.rscratch;rs.nodesOverlap||number(rs.startX)&&number(rs.startY)&&number(rs.endX)&&number(rs.endY)?rs.loggedErr=!1:rs.loggedErr||(rs.loggedErr=!0,warn("Edge `"+edge.id()+"` has invalid endpoints and so it is impossible to draw.  Adjust your edge style (e.g. control points) accordingly or use an alternative edge type.  This is expected behaviour when the source node and the target node overlap."))},BRp$3.findEdgeControlPoints=function(edges){var _this=this;if(edges&&0!==edges.length){for(var r=this,hasCompounds=r.cy.hasCompoundNodes(),hashTable={map:new Map$1,get:function get(pairId){var map2=this.map.get(pairId[0]);return null!=map2?map2.get(pairId[1]):null},set:function set(pairId,val){var map2=this.map.get(pairId[0]);null==map2&&(map2=new Map$1,this.map.set(pairId[0],map2)),map2.set(pairId[1],val)}},pairIds=[],haystackEdges=[],i=0;i<edges.length;i++){var edge=edges[i],_p=edge._private,curveStyle=edge.pstyle("curve-style").value;if(!edge.removed()&&edge.takesUpSpace())if("haystack"!==curveStyle){var edgeIsUnbundled="unbundled-bezier"===curveStyle||"segments"===curveStyle||"straight"===curveStyle||"taxi"===curveStyle,edgeIsBezier="unbundled-bezier"===curveStyle||"bezier"===curveStyle,src=_p.source,tgt=_p.target,pairId=[src.poolIndex(),tgt.poolIndex()].sort(),tableEntry=hashTable.get(pairId);null==tableEntry&&(tableEntry={eles:[]},hashTable.set(pairId,tableEntry),pairIds.push(pairId)),tableEntry.eles.push(edge),edgeIsUnbundled&&(tableEntry.hasUnbundled=!0),edgeIsBezier&&(tableEntry.hasBezier=!0)}else haystackEdges.push(edge)}for(var _loop=function _loop(p){var pairId=pairIds[p],pairInfo=hashTable.get(pairId),swappedpairInfo=void 0;if(!pairInfo.hasUnbundled){var pllEdges=pairInfo.eles[0].parallelEdges().filter((function(e){return e.isBundledBezier()}));clearArray(pairInfo.eles),pllEdges.forEach((function(edge){return pairInfo.eles.push(edge)})),pairInfo.eles.sort((function(edge1,edge2){return edge1.poolIndex()-edge2.poolIndex()}))}var firstEdge=pairInfo.eles[0],src=firstEdge.source(),tgt=firstEdge.target();if(src.poolIndex()>tgt.poolIndex()){var temp=src;src=tgt,tgt=temp}var srcPos=pairInfo.srcPos=src.position(),tgtPos=pairInfo.tgtPos=tgt.position(),srcW=pairInfo.srcW=src.outerWidth(),srcH=pairInfo.srcH=src.outerHeight(),tgtW=pairInfo.tgtW=tgt.outerWidth(),tgtH=pairInfo.tgtH=tgt.outerHeight(),srcShape=pairInfo.srcShape=r.nodeShapes[_this.getNodeShape(src)],tgtShape=pairInfo.tgtShape=r.nodeShapes[_this.getNodeShape(tgt)];pairInfo.dirCounts={north:0,west:0,south:0,east:0,northwest:0,southwest:0,northeast:0,southeast:0};for(var _i2=0;_i2<pairInfo.eles.length;_i2++){var _edge=pairInfo.eles[_i2],rs=_edge[0]._private.rscratch,_curveStyle=_edge.pstyle("curve-style").value,_edgeIsUnbundled="unbundled-bezier"===_curveStyle||"segments"===_curveStyle||"taxi"===_curveStyle,edgeIsSwapped=!src.same(_edge.source());if(!pairInfo.calculatedIntersection&&src!==tgt&&(pairInfo.hasBezier||pairInfo.hasUnbundled)){pairInfo.calculatedIntersection=!0;var srcOutside=srcShape.intersectLine(srcPos.x,srcPos.y,srcW,srcH,tgtPos.x,tgtPos.y,0),srcIntn=pairInfo.srcIntn=srcOutside,tgtOutside=tgtShape.intersectLine(tgtPos.x,tgtPos.y,tgtW,tgtH,srcPos.x,srcPos.y,0),tgtIntn=pairInfo.tgtIntn=tgtOutside,intersectionPts=pairInfo.intersectionPts={x1:srcOutside[0],x2:tgtOutside[0],y1:srcOutside[1],y2:tgtOutside[1]},posPts=pairInfo.posPts={x1:srcPos.x,x2:tgtPos.x,y1:srcPos.y,y2:tgtPos.y},dy=tgtOutside[1]-srcOutside[1],dx=tgtOutside[0]-srcOutside[0],l=Math.sqrt(dx*dx+dy*dy),vector=pairInfo.vector={x:dx,y:dy},vectorNorm=pairInfo.vectorNorm={x:vector.x/l,y:vector.y/l},vectorNormInverse={x:-vectorNorm.y,y:vectorNorm.x};pairInfo.nodesOverlap=!number(l)||tgtShape.checkPoint(srcOutside[0],srcOutside[1],0,tgtW,tgtH,tgtPos.x,tgtPos.y)||srcShape.checkPoint(tgtOutside[0],tgtOutside[1],0,srcW,srcH,srcPos.x,srcPos.y),pairInfo.vectorNormInverse=vectorNormInverse,swappedpairInfo={nodesOverlap:pairInfo.nodesOverlap,dirCounts:pairInfo.dirCounts,calculatedIntersection:!0,hasBezier:pairInfo.hasBezier,hasUnbundled:pairInfo.hasUnbundled,eles:pairInfo.eles,srcPos:tgtPos,tgtPos:srcPos,srcW:tgtW,srcH:tgtH,tgtW:srcW,tgtH:srcH,srcIntn:tgtIntn,tgtIntn:srcIntn,srcShape:tgtShape,tgtShape:srcShape,posPts:{x1:posPts.x2,y1:posPts.y2,x2:posPts.x1,y2:posPts.y1},intersectionPts:{x1:intersectionPts.x2,y1:intersectionPts.y2,x2:intersectionPts.x1,y2:intersectionPts.y1},vector:{x:-vector.x,y:-vector.y},vectorNorm:{x:-vectorNorm.x,y:-vectorNorm.y},vectorNormInverse:{x:-vectorNormInverse.x,y:-vectorNormInverse.y}}}var passedPairInfo=edgeIsSwapped?swappedpairInfo:pairInfo;rs.nodesOverlap=passedPairInfo.nodesOverlap,rs.srcIntn=passedPairInfo.srcIntn,rs.tgtIntn=passedPairInfo.tgtIntn,hasCompounds&&(src.isParent()||src.isChild()||tgt.isParent()||tgt.isChild())&&(src.parents().anySame(tgt)||tgt.parents().anySame(src)||src.same(tgt)&&src.isParent())?_this.findCompoundLoopPoints(_edge,passedPairInfo,_i2,_edgeIsUnbundled):src===tgt?_this.findLoopPoints(_edge,passedPairInfo,_i2,_edgeIsUnbundled):"segments"===_curveStyle?_this.findSegmentsPoints(_edge,passedPairInfo):"taxi"===_curveStyle?_this.findTaxiPoints(_edge,passedPairInfo):"straight"===_curveStyle||!_edgeIsUnbundled&&pairInfo.eles.length%2==1&&_i2===Math.floor(pairInfo.eles.length/2)?_this.findStraightEdgePoints(_edge):_this.findBezierPoints(_edge,passedPairInfo,_i2,_edgeIsUnbundled,edgeIsSwapped),_this.findEndpoints(_edge),_this.tryToCorrectInvalidPoints(_edge,passedPairInfo),_this.checkForInvalidEdgeWarning(_edge),_this.storeAllpts(_edge),_this.storeEdgeProjections(_edge),_this.calculateArrowAngles(_edge),_this.recalculateEdgeLabelProjections(_edge),_this.calculateLabelAngles(_edge)}},p=0;p<pairIds.length;p++)_loop(p);this.findHaystackPoints(haystackEdges)}},BRp$3.getSegmentPoints=function(edge){var rs=edge[0]._private.rscratch;if("segments"===rs.edgeType)return this.recalculateRenderedStyle(edge),getPts(rs.segpts)},BRp$3.getControlPoints=function(edge){var rs=edge[0]._private.rscratch,type=rs.edgeType;if("bezier"===type||"multibezier"===type||"self"===type||"compound"===type)return this.recalculateRenderedStyle(edge),getPts(rs.ctrlpts)},BRp$3.getEdgeMidpoint=function(edge){var rs=edge[0]._private.rscratch;return this.recalculateRenderedStyle(edge),{x:rs.midX,y:rs.midY}};var BRp$4={manualEndptToPx:function(node,prop){var npos=node.position(),w=node.outerWidth(),h=node.outerHeight();if(2===prop.value.length){var p=[prop.pfValue[0],prop.pfValue[1]];return"%"===prop.units[0]&&(p[0]=p[0]*w),"%"===prop.units[1]&&(p[1]=p[1]*h),p[0]+=npos.x,p[1]+=npos.y,p}var angle=prop.pfValue[0];angle=-Math.PI/2+angle;var l=2*Math.max(w,h),_p=[npos.x+Math.cos(angle)*l,npos.y+Math.sin(angle)*l];return this.nodeShapes[this.getNodeShape(node)].intersectLine(npos.x,npos.y,w,h,_p[0],_p[1],0)},findEndpoints:function(edge){var intersect,p1,p2,p1_i,p2_i,r=this,source=edge.source()[0],target=edge.target()[0],srcPos=source.position(),tgtPos=target.position(),tgtArShape=edge.pstyle("target-arrow-shape").value,srcArShape=edge.pstyle("source-arrow-shape").value,tgtDist=edge.pstyle("target-distance-from-node").pfValue,srcDist=edge.pstyle("source-distance-from-node").pfValue,curveStyle=edge.pstyle("curve-style").value,rs=edge._private.rscratch,et=rs.edgeType,self="self"===et||"compound"===et,bezier="bezier"===et||"multibezier"===et||self,multi="bezier"!==et,lines="straight"===et||"segments"===et,segments="segments"===et,hasEndpts=bezier||multi||lines,overrideEndpts=self||"taxi"===curveStyle,srcManEndpt=edge.pstyle("source-endpoint"),srcManEndptVal=overrideEndpts?"outside-to-node":srcManEndpt.value,tgtManEndpt=edge.pstyle("target-endpoint"),tgtManEndptVal=overrideEndpts?"outside-to-node":tgtManEndpt.value;if(rs.srcManEndpt=srcManEndpt,rs.tgtManEndpt=tgtManEndpt,bezier){var cpStart=[rs.ctrlpts[0],rs.ctrlpts[1]];p1=multi?[rs.ctrlpts[rs.ctrlpts.length-2],rs.ctrlpts[rs.ctrlpts.length-1]]:cpStart,p2=cpStart}else if(lines){var srcArrowFromPt=segments?rs.segpts.slice(0,2):[tgtPos.x,tgtPos.y];p1=segments?rs.segpts.slice(rs.segpts.length-2):[srcPos.x,srcPos.y],p2=srcArrowFromPt}if("inside-to-node"===tgtManEndptVal)intersect=[tgtPos.x,tgtPos.y];else if(tgtManEndpt.units)intersect=this.manualEndptToPx(target,tgtManEndpt);else if("outside-to-line"===tgtManEndptVal)intersect=rs.tgtIntn;else if("outside-to-node"===tgtManEndptVal||"outside-to-node-or-label"===tgtManEndptVal?p1_i=p1:"outside-to-line"!==tgtManEndptVal&&"outside-to-line-or-label"!==tgtManEndptVal||(p1_i=[srcPos.x,srcPos.y]),intersect=r.nodeShapes[this.getNodeShape(target)].intersectLine(tgtPos.x,tgtPos.y,target.outerWidth(),target.outerHeight(),p1_i[0],p1_i[1],0),"outside-to-node-or-label"===tgtManEndptVal||"outside-to-line-or-label"===tgtManEndptVal){var trs=target._private.rscratch,lw=trs.labelWidth,lh=trs.labelHeight,lx=trs.labelX,ly=trs.labelY,lw2=lw/2,lh2=lh/2,va=target.pstyle("text-valign").value;"top"===va?ly-=lh2:"bottom"===va&&(ly+=lh2);var ha=target.pstyle("text-halign").value;"left"===ha?lx-=lw2:"right"===ha&&(lx+=lw2);var labelIntersect=polygonIntersectLine(p1_i[0],p1_i[1],[lx-lw2,ly-lh2,lx+lw2,ly-lh2,lx+lw2,ly+lh2,lx-lw2,ly+lh2],tgtPos.x,tgtPos.y);if(labelIntersect.length>0){var refPt=srcPos,intSqdist=sqdist(refPt,array2point(intersect)),labIntSqdist=sqdist(refPt,array2point(labelIntersect)),minSqDist=intSqdist;if(labIntSqdist<intSqdist&&(intersect=labelIntersect,minSqDist=labIntSqdist),labelIntersect.length>2)sqdist(refPt,{x:labelIntersect[2],y:labelIntersect[3]})<minSqDist&&(intersect=[labelIntersect[2],labelIntersect[3]])}}var arrowEnd=shortenIntersection(intersect,p1,r.arrowShapes[tgtArShape].spacing(edge)+tgtDist),edgeEnd=shortenIntersection(intersect,p1,r.arrowShapes[tgtArShape].gap(edge)+tgtDist);if(rs.endX=edgeEnd[0],rs.endY=edgeEnd[1],rs.arrowEndX=arrowEnd[0],rs.arrowEndY=arrowEnd[1],"inside-to-node"===srcManEndptVal)intersect=[srcPos.x,srcPos.y];else if(srcManEndpt.units)intersect=this.manualEndptToPx(source,srcManEndpt);else if("outside-to-line"===srcManEndptVal)intersect=rs.srcIntn;else if("outside-to-node"===srcManEndptVal||"outside-to-node-or-label"===srcManEndptVal?p2_i=p2:"outside-to-line"!==srcManEndptVal&&"outside-to-line-or-label"!==srcManEndptVal||(p2_i=[tgtPos.x,tgtPos.y]),intersect=r.nodeShapes[this.getNodeShape(source)].intersectLine(srcPos.x,srcPos.y,source.outerWidth(),source.outerHeight(),p2_i[0],p2_i[1],0),"outside-to-node-or-label"===srcManEndptVal||"outside-to-line-or-label"===srcManEndptVal){var srs=source._private.rscratch,_lw=srs.labelWidth,_lh=srs.labelHeight,_lx=srs.labelX,_ly=srs.labelY,_lw2=_lw/2,_lh2=_lh/2,_va=source.pstyle("text-valign").value;"top"===_va?_ly-=_lh2:"bottom"===_va&&(_ly+=_lh2);var _ha=source.pstyle("text-halign").value;"left"===_ha?_lx-=_lw2:"right"===_ha&&(_lx+=_lw2);var _labelIntersect=polygonIntersectLine(p2_i[0],p2_i[1],[_lx-_lw2,_ly-_lh2,_lx+_lw2,_ly-_lh2,_lx+_lw2,_ly+_lh2,_lx-_lw2,_ly+_lh2],srcPos.x,srcPos.y);if(_labelIntersect.length>0){var _refPt=tgtPos,_intSqdist=sqdist(_refPt,array2point(intersect)),_labIntSqdist=sqdist(_refPt,array2point(_labelIntersect)),_minSqDist=_intSqdist;if(_labIntSqdist<_intSqdist&&(intersect=[_labelIntersect[0],_labelIntersect[1]],_minSqDist=_labIntSqdist),_labelIntersect.length>2)sqdist(_refPt,{x:_labelIntersect[2],y:_labelIntersect[3]})<_minSqDist&&(intersect=[_labelIntersect[2],_labelIntersect[3]])}}var arrowStart=shortenIntersection(intersect,p2,r.arrowShapes[srcArShape].spacing(edge)+srcDist),edgeStart=shortenIntersection(intersect,p2,r.arrowShapes[srcArShape].gap(edge)+srcDist);rs.startX=edgeStart[0],rs.startY=edgeStart[1],rs.arrowStartX=arrowStart[0],rs.arrowStartY=arrowStart[1],hasEndpts&&(number(rs.startX)&&number(rs.startY)&&number(rs.endX)&&number(rs.endY)?rs.badLine=!1:rs.badLine=!0)},getSourceEndpoint:function(edge){var rs=edge[0]._private.rscratch;switch(this.recalculateRenderedStyle(edge),rs.edgeType){case"haystack":return{x:rs.haystackPts[0],y:rs.haystackPts[1]};default:return{x:rs.arrowStartX,y:rs.arrowStartY}}},getTargetEndpoint:function(edge){var rs=edge[0]._private.rscratch;switch(this.recalculateRenderedStyle(edge),rs.edgeType){case"haystack":return{x:rs.haystackPts[2],y:rs.haystackPts[3]};default:return{x:rs.arrowEndX,y:rs.arrowEndY}}}},BRp$5={};function pushBezierPts(r,edge,pts){for(var qbezierAt$1=function qbezierAt$1(p1,p2,p3,t){return qbezierAt(p1,p2,p3,t)},bpts=edge._private.rstyle.bezierPts,i=0;i<r.bezierProjPcts.length;i++){var p=r.bezierProjPcts[i];bpts.push({x:qbezierAt$1(pts[0],pts[2],pts[4],p),y:qbezierAt$1(pts[1],pts[3],pts[5],p)})}}BRp$5.storeEdgeProjections=function(edge){var _p=edge._private,rs=_p.rscratch,et=rs.edgeType;if(_p.rstyle.bezierPts=null,_p.rstyle.linePts=null,_p.rstyle.haystackPts=null,"multibezier"===et||"bezier"===et||"self"===et||"compound"===et){_p.rstyle.bezierPts=[];for(var i=0;i+5<rs.allpts.length;i+=4)pushBezierPts(this,edge,rs.allpts.slice(i,i+6))}else if("segments"===et){var lpts=_p.rstyle.linePts=[];for(i=0;i+1<rs.allpts.length;i+=2)lpts.push({x:rs.allpts[i],y:rs.allpts[i+1]})}else if("haystack"===et){var hpts=rs.haystackPts;_p.rstyle.haystackPts=[{x:hpts[0],y:hpts[1]},{x:hpts[2],y:hpts[3]}]}_p.rstyle.arrowWidth=this.getArrowWidth(edge.pstyle("width").pfValue,edge.pstyle("arrow-scale").value)*this.arrowShapeWidth},BRp$5.recalculateEdgeProjections=function(edges){this.findEdgeControlPoints(edges)};var BRp$6={recalculateNodeLabelProjection:function(node){var content=node.pstyle("label").strValue;if(!emptyString(content)){var textX,textY,_p=node._private,nodeWidth=node.width(),nodeHeight=node.height(),padding=node.padding(),nodePos=node.position(),textHalign=node.pstyle("text-halign").strValue,textValign=node.pstyle("text-valign").strValue,rs=_p.rscratch,rstyle=_p.rstyle;switch(textHalign){case"left":textX=nodePos.x-nodeWidth/2-padding;break;case"right":textX=nodePos.x+nodeWidth/2+padding;break;default:textX=nodePos.x}switch(textValign){case"top":textY=nodePos.y-nodeHeight/2-padding;break;case"bottom":textY=nodePos.y+nodeHeight/2+padding;break;default:textY=nodePos.y}rs.labelX=textX,rs.labelY=textY,rstyle.labelX=textX,rstyle.labelY=textY,this.calculateLabelAngles(node),this.applyLabelDimensions(node)}}},lineAngleFromDelta=function lineAngleFromDelta(dx,dy){var angle=Math.atan(dy/dx);return 0===dx&&angle<0&&(angle*=-1),angle},lineAngle=function lineAngle(p0,p1){var dx=p1.x-p0.x,dy=p1.y-p0.y;return lineAngleFromDelta(dx,dy)};BRp$6.recalculateEdgeLabelProjections=function(edge){var p,_p=edge._private,rs=_p.rscratch,r=this,content={mid:edge.pstyle("label").strValue,source:edge.pstyle("source-label").strValue,target:edge.pstyle("target-label").strValue};if(content.mid||content.source||content.target){p={x:rs.midX,y:rs.midY};var setRs=function setRs(propName,prefix,value){setPrefixedProperty(_p.rscratch,propName,prefix,value),setPrefixedProperty(_p.rstyle,propName,prefix,value)};setRs("labelX",null,p.x),setRs("labelY",null,p.y);var midAngle=lineAngleFromDelta(rs.midDispX,rs.midDispY);setRs("labelAutoAngle",null,midAngle);var calculateEndProjection=function calculateEndProjection(prefix){var angle,isSrc="source"===prefix;if(content[prefix]){var offset=edge.pstyle(prefix+"-text-offset").pfValue;switch(rs.edgeType){case"self":case"compound":case"bezier":case"multibezier":for(var selected,cps=function createControlPointInfo(){if(createControlPointInfo.cache)return createControlPointInfo.cache;for(var ctrlpts=[],i=0;i+5<rs.allpts.length;i+=4){var p0={x:rs.allpts[i],y:rs.allpts[i+1]},p1={x:rs.allpts[i+2],y:rs.allpts[i+3]},p2={x:rs.allpts[i+4],y:rs.allpts[i+5]};ctrlpts.push({p0:p0,p1:p1,p2:p2,startDist:0,length:0,segments:[]})}var bpts=_p.rstyle.bezierPts,nProjs=r.bezierProjPcts.length;function addSegment(cp,p0,p1,t0,t1){var length=dist(p0,p1),prevSegment=cp.segments[cp.segments.length-1],segment={p0:p0,p1:p1,t0:t0,t1:t1,startDist:prevSegment?prevSegment.startDist+prevSegment.length:0,length:length};cp.segments.push(segment),cp.length+=length}for(var _i=0;_i<ctrlpts.length;_i++){var cp=ctrlpts[_i],prevCp=ctrlpts[_i-1];prevCp&&(cp.startDist=prevCp.startDist+prevCp.length),addSegment(cp,cp.p0,bpts[_i*nProjs],0,r.bezierProjPcts[0]);for(var j=0;j<nProjs-1;j++)addSegment(cp,bpts[_i*nProjs+j],bpts[_i*nProjs+j+1],r.bezierProjPcts[j],r.bezierProjPcts[j+1]);addSegment(cp,bpts[_i*nProjs+nProjs-1],cp.p2,r.bezierProjPcts[nProjs-1],1)}return createControlPointInfo.cache=ctrlpts}(),startDist=0,totalDist=0,i=0;i<cps.length;i++){for(var _cp=cps[isSrc?i:cps.length-1-i],j=0;j<_cp.segments.length;j++){var _seg=_cp.segments[isSrc?j:_cp.segments.length-1-j],lastSeg=i===cps.length-1&&j===_cp.segments.length-1;if(startDist=totalDist,(totalDist+=_seg.length)>=offset||lastSeg){selected={cp:_cp,segment:_seg};break}}if(selected)break}var cp=selected.cp,seg=selected.segment,tSegment=(offset-startDist)/seg.length,segDt=seg.t1-seg.t0,t=isSrc?seg.t0+segDt*tSegment:seg.t1-segDt*tSegment;t=bound(0,t,1),p=qbezierPtAt(cp.p0,cp.p1,cp.p2,t),angle=function bezierAngle(p0,p1,p2,t){var t0=bound(0,t-.001,1),t1=bound(0,t+.001,1),lp0=qbezierPtAt(p0,p1,p2,t0),lp1=qbezierPtAt(p0,p1,p2,t1);return lineAngle(lp0,lp1)}(cp.p0,cp.p1,cp.p2,t);break;case"straight":case"segments":case"haystack":for(var di,d0,p0,p1,d=0,l=rs.allpts.length,_i2=0;_i2+3<l&&(isSrc?(p0={x:rs.allpts[_i2],y:rs.allpts[_i2+1]},p1={x:rs.allpts[_i2+2],y:rs.allpts[_i2+3]}):(p0={x:rs.allpts[l-2-_i2],y:rs.allpts[l-1-_i2]},p1={x:rs.allpts[l-4-_i2],y:rs.allpts[l-3-_i2]}),d0=d,!((d+=di=dist(p0,p1))>=offset));_i2+=2);var _t=(offset-d0)/di;_t=bound(0,_t,1),p=function lineAt(p0,p1,t,d){var vec_x=p1.x-p0.x,vec_y=p1.y-p0.y,vecDist=dist(p0,p1),normVec_x=vec_x/vecDist,normVec_y=vec_y/vecDist;return t=null==t?0:t,d=null!=d?d:t*vecDist,{x:p0.x+normVec_x*d,y:p0.y+normVec_y*d}}(p0,p1,_t),angle=lineAngle(p0,p1)}setRs("labelX",prefix,p.x),setRs("labelY",prefix,p.y),setRs("labelAutoAngle",prefix,angle)}};calculateEndProjection("source"),calculateEndProjection("target"),this.applyLabelDimensions(edge)}},BRp$6.applyLabelDimensions=function(ele){this.applyPrefixedLabelDimensions(ele),ele.isEdge()&&(this.applyPrefixedLabelDimensions(ele,"source"),this.applyPrefixedLabelDimensions(ele,"target"))},BRp$6.applyPrefixedLabelDimensions=function(ele,prefix){var _p=ele._private,text=this.getLabelText(ele,prefix),labelDims=this.calculateLabelDimensions(ele,text),lineHeight=ele.pstyle("line-height").pfValue,textWrap=ele.pstyle("text-wrap").strValue,lines=getPrefixedProperty(_p.rscratch,"labelWrapCachedLines",prefix)||[],numLines="wrap"!==textWrap?1:Math.max(lines.length,1),normPerLineHeight=labelDims.height/numLines,labelLineHeight=normPerLineHeight*lineHeight,width=labelDims.width,height=labelDims.height+(numLines-1)*(lineHeight-1)*normPerLineHeight;setPrefixedProperty(_p.rstyle,"labelWidth",prefix,width),setPrefixedProperty(_p.rscratch,"labelWidth",prefix,width),setPrefixedProperty(_p.rstyle,"labelHeight",prefix,height),setPrefixedProperty(_p.rscratch,"labelHeight",prefix,height),setPrefixedProperty(_p.rscratch,"labelLineHeight",prefix,labelLineHeight)},BRp$6.getLabelText=function(ele,prefix){var _p=ele._private,pfd=prefix?prefix+"-":"",text=ele.pstyle(pfd+"label").strValue,textTransform=ele.pstyle("text-transform").value,rscratch=function rscratch(propName,value){return value?(setPrefixedProperty(_p.rscratch,propName,prefix,value),value):getPrefixedProperty(_p.rscratch,propName,prefix)};if(!text)return"";"none"==textTransform||("uppercase"==textTransform?text=text.toUpperCase():"lowercase"==textTransform&&(text=text.toLowerCase()));var wrapStyle=ele.pstyle("text-wrap").value;if("wrap"===wrapStyle){var labelKey=rscratch("labelKey");if(null!=labelKey&&rscratch("labelWrapKey")===labelKey)return rscratch("labelWrapCachedText");for(var lines=text.split("\n"),maxW=ele.pstyle("text-max-width").pfValue,overflowAny="anywhere"===ele.pstyle("text-overflow-wrap").value,wrappedLines=[],wordsRegex=/[\s\u200b]+/,wordSeparator=overflowAny?"":" ",l=0;l<lines.length;l++){var line=lines[l],lineW=this.calculateLabelDimensions(ele,line).width;if(overflowAny){var processedLine=line.split("").join("​");line=processedLine}if(lineW>maxW){for(var words=line.split(wordsRegex),subline="",w=0;w<words.length;w++){var word=words[w],testLine=0===subline.length?word:subline+wordSeparator+word;this.calculateLabelDimensions(ele,testLine).width<=maxW?subline+=word+wordSeparator:(subline&&wrappedLines.push(subline),subline=word+wordSeparator)}subline.match(/^[\s\u200b]+$/)||wrappedLines.push(subline)}else wrappedLines.push(line)}rscratch("labelWrapCachedLines",wrappedLines),text=rscratch("labelWrapCachedText",wrappedLines.join("\n")),rscratch("labelWrapKey",labelKey)}else if("ellipsis"===wrapStyle){var _maxW=ele.pstyle("text-max-width").pfValue,ellipsized="",incLastCh=!1;if(this.calculateLabelDimensions(ele,text).width<_maxW)return text;for(var i=0;i<text.length;i++){if(this.calculateLabelDimensions(ele,ellipsized+text[i]+"…").width>_maxW)break;ellipsized+=text[i],i===text.length-1&&(incLastCh=!0)}return incLastCh||(ellipsized+="…"),ellipsized}return text},BRp$6.getLabelJustification=function(ele){var justification=ele.pstyle("text-justification").strValue,textHalign=ele.pstyle("text-halign").strValue;if("auto"!==justification)return justification;if(!ele.isNode())return"center";switch(textHalign){case"left":return"right";case"right":return"left";default:return"center"}},BRp$6.calculateLabelDimensions=function(ele,text){var cacheKey=hashString(text,ele._private.labelDimsKey),cache=this.labelDimCache||(this.labelDimCache=[]),existingVal=cache[cacheKey];if(null!=existingVal)return existingVal;var fStyle=ele.pstyle("font-style").strValue,size=ele.pstyle("font-size").pfValue,family=ele.pstyle("font-family").strValue,weight=ele.pstyle("font-weight").strValue,canvas=this.labelCalcCanvas,c2d=this.labelCalcCanvasContext;if(!canvas){canvas=this.labelCalcCanvas=document.createElement("canvas"),c2d=this.labelCalcCanvasContext=canvas.getContext("2d");var ds=canvas.style;ds.position="absolute",ds.left="-9999px",ds.top="-9999px",ds.zIndex="-1",ds.visibility="hidden",ds.pointerEvents="none"}c2d.font="".concat(fStyle," ").concat(weight," ").concat(size,"px ").concat(family);for(var width=0,height=0,lines=text.split("\n"),i=0;i<lines.length;i++){var line=lines[i],metrics=c2d.measureText(line),w=Math.ceil(metrics.width),h=size;width=Math.max(w,width),height+=h}return width+=0,height+=0,cache[cacheKey]={width:width,height:height}},BRp$6.calculateLabelAngle=function(ele,prefix){var rs=ele._private.rscratch,isEdge=ele.isEdge(),prefixDash=prefix?prefix+"-":"",rot=ele.pstyle(prefixDash+"text-rotation"),rotStr=rot.strValue;return"none"===rotStr?0:isEdge&&"autorotate"===rotStr?rs.labelAutoAngle:"autorotate"===rotStr?0:rot.pfValue},BRp$6.calculateLabelAngles=function(ele){var r=this,isEdge=ele.isEdge(),rs=ele._private.rscratch;rs.labelAngle=r.calculateLabelAngle(ele),isEdge&&(rs.sourceLabelAngle=r.calculateLabelAngle(ele,"source"),rs.targetLabelAngle=r.calculateLabelAngle(ele,"target"))};var BRp$7={},warnedCutRect=!1;BRp$7.getNodeShape=function(node){var shape=node.pstyle("shape").value;if("cutrectangle"===shape&&(node.width()<28||node.height()<28))return warnedCutRect||(warn("The `cutrectangle` node shape can not be used at small sizes so `rectangle` is used instead"),warnedCutRect=!0),"rectangle";if(node.isParent())return"rectangle"===shape||"roundrectangle"===shape||"round-rectangle"===shape||"cutrectangle"===shape||"cut-rectangle"===shape||"barrel"===shape?shape:"rectangle";if("polygon"===shape){var points=node.pstyle("shape-polygon-points").value;return this.nodeShapes.makePolygon(points).name}return shape};var BRp$8={registerCalculationListeners:function(){var cy=this.cy,elesToUpdate=cy.collection(),r=this,enqueue=function enqueue(eles){var dirtyStyleCaches=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(elesToUpdate.merge(eles),dirtyStyleCaches)for(var i=0;i<eles.length;i++){var ele=eles[i],_p=ele._private,rstyle=_p.rstyle;rstyle.clean=!1,rstyle.cleanConnected=!1}};r.binder(cy).on("bounds.* dirty.*",(function onDirtyBounds(e){var ele=e.target;enqueue(ele)})).on("style.* background.*",(function onDirtyStyle(e){var ele=e.target;enqueue(ele,!1)}));var updateEleCalcs=function updateEleCalcs(willDraw){if(willDraw){var fns=r.onUpdateEleCalcsFns;elesToUpdate.cleanStyle();for(var i=0;i<elesToUpdate.length;i++){var ele=elesToUpdate[i],rstyle=ele._private.rstyle;ele.isNode()&&!rstyle.cleanConnected&&(enqueue(ele.connectedEdges()),rstyle.cleanConnected=!0)}if(fns)for(var _i=0;_i<fns.length;_i++){(0,fns[_i])(willDraw,elesToUpdate)}r.recalculateRenderedStyle(elesToUpdate),elesToUpdate=cy.collection()}};r.flushRenderedStyleQueue=function(){updateEleCalcs(!0)},r.beforeRender(updateEleCalcs,r.beforeRenderPriorities.eleCalcs)},onUpdateEleCalcs:function(fn){(this.onUpdateEleCalcsFns=this.onUpdateEleCalcsFns||[]).push(fn)},recalculateRenderedStyle:function(eles,useCache){var isCleanConnected=function isCleanConnected(ele){return ele._private.rstyle.cleanConnected},edges=[],nodes=[];if(!this.destroyed){void 0===useCache&&(useCache=!0);for(var i=0;i<eles.length;i++){var ele=eles[i],_p=ele._private,rstyle=_p.rstyle;!ele.isEdge()||isCleanConnected(ele.source())&&isCleanConnected(ele.target())||(rstyle.clean=!1),useCache&&rstyle.clean||ele.removed()||"none"!==ele.pstyle("display").value&&("nodes"===_p.group?nodes.push(ele):edges.push(ele),rstyle.clean=!0)}for(var _i2=0;_i2<nodes.length;_i2++){var _ele=nodes[_i2],_rstyle=_ele._private.rstyle,pos=_ele.position();this.recalculateNodeLabelProjection(_ele),_rstyle.nodeX=pos.x,_rstyle.nodeY=pos.y,_rstyle.nodeW=_ele.pstyle("width").pfValue,_rstyle.nodeH=_ele.pstyle("height").pfValue}this.recalculateEdgeProjections(edges);for(var _i3=0;_i3<edges.length;_i3++){var _p3=edges[_i3]._private,_rstyle2=_p3.rstyle,rs=_p3.rscratch;_rstyle2.srcX=rs.arrowStartX,_rstyle2.srcY=rs.arrowStartY,_rstyle2.tgtX=rs.arrowEndX,_rstyle2.tgtY=rs.arrowEndY,_rstyle2.midX=rs.midX,_rstyle2.midY=rs.midY,_rstyle2.labelAngle=rs.labelAngle,_rstyle2.sourceLabelAngle=rs.sourceLabelAngle,_rstyle2.targetLabelAngle=rs.targetLabelAngle}}}},BRp$9={updateCachedGrabbedEles:function(){var eles=this.cachedZSortedEles;if(eles){eles.drag=[],eles.nondrag=[];for(var grabTargets=[],i=0;i<eles.length;i++){var rs=(ele=eles[i])._private.rscratch;ele.grabbed()&&!ele.isParent()?grabTargets.push(ele):rs.inDragLayer?eles.drag.push(ele):eles.nondrag.push(ele)}for(i=0;i<grabTargets.length;i++){var ele=grabTargets[i];eles.drag.push(ele)}}},invalidateCachedZSortedEles:function(){this.cachedZSortedEles=null},getCachedZSortedEles:function(forceRecalc){if(forceRecalc||!this.cachedZSortedEles){var eles=this.cy.mutableElements().toArray();eles.sort(zIndexSort),eles.interactive=eles.filter((function(ele){return ele.interactive()})),this.cachedZSortedEles=eles,this.updateCachedGrabbedEles()}else eles=this.cachedZSortedEles;return eles}},BRp$a={};[BRp$1,BRp$2,BRp$3,BRp$4,BRp$5,BRp$6,BRp$7,BRp$8,BRp$9].forEach((function(props){extend(BRp$a,props)}));var BRp$b={getCachedImage:function(url,crossOrigin,onLoad){var imageCache=this.imageCache=this.imageCache||{},cache=imageCache[url];if(cache)return cache.image.complete||cache.image.addEventListener("load",onLoad),cache.image;var image=(cache=imageCache[url]=imageCache[url]||{}).image=new Image;image.addEventListener("load",onLoad),image.addEventListener("error",(function(){image.error=!0}));return"data:"===url.substring(0,"data:".length).toLowerCase()||(image.crossOrigin=crossOrigin),image.src=url,image}},BRp$c={registerBinding:function(target,event,handler,useCapture){var args=Array.prototype.slice.apply(arguments,[1]),b=this.binder(target);return b.on.apply(b,args)}};BRp$c.binder=function(tgt){var r=this,tgtIsDom=tgt===window||tgt===document||tgt===document.body||function domElement(obj){return"undefined"!=typeof HTMLElement&&obj instanceof HTMLElement}(tgt);if(null==r.supportsPassiveEvents){var supportsPassive=!1;try{var opts=Object.defineProperty({},"passive",{get:function get(){return supportsPassive=!0,!0}});window.addEventListener("test",null,opts)}catch(err){}r.supportsPassiveEvents=supportsPassive}var on=function on(event,handler,useCapture){var args=Array.prototype.slice.call(arguments);return tgtIsDom&&r.supportsPassiveEvents&&(args[2]={capture:null!=useCapture&&useCapture,passive:!1,once:!1}),r.bindings.push({target:tgt,args:args}),(tgt.addEventListener||tgt.on).apply(tgt,args),this};return{on:on,addEventListener:on,addListener:on,bind:on}},BRp$c.nodeIsDraggable=function(node){return node&&node.isNode()&&!node.locked()&&node.grabbable()},BRp$c.nodeIsGrabbable=function(node){return this.nodeIsDraggable(node)&&node.interactive()},BRp$c.load=function(){var r=this,isSelected=function isSelected(ele){return ele.selected()},triggerEvents=function triggerEvents(target,names,e,position){null==target&&(target=r.cy);for(var i=0;i<names.length;i++){var name=names[i];target.emit({originalEvent:e,type:name,position:position})}},isMultSelKeyDown=function isMultSelKeyDown(e){return e.shiftKey||e.metaKey||e.ctrlKey},allowPanningPassthrough=function allowPanningPassthrough(down,downs){var allowPassthrough=!0;if(r.cy.hasCompoundNodes()&&down&&down.pannable())for(var i=0;downs&&i<downs.length;i++){if((down=downs[i]).isNode()&&down.isParent()&&!down.pannable()){allowPassthrough=!1;break}}else allowPassthrough=!0;return allowPassthrough},setInDragLayer=function setInDragLayer(ele){ele[0]._private.rscratch.inDragLayer=!0},setGrabTarget=function setGrabTarget(ele){ele[0]._private.rscratch.isGrabTarget=!0},addToDragList=function addToDragList(ele,opts){var list=opts.addToList;list.has(ele)||(list.merge(ele),function setGrabbed(ele){ele[0]._private.grabbed=!0}(ele))},addNodesToDrag=function addNodesToDrag(nodes,opts){opts=opts||{};var hasCompoundNodes=nodes.cy().hasCompoundNodes();opts.inDragLayer&&(nodes.forEach(setInDragLayer),nodes.neighborhood().stdFilter((function(ele){return!hasCompoundNodes||ele.isEdge()})).forEach(setInDragLayer)),opts.addToList&&nodes.forEach((function(ele){addToDragList(ele,opts)})),function addDescendantsToDrag(node,opts){if(node.cy().hasCompoundNodes()&&(null!=opts.inDragLayer||null!=opts.addToList)){var innerNodes=node.descendants();opts.inDragLayer&&(innerNodes.forEach(setInDragLayer),innerNodes.connectedEdges().forEach(setInDragLayer)),opts.addToList&&opts.addToList.unmerge(innerNodes)}}(nodes,opts),updateAncestorsInDragLayer(nodes,{inDragLayer:opts.inDragLayer}),r.updateCachedGrabbedEles()},addNodeToDrag=addNodesToDrag,freeDraggedElements=function freeDraggedElements(grabbedEles){grabbedEles&&(r.getCachedZSortedEles().forEach((function(ele){!function setFreed(ele){ele[0]._private.grabbed=!1}(ele),function setOutDragLayer(ele){ele[0]._private.rscratch.inDragLayer=!1}(ele),function removeGrabTarget(ele){ele[0]._private.rscratch.isGrabTarget=!1}(ele)})),r.updateCachedGrabbedEles())},updateAncestorsInDragLayer=function updateAncestorsInDragLayer(node,opts){if((null!=opts.inDragLayer||null!=opts.addToList)&&node.cy().hasCompoundNodes()){var parent=node.ancestors().orphans();if(!parent.same(node)){var nodes=parent.descendants().spawnSelf().merge(parent).unmerge(node).unmerge(node.descendants()),edges=nodes.connectedEdges();opts.inDragLayer&&(edges.forEach(setInDragLayer),nodes.forEach(setInDragLayer)),opts.addToList&&nodes.forEach((function(ele){addToDragList(ele,opts)}))}}},blurActiveDomElement=function blurActiveDomElement(){null!=document.activeElement&&null!=document.activeElement.blur&&document.activeElement.blur()},haveMutationsApi="undefined"!=typeof MutationObserver,haveResizeObserverApi="undefined"!=typeof ResizeObserver;haveMutationsApi?(r.removeObserver=new MutationObserver((function(mutns){for(var i=0;i<mutns.length;i++){var rNodes=mutns[i].removedNodes;if(rNodes)for(var j=0;j<rNodes.length;j++){if(rNodes[j]===r.container){r.destroy();break}}}})),r.container.parentNode&&r.removeObserver.observe(r.container.parentNode,{childList:!0})):r.registerBinding(r.container,"DOMNodeRemoved",(function(e){r.destroy()}));var onResize=util((function(){r.cy.resize()}),100);haveMutationsApi&&(r.styleObserver=new MutationObserver(onResize),r.styleObserver.observe(r.container,{attributes:!0})),r.registerBinding(window,"resize",onResize),haveResizeObserverApi&&(r.resizeObserver=new ResizeObserver(onResize),r.resizeObserver.observe(r.container));var invalidateCoords=function invalidateCoords(){r.invalidateContainerClientCoordsCache()};!function forEachUp(domEle,fn){for(;null!=domEle;)fn(domEle),domEle=domEle.parentNode}(r.container,(function(domEle){r.registerBinding(domEle,"transitionend",invalidateCoords),r.registerBinding(domEle,"animationend",invalidateCoords),r.registerBinding(domEle,"scroll",invalidateCoords)})),r.registerBinding(r.container,"contextmenu",(function(e){e.preventDefault()}));var eventInContainer=function eventInContainer(e){for(var containerPageCoords=r.findContainerClientCoords(),x=containerPageCoords[0],y=containerPageCoords[1],width=containerPageCoords[2],height=containerPageCoords[3],positions=e.touches?e.touches:[e],atLeastOnePosInside=!1,i=0;i<positions.length;i++){var p=positions[i];if(x<=p.clientX&&p.clientX<=x+width&&y<=p.clientY&&p.clientY<=y+height){atLeastOnePosInside=!0;break}}if(!atLeastOnePosInside)return!1;for(var container=r.container,tParent=e.target.parentNode,containerIsTarget=!1;tParent;){if(tParent===container){containerIsTarget=!0;break}tParent=tParent.parentNode}return!!containerIsTarget};r.registerBinding(r.container,"mousedown",(function mousedownHandler(e){if(eventInContainer(e)){e.preventDefault(),blurActiveDomElement(),r.hoverData.capture=!0,r.hoverData.which=e.which;var cy=r.cy,gpos=[e.clientX,e.clientY],pos=r.projectIntoViewport(gpos[0],gpos[1]),select=r.selection,nears=r.findNearestElements(pos[0],pos[1],!0,!1),near=nears[0],draggedElements=r.dragData.possibleDragElements;r.hoverData.mdownPos=pos,r.hoverData.mdownGPos=gpos;if(3==e.which){r.hoverData.cxtStarted=!0;var cxtEvt={originalEvent:e,type:"cxttapstart",position:{x:pos[0],y:pos[1]}};near?(near.activate(),near.emit(cxtEvt),r.hoverData.down=near):cy.emit(cxtEvt),r.hoverData.downTime=(new Date).getTime(),r.hoverData.cxtDragged=!1}else if(1==e.which){if(near&&near.activate(),null!=near&&r.nodeIsGrabbable(near)){var makeEvent=function makeEvent(type){return{originalEvent:e,type:type,position:{x:pos[0],y:pos[1]}}};if(setGrabTarget(near),near.selected()){draggedElements=r.dragData.possibleDragElements=cy.collection();var selectedNodes=cy.$((function(ele){return ele.isNode()&&ele.selected()&&r.nodeIsGrabbable(ele)}));addNodesToDrag(selectedNodes,{addToList:draggedElements}),near.emit(makeEvent("grabon")),selectedNodes.forEach((function triggerGrab(ele){ele.emit(makeEvent("grab"))}))}else draggedElements=r.dragData.possibleDragElements=cy.collection(),addNodeToDrag(near,{addToList:draggedElements}),near.emit(makeEvent("grabon")).emit(makeEvent("grab"));r.redrawHint("eles",!0),r.redrawHint("drag",!0)}r.hoverData.down=near,r.hoverData.downs=nears,r.hoverData.downTime=(new Date).getTime(),triggerEvents(near,["mousedown","tapstart","vmousedown"],e,{x:pos[0],y:pos[1]}),null==near?(select[4]=1,r.data.bgActivePosistion={x:pos[0],y:pos[1]},r.redrawHint("select",!0),r.redraw()):near.pannable()&&(select[4]=1),function checkForTaphold(){r.hoverData.tapholdCancelled=!1,clearTimeout(r.hoverData.tapholdTimeout),r.hoverData.tapholdTimeout=setTimeout((function(){if(!r.hoverData.tapholdCancelled){var ele=r.hoverData.down;ele?ele.emit({originalEvent:e,type:"taphold",position:{x:pos[0],y:pos[1]}}):cy.emit({originalEvent:e,type:"taphold",position:{x:pos[0],y:pos[1]}})}}),r.tapholdDuration)}()}select[0]=select[2]=pos[0],select[1]=select[3]=pos[1]}}),!1),r.registerBinding(window,"mousemove",(function mousemoveHandler(e){if(r.hoverData.capture||eventInContainer(e)){var preventDefault=!1,cy=r.cy,zoom=cy.zoom(),gpos=[e.clientX,e.clientY],pos=r.projectIntoViewport(gpos[0],gpos[1]),mdownPos=r.hoverData.mdownPos,mdownGPos=r.hoverData.mdownGPos,select=r.selection,near=null;r.hoverData.draggingEles||r.hoverData.dragging||r.hoverData.selecting||(near=r.findNearestElement(pos[0],pos[1],!0,!1));var isOverThresholdDrag,last=r.hoverData.last,down=r.hoverData.down,disp=[pos[0]-select[2],pos[1]-select[3]],draggedElements=r.dragData.possibleDragElements;if(mdownGPos){var dx=gpos[0]-mdownGPos[0],dx2=dx*dx,dy=gpos[1]-mdownGPos[1],dist2=dx2+dy*dy;r.hoverData.isOverThresholdDrag=isOverThresholdDrag=dist2>=r.desktopTapThreshold2}var multSelKeyDown=isMultSelKeyDown(e);isOverThresholdDrag&&(r.hoverData.tapholdCancelled=!0);preventDefault=!0,triggerEvents(near,["mousemove","vmousemove","tapdrag"],e,{x:pos[0],y:pos[1]});var goIntoBoxMode=function goIntoBoxMode(){r.data.bgActivePosistion=void 0,r.hoverData.selecting||cy.emit({originalEvent:e,type:"boxstart",position:{x:pos[0],y:pos[1]}}),select[4]=1,r.hoverData.selecting=!0,r.redrawHint("select",!0),r.redraw()};if(3===r.hoverData.which){if(isOverThresholdDrag){var cxtEvt={originalEvent:e,type:"cxtdrag",position:{x:pos[0],y:pos[1]}};down?down.emit(cxtEvt):cy.emit(cxtEvt),r.hoverData.cxtDragged=!0,r.hoverData.cxtOver&&near===r.hoverData.cxtOver||(r.hoverData.cxtOver&&r.hoverData.cxtOver.emit({originalEvent:e,type:"cxtdragout",position:{x:pos[0],y:pos[1]}}),r.hoverData.cxtOver=near,near&&near.emit({originalEvent:e,type:"cxtdragover",position:{x:pos[0],y:pos[1]}}))}}else if(r.hoverData.dragging){if(preventDefault=!0,cy.panningEnabled()&&cy.userPanningEnabled()){var deltaP;if(r.hoverData.justStartedPan){var mdPos=r.hoverData.mdownPos;deltaP={x:(pos[0]-mdPos[0])*zoom,y:(pos[1]-mdPos[1])*zoom},r.hoverData.justStartedPan=!1}else deltaP={x:disp[0]*zoom,y:disp[1]*zoom};cy.panBy(deltaP),r.hoverData.dragged=!0}pos=r.projectIntoViewport(e.clientX,e.clientY)}else if(1!=select[4]||null!=down&&!down.pannable()){if(down&&down.pannable()&&down.active()&&down.unactivate(),down&&down.grabbed()||near==last||(last&&triggerEvents(last,["mouseout","tapdragout"],e,{x:pos[0],y:pos[1]}),near&&triggerEvents(near,["mouseover","tapdragover"],e,{x:pos[0],y:pos[1]}),r.hoverData.last=near),down)if(isOverThresholdDrag){if(cy.boxSelectionEnabled()&&multSelKeyDown)down&&down.grabbed()&&(freeDraggedElements(draggedElements),down.emit("freeon"),draggedElements.emit("free"),r.dragData.didDrag&&(down.emit("dragfreeon"),draggedElements.emit("dragfree"))),goIntoBoxMode();else if(down&&down.grabbed()&&r.nodeIsDraggable(down)){var justStartedDrag=!r.dragData.didDrag;justStartedDrag&&r.redrawHint("eles",!0),r.dragData.didDrag=!0;var toTrigger=cy.collection();r.hoverData.draggingEles||addNodesToDrag(draggedElements,{inDragLayer:!0});var totalShift={x:0,y:0};if(number(disp[0])&&number(disp[1])&&(totalShift.x+=disp[0],totalShift.y+=disp[1],justStartedDrag)){var dragDelta=r.hoverData.dragDelta;dragDelta&&number(dragDelta[0])&&number(dragDelta[1])&&(totalShift.x+=dragDelta[0],totalShift.y+=dragDelta[1])}for(var i=0;i<draggedElements.length;i++){var dEle=draggedElements[i];r.nodeIsDraggable(dEle)&&dEle.grabbed()&&toTrigger.push(dEle)}r.hoverData.draggingEles=!0,toTrigger.silentShift(totalShift).emit("position drag"),r.redrawHint("drag",!0),r.redraw()}}else!function updateDragDelta(){var dragDelta=r.hoverData.dragDelta=r.hoverData.dragDelta||[];0===dragDelta.length?(dragDelta.push(disp[0]),dragDelta.push(disp[1])):(dragDelta[0]+=disp[0],dragDelta[1]+=disp[1])}();preventDefault=!0}else if(isOverThresholdDrag){if(r.hoverData.dragging||!cy.boxSelectionEnabled()||!multSelKeyDown&&cy.panningEnabled()&&cy.userPanningEnabled()){if(!r.hoverData.selecting&&cy.panningEnabled()&&cy.userPanningEnabled()){allowPanningPassthrough(down,r.hoverData.downs)&&(r.hoverData.dragging=!0,r.hoverData.justStartedPan=!0,select[4]=0,r.data.bgActivePosistion=array2point(mdownPos),r.redrawHint("select",!0),r.redraw())}}else goIntoBoxMode();down&&down.pannable()&&down.active()&&down.unactivate()}return select[2]=pos[0],select[3]=pos[1],preventDefault?(e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),!1):void 0}}),!1),r.registerBinding(window,"mouseup",(function mouseupHandler(e){if(r.hoverData.capture){r.hoverData.capture=!1;var cy=r.cy,pos=r.projectIntoViewport(e.clientX,e.clientY),select=r.selection,near=r.findNearestElement(pos[0],pos[1],!0,!1),draggedElements=r.dragData.possibleDragElements,down=r.hoverData.down,multSelKeyDown=isMultSelKeyDown(e);if(r.data.bgActivePosistion&&(r.redrawHint("select",!0),r.redraw()),r.hoverData.tapholdCancelled=!0,r.data.bgActivePosistion=void 0,down&&down.unactivate(),3===r.hoverData.which){var cxtEvt={originalEvent:e,type:"cxttapend",position:{x:pos[0],y:pos[1]}};if(down?down.emit(cxtEvt):cy.emit(cxtEvt),!r.hoverData.cxtDragged){var cxtTap={originalEvent:e,type:"cxttap",position:{x:pos[0],y:pos[1]}};down?down.emit(cxtTap):cy.emit(cxtTap)}r.hoverData.cxtDragged=!1,r.hoverData.which=null}else if(1===r.hoverData.which){if(triggerEvents(near,["mouseup","tapend","vmouseup"],e,{x:pos[0],y:pos[1]}),r.dragData.didDrag||r.hoverData.dragged||r.hoverData.selecting||r.hoverData.isOverThresholdDrag||triggerEvents(down,["click","tap","vclick"],e,{x:pos[0],y:pos[1]}),null!=down||r.dragData.didDrag||r.hoverData.selecting||r.hoverData.dragged||isMultSelKeyDown(e)||(cy.$(isSelected).unselect(["tapunselect"]),draggedElements.length>0&&r.redrawHint("eles",!0),r.dragData.possibleDragElements=draggedElements=cy.collection()),near!=down||r.dragData.didDrag||r.hoverData.selecting||null!=near&&near._private.selectable&&(r.hoverData.dragging||("additive"===cy.selectionType()||multSelKeyDown?near.selected()?near.unselect(["tapunselect"]):near.select(["tapselect"]):multSelKeyDown||(cy.$(isSelected).unmerge(near).unselect(["tapunselect"]),near.select(["tapselect"]))),r.redrawHint("eles",!0)),r.hoverData.selecting){var box=cy.collection(r.getAllInBox(select[0],select[1],select[2],select[3]));r.redrawHint("select",!0),box.length>0&&r.redrawHint("eles",!0),cy.emit({type:"boxend",originalEvent:e,position:{x:pos[0],y:pos[1]}});var eleWouldBeSelected=function eleWouldBeSelected(ele){return ele.selectable()&&!ele.selected()};"additive"===cy.selectionType()||multSelKeyDown||cy.$(isSelected).unmerge(box).unselect(),box.emit("box").stdFilter(eleWouldBeSelected).select().emit("boxselect"),r.redraw()}if(r.hoverData.dragging&&(r.hoverData.dragging=!1,r.redrawHint("select",!0),r.redrawHint("eles",!0),r.redraw()),!select[4]){r.redrawHint("drag",!0),r.redrawHint("eles",!0);var downWasGrabbed=down&&down.grabbed();freeDraggedElements(draggedElements),downWasGrabbed&&(down.emit("freeon"),draggedElements.emit("free"),r.dragData.didDrag&&(down.emit("dragfreeon"),draggedElements.emit("dragfree")))}}select[4]=0,r.hoverData.down=null,r.hoverData.cxtStarted=!1,r.hoverData.draggingEles=!1,r.hoverData.selecting=!1,r.hoverData.isOverThresholdDrag=!1,r.dragData.didDrag=!1,r.hoverData.dragged=!1,r.hoverData.dragDelta=[],r.hoverData.mdownPos=null,r.hoverData.mdownGPos=null}}),!1);var f1x1,f1y1,f2x1,f2y1,distance1,distance1Sq,center1,modelCenter1,offsetLeft,offsetTop,containerWidth,containerHeight,twoFingersStartInside,wheelHandler=function wheelHandler(e){if(!r.scrollingPage){var cy=r.cy,zoom=cy.zoom(),pan=cy.pan(),pos=r.projectIntoViewport(e.clientX,e.clientY),rpos=[pos[0]*zoom+pan.x,pos[1]*zoom+pan.y];if(r.hoverData.draggingEles||r.hoverData.dragging||r.hoverData.cxtStarted||function inBoxSelection(){return 0!==r.selection[4]}())e.preventDefault();else if(cy.panningEnabled()&&cy.userPanningEnabled()&&cy.zoomingEnabled()&&cy.userZoomingEnabled()){var diff;e.preventDefault(),r.data.wheelZooming=!0,clearTimeout(r.data.wheelTimeout),r.data.wheelTimeout=setTimeout((function(){r.data.wheelZooming=!1,r.redrawHint("eles",!0),r.redraw()}),150),diff=null!=e.deltaY?e.deltaY/-250:null!=e.wheelDeltaY?e.wheelDeltaY/1e3:e.wheelDelta/1e3,diff*=r.wheelSensitivity,1===e.deltaMode&&(diff*=33);var newZoom=cy.zoom()*Math.pow(10,diff);"gesturechange"===e.type&&(newZoom=r.gestureStartZoom*e.scale),cy.zoom({level:newZoom,renderedPosition:{x:rpos[0],y:rpos[1]}})}}};r.registerBinding(r.container,"wheel",wheelHandler,!0),r.registerBinding(window,"scroll",(function scrollHandler(e){r.scrollingPage=!0,clearTimeout(r.scrollingPageTimeout),r.scrollingPageTimeout=setTimeout((function(){r.scrollingPage=!1}),250)}),!0),r.registerBinding(r.container,"gesturestart",(function gestureStartHandler(e){r.gestureStartZoom=r.cy.zoom(),r.hasTouchStarted||e.preventDefault()}),!0),r.registerBinding(r.container,"gesturechange",(function(e){r.hasTouchStarted||wheelHandler(e)}),!0),r.registerBinding(r.container,"mouseout",(function mouseOutHandler(e){var pos=r.projectIntoViewport(e.clientX,e.clientY);r.cy.emit({originalEvent:e,type:"mouseout",position:{x:pos[0],y:pos[1]}})}),!1),r.registerBinding(r.container,"mouseover",(function mouseOverHandler(e){var pos=r.projectIntoViewport(e.clientX,e.clientY);r.cy.emit({originalEvent:e,type:"mouseover",position:{x:pos[0],y:pos[1]}})}),!1);var touchstartHandler,touchmoveHandler,touchcancelHandler,touchendHandler,distance=function distance(x1,y1,x2,y2){return Math.sqrt((x2-x1)*(x2-x1)+(y2-y1)*(y2-y1))},distanceSq=function distanceSq(x1,y1,x2,y2){return(x2-x1)*(x2-x1)+(y2-y1)*(y2-y1)};if(r.registerBinding(r.container,"touchstart",touchstartHandler=function touchstartHandler(e){if(r.hasTouchStarted=!0,eventInContainer(e)){blurActiveDomElement(),r.touchData.capture=!0,r.data.bgActivePosistion=void 0;var cy=r.cy,now=r.touchData.now,earlier=r.touchData.earlier;if(e.touches[0]){var pos=r.projectIntoViewport(e.touches[0].clientX,e.touches[0].clientY);now[0]=pos[0],now[1]=pos[1]}if(e.touches[1]){pos=r.projectIntoViewport(e.touches[1].clientX,e.touches[1].clientY);now[2]=pos[0],now[3]=pos[1]}if(e.touches[2]){pos=r.projectIntoViewport(e.touches[2].clientX,e.touches[2].clientY);now[4]=pos[0],now[5]=pos[1]}if(e.touches[1]){r.touchData.singleTouchMoved=!0,freeDraggedElements(r.dragData.touchDragEles);var offsets=r.findContainerClientCoords();offsetLeft=offsets[0],offsetTop=offsets[1],containerWidth=offsets[2],containerHeight=offsets[3],f1x1=e.touches[0].clientX-offsetLeft,f1y1=e.touches[0].clientY-offsetTop,f2x1=e.touches[1].clientX-offsetLeft,f2y1=e.touches[1].clientY-offsetTop,twoFingersStartInside=0<=f1x1&&f1x1<=containerWidth&&0<=f2x1&&f2x1<=containerWidth&&0<=f1y1&&f1y1<=containerHeight&&0<=f2y1&&f2y1<=containerHeight;var pan=cy.pan(),zoom=cy.zoom();distance1=distance(f1x1,f1y1,f2x1,f2y1),distance1Sq=distanceSq(f1x1,f1y1,f2x1,f2y1),modelCenter1=[((center1=[(f1x1+f2x1)/2,(f1y1+f2y1)/2])[0]-pan.x)/zoom,(center1[1]-pan.y)/zoom];if(distance1Sq<4e4&&!e.touches[2]){var near1=r.findNearestElement(now[0],now[1],!0,!0),near2=r.findNearestElement(now[2],now[3],!0,!0);return near1&&near1.isNode()?(near1.activate().emit({originalEvent:e,type:"cxttapstart",position:{x:now[0],y:now[1]}}),r.touchData.start=near1):near2&&near2.isNode()?(near2.activate().emit({originalEvent:e,type:"cxttapstart",position:{x:now[0],y:now[1]}}),r.touchData.start=near2):cy.emit({originalEvent:e,type:"cxttapstart",position:{x:now[0],y:now[1]}}),r.touchData.start&&(r.touchData.start._private.grabbed=!1),r.touchData.cxt=!0,r.touchData.cxtDragged=!1,r.data.bgActivePosistion=void 0,void r.redraw()}}if(e.touches[2])cy.boxSelectionEnabled()&&e.preventDefault();else if(e.touches[1]);else if(e.touches[0]){var nears=r.findNearestElements(now[0],now[1],!0,!0),near=nears[0];if(null!=near&&(near.activate(),r.touchData.start=near,r.touchData.starts=nears,r.nodeIsGrabbable(near))){var draggedEles=r.dragData.touchDragEles=cy.collection(),selectedNodes=null;r.redrawHint("eles",!0),r.redrawHint("drag",!0),near.selected()?(selectedNodes=cy.$((function(ele){return ele.selected()&&r.nodeIsGrabbable(ele)})),addNodesToDrag(selectedNodes,{addToList:draggedEles})):addNodeToDrag(near,{addToList:draggedEles}),setGrabTarget(near);var makeEvent=function makeEvent(type){return{originalEvent:e,type:type,position:{x:now[0],y:now[1]}}};near.emit(makeEvent("grabon")),selectedNodes?selectedNodes.forEach((function(n){n.emit(makeEvent("grab"))})):near.emit(makeEvent("grab"))}triggerEvents(near,["touchstart","tapstart","vmousedown"],e,{x:now[0],y:now[1]}),null==near&&(r.data.bgActivePosistion={x:pos[0],y:pos[1]},r.redrawHint("select",!0),r.redraw()),r.touchData.singleTouchMoved=!1,r.touchData.singleTouchStartTime=+new Date,clearTimeout(r.touchData.tapholdTimeout),r.touchData.tapholdTimeout=setTimeout((function(){!1!==r.touchData.singleTouchMoved||r.pinching||r.touchData.selecting||triggerEvents(r.touchData.start,["taphold"],e,{x:now[0],y:now[1]})}),r.tapholdDuration)}if(e.touches.length>=1){for(var sPos=r.touchData.startPosition=[],i=0;i<now.length;i++)sPos[i]=earlier[i]=now[i];var touch0=e.touches[0];r.touchData.startGPosition=[touch0.clientX,touch0.clientY]}}},!1),r.registerBinding(window,"touchmove",touchmoveHandler=function touchmoveHandler(e){var capture=r.touchData.capture;if(capture||eventInContainer(e)){var select=r.selection,cy=r.cy,now=r.touchData.now,earlier=r.touchData.earlier,zoom=cy.zoom();if(e.touches[0]){var pos=r.projectIntoViewport(e.touches[0].clientX,e.touches[0].clientY);now[0]=pos[0],now[1]=pos[1]}if(e.touches[1]){pos=r.projectIntoViewport(e.touches[1].clientX,e.touches[1].clientY);now[2]=pos[0],now[3]=pos[1]}if(e.touches[2]){pos=r.projectIntoViewport(e.touches[2].clientX,e.touches[2].clientY);now[4]=pos[0],now[5]=pos[1]}var isOverThresholdDrag,startGPos=r.touchData.startGPosition;if(capture&&e.touches[0]&&startGPos){for(var disp=[],j=0;j<now.length;j++)disp[j]=now[j]-earlier[j];var dx=e.touches[0].clientX-startGPos[0],dx2=dx*dx,dy=e.touches[0].clientY-startGPos[1];isOverThresholdDrag=dx2+dy*dy>=r.touchTapThreshold2}if(capture&&r.touchData.cxt){e.preventDefault();var f1x2=e.touches[0].clientX-offsetLeft,f1y2=e.touches[0].clientY-offsetTop,f2x2=e.touches[1].clientX-offsetLeft,f2y2=e.touches[1].clientY-offsetTop,distance2Sq=distanceSq(f1x2,f1y2,f2x2,f2y2);if(distance2Sq/distance1Sq>=2.25||distance2Sq>=22500){r.touchData.cxt=!1,r.data.bgActivePosistion=void 0,r.redrawHint("select",!0);var cxtEvt={originalEvent:e,type:"cxttapend",position:{x:now[0],y:now[1]}};r.touchData.start?(r.touchData.start.unactivate().emit(cxtEvt),r.touchData.start=null):cy.emit(cxtEvt)}}if(capture&&r.touchData.cxt){cxtEvt={originalEvent:e,type:"cxtdrag",position:{x:now[0],y:now[1]}};r.data.bgActivePosistion=void 0,r.redrawHint("select",!0),r.touchData.start?r.touchData.start.emit(cxtEvt):cy.emit(cxtEvt),r.touchData.start&&(r.touchData.start._private.grabbed=!1),r.touchData.cxtDragged=!0;var near=r.findNearestElement(now[0],now[1],!0,!0);r.touchData.cxtOver&&near===r.touchData.cxtOver||(r.touchData.cxtOver&&r.touchData.cxtOver.emit({originalEvent:e,type:"cxtdragout",position:{x:now[0],y:now[1]}}),r.touchData.cxtOver=near,near&&near.emit({originalEvent:e,type:"cxtdragover",position:{x:now[0],y:now[1]}}))}else if(capture&&e.touches[2]&&cy.boxSelectionEnabled())e.preventDefault(),r.data.bgActivePosistion=void 0,this.lastThreeTouch=+new Date,r.touchData.selecting||cy.emit({originalEvent:e,type:"boxstart",position:{x:now[0],y:now[1]}}),r.touchData.selecting=!0,r.touchData.didSelect=!0,select[4]=1,select&&0!==select.length&&void 0!==select[0]?(select[2]=(now[0]+now[2]+now[4])/3,select[3]=(now[1]+now[3]+now[5])/3):(select[0]=(now[0]+now[2]+now[4])/3,select[1]=(now[1]+now[3]+now[5])/3,select[2]=(now[0]+now[2]+now[4])/3+1,select[3]=(now[1]+now[3]+now[5])/3+1),r.redrawHint("select",!0),r.redraw();else if(capture&&e.touches[1]&&!r.touchData.didSelect&&cy.zoomingEnabled()&&cy.panningEnabled()&&cy.userZoomingEnabled()&&cy.userPanningEnabled()){if(e.preventDefault(),r.data.bgActivePosistion=void 0,r.redrawHint("select",!0),draggedEles=r.dragData.touchDragEles){r.redrawHint("drag",!0);for(var i=0;i<draggedEles.length;i++){var de_p=draggedEles[i]._private;de_p.grabbed=!1,de_p.rscratch.inDragLayer=!1}}var _start=r.touchData.start,distance2=(f1x2=e.touches[0].clientX-offsetLeft,f1y2=e.touches[0].clientY-offsetTop,f2x2=e.touches[1].clientX-offsetLeft,f2y2=e.touches[1].clientY-offsetTop,distance(f1x2,f1y2,f2x2,f2y2)),factor=distance2/distance1;if(twoFingersStartInside){var tx=(f1x2-f1x1+(f2x2-f2x1))/2,ty=(f1y2-f1y1+(f2y2-f2y1))/2,zoom1=cy.zoom(),zoom2=zoom1*factor,pan1=cy.pan(),ctrx=modelCenter1[0]*zoom1+pan1.x,ctry=modelCenter1[1]*zoom1+pan1.y,pan2={x:-zoom2/zoom1*(ctrx-pan1.x-tx)+ctrx,y:-zoom2/zoom1*(ctry-pan1.y-ty)+ctry};if(_start&&_start.active()){var draggedEles=r.dragData.touchDragEles;freeDraggedElements(draggedEles),r.redrawHint("drag",!0),r.redrawHint("eles",!0),_start.unactivate().emit("freeon"),draggedEles.emit("free"),r.dragData.didDrag&&(_start.emit("dragfreeon"),draggedEles.emit("dragfree"))}cy.viewport({zoom:zoom2,pan:pan2,cancelOnFailedZoom:!0}),distance1=distance2,f1x1=f1x2,f1y1=f1y2,f2x1=f2x2,f2y1=f2y2,r.pinching=!0}if(e.touches[0]){pos=r.projectIntoViewport(e.touches[0].clientX,e.touches[0].clientY);now[0]=pos[0],now[1]=pos[1]}if(e.touches[1]){pos=r.projectIntoViewport(e.touches[1].clientX,e.touches[1].clientY);now[2]=pos[0],now[3]=pos[1]}if(e.touches[2]){pos=r.projectIntoViewport(e.touches[2].clientX,e.touches[2].clientY);now[4]=pos[0],now[5]=pos[1]}}else if(e.touches[0]&&!r.touchData.didSelect){var start=r.touchData.start,last=r.touchData.last;if(r.hoverData.draggingEles||r.swipePanning||(near=r.findNearestElement(now[0],now[1],!0,!0)),capture&&null!=start&&e.preventDefault(),capture&&null!=start&&r.nodeIsDraggable(start))if(isOverThresholdDrag){draggedEles=r.dragData.touchDragEles;var justStartedDrag=!r.dragData.didDrag;justStartedDrag&&addNodesToDrag(draggedEles,{inDragLayer:!0}),r.dragData.didDrag=!0;var totalShift={x:0,y:0};if(number(disp[0])&&number(disp[1]))if(totalShift.x+=disp[0],totalShift.y+=disp[1],justStartedDrag)r.redrawHint("eles",!0),(dragDelta=r.touchData.dragDelta)&&number(dragDelta[0])&&number(dragDelta[1])&&(totalShift.x+=dragDelta[0],totalShift.y+=dragDelta[1]);r.hoverData.draggingEles=!0,draggedEles.silentShift(totalShift).emit("position drag"),r.redrawHint("drag",!0),r.touchData.startPosition[0]==earlier[0]&&r.touchData.startPosition[1]==earlier[1]&&r.redrawHint("eles",!0),r.redraw()}else{var dragDelta;0===(dragDelta=r.touchData.dragDelta=r.touchData.dragDelta||[]).length?(dragDelta.push(disp[0]),dragDelta.push(disp[1])):(dragDelta[0]+=disp[0],dragDelta[1]+=disp[1])}if(triggerEvents(start||near,["touchmove","tapdrag","vmousemove"],e,{x:now[0],y:now[1]}),start&&start.grabbed()||near==last||(last&&last.emit({originalEvent:e,type:"tapdragout",position:{x:now[0],y:now[1]}}),near&&near.emit({originalEvent:e,type:"tapdragover",position:{x:now[0],y:now[1]}})),r.touchData.last=near,capture)for(i=0;i<now.length;i++)now[i]&&r.touchData.startPosition[i]&&isOverThresholdDrag&&(r.touchData.singleTouchMoved=!0);if(capture&&(null==start||start.pannable())&&cy.panningEnabled()&&cy.userPanningEnabled()){allowPanningPassthrough(start,r.touchData.starts)&&(e.preventDefault(),r.data.bgActivePosistion||(r.data.bgActivePosistion=array2point(r.touchData.startPosition)),r.swipePanning?cy.panBy({x:disp[0]*zoom,y:disp[1]*zoom}):isOverThresholdDrag&&(r.swipePanning=!0,cy.panBy({x:dx*zoom,y:dy*zoom}),start&&(start.unactivate(),r.redrawHint("select",!0),r.touchData.start=null)));pos=r.projectIntoViewport(e.touches[0].clientX,e.touches[0].clientY);now[0]=pos[0],now[1]=pos[1]}}for(j=0;j<now.length;j++)earlier[j]=now[j];capture&&e.touches.length>0&&!r.hoverData.draggingEles&&!r.swipePanning&&null!=r.data.bgActivePosistion&&(r.data.bgActivePosistion=void 0,r.redrawHint("select",!0),r.redraw())}},!1),r.registerBinding(window,"touchcancel",touchcancelHandler=function touchcancelHandler(e){var start=r.touchData.start;r.touchData.capture=!1,start&&start.unactivate()}),r.registerBinding(window,"touchend",touchendHandler=function touchendHandler(e){var start=r.touchData.start;if(r.touchData.capture){0===e.touches.length&&(r.touchData.capture=!1),e.preventDefault();var select=r.selection;r.swipePanning=!1,r.hoverData.draggingEles=!1;var ctxTapend,cy=r.cy,zoom=cy.zoom(),now=r.touchData.now,earlier=r.touchData.earlier;if(e.touches[0]){var pos=r.projectIntoViewport(e.touches[0].clientX,e.touches[0].clientY);now[0]=pos[0],now[1]=pos[1]}if(e.touches[1]){pos=r.projectIntoViewport(e.touches[1].clientX,e.touches[1].clientY);now[2]=pos[0],now[3]=pos[1]}if(e.touches[2]){pos=r.projectIntoViewport(e.touches[2].clientX,e.touches[2].clientY);now[4]=pos[0],now[5]=pos[1]}if(start&&start.unactivate(),r.touchData.cxt){if(ctxTapend={originalEvent:e,type:"cxttapend",position:{x:now[0],y:now[1]}},start?start.emit(ctxTapend):cy.emit(ctxTapend),!r.touchData.cxtDragged){var ctxTap={originalEvent:e,type:"cxttap",position:{x:now[0],y:now[1]}};start?start.emit(ctxTap):cy.emit(ctxTap)}return r.touchData.start&&(r.touchData.start._private.grabbed=!1),r.touchData.cxt=!1,r.touchData.start=null,void r.redraw()}if(!e.touches[2]&&cy.boxSelectionEnabled()&&r.touchData.selecting){r.touchData.selecting=!1;var box=cy.collection(r.getAllInBox(select[0],select[1],select[2],select[3]));select[0]=void 0,select[1]=void 0,select[2]=void 0,select[3]=void 0,select[4]=0,r.redrawHint("select",!0),cy.emit({type:"boxend",originalEvent:e,position:{x:now[0],y:now[1]}});box.emit("box").stdFilter((function eleWouldBeSelected(ele){return ele.selectable()&&!ele.selected()})).select().emit("boxselect"),box.nonempty()&&r.redrawHint("eles",!0),r.redraw()}if(null!=start&&start.unactivate(),e.touches[2])r.data.bgActivePosistion=void 0,r.redrawHint("select",!0);else if(e.touches[1]);else if(e.touches[0]);else if(!e.touches[0]){r.data.bgActivePosistion=void 0,r.redrawHint("select",!0);var draggedEles=r.dragData.touchDragEles;if(null!=start){var startWasGrabbed=start._private.grabbed;freeDraggedElements(draggedEles),r.redrawHint("drag",!0),r.redrawHint("eles",!0),startWasGrabbed&&(start.emit("freeon"),draggedEles.emit("free"),r.dragData.didDrag&&(start.emit("dragfreeon"),draggedEles.emit("dragfree"))),triggerEvents(start,["touchend","tapend","vmouseup","tapdragout"],e,{x:now[0],y:now[1]}),start.unactivate(),r.touchData.start=null}else{var near=r.findNearestElement(now[0],now[1],!0,!0);triggerEvents(near,["touchend","tapend","vmouseup","tapdragout"],e,{x:now[0],y:now[1]})}var dx=r.touchData.startPosition[0]-now[0],dx2=dx*dx,dy=r.touchData.startPosition[1]-now[1],rdist2=(dx2+dy*dy)*zoom*zoom;r.touchData.singleTouchMoved||(start||cy.$(":selected").unselect(["tapunselect"]),triggerEvents(start,["tap","vclick"],e,{x:now[0],y:now[1]})),null!=start&&!r.dragData.didDrag&&start._private.selectable&&rdist2<r.touchTapThreshold2&&!r.pinching&&("single"===cy.selectionType()?(cy.$(isSelected).unmerge(start).unselect(["tapunselect"]),start.select(["tapselect"])):start.selected()?start.unselect(["tapunselect"]):start.select(["tapselect"]),r.redrawHint("eles",!0)),r.touchData.singleTouchMoved=!0}for(var j=0;j<now.length;j++)earlier[j]=now[j];r.dragData.didDrag=!1,0===e.touches.length&&(r.touchData.dragDelta=[],r.touchData.startPosition=null,r.touchData.startGPosition=null,r.touchData.didSelect=!1),e.touches.length<2&&(1===e.touches.length&&(r.touchData.startGPosition=[e.touches[0].clientX,e.touches[0].clientY]),r.pinching=!1,r.redrawHint("eles",!0),r.redraw())}},!1),"undefined"==typeof TouchEvent){var pointers=[],makeTouch=function makeTouch(e){return{clientX:e.clientX,clientY:e.clientY,force:1,identifier:e.pointerId,pageX:e.pageX,pageY:e.pageY,radiusX:e.width/2,radiusY:e.height/2,screenX:e.screenX,screenY:e.screenY,target:e.target}},addPointer=function addPointer(e){pointers.push(function makePointer(e){return{event:e,touch:makeTouch(e)}}(e))},removePointer=function removePointer(e){for(var i=0;i<pointers.length;i++){if(pointers[i].event.pointerId===e.pointerId)return void pointers.splice(i,1)}},addTouchesToEvent=function addTouchesToEvent(e){e.touches=pointers.map((function(p){return p.touch}))},pointerIsMouse=function pointerIsMouse(e){return"mouse"===e.pointerType||4===e.pointerType};r.registerBinding(r.container,"pointerdown",(function(e){pointerIsMouse(e)||(e.preventDefault(),addPointer(e),addTouchesToEvent(e),touchstartHandler(e))})),r.registerBinding(r.container,"pointerup",(function(e){pointerIsMouse(e)||(removePointer(e),addTouchesToEvent(e),touchendHandler(e))})),r.registerBinding(r.container,"pointercancel",(function(e){pointerIsMouse(e)||(removePointer(e),addTouchesToEvent(e),touchcancelHandler())})),r.registerBinding(r.container,"pointermove",(function(e){pointerIsMouse(e)||(e.preventDefault(),function updatePointer(e){var p=pointers.filter((function(p){return p.event.pointerId===e.pointerId}))[0];p.event=e,p.touch=makeTouch(e)}(e),addTouchesToEvent(e),touchmoveHandler(e))}))}};var BRp$d={generatePolygon:function(name,points){return this.nodeShapes[name]={renderer:this,name:name,points:points,draw:function draw(context,centerX,centerY,width,height){this.renderer.nodeShapeImpl("polygon",context,centerX,centerY,width,height,this.points)},intersectLine:function intersectLine(nodeX,nodeY,width,height,x,y,padding){return polygonIntersectLine(x,y,this.points,nodeX,nodeY,width/2,height/2,padding)},checkPoint:function checkPoint(x,y,padding,width,height,centerX,centerY){return pointInsidePolygon(x,y,this.points,centerX,centerY,width,height,[0,-1],padding)}}}};BRp$d.generateEllipse=function(){return this.nodeShapes.ellipse={renderer:this,name:"ellipse",draw:function draw(context,centerX,centerY,width,height){this.renderer.nodeShapeImpl(this.name,context,centerX,centerY,width,height)},intersectLine:function intersectLine(nodeX,nodeY,width,height,x,y,padding){return function intersectLineEllipse(x,y,centerX,centerY,ellipseWradius,ellipseHradius){var dispX=centerX-x,dispY=centerY-y;dispX/=ellipseWradius,dispY/=ellipseHradius;var len=Math.sqrt(dispX*dispX+dispY*dispY),newLength=len-1;if(newLength<0)return[];var lenProportion=newLength/len;return[(centerX-x)*lenProportion+x,(centerY-y)*lenProportion+y]}(x,y,nodeX,nodeY,width/2+padding,height/2+padding)},checkPoint:function checkPoint(x,y,padding,width,height,centerX,centerY){return checkInEllipse(x,y,width,height,centerX,centerY,padding)}}},BRp$d.generateRoundPolygon=function(name,points){for(var allPoints=new Array(2*points.length),i=0;i<points.length/2;i++){var sourceIndex=2*i,destIndex=void 0;destIndex=i<points.length/2-1?2*(i+1):0,allPoints[4*i]=points[sourceIndex],allPoints[4*i+1]=points[sourceIndex+1];var xDest=points[destIndex]-points[sourceIndex],yDest=points[destIndex+1]-points[sourceIndex+1],norm=Math.sqrt(xDest*xDest+yDest*yDest);allPoints[4*i+2]=xDest/norm,allPoints[4*i+3]=yDest/norm}return this.nodeShapes[name]={renderer:this,name:name,points:allPoints,draw:function draw(context,centerX,centerY,width,height){this.renderer.nodeShapeImpl("round-polygon",context,centerX,centerY,width,height,this.points)},intersectLine:function intersectLine(nodeX,nodeY,width,height,x,y,padding){return function roundPolygonIntersectLine(x,y,basePoints,centerX,centerY,width,height,padding){for(var intersection,intersections=[],lines=new Array(basePoints.length),halfW=width/2,halfH=height/2,cornerRadius=getRoundPolygonRadius(width,height),i=0;i<basePoints.length/4;i++){var destUv,sourceUv=void 0;sourceUv=0===i?basePoints.length-2:4*i-2,destUv=4*i+2;var px=centerX+halfW*basePoints[4*i],py=centerY+halfH*basePoints[4*i+1],cosTheta=-basePoints[sourceUv]*basePoints[destUv]-basePoints[sourceUv+1]*basePoints[destUv+1],offset=cornerRadius/Math.tan(Math.acos(cosTheta)/2),cp0x=px-offset*basePoints[sourceUv],cp0y=py-offset*basePoints[sourceUv+1],cp1x=px+offset*basePoints[destUv],cp1y=py+offset*basePoints[destUv+1];0===i?(lines[basePoints.length-2]=cp0x,lines[basePoints.length-1]=cp0y):(lines[4*i-2]=cp0x,lines[4*i-1]=cp0y),lines[4*i]=cp1x,lines[4*i+1]=cp1y;var orthx=basePoints[sourceUv+1],orthy=-basePoints[sourceUv];orthx*basePoints[destUv]+orthy*basePoints[destUv+1]<0&&(orthx*=-1,orthy*=-1),0!==(intersection=intersectLineCircle(x,y,centerX,centerY,cp0x+orthx*cornerRadius,cp0y+orthy*cornerRadius,cornerRadius)).length&&intersections.push(intersection[0],intersection[1])}for(var _i3=0;_i3<lines.length/4;_i3++)0!==(intersection=finiteLinesIntersect(x,y,centerX,centerY,lines[4*_i3],lines[4*_i3+1],lines[4*_i3+2],lines[4*_i3+3],!1)).length&&intersections.push(intersection[0],intersection[1]);if(intersections.length>2){for(var lowestIntersection=[intersections[0],intersections[1]],lowestSquaredDistance=Math.pow(lowestIntersection[0]-x,2)+Math.pow(lowestIntersection[1]-y,2),_i4=1;_i4<intersections.length/2;_i4++){var squaredDistance=Math.pow(intersections[2*_i4]-x,2)+Math.pow(intersections[2*_i4+1]-y,2);squaredDistance<=lowestSquaredDistance&&(lowestIntersection[0]=intersections[2*_i4],lowestIntersection[1]=intersections[2*_i4+1],lowestSquaredDistance=squaredDistance)}return lowestIntersection}return intersections}(x,y,this.points,nodeX,nodeY,width,height)},checkPoint:function checkPoint(x,y,padding,width,height,centerX,centerY){return function pointInsideRoundPolygon(x,y,basePoints,centerX,centerY,width,height){for(var cutPolygonPoints=new Array(basePoints.length),halfW=width/2,halfH=height/2,cornerRadius=getRoundPolygonRadius(width,height),squaredCornerRadius=cornerRadius*cornerRadius,i=0;i<basePoints.length/4;i++){var destUv,sourceUv=void 0;sourceUv=0===i?basePoints.length-2:4*i-2,destUv=4*i+2;var px=centerX+halfW*basePoints[4*i],py=centerY+halfH*basePoints[4*i+1],cosTheta=-basePoints[sourceUv]*basePoints[destUv]-basePoints[sourceUv+1]*basePoints[destUv+1],offset=cornerRadius/Math.tan(Math.acos(cosTheta)/2),cp0x=px-offset*basePoints[sourceUv],cp0y=py-offset*basePoints[sourceUv+1],cp1x=px+offset*basePoints[destUv],cp1y=py+offset*basePoints[destUv+1];cutPolygonPoints[4*i]=cp0x,cutPolygonPoints[4*i+1]=cp0y,cutPolygonPoints[4*i+2]=cp1x,cutPolygonPoints[4*i+3]=cp1y;var orthx=basePoints[sourceUv+1],orthy=-basePoints[sourceUv];orthx*basePoints[destUv]+orthy*basePoints[destUv+1]<0&&(orthx*=-1,orthy*=-1);var cx=cp0x+orthx*cornerRadius,cy=cp0y+orthy*cornerRadius;if(Math.pow(cx-x,2)+Math.pow(cy-y,2)<=squaredCornerRadius)return!0}return pointInsidePolygonPoints(x,y,cutPolygonPoints)}(x,y,this.points,centerX,centerY,width,height)}}},BRp$d.generateRoundRectangle=function(){return this.nodeShapes["round-rectangle"]=this.nodeShapes.roundrectangle={renderer:this,name:"round-rectangle",points:generateUnitNgonPointsFitToSquare(4,0),draw:function draw(context,centerX,centerY,width,height){this.renderer.nodeShapeImpl(this.name,context,centerX,centerY,width,height)},intersectLine:function intersectLine(nodeX,nodeY,width,height,x,y,padding){return roundRectangleIntersectLine(x,y,nodeX,nodeY,width,height,padding)},checkPoint:function checkPoint(x,y,padding,width,height,centerX,centerY){var cornerRadius=getRoundRectangleRadius(width,height),diam=2*cornerRadius;return!!pointInsidePolygon(x,y,this.points,centerX,centerY,width,height-diam,[0,-1],padding)||(!!pointInsidePolygon(x,y,this.points,centerX,centerY,width-diam,height,[0,-1],padding)||(!!checkInEllipse(x,y,diam,diam,centerX-width/2+cornerRadius,centerY-height/2+cornerRadius,padding)||(!!checkInEllipse(x,y,diam,diam,centerX+width/2-cornerRadius,centerY-height/2+cornerRadius,padding)||(!!checkInEllipse(x,y,diam,diam,centerX+width/2-cornerRadius,centerY+height/2-cornerRadius,padding)||!!checkInEllipse(x,y,diam,diam,centerX-width/2+cornerRadius,centerY+height/2-cornerRadius,padding)))))}}},BRp$d.generateCutRectangle=function(){return this.nodeShapes["cut-rectangle"]=this.nodeShapes.cutrectangle={renderer:this,name:"cut-rectangle",cornerLength:8,points:generateUnitNgonPointsFitToSquare(4,0),draw:function draw(context,centerX,centerY,width,height){this.renderer.nodeShapeImpl(this.name,context,centerX,centerY,width,height)},generateCutTrianglePts:function generateCutTrianglePts(width,height,centerX,centerY){var cl=this.cornerLength,hh=height/2,hw=width/2,xBegin=centerX-hw,xEnd=centerX+hw,yBegin=centerY-hh,yEnd=centerY+hh;return{topLeft:[xBegin,yBegin+cl,xBegin+cl,yBegin,xBegin+cl,yBegin+cl],topRight:[xEnd-cl,yBegin,xEnd,yBegin+cl,xEnd-cl,yBegin+cl],bottomRight:[xEnd,yEnd-cl,xEnd-cl,yEnd,xEnd-cl,yEnd-cl],bottomLeft:[xBegin+cl,yEnd,xBegin,yEnd-cl,xBegin+cl,yEnd-cl]}},intersectLine:function intersectLine(nodeX,nodeY,width,height,x,y,padding){var cPts=this.generateCutTrianglePts(width+2*padding,height+2*padding,nodeX,nodeY),pts=[].concat.apply([],[cPts.topLeft.splice(0,4),cPts.topRight.splice(0,4),cPts.bottomRight.splice(0,4),cPts.bottomLeft.splice(0,4)]);return polygonIntersectLine(x,y,pts,nodeX,nodeY)},checkPoint:function checkPoint(x,y,padding,width,height,centerX,centerY){if(pointInsidePolygon(x,y,this.points,centerX,centerY,width,height-2*this.cornerLength,[0,-1],padding))return!0;if(pointInsidePolygon(x,y,this.points,centerX,centerY,width-2*this.cornerLength,height,[0,-1],padding))return!0;var cutTrianglePts=this.generateCutTrianglePts(width,height,centerX,centerY);return pointInsidePolygonPoints(x,y,cutTrianglePts.topLeft)||pointInsidePolygonPoints(x,y,cutTrianglePts.topRight)||pointInsidePolygonPoints(x,y,cutTrianglePts.bottomRight)||pointInsidePolygonPoints(x,y,cutTrianglePts.bottomLeft)}}},BRp$d.generateBarrel=function(){return this.nodeShapes.barrel={renderer:this,name:"barrel",points:generateUnitNgonPointsFitToSquare(4,0),draw:function draw(context,centerX,centerY,width,height){this.renderer.nodeShapeImpl(this.name,context,centerX,centerY,width,height)},intersectLine:function intersectLine(nodeX,nodeY,width,height,x,y,padding){var bPts=this.generateBarrelBezierPts(width+2*padding,height+2*padding,nodeX,nodeY),approximateBarrelCurvePts=function approximateBarrelCurvePts(pts){var m0=qbezierPtAt({x:pts[0],y:pts[1]},{x:pts[2],y:pts[3]},{x:pts[4],y:pts[5]},.15),m1=qbezierPtAt({x:pts[0],y:pts[1]},{x:pts[2],y:pts[3]},{x:pts[4],y:pts[5]},.5),m2=qbezierPtAt({x:pts[0],y:pts[1]},{x:pts[2],y:pts[3]},{x:pts[4],y:pts[5]},.85);return[pts[0],pts[1],m0.x,m0.y,m1.x,m1.y,m2.x,m2.y,pts[4],pts[5]]},pts=[].concat(approximateBarrelCurvePts(bPts.topLeft),approximateBarrelCurvePts(bPts.topRight),approximateBarrelCurvePts(bPts.bottomRight),approximateBarrelCurvePts(bPts.bottomLeft));return polygonIntersectLine(x,y,pts,nodeX,nodeY)},generateBarrelBezierPts:function generateBarrelBezierPts(width,height,centerX,centerY){var hh=height/2,hw=width/2,xBegin=centerX-hw,xEnd=centerX+hw,yBegin=centerY-hh,yEnd=centerY+hh,curveConstants=getBarrelCurveConstants(width,height),hOffset=curveConstants.heightOffset,wOffset=curveConstants.widthOffset,ctrlPtXOffset=curveConstants.ctrlPtOffsetPct*width,pts={topLeft:[xBegin,yBegin+hOffset,xBegin+ctrlPtXOffset,yBegin,xBegin+wOffset,yBegin],topRight:[xEnd-wOffset,yBegin,xEnd-ctrlPtXOffset,yBegin,xEnd,yBegin+hOffset],bottomRight:[xEnd,yEnd-hOffset,xEnd-ctrlPtXOffset,yEnd,xEnd-wOffset,yEnd],bottomLeft:[xBegin+wOffset,yEnd,xBegin+ctrlPtXOffset,yEnd,xBegin,yEnd-hOffset]};return pts.topLeft.isTop=!0,pts.topRight.isTop=!0,pts.bottomLeft.isBottom=!0,pts.bottomRight.isBottom=!0,pts},checkPoint:function checkPoint(x,y,padding,width,height,centerX,centerY){var curveConstants=getBarrelCurveConstants(width,height),hOffset=curveConstants.heightOffset,wOffset=curveConstants.widthOffset;if(pointInsidePolygon(x,y,this.points,centerX,centerY,width,height-2*hOffset,[0,-1],padding))return!0;if(pointInsidePolygon(x,y,this.points,centerX,centerY,width-2*wOffset,height,[0,-1],padding))return!0;for(var barrelCurvePts=this.generateBarrelBezierPts(width,height,centerX,centerY),getCurveT=function getCurveT(x,y,curvePts){var x0=curvePts[4],x1=curvePts[2],x2=curvePts[0],y0=curvePts[5],y2=curvePts[1],xMin=Math.min(x0,x2),xMax=Math.max(x0,x2),yMin=Math.min(y0,y2),yMax=Math.max(y0,y2);if(xMin<=x&&x<=xMax&&yMin<=y&&y<=yMax){var coeff=function bezierPtsToQuadCoeff(p0,p1,p2){return[p0-2*p1+p2,2*(p1-p0),p0]}(x0,x1,x2),validRoots=function solveQuadratic(a,b,c,val){var r=b*b-4*a*(c-=val);if(r<0)return[];var sqrtR=Math.sqrt(r),denom=2*a;return[(-b+sqrtR)/denom,(-b-sqrtR)/denom]}(coeff[0],coeff[1],coeff[2],x).filter((function(r){return 0<=r&&r<=1}));if(validRoots.length>0)return validRoots[0]}return null},curveRegions=Object.keys(barrelCurvePts),i=0;i<curveRegions.length;i++){var cornerPts=barrelCurvePts[curveRegions[i]],t=getCurveT(x,y,cornerPts);if(null!=t){var y0=cornerPts[5],y1=cornerPts[3],y2=cornerPts[1],bezY=qbezierAt(y0,y1,y2,t);if(cornerPts.isTop&&bezY<=y)return!0;if(cornerPts.isBottom&&y<=bezY)return!0}}return!1}}},BRp$d.generateBottomRoundrectangle=function(){return this.nodeShapes["bottom-round-rectangle"]=this.nodeShapes.bottomroundrectangle={renderer:this,name:"bottom-round-rectangle",points:generateUnitNgonPointsFitToSquare(4,0),draw:function draw(context,centerX,centerY,width,height){this.renderer.nodeShapeImpl(this.name,context,centerX,centerY,width,height)},intersectLine:function intersectLine(nodeX,nodeY,width,height,x,y,padding){var topStartY=nodeY-(height/2+padding),topIntersections=finiteLinesIntersect(x,y,nodeX,nodeY,nodeX-(width/2+padding),topStartY,nodeX+(width/2+padding),topStartY,!1);return topIntersections.length>0?topIntersections:roundRectangleIntersectLine(x,y,nodeX,nodeY,width,height,padding)},checkPoint:function checkPoint(x,y,padding,width,height,centerX,centerY){var cornerRadius=getRoundRectangleRadius(width,height),diam=2*cornerRadius;if(pointInsidePolygon(x,y,this.points,centerX,centerY,width,height-diam,[0,-1],padding))return!0;if(pointInsidePolygon(x,y,this.points,centerX,centerY,width-diam,height,[0,-1],padding))return!0;var outerWidth=width/2+2*padding,outerHeight=height/2+2*padding;return!!pointInsidePolygonPoints(x,y,[centerX-outerWidth,centerY-outerHeight,centerX-outerWidth,centerY,centerX+outerWidth,centerY,centerX+outerWidth,centerY-outerHeight])||(!!checkInEllipse(x,y,diam,diam,centerX+width/2-cornerRadius,centerY+height/2-cornerRadius,padding)||!!checkInEllipse(x,y,diam,diam,centerX-width/2+cornerRadius,centerY+height/2-cornerRadius,padding))}}},BRp$d.registerNodeShapes=function(){var nodeShapes=this.nodeShapes={},renderer=this;this.generateEllipse(),this.generatePolygon("triangle",generateUnitNgonPointsFitToSquare(3,0)),this.generateRoundPolygon("round-triangle",generateUnitNgonPointsFitToSquare(3,0)),this.generatePolygon("rectangle",generateUnitNgonPointsFitToSquare(4,0)),nodeShapes.square=nodeShapes.rectangle,this.generateRoundRectangle(),this.generateCutRectangle(),this.generateBarrel(),this.generateBottomRoundrectangle();var diamondPoints=[0,1,1,0,0,-1,-1,0];this.generatePolygon("diamond",diamondPoints),this.generateRoundPolygon("round-diamond",diamondPoints),this.generatePolygon("pentagon",generateUnitNgonPointsFitToSquare(5,0)),this.generateRoundPolygon("round-pentagon",generateUnitNgonPointsFitToSquare(5,0)),this.generatePolygon("hexagon",generateUnitNgonPointsFitToSquare(6,0)),this.generateRoundPolygon("round-hexagon",generateUnitNgonPointsFitToSquare(6,0)),this.generatePolygon("heptagon",generateUnitNgonPointsFitToSquare(7,0)),this.generateRoundPolygon("round-heptagon",generateUnitNgonPointsFitToSquare(7,0)),this.generatePolygon("octagon",generateUnitNgonPointsFitToSquare(8,0)),this.generateRoundPolygon("round-octagon",generateUnitNgonPointsFitToSquare(8,0));var star5Points=new Array(20),outerPoints=generateUnitNgonPoints(5,0),innerPoints=generateUnitNgonPoints(5,Math.PI/5),innerRadius=.5*(3-Math.sqrt(5));innerRadius*=1.57;for(var i=0;i<innerPoints.length/2;i++)innerPoints[2*i]*=innerRadius,innerPoints[2*i+1]*=innerRadius;for(i=0;i<5;i++)star5Points[4*i]=outerPoints[2*i],star5Points[4*i+1]=outerPoints[2*i+1],star5Points[4*i+2]=innerPoints[2*i],star5Points[4*i+3]=innerPoints[2*i+1];star5Points=fitPolygonToSquare(star5Points),this.generatePolygon("star",star5Points),this.generatePolygon("vee",[-1,-1,0,-.333,1,-1,0,1]),this.generatePolygon("rhomboid",[-1,-1,.333,-1,1,1,-.333,1]),this.nodeShapes.concavehexagon=this.generatePolygon("concave-hexagon",[-1,-.95,-.75,0,-1,.95,1,.95,.75,0,1,-.95]);var tagPoints=[-1,-1,.25,-1,1,0,.25,1,-1,1];this.generatePolygon("tag",tagPoints),this.generateRoundPolygon("round-tag",tagPoints),nodeShapes.makePolygon=function(points){var shape,name="polygon-"+points.join("$");return(shape=this[name])?shape:renderer.generatePolygon(name,points)}};var BRp$e={timeToRender:function(){return this.redrawTotalTime/this.redrawCount},redraw:function(options){options=options||staticEmptyObject();var r=this;void 0===r.averageRedrawTime&&(r.averageRedrawTime=0),void 0===r.lastRedrawTime&&(r.lastRedrawTime=0),void 0===r.lastDrawTime&&(r.lastDrawTime=0),r.requestedFrame=!0,r.renderOptions=options},beforeRender:function(fn,priority){if(!this.destroyed){null==priority&&error("Priority is not optional for beforeRender");var cbs=this.beforeRenderCallbacks;cbs.push({fn:fn,priority:priority}),cbs.sort((function(a,b){return b.priority-a.priority}))}}},beforeRenderCallbacks=function beforeRenderCallbacks(r,willDraw,startTime){for(var cbs=r.beforeRenderCallbacks,i=0;i<cbs.length;i++)cbs[i].fn(willDraw,startTime)};BRp$e.startRenderLoop=function(){var r=this,cy=r.cy;if(!r.renderLoopStarted){r.renderLoopStarted=!0;requestAnimationFrame((function renderFn(requestTime){if(!r.destroyed){if(cy.batching());else if(r.requestedFrame&&!r.skipFrame){beforeRenderCallbacks(r,!0,requestTime);var startTime=performanceNow();r.render(r.renderOptions);var endTime=r.lastDrawTime=performanceNow();void 0===r.averageRedrawTime&&(r.averageRedrawTime=endTime-startTime),void 0===r.redrawCount&&(r.redrawCount=0),r.redrawCount++,void 0===r.redrawTotalTime&&(r.redrawTotalTime=0);var duration=endTime-startTime;r.redrawTotalTime+=duration,r.lastRedrawTime=duration,r.averageRedrawTime=r.averageRedrawTime/2+duration/2,r.requestedFrame=!1}else beforeRenderCallbacks(r,!1,requestTime);r.skipFrame=!1,requestAnimationFrame(renderFn)}}))}};var BR=function BaseRenderer(options){this.init(options)},BRp$f=BR.prototype;BRp$f.clientFunctions=["redrawHint","render","renderTo","matchCanvasSize","nodeShapeImpl","arrowShapeImpl"],BRp$f.init=function(options){var r=this;r.options=options,r.cy=options.cy;var ctr=r.container=options.cy.container();if(window$1){var document=window$1.document,head=document.head,className="__________cytoscape_container",stylesheetAlreadyExists=null!=document.getElementById("__________cytoscape_stylesheet");if(ctr.className.indexOf(className)<0&&(ctr.className=(ctr.className||"")+" "+className),!stylesheetAlreadyExists){var stylesheet=document.createElement("style");stylesheet.id="__________cytoscape_stylesheet",stylesheet.innerHTML="."+className+" { position: relative; }",head.insertBefore(stylesheet,head.children[0])}"static"===window$1.getComputedStyle(ctr).getPropertyValue("position")&&warn("A Cytoscape container has style position:static and so can not use UI extensions properly")}r.selection=[void 0,void 0,void 0,void 0,0],r.bezierProjPcts=[.05,.225,.4,.5,.6,.775,.95],r.hoverData={down:null,last:null,downTime:null,triggerMode:null,dragging:!1,initialPan:[null,null],capture:!1},r.dragData={possibleDragElements:[]},r.touchData={start:null,capture:!1,startPosition:[null,null,null,null,null,null],singleTouchStartTime:null,singleTouchMoved:!0,now:[null,null,null,null,null,null],earlier:[null,null,null,null,null,null]},r.redraws=0,r.showFps=options.showFps,r.debug=options.debug,r.hideEdgesOnViewport=options.hideEdgesOnViewport,r.textureOnViewport=options.textureOnViewport,r.wheelSensitivity=options.wheelSensitivity,r.motionBlurEnabled=options.motionBlur,r.forcedPixelRatio=number(options.pixelRatio)?options.pixelRatio:null,r.motionBlur=options.motionBlur,r.motionBlurOpacity=options.motionBlurOpacity,r.motionBlurTransparency=1-r.motionBlurOpacity,r.motionBlurPxRatio=1,r.mbPxRBlurry=1,r.minMbLowQualFrames=4,r.fullQualityMb=!1,r.clearedForMotionBlur=[],r.desktopTapThreshold=options.desktopTapThreshold,r.desktopTapThreshold2=options.desktopTapThreshold*options.desktopTapThreshold,r.touchTapThreshold=options.touchTapThreshold,r.touchTapThreshold2=options.touchTapThreshold*options.touchTapThreshold,r.tapholdDuration=500,r.bindings=[],r.beforeRenderCallbacks=[],r.beforeRenderPriorities={animations:400,eleCalcs:300,eleTxrDeq:200,lyrTxrDeq:150,lyrTxrSkip:100},r.registerNodeShapes(),r.registerArrowShapes(),r.registerCalculationListeners()},BRp$f.notify=function(eventName,eles){var r=this,cy=r.cy;this.destroyed||("init"!==eventName?"destroy"!==eventName?(("add"===eventName||"remove"===eventName||"move"===eventName&&cy.hasCompoundNodes()||"load"===eventName||"zorder"===eventName||"mount"===eventName)&&r.invalidateCachedZSortedEles(),"viewport"===eventName&&r.redrawHint("select",!0),"load"!==eventName&&"resize"!==eventName&&"mount"!==eventName||(r.invalidateContainerClientCoordsCache(),r.matchCanvasSize(r.container)),r.redrawHint("eles",!0),r.redrawHint("drag",!0),this.startRenderLoop(),this.redraw()):r.destroy():r.load())},BRp$f.destroy=function(){var r=this;r.destroyed=!0,r.cy.stopAnimationLoop();for(var i=0;i<r.bindings.length;i++){var b=r.bindings[i],tgt=b.target;(tgt.off||tgt.removeEventListener).apply(tgt,b.args)}if(r.bindings=[],r.beforeRenderCallbacks=[],r.onUpdateEleCalcsFns=[],r.removeObserver&&r.removeObserver.disconnect(),r.styleObserver&&r.styleObserver.disconnect(),r.resizeObserver&&r.resizeObserver.disconnect(),r.labelCalcDiv)try{document.body.removeChild(r.labelCalcDiv)}catch(e){}},BRp$f.isHeadless=function(){return!1},[BRp,BRp$a,BRp$b,BRp$c,BRp$d,BRp$e].forEach((function(props){extend(BRp$f,props)}));var defs_setupDequeueing=function setupDequeueing(opts){return function setupDequeueingImpl(){var self=this,r=this.renderer;if(!self.dequeueingSetup){self.dequeueingSetup=!0;var queueRedraw=util((function(){r.redrawHint("eles",!0),r.redrawHint("drag",!0),r.redraw()}),opts.deqRedrawThreshold),priority=opts.priority||noop;r.beforeRender((function dequeue(willDraw,frameStartTime){var startTime=performanceNow(),avgRenderTime=r.averageRedrawTime,renderTime=r.lastRedrawTime,deqd=[],extent=r.cy.extent(),pixelRatio=r.getPixelRatio();for(willDraw||r.flushRenderedStyleQueue();;){var now=performanceNow(),duration=now-startTime,frameDuration=now-frameStartTime;if(renderTime<1e3/60){var timeAvailable=1e3/60-(willDraw?avgRenderTime:0);if(frameDuration>=opts.deqFastCost*timeAvailable)break}else if(willDraw){if(duration>=opts.deqCost*renderTime||duration>=opts.deqAvgCost*avgRenderTime)break}else if(frameDuration>=opts.deqNoDrawCost*(1e3/60))break;var thisDeqd=opts.deq(self,pixelRatio,extent);if(!(thisDeqd.length>0))break;for(var i=0;i<thisDeqd.length;i++)deqd.push(thisDeqd[i])}deqd.length>0&&(opts.onDeqd(self,deqd),!willDraw&&opts.shouldRedraw(self,deqd,pixelRatio,extent)&&queueRedraw())}),priority(self))}}},ElementTextureCacheLookup=function(){function ElementTextureCacheLookup(getKey){var doesEleInvalidateKey=arguments.length>1&&void 0!==arguments[1]?arguments[1]:falsify;_classCallCheck(this,ElementTextureCacheLookup),this.idsByKey=new Map$1,this.keyForId=new Map$1,this.cachesByLvl=new Map$1,this.lvls=[],this.getKey=getKey,this.doesEleInvalidateKey=doesEleInvalidateKey}return _createClass(ElementTextureCacheLookup,[{key:"getIdsFor",value:function getIdsFor(key){null==key&&error("Can not get id list for null key");var idsByKey=this.idsByKey,ids=this.idsByKey.get(key);return ids||(ids=new Set$1,idsByKey.set(key,ids)),ids}},{key:"addIdForKey",value:function addIdForKey(key,id){null!=key&&this.getIdsFor(key).add(id)}},{key:"deleteIdForKey",value:function deleteIdForKey(key,id){null!=key&&this.getIdsFor(key).delete(id)}},{key:"getNumberOfIdsForKey",value:function getNumberOfIdsForKey(key){return null==key?0:this.getIdsFor(key).size}},{key:"updateKeyMappingFor",value:function updateKeyMappingFor(ele){var id=ele.id(),prevKey=this.keyForId.get(id),currKey=this.getKey(ele);this.deleteIdForKey(prevKey,id),this.addIdForKey(currKey,id),this.keyForId.set(id,currKey)}},{key:"deleteKeyMappingFor",value:function deleteKeyMappingFor(ele){var id=ele.id(),prevKey=this.keyForId.get(id);this.deleteIdForKey(prevKey,id),this.keyForId.delete(id)}},{key:"keyHasChangedFor",value:function keyHasChangedFor(ele){var id=ele.id();return this.keyForId.get(id)!==this.getKey(ele)}},{key:"isInvalid",value:function isInvalid(ele){return this.keyHasChangedFor(ele)||this.doesEleInvalidateKey(ele)}},{key:"getCachesAt",value:function getCachesAt(lvl){var cachesByLvl=this.cachesByLvl,lvls=this.lvls,caches=cachesByLvl.get(lvl);return caches||(caches=new Map$1,cachesByLvl.set(lvl,caches),lvls.push(lvl)),caches}},{key:"getCache",value:function getCache(key,lvl){return this.getCachesAt(lvl).get(key)}},{key:"get",value:function get(ele,lvl){var key=this.getKey(ele),cache=this.getCache(key,lvl);return null!=cache&&this.updateKeyMappingFor(ele),cache}},{key:"getForCachedKey",value:function getForCachedKey(ele,lvl){var key=this.keyForId.get(ele.id());return this.getCache(key,lvl)}},{key:"hasCache",value:function hasCache(key,lvl){return this.getCachesAt(lvl).has(key)}},{key:"has",value:function has(ele,lvl){var key=this.getKey(ele);return this.hasCache(key,lvl)}},{key:"setCache",value:function setCache(key,lvl,cache){cache.key=key,this.getCachesAt(lvl).set(key,cache)}},{key:"set",value:function set(ele,lvl,cache){var key=this.getKey(ele);this.setCache(key,lvl,cache),this.updateKeyMappingFor(ele)}},{key:"deleteCache",value:function deleteCache(key,lvl){this.getCachesAt(lvl).delete(key)}},{key:"delete",value:function _delete(ele,lvl){var key=this.getKey(ele);this.deleteCache(key,lvl)}},{key:"invalidateKey",value:function invalidateKey(key){var _this=this;this.lvls.forEach((function(lvl){return _this.deleteCache(key,lvl)}))}},{key:"invalidate",value:function invalidate(ele){var id=ele.id(),key=this.keyForId.get(id);this.deleteKeyMappingFor(ele);var entireKeyInvalidated=this.doesEleInvalidateKey(ele);return entireKeyInvalidated&&this.invalidateKey(key),entireKeyInvalidated||0===this.getNumberOfIdsForKey(key)}}]),ElementTextureCacheLookup}(),getTxrReasons={dequeue:"dequeue",downscale:"downscale",highQuality:"highQuality"},initDefaults=defaults({getKey:null,doesEleInvalidateKey:falsify,drawElement:null,getBoundingBox:null,getRotationPoint:null,getRotationOffset:null,isVisible:trueify,allowEdgeTxrCaching:!0,allowParentTxrCaching:!0}),ElementTextureCache=function ElementTextureCache(renderer,initOptions){this.renderer=renderer,this.onDequeues=[];var opts=initDefaults(initOptions);extend(this,opts),this.lookup=new ElementTextureCacheLookup(opts.getKey,opts.doesEleInvalidateKey),this.setupDequeueing()},ETCp=ElementTextureCache.prototype;ETCp.reasons=getTxrReasons,ETCp.getTextureQueue=function(txrH){return this.eleImgCaches=this.eleImgCaches||{},this.eleImgCaches[txrH]=this.eleImgCaches[txrH]||[]},ETCp.getRetiredTextureQueue=function(txrH){var rtxtrQs=this.eleImgCaches.retired=this.eleImgCaches.retired||{};return rtxtrQs[txrH]=rtxtrQs[txrH]||[]},ETCp.getElementQueue=function(){return this.eleCacheQueue=this.eleCacheQueue||new Heap((function(a,b){return b.reqs-a.reqs}))},ETCp.getElementKeyToQueue=function(){return this.eleKeyToCacheQueue=this.eleKeyToCacheQueue||{}},ETCp.getElement=function(ele,bb,pxRatio,lvl,reason){var self=this,r=this.renderer,zoom=r.cy.zoom(),lookup=this.lookup;if(!bb||0===bb.w||0===bb.h||isNaN(bb.w)||isNaN(bb.h)||!ele.visible()||ele.removed())return null;if(!self.allowEdgeTxrCaching&&ele.isEdge()||!self.allowParentTxrCaching&&ele.isParent())return null;if(null==lvl&&(lvl=Math.ceil(log2(zoom*pxRatio))),lvl<-4)lvl=-4;else if(zoom>=7.99||lvl>3)return null;var scale=Math.pow(2,lvl),eleScaledH=bb.h*scale,eleScaledW=bb.w*scale,scaledLabelShown=r.eleTextBiggerThanMin(ele,scale);if(!this.isVisible(ele,scaledLabelShown))return null;var txrH,eleCache=lookup.get(ele,lvl);if(eleCache&&eleCache.invalidated&&(eleCache.invalidated=!1,eleCache.texture.invalidatedWidth-=eleCache.width),eleCache)return eleCache;if(txrH=eleScaledH<=25?25:eleScaledH<=50?50:50*Math.ceil(eleScaledH/50),eleScaledH>1024||eleScaledW>1024)return null;var txrQ=self.getTextureQueue(txrH),txr=txrQ[txrQ.length-2],addNewTxr=function addNewTxr(){return self.recycleTexture(txrH,eleScaledW)||self.addTexture(txrH,eleScaledW)};txr||(txr=txrQ[txrQ.length-1]),txr||(txr=addNewTxr()),txr.width-txr.usedWidth<eleScaledW&&(txr=addNewTxr());for(var higherCache,scalableFrom=function scalableFrom(otherCache){return otherCache&&otherCache.scaledLabelShown===scaledLabelShown},deqing=reason&&reason===getTxrReasons.dequeue,highQualityReq=reason&&reason===getTxrReasons.highQuality,downscaleReq=reason&&reason===getTxrReasons.downscale,l=lvl+1;l<=3;l++){var c=lookup.get(ele,l);if(c){higherCache=c;break}}var oneUpCache=higherCache&&higherCache.level===lvl+1?higherCache:null,downscale=function downscale(){txr.context.drawImage(oneUpCache.texture.canvas,oneUpCache.x,0,oneUpCache.width,oneUpCache.height,txr.usedWidth,0,eleScaledW,eleScaledH)};if(txr.context.setTransform(1,0,0,1,0,0),txr.context.clearRect(txr.usedWidth,0,eleScaledW,txrH),scalableFrom(oneUpCache))downscale();else if(scalableFrom(higherCache)){if(!highQualityReq)return self.queueElement(ele,higherCache.level-1),higherCache;for(var _l=higherCache.level;_l>lvl;_l--)oneUpCache=self.getElement(ele,bb,pxRatio,_l,getTxrReasons.downscale);downscale()}else{var lowerCache;if(!deqing&&!highQualityReq&&!downscaleReq)for(var _l2=lvl-1;_l2>=-4;_l2--){var _c=lookup.get(ele,_l2);if(_c){lowerCache=_c;break}}if(scalableFrom(lowerCache))return self.queueElement(ele,lvl),lowerCache;txr.context.translate(txr.usedWidth,0),txr.context.scale(scale,scale),this.drawElement(txr.context,ele,bb,scaledLabelShown,!1),txr.context.scale(1/scale,1/scale),txr.context.translate(-txr.usedWidth,0)}return eleCache={x:txr.usedWidth,texture:txr,level:lvl,scale:scale,width:eleScaledW,height:eleScaledH,scaledLabelShown:scaledLabelShown},txr.usedWidth+=Math.ceil(eleScaledW+8),txr.eleCaches.push(eleCache),lookup.set(ele,lvl,eleCache),self.checkTextureFullness(txr),eleCache},ETCp.invalidateElements=function(eles){for(var i=0;i<eles.length;i++)this.invalidateElement(eles[i])},ETCp.invalidateElement=function(ele){var lookup=this.lookup,caches=[];if(lookup.isInvalid(ele)){for(var lvl=-4;lvl<=3;lvl++){var cache=lookup.getForCachedKey(ele,lvl);cache&&caches.push(cache)}if(lookup.invalidate(ele))for(var i=0;i<caches.length;i++){var _cache=caches[i],txr=_cache.texture;txr.invalidatedWidth+=_cache.width,_cache.invalidated=!0,this.checkTextureUtility(txr)}this.removeFromQueue(ele)}},ETCp.checkTextureUtility=function(txr){txr.invalidatedWidth>=.2*txr.width&&this.retireTexture(txr)},ETCp.checkTextureFullness=function(txr){var txrQ=this.getTextureQueue(txr.height);txr.usedWidth/txr.width>.8&&txr.fullnessChecks>=10?removeFromArray(txrQ,txr):txr.fullnessChecks++},ETCp.retireTexture=function(txr){var txrH=txr.height,txrQ=this.getTextureQueue(txrH),lookup=this.lookup;removeFromArray(txrQ,txr),txr.retired=!0;for(var eleCaches=txr.eleCaches,i=0;i<eleCaches.length;i++){var eleCache=eleCaches[i];lookup.deleteCache(eleCache.key,eleCache.level)}clearArray(eleCaches),this.getRetiredTextureQueue(txrH).push(txr)},ETCp.addTexture=function(txrH,minW){var txr={};return this.getTextureQueue(txrH).push(txr),txr.eleCaches=[],txr.height=txrH,txr.width=Math.max(1024,minW),txr.usedWidth=0,txr.invalidatedWidth=0,txr.fullnessChecks=0,txr.canvas=this.renderer.makeOffscreenCanvas(txr.width,txr.height),txr.context=txr.canvas.getContext("2d"),txr},ETCp.recycleTexture=function(txrH,minW){for(var txrQ=this.getTextureQueue(txrH),rtxtrQ=this.getRetiredTextureQueue(txrH),i=0;i<rtxtrQ.length;i++){var txr=rtxtrQ[i];if(txr.width>=minW)return txr.retired=!1,txr.usedWidth=0,txr.invalidatedWidth=0,txr.fullnessChecks=0,clearArray(txr.eleCaches),txr.context.setTransform(1,0,0,1,0,0),txr.context.clearRect(0,0,txr.width,txr.height),removeFromArray(rtxtrQ,txr),txrQ.push(txr),txr}},ETCp.queueElement=function(ele,lvl){var q=this.getElementQueue(),k2q=this.getElementKeyToQueue(),key=this.getKey(ele),existingReq=k2q[key];if(existingReq)existingReq.level=Math.max(existingReq.level,lvl),existingReq.eles.merge(ele),existingReq.reqs++,q.updateItem(existingReq);else{var req={eles:ele.spawn().merge(ele),level:lvl,reqs:1,key:key};q.push(req),k2q[key]=req}},ETCp.dequeue=function(pxRatio){for(var q=this.getElementQueue(),k2q=this.getElementKeyToQueue(),dequeued=[],lookup=this.lookup,i=0;i<1&&q.size()>0;i++){var req=q.pop(),key=req.key,ele=req.eles[0],cacheExists=lookup.hasCache(ele,req.level);if(k2q[key]=null,!cacheExists){dequeued.push(req);var bb=this.getBoundingBox(ele);this.getElement(ele,bb,pxRatio,req.level,getTxrReasons.dequeue)}}return dequeued},ETCp.removeFromQueue=function(ele){var q=this.getElementQueue(),k2q=this.getElementKeyToQueue(),key=this.getKey(ele),req=k2q[key];null!=req&&(1===req.eles.length?(req.reqs=MAX_INT,q.updateItem(req),q.pop(),k2q[key]=null):req.eles.unmerge(ele))},ETCp.onDequeue=function(fn){this.onDequeues.push(fn)},ETCp.offDequeue=function(fn){removeFromArray(this.onDequeues,fn)},ETCp.setupDequeueing=defs_setupDequeueing({deqRedrawThreshold:100,deqCost:.15,deqAvgCost:.1,deqNoDrawCost:.9,deqFastCost:.9,deq:function deq(self,pxRatio,extent){return self.dequeue(pxRatio,extent)},onDeqd:function onDeqd(self,deqd){for(var i=0;i<self.onDequeues.length;i++){(0,self.onDequeues[i])(deqd)}},shouldRedraw:function shouldRedraw(self,deqd,pxRatio,extent){for(var i=0;i<deqd.length;i++)for(var eles=deqd[i].eles,j=0;j<eles.length;j++){var bb=eles[j].boundingBox();if(boundingBoxesIntersect(bb,extent))return!0}return!1},priority:function priority(self){return self.renderer.beforeRenderPriorities.eleTxrDeq}});var LayeredTextureCache=function LayeredTextureCache(renderer){var self=this,r=self.renderer=renderer,cy=r.cy;self.layersByLevel={},self.firstGet=!0,self.lastInvalidationTime=performanceNow()-500,self.skipping=!1,self.eleTxrDeqs=cy.collection(),self.scheduleElementRefinement=util((function(){self.refineElementTextures(self.eleTxrDeqs),self.eleTxrDeqs.unmerge(self.eleTxrDeqs)}),50),r.beforeRender((function(willDraw,now){now-self.lastInvalidationTime<=250?self.skipping=!0:self.skipping=!1}),r.beforeRenderPriorities.lyrTxrSkip);self.layersQueue=new Heap((function qSort(a,b){return b.reqs-a.reqs})),self.setupDequeueing()},LTCp=LayeredTextureCache.prototype,layerIdPool=0,MAX_INT$1=Math.pow(2,53)-1;LTCp.makeLayer=function(bb,lvl){var scale=Math.pow(2,lvl),w=Math.ceil(bb.w*scale),h=Math.ceil(bb.h*scale),canvas=this.renderer.makeOffscreenCanvas(w,h),layer={id:layerIdPool=++layerIdPool%MAX_INT$1,bb:bb,level:lvl,width:w,height:h,canvas:canvas,context:canvas.getContext("2d"),eles:[],elesQueue:[],reqs:0},cxt=layer.context,dx=-layer.bb.x1,dy=-layer.bb.y1;return cxt.scale(scale,scale),cxt.translate(dx,dy),layer},LTCp.getLayers=function(eles,pxRatio,lvl){var self=this,zoom=self.renderer.cy.zoom(),firstGet=self.firstGet;if(self.firstGet=!1,null==lvl)if((lvl=Math.ceil(log2(zoom*pxRatio)))<-4)lvl=-4;else if(zoom>=3.99||lvl>2)return null;self.validateLayersElesOrdering(lvl,eles);var bb,tmpLayers,layersByLvl=self.layersByLevel,scale=Math.pow(2,lvl),layers=layersByLvl[lvl]=layersByLvl[lvl]||[];if(self.levelIsComplete(lvl,eles))return layers;!function checkTempLevels(){var canUseAsTmpLvl=function canUseAsTmpLvl(l){if(self.validateLayersElesOrdering(l,eles),self.levelIsComplete(l,eles))return tmpLayers=layersByLvl[l],!0},checkLvls=function checkLvls(dir){if(!tmpLayers)for(var l=lvl+dir;-4<=l&&l<=2&&!canUseAsTmpLvl(l);l+=dir);};checkLvls(1),checkLvls(-1);for(var i=layers.length-1;i>=0;i--){var layer=layers[i];layer.invalid&&removeFromArray(layers,layer)}}();var makeLayer=function makeLayer(opts){var after=(opts=opts||{}).after;if(function getBb(){if(!bb){bb=makeBoundingBox();for(var i=0;i<eles.length;i++)updateBoundingBox(bb,eles[i].boundingBox())}}(),bb.w*scale*(bb.h*scale)>16e6)return null;var layer=self.makeLayer(bb,lvl);if(null!=after){var index=layers.indexOf(after)+1;layers.splice(index,0,layer)}else(void 0===opts.insert||opts.insert)&&layers.unshift(layer);return layer};if(self.skipping&&!firstGet)return null;for(var layer=null,maxElesPerLayer=eles.length/1,allowLazyQueueing=!firstGet,i=0;i<eles.length;i++){var ele=eles[i],rs=ele._private.rscratch,caches=rs.imgLayerCaches=rs.imgLayerCaches||{},existingLayer=caches[lvl];if(existingLayer)layer=existingLayer;else{if((!layer||layer.eles.length>=maxElesPerLayer||!boundingBoxInBoundingBox(layer.bb,ele.boundingBox()))&&!(layer=makeLayer({insert:!0,after:layer})))return null;tmpLayers||allowLazyQueueing?self.queueLayer(layer,ele):self.drawEleInLayer(layer,ele,lvl,pxRatio),layer.eles.push(ele),caches[lvl]=layer}}return tmpLayers||(allowLazyQueueing?null:layers)},LTCp.getEleLevelForLayerLevel=function(lvl,pxRatio){return lvl},LTCp.drawEleInLayer=function(layer,ele,lvl,pxRatio){var r=this.renderer,context=layer.context,bb=ele.boundingBox();0!==bb.w&&0!==bb.h&&ele.visible()&&(lvl=this.getEleLevelForLayerLevel(lvl,pxRatio),r.setImgSmoothing(context,!1),r.drawCachedElement(context,ele,null,null,lvl,!0),r.setImgSmoothing(context,!0))},LTCp.levelIsComplete=function(lvl,eles){var layers=this.layersByLevel[lvl];if(!layers||0===layers.length)return!1;for(var numElesInLayers=0,i=0;i<layers.length;i++){var layer=layers[i];if(layer.reqs>0)return!1;if(layer.invalid)return!1;numElesInLayers+=layer.eles.length}return numElesInLayers===eles.length},LTCp.validateLayersElesOrdering=function(lvl,eles){var layers=this.layersByLevel[lvl];if(layers)for(var i=0;i<layers.length;i++){for(var layer=layers[i],offset=-1,j=0;j<eles.length;j++)if(layer.eles[0]===eles[j]){offset=j;break}if(offset<0)this.invalidateLayer(layer);else{var o=offset;for(j=0;j<layer.eles.length;j++)if(layer.eles[j]!==eles[o+j]){this.invalidateLayer(layer);break}}}},LTCp.updateElementsInLayers=function(eles,update){for(var isEles=element(eles[0]),i=0;i<eles.length;i++)for(var req=isEles?null:eles[i],ele=isEles?eles[i]:eles[i].ele,rs=ele._private.rscratch,caches=rs.imgLayerCaches=rs.imgLayerCaches||{},l=-4;l<=2;l++){var layer=caches[l];layer&&(req&&this.getEleLevelForLayerLevel(layer.level)!==req.level||update(layer,ele,req))}},LTCp.haveLayers=function(){for(var haveLayers=!1,l=-4;l<=2;l++){var layers=this.layersByLevel[l];if(layers&&layers.length>0){haveLayers=!0;break}}return haveLayers},LTCp.invalidateElements=function(eles){var self=this;0!==eles.length&&(self.lastInvalidationTime=performanceNow(),0!==eles.length&&self.haveLayers()&&self.updateElementsInLayers(eles,(function invalAssocLayers(layer,ele,req){self.invalidateLayer(layer)})))},LTCp.invalidateLayer=function(layer){if(this.lastInvalidationTime=performanceNow(),!layer.invalid){var lvl=layer.level,eles=layer.eles,layers=this.layersByLevel[lvl];removeFromArray(layers,layer),layer.elesQueue=[],layer.invalid=!0,layer.replacement&&(layer.replacement.invalid=!0);for(var i=0;i<eles.length;i++){var caches=eles[i]._private.rscratch.imgLayerCaches;caches&&(caches[lvl]=null)}}},LTCp.refineElementTextures=function(eles){var self=this;self.updateElementsInLayers(eles,(function refineEachEle(layer,ele,req){var rLyr=layer.replacement;if(rLyr||((rLyr=layer.replacement=self.makeLayer(layer.bb,layer.level)).replaces=layer,rLyr.eles=layer.eles),!rLyr.reqs)for(var i=0;i<rLyr.eles.length;i++)self.queueLayer(rLyr,rLyr.eles[i])}))},LTCp.enqueueElementRefinement=function(ele){this.eleTxrDeqs.merge(ele),this.scheduleElementRefinement()},LTCp.queueLayer=function(layer,ele){var q=this.layersQueue,elesQ=layer.elesQueue,hasId=elesQ.hasId=elesQ.hasId||{};if(!layer.replacement){if(ele){if(hasId[ele.id()])return;elesQ.push(ele),hasId[ele.id()]=!0}layer.reqs?(layer.reqs++,q.updateItem(layer)):(layer.reqs=1,q.push(layer))}},LTCp.dequeue=function(pxRatio){for(var q=this.layersQueue,deqd=[],eleDeqs=0;eleDeqs<1&&0!==q.size();){var layer=q.peek();if(layer.replacement)q.pop();else if(layer.replaces&&layer!==layer.replaces.replacement)q.pop();else if(layer.invalid)q.pop();else{var ele=layer.elesQueue.shift();ele&&(this.drawEleInLayer(layer,ele,layer.level,pxRatio),eleDeqs++),0===deqd.length&&deqd.push(!0),0===layer.elesQueue.length&&(q.pop(),layer.reqs=0,layer.replaces&&this.applyLayerReplacement(layer),this.requestRedraw())}}return deqd},LTCp.applyLayerReplacement=function(layer){var layersInLevel=this.layersByLevel[layer.level],replaced=layer.replaces,index=layersInLevel.indexOf(replaced);if(!(index<0||replaced.invalid)){layersInLevel[index]=layer;for(var i=0;i<layer.eles.length;i++){var _p=layer.eles[i]._private,cache=_p.imgLayerCaches=_p.imgLayerCaches||{};cache&&(cache[layer.level]=layer)}this.requestRedraw()}},LTCp.requestRedraw=util((function(){var r=this.renderer;r.redrawHint("eles",!0),r.redrawHint("drag",!0),r.redraw()}),100),LTCp.setupDequeueing=defs_setupDequeueing({deqRedrawThreshold:50,deqCost:.15,deqAvgCost:.1,deqNoDrawCost:.9,deqFastCost:.9,deq:function deq(self,pxRatio){return self.dequeue(pxRatio)},onDeqd:noop,shouldRedraw:trueify,priority:function priority(self){return self.renderer.beforeRenderPriorities.lyrTxrDeq}});var impl,CRp={};function polygon(context,points){for(var i=0;i<points.length;i++){var pt=points[i];context.lineTo(pt.x,pt.y)}}function triangleBackcurve(context,points,controlPoint){for(var firstPt,i=0;i<points.length;i++){var pt=points[i];0===i&&(firstPt=pt),context.lineTo(pt.x,pt.y)}context.quadraticCurveTo(controlPoint.x,controlPoint.y,firstPt.x,firstPt.y)}function triangleTee(context,trianglePoints,teePoints){context.beginPath&&context.beginPath();for(var triPts=trianglePoints,i=0;i<triPts.length;i++){var pt=triPts[i];context.lineTo(pt.x,pt.y)}var teePts=teePoints,firstTeePt=teePoints[0];context.moveTo(firstTeePt.x,firstTeePt.y);for(i=1;i<teePts.length;i++){pt=teePts[i];context.lineTo(pt.x,pt.y)}context.closePath&&context.closePath()}function circleTriangle(context,trianglePoints,rx,ry,r){context.beginPath&&context.beginPath(),context.arc(rx,ry,r,0,2*Math.PI,!1);var triPts=trianglePoints,firstTrPt=triPts[0];context.moveTo(firstTrPt.x,firstTrPt.y);for(var i=0;i<triPts.length;i++){var pt=triPts[i];context.lineTo(pt.x,pt.y)}context.closePath&&context.closePath()}function circle(context,rx,ry,r){context.arc(rx,ry,r,0,2*Math.PI,!1)}CRp.arrowShapeImpl=function(name){return(impl||(impl={polygon:polygon,"triangle-backcurve":triangleBackcurve,"triangle-tee":triangleTee,"circle-triangle":circleTriangle,"triangle-cross":triangleTee,circle:circle}))[name]};var CRp$1={drawElement:function(context,ele,shiftToOriginWithBb,showLabel,showOverlay,showOpacity){ele.isNode()?this.drawNode(context,ele,shiftToOriginWithBb,showLabel,showOverlay,showOpacity):this.drawEdge(context,ele,shiftToOriginWithBb,showLabel,showOverlay,showOpacity)},drawElementOverlay:function(context,ele){ele.isNode()?this.drawNodeOverlay(context,ele):this.drawEdgeOverlay(context,ele)},drawCachedElementPortion:function(context,ele,eleTxrCache,pxRatio,lvl,reason,getRotation,getOpacity){var r=this,bb=eleTxrCache.getBoundingBox(ele);if(0!==bb.w&&0!==bb.h){var eleCache=eleTxrCache.getElement(ele,bb,pxRatio,lvl,reason);if(null!=eleCache){var opacity=getOpacity(r,ele);if(0===opacity)return;var x,y,sx,sy,smooth,oldGlobalAlpha,theta=getRotation(r,ele),x1=bb.x1,y1=bb.y1,w=bb.w,h=bb.h;if(0!==theta){var rotPt=eleTxrCache.getRotationPoint(ele);sx=rotPt.x,sy=rotPt.y,context.translate(sx,sy),context.rotate(theta),(smooth=r.getImgSmoothing(context))||r.setImgSmoothing(context,!0);var off=eleTxrCache.getRotationOffset(ele);x=off.x,y=off.y}else x=x1,y=y1;1!==opacity&&(oldGlobalAlpha=context.globalAlpha,context.globalAlpha=oldGlobalAlpha*opacity),context.drawImage(eleCache.texture.canvas,eleCache.x,0,eleCache.width,eleCache.height,x,y,w,h),1!==opacity&&(context.globalAlpha=oldGlobalAlpha),0!==theta&&(context.rotate(-theta),context.translate(-sx,-sy),smooth||r.setImgSmoothing(context,!1))}else eleTxrCache.drawElement(context,ele)}}},getZeroRotation=function getZeroRotation(){return 0},getLabelRotation=function getLabelRotation(r,ele){return r.getTextAngle(ele,null)},getSourceLabelRotation=function getSourceLabelRotation(r,ele){return r.getTextAngle(ele,"source")},getTargetLabelRotation=function getTargetLabelRotation(r,ele){return r.getTextAngle(ele,"target")},getOpacity=function getOpacity(r,ele){return ele.effectiveOpacity()},getTextOpacity=function getTextOpacity(e,ele){return ele.pstyle("text-opacity").pfValue*ele.effectiveOpacity()};CRp$1.drawCachedElement=function(context,ele,pxRatio,extent,lvl,requestHighQuality){var r=this,_r$data=r.data,eleTxrCache=_r$data.eleTxrCache,lblTxrCache=_r$data.lblTxrCache,slbTxrCache=_r$data.slbTxrCache,tlbTxrCache=_r$data.tlbTxrCache,bb=ele.boundingBox(),reason=!0===requestHighQuality?eleTxrCache.reasons.highQuality:null;if(0!==bb.w&&0!==bb.h&&ele.visible()&&(!extent||boundingBoxesIntersect(bb,extent))){var isEdge=ele.isEdge(),badLine=ele.element()._private.rscratch.badLine;r.drawCachedElementPortion(context,ele,eleTxrCache,pxRatio,lvl,reason,getZeroRotation,getOpacity),isEdge&&badLine||r.drawCachedElementPortion(context,ele,lblTxrCache,pxRatio,lvl,reason,getLabelRotation,getTextOpacity),isEdge&&!badLine&&(r.drawCachedElementPortion(context,ele,slbTxrCache,pxRatio,lvl,reason,getSourceLabelRotation,getTextOpacity),r.drawCachedElementPortion(context,ele,tlbTxrCache,pxRatio,lvl,reason,getTargetLabelRotation,getTextOpacity)),r.drawElementOverlay(context,ele)}},CRp$1.drawElements=function(context,eles){for(var i=0;i<eles.length;i++){var ele=eles[i];this.drawElement(context,ele)}},CRp$1.drawCachedElements=function(context,eles,pxRatio,extent){for(var i=0;i<eles.length;i++){var ele=eles[i];this.drawCachedElement(context,ele,pxRatio,extent)}},CRp$1.drawCachedNodes=function(context,eles,pxRatio,extent){for(var i=0;i<eles.length;i++){var ele=eles[i];ele.isNode()&&this.drawCachedElement(context,ele,pxRatio,extent)}},CRp$1.drawLayeredElements=function(context,eles,pxRatio,extent){var layers=this.data.lyrTxrCache.getLayers(eles,pxRatio);if(layers)for(var i=0;i<layers.length;i++){var layer=layers[i],bb=layer.bb;0!==bb.w&&0!==bb.h&&context.drawImage(layer.canvas,bb.x1,bb.y1,bb.w,bb.h)}else this.drawCachedElements(context,eles,pxRatio,extent)};var CRp$2={drawEdge:function(context,edge,shiftToOriginWithBb){var drawLabel=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],shouldDrawOverlay=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],shouldDrawOpacity=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],r=this,rs=edge._private.rscratch;if((!shouldDrawOpacity||edge.visible())&&!rs.badLine&&null!=rs.allpts&&!isNaN(rs.allpts[0])){var bb;shiftToOriginWithBb&&(bb=shiftToOriginWithBb,context.translate(-bb.x1,-bb.y1));var opacity=shouldDrawOpacity?edge.pstyle("opacity").value:1,lineOpacity=shouldDrawOpacity?edge.pstyle("line-opacity").value:1,lineStyle=edge.pstyle("line-style").value,edgeWidth=edge.pstyle("width").pfValue,lineCap=edge.pstyle("line-cap").value,effectiveLineOpacity=opacity*lineOpacity,effectiveArrowOpacity=opacity*lineOpacity,drawLine=function drawLine(){var strokeOpacity=arguments.length>0&&void 0!==arguments[0]?arguments[0]:effectiveLineOpacity;context.lineWidth=edgeWidth,context.lineCap=lineCap,r.eleStrokeStyle(context,edge,strokeOpacity),r.drawEdgePath(edge,context,rs.allpts,lineStyle),context.lineCap="butt"},drawOverlay=function drawOverlay(){shouldDrawOverlay&&r.drawEdgeOverlay(context,edge)},drawArrows=function drawArrows(){var arrowOpacity=arguments.length>0&&void 0!==arguments[0]?arguments[0]:effectiveArrowOpacity;r.drawArrowheads(context,edge,arrowOpacity)},drawText=function drawText(){r.drawElementText(context,edge,null,drawLabel)};context.lineJoin="round";var ghost="yes"===edge.pstyle("ghost").value;if(ghost){var gx=edge.pstyle("ghost-offset-x").pfValue,gy=edge.pstyle("ghost-offset-y").pfValue,ghostOpacity=edge.pstyle("ghost-opacity").value,effectiveGhostOpacity=effectiveLineOpacity*ghostOpacity;context.translate(gx,gy),drawLine(effectiveGhostOpacity),drawArrows(effectiveGhostOpacity),context.translate(-gx,-gy)}drawLine(),drawArrows(),drawOverlay(),drawText(),shiftToOriginWithBb&&context.translate(bb.x1,bb.y1)}},drawEdgeOverlay:function(context,edge){if(edge.visible()){var overlayOpacity=edge.pstyle("overlay-opacity").value;if(0!==overlayOpacity){var r=this,usePaths=r.usePaths(),rs=edge._private.rscratch,overlayWidth=2*edge.pstyle("overlay-padding").pfValue,overlayColor=edge.pstyle("overlay-color").value;context.lineWidth=overlayWidth,"self"!==rs.edgeType||usePaths?context.lineCap="round":context.lineCap="butt",r.colorStrokeStyle(context,overlayColor[0],overlayColor[1],overlayColor[2],overlayOpacity),r.drawEdgePath(edge,context,rs.allpts,"solid")}}},drawEdgePath:function(edge,context,pts,type){var path,rs=edge._private.rscratch,canvasCxt=context,pathCacheHit=!1,usePaths=this.usePaths(),lineDashPattern=edge.pstyle("line-dash-pattern").pfValue,lineDashOffset=edge.pstyle("line-dash-offset").pfValue;if(usePaths){var pathCacheKey=pts.join("$");rs.pathCacheKey&&rs.pathCacheKey===pathCacheKey?(path=context=rs.pathCache,pathCacheHit=!0):(path=context=new Path2D,rs.pathCacheKey=pathCacheKey,rs.pathCache=path)}if(canvasCxt.setLineDash)switch(type){case"dotted":canvasCxt.setLineDash([1,1]);break;case"dashed":canvasCxt.setLineDash(lineDashPattern),canvasCxt.lineDashOffset=lineDashOffset;break;case"solid":canvasCxt.setLineDash([])}if(!pathCacheHit&&!rs.badLine)switch(context.beginPath&&context.beginPath(),context.moveTo(pts[0],pts[1]),rs.edgeType){case"bezier":case"self":case"compound":case"multibezier":for(var i=2;i+3<pts.length;i+=4)context.quadraticCurveTo(pts[i],pts[i+1],pts[i+2],pts[i+3]);break;case"straight":case"segments":case"haystack":for(var _i=2;_i+1<pts.length;_i+=2)context.lineTo(pts[_i],pts[_i+1])}context=canvasCxt,usePaths?context.stroke(path):context.stroke(),context.setLineDash&&context.setLineDash([])},drawArrowheads:function(context,edge,opacity){var rs=edge._private.rscratch,isHaystack="haystack"===rs.edgeType;isHaystack||this.drawArrowhead(context,edge,"source",rs.arrowStartX,rs.arrowStartY,rs.srcArrowAngle,opacity),this.drawArrowhead(context,edge,"mid-target",rs.midX,rs.midY,rs.midtgtArrowAngle,opacity),this.drawArrowhead(context,edge,"mid-source",rs.midX,rs.midY,rs.midsrcArrowAngle,opacity),isHaystack||this.drawArrowhead(context,edge,"target",rs.arrowEndX,rs.arrowEndY,rs.tgtArrowAngle,opacity)},drawArrowhead:function(context,edge,prefix,x,y,angle,opacity){if(!(isNaN(x)||null==x||isNaN(y)||null==y||isNaN(angle)||null==angle)){var arrowShape=edge.pstyle(prefix+"-arrow-shape").value;if("none"!==arrowShape){var arrowClearFill="hollow"===edge.pstyle(prefix+"-arrow-fill").value?"both":"filled",arrowFill=edge.pstyle(prefix+"-arrow-fill").value,edgeWidth=edge.pstyle("width").pfValue,edgeOpacity=edge.pstyle("opacity").value;void 0===opacity&&(opacity=edgeOpacity);var gco=context.globalCompositeOperation;1===opacity&&"hollow"!==arrowFill||(context.globalCompositeOperation="destination-out",this.colorFillStyle(context,255,255,255,1),this.colorStrokeStyle(context,255,255,255,1),this.drawArrowShape(edge,context,arrowClearFill,edgeWidth,arrowShape,x,y,angle),context.globalCompositeOperation=gco);var color=edge.pstyle(prefix+"-arrow-color").value;this.colorFillStyle(context,color[0],color[1],color[2],opacity),this.colorStrokeStyle(context,color[0],color[1],color[2],opacity),this.drawArrowShape(edge,context,arrowFill,edgeWidth,arrowShape,x,y,angle)}}},drawArrowShape:function(edge,context,fill,edgeWidth,shape,x,y,angle){var path,r=this,usePaths=this.usePaths()&&"triangle-cross"!==shape,pathCacheHit=!1,canvasContext=context,translation={x:x,y:y},scale=edge.pstyle("arrow-scale").value,size=this.getArrowWidth(edgeWidth,scale),shapeImpl=r.arrowShapes[shape];if(usePaths){var cache=r.arrowPathCache=r.arrowPathCache||[],key=hashString(shape),cachedPath=cache[key];null!=cachedPath?(path=context=cachedPath,pathCacheHit=!0):(path=context=new Path2D,cache[key]=path)}pathCacheHit||(context.beginPath&&context.beginPath(),usePaths?shapeImpl.draw(context,1,0,{x:0,y:0},1):shapeImpl.draw(context,size,angle,translation,edgeWidth),context.closePath&&context.closePath()),context=canvasContext,usePaths&&(context.translate(x,y),context.rotate(angle),context.scale(size,size)),"filled"!==fill&&"both"!==fill||(usePaths?context.fill(path):context.fill()),"hollow"!==fill&&"both"!==fill||(context.lineWidth=(shapeImpl.matchEdgeWidth?edgeWidth:1)/(usePaths?size:1),context.lineJoin="miter",usePaths?context.stroke(path):context.stroke()),usePaths&&(context.scale(1/size,1/size),context.rotate(-angle),context.translate(-x,-y))}},CRp$3={safeDrawImage:function(context,img,ix,iy,iw,ih,x,y,w,h){iw<=0||ih<=0||w<=0||h<=0||context.drawImage(img,ix,iy,iw,ih,x,y,w,h)},drawInscribedImage:function(context,img,node,index,nodeOpacity){var r=this,pos=node.position(),nodeX=pos.x,nodeY=pos.y,styleObj=node.cy().style(),getIndexedStyle=styleObj.getIndexedStyle.bind(styleObj),fit=getIndexedStyle(node,"background-fit","value",index),repeat=getIndexedStyle(node,"background-repeat","value",index),nodeW=node.width(),nodeH=node.height(),paddingX2=2*node.padding(),nodeTW=nodeW+("inner"===getIndexedStyle(node,"background-width-relative-to","value",index)?0:paddingX2),nodeTH=nodeH+("inner"===getIndexedStyle(node,"background-height-relative-to","value",index)?0:paddingX2),rs=node._private.rscratch,shouldClip="node"===getIndexedStyle(node,"background-clip","value",index),imgOpacity=getIndexedStyle(node,"background-image-opacity","value",index)*nodeOpacity,smooth=getIndexedStyle(node,"background-image-smoothing","value",index),imgW=img.width||img.cachedW,imgH=img.height||img.cachedH;null!=imgW&&null!=imgH||(document.body.appendChild(img),imgW=img.cachedW=img.width||img.offsetWidth,imgH=img.cachedH=img.height||img.offsetHeight,document.body.removeChild(img));var w=imgW,h=imgH;if("auto"!==getIndexedStyle(node,"background-width","value",index)&&(w="%"===getIndexedStyle(node,"background-width","units",index)?getIndexedStyle(node,"background-width","pfValue",index)*nodeTW:getIndexedStyle(node,"background-width","pfValue",index)),"auto"!==getIndexedStyle(node,"background-height","value",index)&&(h="%"===getIndexedStyle(node,"background-height","units",index)?getIndexedStyle(node,"background-height","pfValue",index)*nodeTH:getIndexedStyle(node,"background-height","pfValue",index)),0!==w&&0!==h){if("contain"===fit)w*=scale=Math.min(nodeTW/w,nodeTH/h),h*=scale;else if("cover"===fit){var scale;w*=scale=Math.max(nodeTW/w,nodeTH/h),h*=scale}var x=nodeX-nodeTW/2,posXUnits=getIndexedStyle(node,"background-position-x","units",index),posXPfVal=getIndexedStyle(node,"background-position-x","pfValue",index);x+="%"===posXUnits?(nodeTW-w)*posXPfVal:posXPfVal;var offXUnits=getIndexedStyle(node,"background-offset-x","units",index),offXPfVal=getIndexedStyle(node,"background-offset-x","pfValue",index);x+="%"===offXUnits?(nodeTW-w)*offXPfVal:offXPfVal;var y=nodeY-nodeTH/2,posYUnits=getIndexedStyle(node,"background-position-y","units",index),posYPfVal=getIndexedStyle(node,"background-position-y","pfValue",index);y+="%"===posYUnits?(nodeTH-h)*posYPfVal:posYPfVal;var offYUnits=getIndexedStyle(node,"background-offset-y","units",index),offYPfVal=getIndexedStyle(node,"background-offset-y","pfValue",index);y+="%"===offYUnits?(nodeTH-h)*offYPfVal:offYPfVal,rs.pathCache&&(x-=nodeX,y-=nodeY,nodeX=0,nodeY=0);var gAlpha=context.globalAlpha;context.globalAlpha=imgOpacity;var smoothingEnabled=r.getImgSmoothing(context),isSmoothingSwitched=!1;if("no"===smooth&&smoothingEnabled?(r.setImgSmoothing(context,!1),isSmoothingSwitched=!0):"yes"!==smooth||smoothingEnabled||(r.setImgSmoothing(context,!0),isSmoothingSwitched=!0),"no-repeat"===repeat)shouldClip&&(context.save(),rs.pathCache?context.clip(rs.pathCache):(r.nodeShapes[r.getNodeShape(node)].draw(context,nodeX,nodeY,nodeTW,nodeTH),context.clip())),r.safeDrawImage(context,img,0,0,imgW,imgH,x,y,w,h),shouldClip&&context.restore();else{var pattern=context.createPattern(img,repeat);context.fillStyle=pattern,r.nodeShapes[r.getNodeShape(node)].draw(context,nodeX,nodeY,nodeTW,nodeTH),context.translate(x,y),context.fill(),context.translate(-x,-y)}context.globalAlpha=gAlpha,isSmoothingSwitched&&r.setImgSmoothing(context,smoothingEnabled)}}},CRp$4={};function roundRect(ctx,x,y,width,height){var radius=arguments.length>5&&void 0!==arguments[5]?arguments[5]:5;ctx.beginPath(),ctx.moveTo(x+radius,y),ctx.lineTo(x+width-radius,y),ctx.quadraticCurveTo(x+width,y,x+width,y+radius),ctx.lineTo(x+width,y+height-radius),ctx.quadraticCurveTo(x+width,y+height,x+width-radius,y+height),ctx.lineTo(x+radius,y+height),ctx.quadraticCurveTo(x,y+height,x,y+height-radius),ctx.lineTo(x,y+radius),ctx.quadraticCurveTo(x,y,x+radius,y),ctx.closePath(),ctx.fill()}CRp$4.eleTextBiggerThanMin=function(ele,scale){if(!scale){var zoom=ele.cy().zoom(),pxRatio=this.getPixelRatio(),lvl=Math.ceil(log2(zoom*pxRatio));scale=Math.pow(2,lvl)}return!(ele.pstyle("font-size").pfValue*scale<ele.pstyle("min-zoomed-font-size").pfValue)},CRp$4.drawElementText=function(context,ele,shiftToOriginWithBb,force,prefix){var useEleOpacity=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],r=this;if(null==force){if(useEleOpacity&&!r.eleTextBiggerThanMin(ele))return}else if(!1===force)return;if(ele.isNode()){var label=ele.pstyle("label");if(!label||!label.value)return;var justification=r.getLabelJustification(ele);context.textAlign=justification,context.textBaseline="bottom"}else{var badLine=ele.element()._private.rscratch.badLine,_label=ele.pstyle("label"),srcLabel=ele.pstyle("source-label"),tgtLabel=ele.pstyle("target-label");if(badLine||(!_label||!_label.value)&&(!srcLabel||!srcLabel.value)&&(!tgtLabel||!tgtLabel.value))return;context.textAlign="center",context.textBaseline="bottom"}var bb,applyRotation=!shiftToOriginWithBb;shiftToOriginWithBb&&(bb=shiftToOriginWithBb,context.translate(-bb.x1,-bb.y1)),null==prefix?(r.drawText(context,ele,null,applyRotation,useEleOpacity),ele.isEdge()&&(r.drawText(context,ele,"source",applyRotation,useEleOpacity),r.drawText(context,ele,"target",applyRotation,useEleOpacity))):r.drawText(context,ele,prefix,applyRotation,useEleOpacity),shiftToOriginWithBb&&context.translate(bb.x1,bb.y1)},CRp$4.getFontCache=function(context){var cache;this.fontCaches=this.fontCaches||[];for(var i=0;i<this.fontCaches.length;i++)if((cache=this.fontCaches[i]).context===context)return cache;return cache={context:context},this.fontCaches.push(cache),cache},CRp$4.setupTextStyle=function(context,ele){var useEleOpacity=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],labelStyle=ele.pstyle("font-style").strValue,labelSize=ele.pstyle("font-size").pfValue+"px",labelFamily=ele.pstyle("font-family").strValue,labelWeight=ele.pstyle("font-weight").strValue,opacity=useEleOpacity?ele.effectiveOpacity()*ele.pstyle("text-opacity").value:1,outlineOpacity=ele.pstyle("text-outline-opacity").value*opacity,color=ele.pstyle("color").value,outlineColor=ele.pstyle("text-outline-color").value;context.font=labelStyle+" "+labelWeight+" "+labelSize+" "+labelFamily,context.lineJoin="round",this.colorFillStyle(context,color[0],color[1],color[2],opacity),this.colorStrokeStyle(context,outlineColor[0],outlineColor[1],outlineColor[2],outlineOpacity)},CRp$4.getTextAngle=function(ele,prefix){var rscratch=ele._private.rscratch,pdash=prefix?prefix+"-":"",rotation=ele.pstyle(pdash+"text-rotation"),textAngle=getPrefixedProperty(rscratch,"labelAngle",prefix);return"autorotate"===rotation.strValue?ele.isEdge()?textAngle:0:"none"===rotation.strValue?0:rotation.pfValue},CRp$4.drawText=function(context,ele,prefix){var applyRotation=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],useEleOpacity=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],_p=ele._private,rscratch=_p.rscratch,parentOpacity=useEleOpacity?ele.effectiveOpacity():1;if(!useEleOpacity||0!==parentOpacity&&0!==ele.pstyle("text-opacity").value){"main"===prefix&&(prefix=null);var orgTextX,orgTextY,textX=getPrefixedProperty(rscratch,"labelX",prefix),textY=getPrefixedProperty(rscratch,"labelY",prefix),text=this.getLabelText(ele,prefix);if(null!=text&&""!==text&&!isNaN(textX)&&!isNaN(textY)){this.setupTextStyle(context,ele,useEleOpacity);var theta,pdash=prefix?prefix+"-":"",textW=getPrefixedProperty(rscratch,"labelWidth",prefix),textH=getPrefixedProperty(rscratch,"labelHeight",prefix),marginX=ele.pstyle(pdash+"text-margin-x").pfValue,marginY=ele.pstyle(pdash+"text-margin-y").pfValue,isEdge=ele.isEdge(),halign=ele.pstyle("text-halign").value,valign=ele.pstyle("text-valign").value;switch(isEdge&&(halign="center",valign="center"),textX+=marginX,textY+=marginY,0!==(theta=applyRotation?this.getTextAngle(ele,prefix):0)&&(orgTextX=textX,orgTextY=textY,context.translate(orgTextX,orgTextY),context.rotate(theta),textX=0,textY=0),valign){case"top":break;case"center":textY+=textH/2;break;case"bottom":textY+=textH}var backgroundOpacity=ele.pstyle("text-background-opacity").value,borderOpacity=ele.pstyle("text-border-opacity").value,textBorderWidth=ele.pstyle("text-border-width").pfValue,backgroundPadding=ele.pstyle("text-background-padding").pfValue;if(backgroundOpacity>0||textBorderWidth>0&&borderOpacity>0){var bgX=textX-backgroundPadding;switch(halign){case"left":bgX-=textW;break;case"center":bgX-=textW/2}var bgY=textY-textH-backgroundPadding,bgW=textW+2*backgroundPadding,bgH=textH+2*backgroundPadding;if(backgroundOpacity>0){var textFill=context.fillStyle,textBackgroundColor=ele.pstyle("text-background-color").value;context.fillStyle="rgba("+textBackgroundColor[0]+","+textBackgroundColor[1]+","+textBackgroundColor[2]+","+backgroundOpacity*parentOpacity+")";var styleShape=ele.pstyle("text-background-shape").strValue;0===styleShape.indexOf("round")?roundRect(context,bgX,bgY,bgW,bgH,2):context.fillRect(bgX,bgY,bgW,bgH),context.fillStyle=textFill}if(textBorderWidth>0&&borderOpacity>0){var textStroke=context.strokeStyle,textLineWidth=context.lineWidth,textBorderColor=ele.pstyle("text-border-color").value,textBorderStyle=ele.pstyle("text-border-style").value;if(context.strokeStyle="rgba("+textBorderColor[0]+","+textBorderColor[1]+","+textBorderColor[2]+","+borderOpacity*parentOpacity+")",context.lineWidth=textBorderWidth,context.setLineDash)switch(textBorderStyle){case"dotted":context.setLineDash([1,1]);break;case"dashed":context.setLineDash([4,2]);break;case"double":context.lineWidth=textBorderWidth/4,context.setLineDash([]);break;case"solid":context.setLineDash([])}if(context.strokeRect(bgX,bgY,bgW,bgH),"double"===textBorderStyle){var whiteWidth=textBorderWidth/2;context.strokeRect(bgX+whiteWidth,bgY+whiteWidth,bgW-2*whiteWidth,bgH-2*whiteWidth)}context.setLineDash&&context.setLineDash([]),context.lineWidth=textLineWidth,context.strokeStyle=textStroke}}var lineWidth=2*ele.pstyle("text-outline-width").pfValue;if(lineWidth>0&&(context.lineWidth=lineWidth),"wrap"===ele.pstyle("text-wrap").value){var lines=getPrefixedProperty(rscratch,"labelWrapCachedLines",prefix),lineHeight=getPrefixedProperty(rscratch,"labelLineHeight",prefix),halfTextW=textW/2,justification=this.getLabelJustification(ele);switch("auto"===justification||("left"===halign?"left"===justification?textX+=-textW:"center"===justification&&(textX+=-halfTextW):"center"===halign?"left"===justification?textX+=-halfTextW:"right"===justification&&(textX+=halfTextW):"right"===halign&&("center"===justification?textX+=halfTextW:"right"===justification&&(textX+=textW))),valign){case"top":textY-=(lines.length-1)*lineHeight;break;case"center":case"bottom":textY-=(lines.length-1)*lineHeight}for(var l=0;l<lines.length;l++)lineWidth>0&&context.strokeText(lines[l],textX,textY),context.fillText(lines[l],textX,textY),textY+=lineHeight}else lineWidth>0&&context.strokeText(text,textX,textY),context.fillText(text,textX,textY);0!==theta&&(context.rotate(-theta),context.translate(-orgTextX,-orgTextY))}}};var CRp$5={drawNode:function(context,node,shiftToOriginWithBb){var nodeWidth,nodeHeight,drawLabel=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],shouldDrawOverlay=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],shouldDrawOpacity=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],r=this,_p=node._private,rs=_p.rscratch,pos=node.position();if(number(pos.x)&&number(pos.y)&&(!shouldDrawOpacity||node.visible())){var path,bb,eleOpacity=shouldDrawOpacity?node.effectiveOpacity():1,usePaths=r.usePaths(),pathCacheHit=!1,padding=node.padding();nodeWidth=node.width()+2*padding,nodeHeight=node.height()+2*padding,shiftToOriginWithBb&&(bb=shiftToOriginWithBb,context.translate(-bb.x1,-bb.y1));for(var bgImgProp=node.pstyle("background-image"),urls=bgImgProp.value,urlDefined=new Array(urls.length),image=new Array(urls.length),numImages=0,i=0;i<urls.length;i++){var url=urls[i],defd=urlDefined[i]=null!=url&&"none"!==url;if(defd){var bgImgCrossOrigin=node.cy().style().getIndexedStyle(node,"background-image-crossorigin","value",i);numImages++,image[i]=r.getCachedImage(url,bgImgCrossOrigin,(function(){_p.backgroundTimestamp=Date.now(),node.emitAndNotify("background")}))}}var darkness=node.pstyle("background-blacken").value,borderWidth=node.pstyle("border-width").pfValue,bgOpacity=node.pstyle("background-opacity").value*eleOpacity,borderColor=node.pstyle("border-color").value,borderStyle=node.pstyle("border-style").value,borderOpacity=node.pstyle("border-opacity").value*eleOpacity;context.lineJoin="miter";var setupShapeColor=function setupShapeColor(){var bgOpy=arguments.length>0&&void 0!==arguments[0]?arguments[0]:bgOpacity;r.eleFillStyle(context,node,bgOpy)},setupBorderColor=function setupBorderColor(){var bdrOpy=arguments.length>0&&void 0!==arguments[0]?arguments[0]:borderOpacity;r.colorStrokeStyle(context,borderColor[0],borderColor[1],borderColor[2],bdrOpy)},styleShape=node.pstyle("shape").strValue,shapePts=node.pstyle("shape-polygon-points").pfValue;if(usePaths){context.translate(pos.x,pos.y);var pathCache=r.nodePathCache=r.nodePathCache||[],key=hashStrings("polygon"===styleShape?styleShape+","+shapePts.join(","):styleShape,""+nodeHeight,""+nodeWidth),cachedPath=pathCache[key];null!=cachedPath?(path=cachedPath,pathCacheHit=!0,rs.pathCache=path):(path=new Path2D,pathCache[key]=rs.pathCache=path)}var drawShape=function drawShape(){if(!pathCacheHit){var npos=pos;usePaths&&(npos={x:0,y:0}),r.nodeShapes[r.getNodeShape(node)].draw(path||context,npos.x,npos.y,nodeWidth,nodeHeight)}usePaths?context.fill(path):context.fill()},drawImages=function drawImages(){for(var nodeOpacity=arguments.length>0&&void 0!==arguments[0]?arguments[0]:eleOpacity,inside=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],prevBging=_p.backgrounding,totalCompleted=0,_i=0;_i<image.length;_i++){var bgContainment=node.cy().style().getIndexedStyle(node,"background-image-containment","value",_i);inside&&"over"===bgContainment||!inside&&"inside"===bgContainment?totalCompleted++:urlDefined[_i]&&image[_i].complete&&!image[_i].error&&(totalCompleted++,r.drawInscribedImage(context,image[_i],node,_i,nodeOpacity))}_p.backgrounding=!(totalCompleted===numImages),prevBging!==_p.backgrounding&&node.updateStyle(!1)},drawPie=function drawPie(){var redrawShape=arguments.length>0&&void 0!==arguments[0]&&arguments[0],pieOpacity=arguments.length>1&&void 0!==arguments[1]?arguments[1]:eleOpacity;r.hasPie(node)&&(r.drawPie(context,node,pieOpacity),redrawShape&&(usePaths||r.nodeShapes[r.getNodeShape(node)].draw(context,pos.x,pos.y,nodeWidth,nodeHeight)))},darken=function darken(){var darkenOpacity=arguments.length>0&&void 0!==arguments[0]?arguments[0]:eleOpacity,opacity=(darkness>0?darkness:-darkness)*darkenOpacity,c=darkness>0?0:255;0!==darkness&&(r.colorFillStyle(context,c,c,c,opacity),usePaths?context.fill(path):context.fill())},drawBorder=function drawBorder(){if(borderWidth>0){if(context.lineWidth=borderWidth,context.lineCap="butt",context.setLineDash)switch(borderStyle){case"dotted":context.setLineDash([1,1]);break;case"dashed":context.setLineDash([4,2]);break;case"solid":case"double":context.setLineDash([])}if(usePaths?context.stroke(path):context.stroke(),"double"===borderStyle){context.lineWidth=borderWidth/3;var gco=context.globalCompositeOperation;context.globalCompositeOperation="destination-out",usePaths?context.stroke(path):context.stroke(),context.globalCompositeOperation=gco}context.setLineDash&&context.setLineDash([])}},drawOverlay=function drawOverlay(){shouldDrawOverlay&&r.drawNodeOverlay(context,node,pos,nodeWidth,nodeHeight)},drawText=function drawText(){r.drawElementText(context,node,null,drawLabel)},ghost="yes"===node.pstyle("ghost").value;if(ghost){var gx=node.pstyle("ghost-offset-x").pfValue,gy=node.pstyle("ghost-offset-y").pfValue,ghostOpacity=node.pstyle("ghost-opacity").value,effGhostOpacity=ghostOpacity*eleOpacity;context.translate(gx,gy),setupShapeColor(ghostOpacity*bgOpacity),drawShape(),drawImages(effGhostOpacity,!0),setupBorderColor(ghostOpacity*borderOpacity),drawBorder(),drawPie(0!==darkness||0!==borderWidth),drawImages(effGhostOpacity,!1),darken(effGhostOpacity),context.translate(-gx,-gy)}setupShapeColor(),drawShape(),drawImages(eleOpacity,!0),setupBorderColor(),drawBorder(),drawPie(0!==darkness||0!==borderWidth),drawImages(eleOpacity,!1),darken(),usePaths&&context.translate(-pos.x,-pos.y),drawText(),drawOverlay(),shiftToOriginWithBb&&context.translate(bb.x1,bb.y1)}},drawNodeOverlay:function(context,node,pos,nodeWidth,nodeHeight){if(node.visible()){var overlayPadding=node.pstyle("overlay-padding").pfValue,overlayOpacity=node.pstyle("overlay-opacity").value,overlayColor=node.pstyle("overlay-color").value;if(overlayOpacity>0){if(pos=pos||node.position(),null==nodeWidth||null==nodeHeight){var padding=node.padding();nodeWidth=node.width()+2*padding,nodeHeight=node.height()+2*padding}this.colorFillStyle(context,overlayColor[0],overlayColor[1],overlayColor[2],overlayOpacity),this.nodeShapes.roundrectangle.draw(context,pos.x,pos.y,nodeWidth+2*overlayPadding,nodeHeight+2*overlayPadding),context.fill()}}},hasPie:function(node){return(node=node[0])._private.hasPie},drawPie:function(context,node,nodeOpacity,pos){node=node[0],pos=pos||node.position();var cyStyle=node.cy().style(),pieSize=node.pstyle("pie-size"),x=pos.x,y=pos.y,nodeW=node.width(),nodeH=node.height(),radius=Math.min(nodeW,nodeH)/2,lastPercent=0;this.usePaths()&&(x=0,y=0),"%"===pieSize.units?radius*=pieSize.pfValue:void 0!==pieSize.pfValue&&(radius=pieSize.pfValue/2);for(var i=1;i<=cyStyle.pieBackgroundN;i++){var size=node.pstyle("pie-"+i+"-background-size").value,color=node.pstyle("pie-"+i+"-background-color").value,opacity=node.pstyle("pie-"+i+"-background-opacity").value*nodeOpacity,percent=size/100;percent+lastPercent>1&&(percent=1-lastPercent);var angleStart=1.5*Math.PI+2*Math.PI*lastPercent,angleEnd=angleStart+2*Math.PI*percent;0===size||lastPercent>=1||lastPercent+percent>1||(context.beginPath(),context.moveTo(x,y),context.arc(x,y,radius,angleStart,angleEnd),context.closePath(),this.colorFillStyle(context,color[0],color[1],color[2],opacity),context.fill(),lastPercent+=percent)}}},CRp$6={};CRp$6.getPixelRatio=function(){var context=this.data.contexts[0];if(null!=this.forcedPixelRatio)return this.forcedPixelRatio;var backingStore=context.backingStorePixelRatio||context.webkitBackingStorePixelRatio||context.mozBackingStorePixelRatio||context.msBackingStorePixelRatio||context.oBackingStorePixelRatio||context.backingStorePixelRatio||1;return(window.devicePixelRatio||1)/backingStore},CRp$6.paintCache=function(context){for(var cache,caches=this.paintCaches=this.paintCaches||[],needToCreateCache=!0,i=0;i<caches.length;i++)if((cache=caches[i]).context===context){needToCreateCache=!1;break}return needToCreateCache&&(cache={context:context},caches.push(cache)),cache},CRp$6.createGradientStyleFor=function(context,shapeStyleName,ele,fill,opacity){var gradientStyle,usePaths=this.usePaths(),colors=ele.pstyle(shapeStyleName+"-gradient-stop-colors").value,positions=ele.pstyle(shapeStyleName+"-gradient-stop-positions").pfValue;if("radial-gradient"===fill)if(ele.isEdge()){var start=ele.sourceEndpoint(),end=ele.targetEndpoint(),mid=ele.midpoint(),d1=dist(start,mid),d2=dist(end,mid);gradientStyle=context.createRadialGradient(mid.x,mid.y,0,mid.x,mid.y,Math.max(d1,d2))}else{var pos=usePaths?{x:0,y:0}:ele.position(),width=ele.paddedWidth(),height=ele.paddedHeight();gradientStyle=context.createRadialGradient(pos.x,pos.y,0,pos.x,pos.y,Math.max(width,height))}else if(ele.isEdge()){var _start=ele.sourceEndpoint(),_end=ele.targetEndpoint();gradientStyle=context.createLinearGradient(_start.x,_start.y,_end.x,_end.y)}else{var _pos=usePaths?{x:0,y:0}:ele.position(),halfWidth=ele.paddedWidth()/2,halfHeight=ele.paddedHeight()/2;switch(ele.pstyle("background-gradient-direction").value){case"to-bottom":gradientStyle=context.createLinearGradient(_pos.x,_pos.y-halfHeight,_pos.x,_pos.y+halfHeight);break;case"to-top":gradientStyle=context.createLinearGradient(_pos.x,_pos.y+halfHeight,_pos.x,_pos.y-halfHeight);break;case"to-left":gradientStyle=context.createLinearGradient(_pos.x+halfWidth,_pos.y,_pos.x-halfWidth,_pos.y);break;case"to-right":gradientStyle=context.createLinearGradient(_pos.x-halfWidth,_pos.y,_pos.x+halfWidth,_pos.y);break;case"to-bottom-right":case"to-right-bottom":gradientStyle=context.createLinearGradient(_pos.x-halfWidth,_pos.y-halfHeight,_pos.x+halfWidth,_pos.y+halfHeight);break;case"to-top-right":case"to-right-top":gradientStyle=context.createLinearGradient(_pos.x-halfWidth,_pos.y+halfHeight,_pos.x+halfWidth,_pos.y-halfHeight);break;case"to-bottom-left":case"to-left-bottom":gradientStyle=context.createLinearGradient(_pos.x+halfWidth,_pos.y-halfHeight,_pos.x-halfWidth,_pos.y+halfHeight);break;case"to-top-left":case"to-left-top":gradientStyle=context.createLinearGradient(_pos.x+halfWidth,_pos.y+halfHeight,_pos.x-halfWidth,_pos.y-halfHeight)}}if(!gradientStyle)return null;for(var hasPositions=positions.length===colors.length,length=colors.length,i=0;i<length;i++)gradientStyle.addColorStop(hasPositions?positions[i]:i/(length-1),"rgba("+colors[i][0]+","+colors[i][1]+","+colors[i][2]+","+opacity+")");return gradientStyle},CRp$6.gradientFillStyle=function(context,ele,fill,opacity){var gradientStyle=this.createGradientStyleFor(context,"background",ele,fill,opacity);if(!gradientStyle)return null;context.fillStyle=gradientStyle},CRp$6.colorFillStyle=function(context,r,g,b,a){context.fillStyle="rgba("+r+","+g+","+b+","+a+")"},CRp$6.eleFillStyle=function(context,ele,opacity){var backgroundFill=ele.pstyle("background-fill").value;if("linear-gradient"===backgroundFill||"radial-gradient"===backgroundFill)this.gradientFillStyle(context,ele,backgroundFill,opacity);else{var backgroundColor=ele.pstyle("background-color").value;this.colorFillStyle(context,backgroundColor[0],backgroundColor[1],backgroundColor[2],opacity)}},CRp$6.gradientStrokeStyle=function(context,ele,fill,opacity){var gradientStyle=this.createGradientStyleFor(context,"line",ele,fill,opacity);if(!gradientStyle)return null;context.strokeStyle=gradientStyle},CRp$6.colorStrokeStyle=function(context,r,g,b,a){context.strokeStyle="rgba("+r+","+g+","+b+","+a+")"},CRp$6.eleStrokeStyle=function(context,ele,opacity){var lineFill=ele.pstyle("line-fill").value;if("linear-gradient"===lineFill||"radial-gradient"===lineFill)this.gradientStrokeStyle(context,ele,lineFill,opacity);else{var lineColor=ele.pstyle("line-color").value;this.colorStrokeStyle(context,lineColor[0],lineColor[1],lineColor[2],opacity)}},CRp$6.matchCanvasSize=function(container){var r=this,data=r.data,bb=r.findContainerClientCoords(),width=bb[2],height=bb[3],pixelRatio=r.getPixelRatio(),mbPxRatio=r.motionBlurPxRatio;container!==r.data.bufferCanvases[r.MOTIONBLUR_BUFFER_NODE]&&container!==r.data.bufferCanvases[r.MOTIONBLUR_BUFFER_DRAG]||(pixelRatio=mbPxRatio);var canvas,canvasWidth=width*pixelRatio,canvasHeight=height*pixelRatio;if(canvasWidth!==r.canvasWidth||canvasHeight!==r.canvasHeight){r.fontCaches=null;var canvasContainer=data.canvasContainer;canvasContainer.style.width=width+"px",canvasContainer.style.height=height+"px";for(var i=0;i<r.CANVAS_LAYERS;i++)(canvas=data.canvases[i]).width=canvasWidth,canvas.height=canvasHeight,canvas.style.width=width+"px",canvas.style.height=height+"px";for(i=0;i<r.BUFFER_COUNT;i++)(canvas=data.bufferCanvases[i]).width=canvasWidth,canvas.height=canvasHeight,canvas.style.width=width+"px",canvas.style.height=height+"px";r.textureMult=1,pixelRatio<=1&&(canvas=data.bufferCanvases[r.TEXTURE_BUFFER],r.textureMult=2,canvas.width=canvasWidth*r.textureMult,canvas.height=canvasHeight*r.textureMult),r.canvasWidth=canvasWidth,r.canvasHeight=canvasHeight}},CRp$6.renderTo=function(cxt,zoom,pan,pxRatio){this.render({forcedContext:cxt,forcedZoom:zoom,forcedPan:pan,drawAllLayers:!0,forcedPxRatio:pxRatio})},CRp$6.render=function(options){var forcedContext=(options=options||staticEmptyObject()).forcedContext,drawAllLayers=options.drawAllLayers,drawOnlyNodeLayer=options.drawOnlyNodeLayer,forcedZoom=options.forcedZoom,forcedPan=options.forcedPan,r=this,pixelRatio=void 0===options.forcedPxRatio?this.getPixelRatio():options.forcedPxRatio,cy=r.cy,data=r.data,needDraw=data.canvasNeedsRedraw,textureDraw=r.textureOnViewport&&!forcedContext&&(r.pinching||r.hoverData.dragging||r.swipePanning||r.data.wheelZooming),motionBlur=void 0!==options.motionBlur?options.motionBlur:r.motionBlur,mbPxRatio=r.motionBlurPxRatio,hasCompoundNodes=cy.hasCompoundNodes(),inNodeDragGesture=r.hoverData.draggingEles,inBoxSelection=!(!r.hoverData.selecting&&!r.touchData.selecting),motionBlurFadeEffect=motionBlur=motionBlur&&!forcedContext&&r.motionBlurEnabled&&!inBoxSelection;forcedContext||(r.prevPxRatio!==pixelRatio&&(r.invalidateContainerClientCoordsCache(),r.matchCanvasSize(r.container),r.redrawHint("eles",!0),r.redrawHint("drag",!0)),r.prevPxRatio=pixelRatio),!forcedContext&&r.motionBlurTimeout&&clearTimeout(r.motionBlurTimeout),motionBlur&&(null==r.mbFrames&&(r.mbFrames=0),r.mbFrames++,r.mbFrames<3&&(motionBlurFadeEffect=!1),r.mbFrames>r.minMbLowQualFrames&&(r.motionBlurPxRatio=r.mbPxRBlurry)),r.clearingMotionBlur&&(r.motionBlurPxRatio=1),r.textureDrawLastFrame&&!textureDraw&&(needDraw[r.NODE]=!0,needDraw[r.SELECT_BOX]=!0);var style=cy.style(),zoom=cy.zoom(),effectiveZoom=void 0!==forcedZoom?forcedZoom:zoom,pan=cy.pan(),effectivePan={x:pan.x,y:pan.y},vp={zoom:zoom,pan:{x:pan.x,y:pan.y}},prevVp=r.prevViewport;void 0===prevVp||vp.zoom!==prevVp.zoom||vp.pan.x!==prevVp.pan.x||vp.pan.y!==prevVp.pan.y||inNodeDragGesture&&!hasCompoundNodes||(r.motionBlurPxRatio=1),forcedPan&&(effectivePan=forcedPan),effectiveZoom*=pixelRatio,effectivePan.x*=pixelRatio,effectivePan.y*=pixelRatio;var eles=r.getCachedZSortedEles();function mbclear(context,x,y,w,h){var gco=context.globalCompositeOperation;context.globalCompositeOperation="destination-out",r.colorFillStyle(context,255,255,255,r.motionBlurTransparency),context.fillRect(x,y,w,h),context.globalCompositeOperation=gco}function setContextTransform(context,clear){var ePan,eZoom,w,h;r.clearingMotionBlur||context!==data.bufferContexts[r.MOTIONBLUR_BUFFER_NODE]&&context!==data.bufferContexts[r.MOTIONBLUR_BUFFER_DRAG]?(ePan=effectivePan,eZoom=effectiveZoom,w=r.canvasWidth,h=r.canvasHeight):(ePan={x:pan.x*mbPxRatio,y:pan.y*mbPxRatio},eZoom=zoom*mbPxRatio,w=r.canvasWidth*mbPxRatio,h=r.canvasHeight*mbPxRatio),context.setTransform(1,0,0,1,0,0),"motionBlur"===clear?mbclear(context,0,0,w,h):forcedContext||void 0!==clear&&!clear||context.clearRect(0,0,w,h),drawAllLayers||(context.translate(ePan.x,ePan.y),context.scale(eZoom,eZoom)),forcedPan&&context.translate(forcedPan.x,forcedPan.y),forcedZoom&&context.scale(forcedZoom,forcedZoom)}if(textureDraw||(r.textureDrawLastFrame=!1),textureDraw){if(r.textureDrawLastFrame=!0,!r.textureCache){r.textureCache={},r.textureCache.bb=cy.mutableElements().boundingBox(),r.textureCache.texture=r.data.bufferCanvases[r.TEXTURE_BUFFER];var cxt=r.data.bufferContexts[r.TEXTURE_BUFFER];cxt.setTransform(1,0,0,1,0,0),cxt.clearRect(0,0,r.canvasWidth*r.textureMult,r.canvasHeight*r.textureMult),r.render({forcedContext:cxt,drawOnlyNodeLayer:!0,forcedPxRatio:pixelRatio*r.textureMult}),(vp=r.textureCache.viewport={zoom:cy.zoom(),pan:cy.pan(),width:r.canvasWidth,height:r.canvasHeight}).mpan={x:(0-vp.pan.x)/vp.zoom,y:(0-vp.pan.y)/vp.zoom}}needDraw[r.DRAG]=!1,needDraw[r.NODE]=!1;var context=data.contexts[r.NODE],texture=r.textureCache.texture;vp=r.textureCache.viewport;context.setTransform(1,0,0,1,0,0),motionBlur?mbclear(context,0,0,vp.width,vp.height):context.clearRect(0,0,vp.width,vp.height);var outsideBgColor=style.core("outside-texture-bg-color").value,outsideBgOpacity=style.core("outside-texture-bg-opacity").value;r.colorFillStyle(context,outsideBgColor[0],outsideBgColor[1],outsideBgColor[2],outsideBgOpacity),context.fillRect(0,0,vp.width,vp.height);zoom=cy.zoom();setContextTransform(context,!1),context.clearRect(vp.mpan.x,vp.mpan.y,vp.width/vp.zoom/pixelRatio,vp.height/vp.zoom/pixelRatio),context.drawImage(texture,vp.mpan.x,vp.mpan.y,vp.width/vp.zoom/pixelRatio,vp.height/vp.zoom/pixelRatio)}else r.textureOnViewport&&!forcedContext&&(r.textureCache=null);var extent=cy.extent(),vpManip=r.pinching||r.hoverData.dragging||r.swipePanning||r.data.wheelZooming||r.hoverData.draggingEles||r.cy.animated(),hideEdges=r.hideEdgesOnViewport&&vpManip,needMbClear=[];if(needMbClear[r.NODE]=!needDraw[r.NODE]&&motionBlur&&!r.clearedForMotionBlur[r.NODE]||r.clearingMotionBlur,needMbClear[r.NODE]&&(r.clearedForMotionBlur[r.NODE]=!0),needMbClear[r.DRAG]=!needDraw[r.DRAG]&&motionBlur&&!r.clearedForMotionBlur[r.DRAG]||r.clearingMotionBlur,needMbClear[r.DRAG]&&(r.clearedForMotionBlur[r.DRAG]=!0),needDraw[r.NODE]||drawAllLayers||drawOnlyNodeLayer||needMbClear[r.NODE]){var useBuffer=motionBlur&&!needMbClear[r.NODE]&&1!==mbPxRatio;setContextTransform(context=forcedContext||(useBuffer?r.data.bufferContexts[r.MOTIONBLUR_BUFFER_NODE]:data.contexts[r.NODE]),motionBlur&&!useBuffer?"motionBlur":void 0),hideEdges?r.drawCachedNodes(context,eles.nondrag,pixelRatio,extent):r.drawLayeredElements(context,eles.nondrag,pixelRatio,extent),r.debug&&r.drawDebugPoints(context,eles.nondrag),drawAllLayers||motionBlur||(needDraw[r.NODE]=!1)}if(!drawOnlyNodeLayer&&(needDraw[r.DRAG]||drawAllLayers||needMbClear[r.DRAG])){useBuffer=motionBlur&&!needMbClear[r.DRAG]&&1!==mbPxRatio;setContextTransform(context=forcedContext||(useBuffer?r.data.bufferContexts[r.MOTIONBLUR_BUFFER_DRAG]:data.contexts[r.DRAG]),motionBlur&&!useBuffer?"motionBlur":void 0),hideEdges?r.drawCachedNodes(context,eles.drag,pixelRatio,extent):r.drawCachedElements(context,eles.drag,pixelRatio,extent),r.debug&&r.drawDebugPoints(context,eles.drag),drawAllLayers||motionBlur||(needDraw[r.DRAG]=!1)}if(r.showFps||!drawOnlyNodeLayer&&needDraw[r.SELECT_BOX]&&!drawAllLayers){if(setContextTransform(context=forcedContext||data.contexts[r.SELECT_BOX]),1==r.selection[4]&&(r.hoverData.selecting||r.touchData.selecting)){zoom=r.cy.zoom();var borderWidth=style.core("selection-box-border-width").value/zoom;context.lineWidth=borderWidth,context.fillStyle="rgba("+style.core("selection-box-color").value[0]+","+style.core("selection-box-color").value[1]+","+style.core("selection-box-color").value[2]+","+style.core("selection-box-opacity").value+")",context.fillRect(r.selection[0],r.selection[1],r.selection[2]-r.selection[0],r.selection[3]-r.selection[1]),borderWidth>0&&(context.strokeStyle="rgba("+style.core("selection-box-border-color").value[0]+","+style.core("selection-box-border-color").value[1]+","+style.core("selection-box-border-color").value[2]+","+style.core("selection-box-opacity").value+")",context.strokeRect(r.selection[0],r.selection[1],r.selection[2]-r.selection[0],r.selection[3]-r.selection[1]))}if(data.bgActivePosistion&&!r.hoverData.selecting){zoom=r.cy.zoom();var pos=data.bgActivePosistion;context.fillStyle="rgba("+style.core("active-bg-color").value[0]+","+style.core("active-bg-color").value[1]+","+style.core("active-bg-color").value[2]+","+style.core("active-bg-opacity").value+")",context.beginPath(),context.arc(pos.x,pos.y,style.core("active-bg-size").pfValue/zoom,0,2*Math.PI),context.fill()}var timeToRender=r.lastRedrawTime;if(r.showFps&&timeToRender){timeToRender=Math.round(timeToRender);var fps=Math.round(1e3/timeToRender);context.setTransform(1,0,0,1,0,0),context.fillStyle="rgba(255, 0, 0, 0.75)",context.strokeStyle="rgba(255, 0, 0, 0.75)",context.lineWidth=1,context.fillText("1 frame = "+timeToRender+" ms = "+fps+" fps",0,20);context.strokeRect(0,30,250,20),context.fillRect(0,30,250*Math.min(fps/60,1),20)}drawAllLayers||(needDraw[r.SELECT_BOX]=!1)}if(motionBlur&&1!==mbPxRatio){var cxtNode=data.contexts[r.NODE],txtNode=r.data.bufferCanvases[r.MOTIONBLUR_BUFFER_NODE],cxtDrag=data.contexts[r.DRAG],txtDrag=r.data.bufferCanvases[r.MOTIONBLUR_BUFFER_DRAG],drawMotionBlur=function drawMotionBlur(cxt,txt,needClear){cxt.setTransform(1,0,0,1,0,0),needClear||!motionBlurFadeEffect?cxt.clearRect(0,0,r.canvasWidth,r.canvasHeight):mbclear(cxt,0,0,r.canvasWidth,r.canvasHeight);var pxr=mbPxRatio;cxt.drawImage(txt,0,0,r.canvasWidth*pxr,r.canvasHeight*pxr,0,0,r.canvasWidth,r.canvasHeight)};(needDraw[r.NODE]||needMbClear[r.NODE])&&(drawMotionBlur(cxtNode,txtNode,needMbClear[r.NODE]),needDraw[r.NODE]=!1),(needDraw[r.DRAG]||needMbClear[r.DRAG])&&(drawMotionBlur(cxtDrag,txtDrag,needMbClear[r.DRAG]),needDraw[r.DRAG]=!1)}r.prevViewport=vp,r.clearingMotionBlur&&(r.clearingMotionBlur=!1,r.motionBlurCleared=!0,r.motionBlur=!0),motionBlur&&(r.motionBlurTimeout=setTimeout((function(){r.motionBlurTimeout=null,r.clearedForMotionBlur[r.NODE]=!1,r.clearedForMotionBlur[r.DRAG]=!1,r.motionBlur=!1,r.clearingMotionBlur=!textureDraw,r.mbFrames=0,needDraw[r.NODE]=!0,needDraw[r.DRAG]=!0,r.redraw()}),100)),forcedContext||cy.emit("render")};for(var CRp$7={drawPolygonPath:function(context,x,y,width,height,points){var halfW=width/2,halfH=height/2;context.beginPath&&context.beginPath(),context.moveTo(x+halfW*points[0],y+halfH*points[1]);for(var i=1;i<points.length/2;i++)context.lineTo(x+halfW*points[2*i],y+halfH*points[2*i+1]);context.closePath()},drawRoundPolygonPath:function(context,x,y,width,height,points){var halfW=width/2,halfH=height/2,cornerRadius=getRoundPolygonRadius(width,height);context.beginPath&&context.beginPath();for(var _i=0;_i<points.length/4;_i++){var destUv,sourceUv=void 0;sourceUv=0===_i?points.length-2:4*_i-2,destUv=4*_i+2;var px=x+halfW*points[4*_i],py=y+halfH*points[4*_i+1],cosTheta=-points[sourceUv]*points[destUv]-points[sourceUv+1]*points[destUv+1],offset=cornerRadius/Math.tan(Math.acos(cosTheta)/2),cp0x=px-offset*points[sourceUv],cp0y=py-offset*points[sourceUv+1],cp1x=px+offset*points[destUv],cp1y=py+offset*points[destUv+1];0===_i?context.moveTo(cp0x,cp0y):context.lineTo(cp0x,cp0y),context.arcTo(px,py,cp1x,cp1y,cornerRadius)}context.closePath()},drawRoundRectanglePath:function(context,x,y,width,height){var halfWidth=width/2,halfHeight=height/2,cornerRadius=getRoundRectangleRadius(width,height);context.beginPath&&context.beginPath(),context.moveTo(x,y-halfHeight),context.arcTo(x+halfWidth,y-halfHeight,x+halfWidth,y,cornerRadius),context.arcTo(x+halfWidth,y+halfHeight,x,y+halfHeight,cornerRadius),context.arcTo(x-halfWidth,y+halfHeight,x-halfWidth,y,cornerRadius),context.arcTo(x-halfWidth,y-halfHeight,x,y-halfHeight,cornerRadius),context.lineTo(x,y-halfHeight),context.closePath()},drawBottomRoundRectanglePath:function(context,x,y,width,height){var halfWidth=width/2,halfHeight=height/2,cornerRadius=getRoundRectangleRadius(width,height);context.beginPath&&context.beginPath(),context.moveTo(x,y-halfHeight),context.lineTo(x+halfWidth,y-halfHeight),context.lineTo(x+halfWidth,y),context.arcTo(x+halfWidth,y+halfHeight,x,y+halfHeight,cornerRadius),context.arcTo(x-halfWidth,y+halfHeight,x-halfWidth,y,cornerRadius),context.lineTo(x-halfWidth,y-halfHeight),context.lineTo(x,y-halfHeight),context.closePath()},drawCutRectanglePath:function(context,x,y,width,height){var halfWidth=width/2,halfHeight=height/2;context.beginPath&&context.beginPath(),context.moveTo(x-halfWidth+8,y-halfHeight),context.lineTo(x+halfWidth-8,y-halfHeight),context.lineTo(x+halfWidth,y-halfHeight+8),context.lineTo(x+halfWidth,y+halfHeight-8),context.lineTo(x+halfWidth-8,y+halfHeight),context.lineTo(x-halfWidth+8,y+halfHeight),context.lineTo(x-halfWidth,y+halfHeight-8),context.lineTo(x-halfWidth,y-halfHeight+8),context.closePath()},drawBarrelPath:function(context,x,y,width,height){var halfWidth=width/2,halfHeight=height/2,xBegin=x-halfWidth,xEnd=x+halfWidth,yBegin=y-halfHeight,yEnd=y+halfHeight,barrelCurveConstants=getBarrelCurveConstants(width,height),wOffset=barrelCurveConstants.widthOffset,hOffset=barrelCurveConstants.heightOffset,ctrlPtXOffset=barrelCurveConstants.ctrlPtOffsetPct*wOffset;context.beginPath&&context.beginPath(),context.moveTo(xBegin,yBegin+hOffset),context.lineTo(xBegin,yEnd-hOffset),context.quadraticCurveTo(xBegin+ctrlPtXOffset,yEnd,xBegin+wOffset,yEnd),context.lineTo(xEnd-wOffset,yEnd),context.quadraticCurveTo(xEnd-ctrlPtXOffset,yEnd,xEnd,yEnd-hOffset),context.lineTo(xEnd,yBegin+hOffset),context.quadraticCurveTo(xEnd-ctrlPtXOffset,yBegin,xEnd-wOffset,yBegin),context.lineTo(xBegin+wOffset,yBegin),context.quadraticCurveTo(xBegin+ctrlPtXOffset,yBegin,xBegin,yBegin+hOffset),context.closePath()}},sin0=Math.sin(0),cos0=Math.cos(0),sin={},cos={},ellipseStepSize=Math.PI/40,i=0*Math.PI;i<2*Math.PI;i+=ellipseStepSize)sin[i]=Math.sin(i),cos[i]=Math.cos(i);CRp$7.drawEllipsePath=function(context,centerX,centerY,width,height){if(context.beginPath&&context.beginPath(),context.ellipse)context.ellipse(centerX,centerY,width/2,height/2,0,0,2*Math.PI);else for(var xPos,yPos,rw=width/2,rh=height/2,i=0*Math.PI;i<2*Math.PI;i+=ellipseStepSize)xPos=centerX-rw*sin[i]*sin0+rw*cos[i]*cos0,yPos=centerY+rh*cos[i]*sin0+rh*sin[i]*cos0,0===i?context.moveTo(xPos,yPos):context.lineTo(xPos,yPos);context.closePath()};var CRp$8={};function b64UriToB64(b64uri){var i=b64uri.indexOf(",");return b64uri.substr(i+1)}function output(options,canvas,mimeType){var getB64Uri=function getB64Uri(){return canvas.toDataURL(mimeType,options.quality)};switch(options.output){case"blob-promise":return new Promise$1((function(resolve,reject){try{canvas.toBlob((function(blob){null!=blob?resolve(blob):reject(new Error("`canvas.toBlob()` sent a null value in its callback"))}),mimeType,options.quality)}catch(err){reject(err)}}));case"blob":return function b64ToBlob(b64,mimeType){for(var bytes=atob(b64),buff=new ArrayBuffer(bytes.length),buffUint8=new Uint8Array(buff),i=0;i<bytes.length;i++)buffUint8[i]=bytes.charCodeAt(i);return new Blob([buff],{type:mimeType})}(b64UriToB64(getB64Uri()),mimeType);case"base64":return b64UriToB64(getB64Uri());case"base64uri":default:return getB64Uri()}}CRp$8.createBuffer=function(w,h){var buffer=document.createElement("canvas");return buffer.width=w,buffer.height=h,[buffer,buffer.getContext("2d")]},CRp$8.bufferCanvasImage=function(options){var cy=this.cy,bb=cy.mutableElements().boundingBox(),ctrRect=this.findContainerClientCoords(),width=options.full?Math.ceil(bb.w):ctrRect[2],height=options.full?Math.ceil(bb.h):ctrRect[3],specdMaxDims=number(options.maxWidth)||number(options.maxHeight),pxRatio=this.getPixelRatio(),scale=1;if(void 0!==options.scale)width*=options.scale,height*=options.scale,scale=options.scale;else if(specdMaxDims){var maxScaleW=1/0,maxScaleH=1/0;number(options.maxWidth)&&(maxScaleW=scale*options.maxWidth/width),number(options.maxHeight)&&(maxScaleH=scale*options.maxHeight/height),width*=scale=Math.min(maxScaleW,maxScaleH),height*=scale}specdMaxDims||(width*=pxRatio,height*=pxRatio,scale*=pxRatio);var buffCanvas=document.createElement("canvas");buffCanvas.width=width,buffCanvas.height=height,buffCanvas.style.width=width+"px",buffCanvas.style.height=height+"px";var buffCxt=buffCanvas.getContext("2d");if(width>0&&height>0){buffCxt.clearRect(0,0,width,height),buffCxt.globalCompositeOperation="source-over";var zsortedEles=this.getCachedZSortedEles();if(options.full)buffCxt.translate(-bb.x1*scale,-bb.y1*scale),buffCxt.scale(scale,scale),this.drawElements(buffCxt,zsortedEles),buffCxt.scale(1/scale,1/scale),buffCxt.translate(bb.x1*scale,bb.y1*scale);else{var pan=cy.pan(),translation={x:pan.x*scale,y:pan.y*scale};scale*=cy.zoom(),buffCxt.translate(translation.x,translation.y),buffCxt.scale(scale,scale),this.drawElements(buffCxt,zsortedEles),buffCxt.scale(1/scale,1/scale),buffCxt.translate(-translation.x,-translation.y)}options.bg&&(buffCxt.globalCompositeOperation="destination-over",buffCxt.fillStyle=options.bg,buffCxt.rect(0,0,width,height),buffCxt.fill())}return buffCanvas},CRp$8.png=function(options){return output(options,this.bufferCanvasImage(options),"image/png")},CRp$8.jpg=function(options){return output(options,this.bufferCanvasImage(options),"image/jpeg")};var CRp$9={nodeShapeImpl:function(name,context,centerX,centerY,width,height,points){switch(name){case"ellipse":return this.drawEllipsePath(context,centerX,centerY,width,height);case"polygon":return this.drawPolygonPath(context,centerX,centerY,width,height,points);case"round-polygon":return this.drawRoundPolygonPath(context,centerX,centerY,width,height,points);case"roundrectangle":case"round-rectangle":return this.drawRoundRectanglePath(context,centerX,centerY,width,height);case"cutrectangle":case"cut-rectangle":return this.drawCutRectanglePath(context,centerX,centerY,width,height);case"bottomroundrectangle":case"bottom-round-rectangle":return this.drawBottomRoundRectanglePath(context,centerX,centerY,width,height);case"barrel":return this.drawBarrelPath(context,centerX,centerY,width,height)}}},CR=CanvasRenderer,CRp$a=CanvasRenderer.prototype;function CanvasRenderer(options){var r=this;r.data={canvases:new Array(CRp$a.CANVAS_LAYERS),contexts:new Array(CRp$a.CANVAS_LAYERS),canvasNeedsRedraw:new Array(CRp$a.CANVAS_LAYERS),bufferCanvases:new Array(CRp$a.BUFFER_COUNT),bufferContexts:new Array(CRp$a.CANVAS_LAYERS)};r.data.canvasContainer=document.createElement("div");var containerStyle=r.data.canvasContainer.style;r.data.canvasContainer.style["-webkit-tap-highlight-color"]="rgba(0,0,0,0)",containerStyle.position="relative",containerStyle.zIndex="0",containerStyle.overflow="hidden";var container=options.cy.container();container.appendChild(r.data.canvasContainer),container.style["-webkit-tap-highlight-color"]="rgba(0,0,0,0)";var styleMap={"-webkit-user-select":"none","-moz-user-select":"-moz-none","user-select":"none","-webkit-tap-highlight-color":"rgba(0,0,0,0)","outline-style":"none"};(function ms(){return navigator&&navigator.userAgent.match(/msie|trident|edge/i)})()&&(styleMap["-ms-touch-action"]="none",styleMap["touch-action"]="none");for(var i=0;i<CRp$a.CANVAS_LAYERS;i++){var canvas=r.data.canvases[i]=document.createElement("canvas");r.data.contexts[i]=canvas.getContext("2d"),Object.keys(styleMap).forEach((function(k){canvas.style[k]=styleMap[k]})),canvas.style.position="absolute",canvas.setAttribute("data-id","layer"+i),canvas.style.zIndex=String(CRp$a.CANVAS_LAYERS-i),r.data.canvasContainer.appendChild(canvas),r.data.canvasNeedsRedraw[i]=!1}r.data.topCanvas=r.data.canvases[0],r.data.canvases[CRp$a.NODE].setAttribute("data-id","layer"+CRp$a.NODE+"-node"),r.data.canvases[CRp$a.SELECT_BOX].setAttribute("data-id","layer"+CRp$a.SELECT_BOX+"-selectbox"),r.data.canvases[CRp$a.DRAG].setAttribute("data-id","layer"+CRp$a.DRAG+"-drag");for(i=0;i<CRp$a.BUFFER_COUNT;i++)r.data.bufferCanvases[i]=document.createElement("canvas"),r.data.bufferContexts[i]=r.data.bufferCanvases[i].getContext("2d"),r.data.bufferCanvases[i].style.position="absolute",r.data.bufferCanvases[i].setAttribute("data-id","buffer"+i),r.data.bufferCanvases[i].style.zIndex=String(-i-1),r.data.bufferCanvases[i].style.visibility="hidden";r.pathsEnabled=!0;var emptyBb=makeBoundingBox(),getCenterOffset=function getCenterOffset(bb){return{x:-bb.w/2,y:-bb.h/2}},getElementBox=function getElementBox(ele){return ele.boundingBox(),ele[0]._private.bodyBounds},getLabelBox=function getLabelBox(ele){return ele.boundingBox(),ele[0]._private.labelBounds.main||emptyBb},getSourceLabelBox=function getSourceLabelBox(ele){return ele.boundingBox(),ele[0]._private.labelBounds.source||emptyBb},getTargetLabelBox=function getTargetLabelBox(ele){return ele.boundingBox(),ele[0]._private.labelBounds.target||emptyBb},isLabelVisibleAtScale=function isLabelVisibleAtScale(ele,scaledLabelShown){return scaledLabelShown},addTextMargin=function addTextMargin(prefix,pt,ele){var pre=prefix?prefix+"-":"";return{x:pt.x+ele.pstyle(pre+"text-margin-x").pfValue,y:pt.y+ele.pstyle(pre+"text-margin-y").pfValue}},getRsPt=function getRsPt(ele,x,y){var rs=ele[0]._private.rscratch;return{x:rs[x],y:rs[y]}},eleTxrCache=r.data.eleTxrCache=new ElementTextureCache(r,{getKey:function getStyleKey(ele){return ele[0]._private.nodeKey},doesEleInvalidateKey:function backgroundTimestampHasChanged(ele){var _p=ele[0]._private;return!(_p.oldBackgroundTimestamp===_p.backgroundTimestamp)},drawElement:function drawElement(context,ele,bb,scaledLabelShown,useEleOpacity){return r.drawElement(context,ele,bb,!1,!1,useEleOpacity)},getBoundingBox:getElementBox,getRotationPoint:function getElementRotationPoint(ele){return function getBoxCenter(bb){return{x:(bb.x1+bb.x2)/2,y:(bb.y1+bb.y2)/2}}(getElementBox(ele))},getRotationOffset:function getElementRotationOffset(ele){return getCenterOffset(getElementBox(ele))},allowEdgeTxrCaching:!1,allowParentTxrCaching:!1}),lblTxrCache=r.data.lblTxrCache=new ElementTextureCache(r,{getKey:function getLabelKey(ele){return ele[0]._private.labelStyleKey},drawElement:function drawLabel(context,ele,bb,scaledLabelShown,useEleOpacity){return r.drawElementText(context,ele,bb,scaledLabelShown,"main",useEleOpacity)},getBoundingBox:getLabelBox,getRotationPoint:function getLabelRotationPoint(ele){return addTextMargin("",getRsPt(ele,"labelX","labelY"),ele)},getRotationOffset:function getLabelRotationOffset(ele){var bb=getLabelBox(ele),p=getCenterOffset(getLabelBox(ele));if(ele.isNode()){switch(ele.pstyle("text-halign").value){case"left":p.x=-bb.w;break;case"right":p.x=0}switch(ele.pstyle("text-valign").value){case"top":p.y=-bb.h;break;case"bottom":p.y=0}}return p},isVisible:isLabelVisibleAtScale}),slbTxrCache=r.data.slbTxrCache=new ElementTextureCache(r,{getKey:function getSourceLabelKey(ele){return ele[0]._private.sourceLabelStyleKey},drawElement:function drawSourceLabel(context,ele,bb,scaledLabelShown,useEleOpacity){return r.drawElementText(context,ele,bb,scaledLabelShown,"source",useEleOpacity)},getBoundingBox:getSourceLabelBox,getRotationPoint:function getSourceLabelRotationPoint(ele){return addTextMargin("source",getRsPt(ele,"sourceLabelX","sourceLabelY"),ele)},getRotationOffset:function getSourceLabelRotationOffset(ele){return getCenterOffset(getSourceLabelBox(ele))},isVisible:isLabelVisibleAtScale}),tlbTxrCache=r.data.tlbTxrCache=new ElementTextureCache(r,{getKey:function getTargetLabelKey(ele){return ele[0]._private.targetLabelStyleKey},drawElement:function drawTargetLabel(context,ele,bb,scaledLabelShown,useEleOpacity){return r.drawElementText(context,ele,bb,scaledLabelShown,"target",useEleOpacity)},getBoundingBox:getTargetLabelBox,getRotationPoint:function getTargetLabelRotationPoint(ele){return addTextMargin("target",getRsPt(ele,"targetLabelX","targetLabelY"),ele)},getRotationOffset:function getTargetLabelRotationOffset(ele){return getCenterOffset(getTargetLabelBox(ele))},isVisible:isLabelVisibleAtScale}),lyrTxrCache=r.data.lyrTxrCache=new LayeredTextureCache(r);r.onUpdateEleCalcs((function invalidateTextureCaches(willDraw,eles){eleTxrCache.invalidateElements(eles),lblTxrCache.invalidateElements(eles),slbTxrCache.invalidateElements(eles),tlbTxrCache.invalidateElements(eles),lyrTxrCache.invalidateElements(eles);for(var _i=0;_i<eles.length;_i++){var _p=eles[_i]._private;_p.oldBackgroundTimestamp=_p.backgroundTimestamp}}));var refineInLayers=function refineInLayers(reqs){for(var i=0;i<reqs.length;i++)lyrTxrCache.enqueueElementRefinement(reqs[i].ele)};eleTxrCache.onDequeue(refineInLayers),lblTxrCache.onDequeue(refineInLayers),slbTxrCache.onDequeue(refineInLayers),tlbTxrCache.onDequeue(refineInLayers)}CRp$a.CANVAS_LAYERS=3,CRp$a.SELECT_BOX=0,CRp$a.DRAG=1,CRp$a.NODE=2,CRp$a.BUFFER_COUNT=3,CRp$a.TEXTURE_BUFFER=0,CRp$a.MOTIONBLUR_BUFFER_NODE=1,CRp$a.MOTIONBLUR_BUFFER_DRAG=2,CRp$a.redrawHint=function(group,bool){var r=this;switch(group){case"eles":r.data.canvasNeedsRedraw[CRp$a.NODE]=bool;break;case"drag":r.data.canvasNeedsRedraw[CRp$a.DRAG]=bool;break;case"select":r.data.canvasNeedsRedraw[CRp$a.SELECT_BOX]=bool}};var pathsImpld="undefined"!=typeof Path2D;CRp$a.path2dEnabled=function(on){if(void 0===on)return this.pathsEnabled;this.pathsEnabled=!!on},CRp$a.usePaths=function(){return pathsImpld&&this.pathsEnabled},CRp$a.setImgSmoothing=function(context,bool){null!=context.imageSmoothingEnabled?context.imageSmoothingEnabled=bool:(context.webkitImageSmoothingEnabled=bool,context.mozImageSmoothingEnabled=bool,context.msImageSmoothingEnabled=bool)},CRp$a.getImgSmoothing=function(context){return null!=context.imageSmoothingEnabled?context.imageSmoothingEnabled:context.webkitImageSmoothingEnabled||context.mozImageSmoothingEnabled||context.msImageSmoothingEnabled},CRp$a.makeOffscreenCanvas=function(width,height){var canvas;return"undefined"!==("undefined"==typeof OffscreenCanvas?"undefined":_typeof(OffscreenCanvas))?canvas=new OffscreenCanvas(width,height):((canvas=document.createElement("canvas")).width=width,canvas.height=height),canvas},[CRp,CRp$1,CRp$2,CRp$3,CRp$4,CRp$5,CRp$6,CRp$7,CRp$8,CRp$9].forEach((function(props){extend(CRp$a,props)}));var incExts=[{type:"layout",extensions:layout},{type:"renderer",extensions:[{name:"null",impl:NullRenderer},{name:"base",impl:BR},{name:"canvas",impl:CR}]}],extensions={},modules={};function setExtension(type,name,registrant){var ext=registrant,overrideErr=function overrideErr(field){error("Can not register `"+name+"` for `"+type+"` since `"+field+"` already exists in the prototype and can not be overridden")};if("core"===type){if(Core.prototype[name])return overrideErr(name);Core.prototype[name]=registrant}else if("collection"===type){if(Collection.prototype[name])return overrideErr(name);Collection.prototype[name]=registrant}else if("layout"===type){for(var Layout=function Layout(options){this.options=options,registrant.call(this,options),plainObject(this._private)||(this._private={}),this._private.cy=options.cy,this._private.listeners=[],this.createEmitter()},layoutProto=Layout.prototype=Object.create(registrant.prototype),optLayoutFns=[],i=0;i<optLayoutFns.length;i++){var fnName=optLayoutFns[i];layoutProto[fnName]=layoutProto[fnName]||function(){return this}}layoutProto.start&&!layoutProto.run?layoutProto.run=function(){return this.start(),this}:!layoutProto.start&&layoutProto.run&&(layoutProto.start=function(){return this.run(),this});var regStop=registrant.prototype.stop;layoutProto.stop=function(){var opts=this.options;if(opts&&opts.animate){var anis=this.animations;if(anis)for(var _i=0;_i<anis.length;_i++)anis[_i].stop()}return regStop?regStop.call(this):this.emit("layoutstop"),this},layoutProto.destroy||(layoutProto.destroy=function(){return this}),layoutProto.cy=function(){return this._private.cy};var getCy=function getCy(layout){return layout._private.cy},emitterOpts={addEventFields:function addEventFields(layout,evt){evt.layout=layout,evt.cy=getCy(layout),evt.target=layout},bubble:function bubble(){return!0},parent:function parent(layout){return getCy(layout)}};extend(layoutProto,{createEmitter:function createEmitter(){return this._private.emitter=new Emitter(emitterOpts,this),this},emitter:function emitter(){return this._private.emitter},on:function on(evt,cb){return this.emitter().on(evt,cb),this},one:function one(evt,cb){return this.emitter().one(evt,cb),this},once:function once(evt,cb){return this.emitter().one(evt,cb),this},removeListener:function removeListener(evt,cb){return this.emitter().removeListener(evt,cb),this},removeAllListeners:function removeAllListeners(){return this.emitter().removeAllListeners(),this},emit:function emit(evt,params){return this.emitter().emit(evt,params),this}}),define$3.eventAliasesOn(layoutProto),ext=Layout}else if("renderer"===type&&"null"!==name&&"base"!==name){var BaseRenderer=getExtension("renderer","base"),bProto=BaseRenderer.prototype,RegistrantRenderer=registrant,rProto=registrant.prototype,Renderer=function Renderer(){BaseRenderer.apply(this,arguments),RegistrantRenderer.apply(this,arguments)},proto=Renderer.prototype;for(var pName in bProto){var pVal=bProto[pName];if(null!=rProto[pName])return overrideErr(pName);proto[pName]=pVal}for(var _pName in rProto)proto[_pName]=rProto[_pName];bProto.clientFunctions.forEach((function(name){proto[name]=proto[name]||function(){error("Renderer does not implement `renderer."+name+"()` on its prototype")}})),ext=Renderer}return setMap({map:extensions,keys:[type,name],value:ext})}function getExtension(type,name){return getMap({map:extensions,keys:[type,name]})}function setModule(type,name,moduleType,moduleName,registrant){return setMap({map:modules,keys:[type,name,moduleType,moduleName],value:registrant})}function getModule(type,name,moduleType,moduleName){return getMap({map:modules,keys:[type,name,moduleType,moduleName]})}var extension=function extension(){return 2===arguments.length?getExtension.apply(null,arguments):3===arguments.length?setExtension.apply(null,arguments):4===arguments.length?getModule.apply(null,arguments):5===arguments.length?setModule.apply(null,arguments):void error("Invalid extension access syntax")};Core.prototype.extension=extension,incExts.forEach((function(group){group.extensions.forEach((function(ext){setExtension(group.type,ext.name,ext.impl)}))}));var Stylesheet=function Stylesheet(){if(!(this instanceof Stylesheet))return new Stylesheet;this.length=0},sheetfn=Stylesheet.prototype;sheetfn.instanceString=function(){return"stylesheet"},sheetfn.selector=function(selector){return this[this.length++]={selector:selector,properties:[]},this},sheetfn.css=function(name,value){var i=this.length-1;if(string(name))this[i].properties.push({name:name,value:value});else if(plainObject(name))for(var map=name,propNames=Object.keys(map),j=0;j<propNames.length;j++){var key=propNames[j],mapVal=map[key];if(null!=mapVal){var prop=Style.properties[key]||Style.properties[dash2camel(key)];if(null!=prop){var _name=prop.name,_value=mapVal;this[i].properties.push({name:_name,value:_value})}}}return this},sheetfn.style=sheetfn.css,sheetfn.generateStyle=function(cy){var style=new Style(cy);return this.appendToStyle(style)},sheetfn.appendToStyle=function(style){for(var i=0;i<this.length;i++){var context=this[i],selector=context.selector,props=context.properties;style.selector(selector);for(var j=0;j<props.length;j++){var prop=props[j];style.css(prop.name,prop.value)}}return style};var cytoscape$1=function cytoscape(options){return void 0===options&&(options={}),plainObject(options)?new Core(options):string(options)?extension.apply(extension,arguments):void 0};cytoscape$1.use=function(ext){var args=Array.prototype.slice.call(arguments,1);return args.unshift(cytoscape$1),ext.apply(null,args),this},cytoscape$1.warnings=function(bool){return warnings(bool)},cytoscape$1.version="3.18.1",cytoscape$1.stylesheet=cytoscape$1.Stylesheet=Stylesheet;var cytoscape_cjs=cytoscape$1,CellTasks=function(_PlaygroundElement5){_inherits(CellTasks,_PlaygroundElement5);var _super11=_createSuper(CellTasks);function CellTasks(){var _this19;return _classCallCheck2(this,CellTasks),(_this19=_super11.apply(this,arguments)).workflowsToDisplay=[_holochain_playground_core__WEBPACK_IMPORTED_MODULE_104__.d.GENESIS,_holochain_playground_core__WEBPACK_IMPORTED_MODULE_104__.d.CALL_ZOME,_holochain_playground_core__WEBPACK_IMPORTED_MODULE_104__.d.INCOMING_DHT_OPS,_holochain_playground_core__WEBPACK_IMPORTED_MODULE_104__.d.INTEGRATE_DHT_OPS,_holochain_playground_core__WEBPACK_IMPORTED_MODULE_104__.d.PRODUCE_DHT_OPS,_holochain_playground_core__WEBPACK_IMPORTED_MODULE_104__.d.PUBLISH_DHT_OPS,_holochain_playground_core__WEBPACK_IMPORTED_MODULE_104__.d.APP_VALIDATION,_holochain_playground_core__WEBPACK_IMPORTED_MODULE_104__.d.SYS_VALIDATION],_this19.workflowDelay=1e3,_this19.hideErrors=!1,_this19.stepByStep=!1,_this19._onPause=!1,_this19._callZomeTasks=[],_this19._runningTasks={},_this19._errors=[],_this19}return _createClass2(CellTasks,[{key:"observedCells",value:function observedCells(){return[this.cell]}},{key:"onNewObservedCell",value:function onNewObservedCell(cell){var _this20=this;return[cell.workflowExecutor.before(function(){var _ref27=_asyncToGenerator(regeneratorRuntime.mark((function _callee4(task){return regeneratorRuntime.wrap((function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:if(_this20.workflowsToDisplay.includes(task.type)){_context4.next=2;break}return _context4.abrupt("return");case 2:if(task.type===_holochain_playground_core__WEBPACK_IMPORTED_MODULE_104__.d.CALL_ZOME?_this20._callZomeTasks.push(task):(_this20._runningTasks[task.type]||(_this20._runningTasks[task.type]=0),_this20._runningTasks[task.type]+=1),_this20.requestUpdate(),!_this20.stepByStep){_context4.next=11;break}return _this20.dispatchEvent(new CustomEvent("execution-paused",{detail:{paused:!0},composed:!0,bubbles:!0})),_context4.next=8,new Promise((function(resolve){return _this20._resumeObservable.subscribe((function(){return resolve(null)}))}));case 8:_this20.dispatchEvent(new CustomEvent("execution-paused",{detail:{paused:!1},composed:!0,bubbles:!0})),_context4.next=13;break;case 11:return _context4.next=13,Object(_holochain_playground_core__WEBPACK_IMPORTED_MODULE_104__.r)(_this20.workflowDelay);case 13:case"end":return _context4.stop()}}),_callee4)})));return function(_x8){return _ref27.apply(this,arguments)}}()),cell.workflowExecutor.success(function(){var _ref28=_asyncToGenerator(regeneratorRuntime.mark((function _callee5(task){return regeneratorRuntime.wrap((function _callee5$(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:task.type===_holochain_playground_core__WEBPACK_IMPORTED_MODULE_104__.d.CALL_ZOME?_this20._callZomeTasks=_this20._callZomeTasks.filter((function(t){return t!==task})):_this20._runningTasks[task.type]&&(_this20._runningTasks[task.type]-=1,0===_this20._runningTasks[task.type]&&delete _this20._runningTasks[task.type]),_this20.requestUpdate();case 2:case"end":return _context5.stop()}}),_callee5)})));return function(_x9){return _ref28.apply(this,arguments)}}()),cell.workflowExecutor.error(function(){var _ref29=_asyncToGenerator(regeneratorRuntime.mark((function _callee6(task,error){var errorInfo,index;return regeneratorRuntime.wrap((function _callee6$(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:if(task.type===_holochain_playground_core__WEBPACK_IMPORTED_MODULE_104__.d.CALL_ZOME?_this20._callZomeTasks=_this20._callZomeTasks.filter((function(t){return t!==task})):_this20._runningTasks[task.type]&&(_this20._runningTasks[task.type]-=1,0===_this20._runningTasks[task.type]&&delete _this20._runningTasks[task.type]),_this20.hideErrors){_context6.next=16;break}if(errorInfo={task:task,error:error},_this20._errors.push(errorInfo),_this20.requestUpdate(),!_this20.stepByStep){_context6.next=12;break}return _this20.dispatchEvent(new CustomEvent("execution-paused",{detail:{paused:!0},composed:!0,bubbles:!0})),_context6.next=9,new Promise((function(resolve){return _this20._resumeObservable.subscribe((function(){return resolve(null)}))}));case 9:_this20.dispatchEvent(new CustomEvent("execution-paused",{detail:{paused:!1},composed:!0,bubbles:!0})),_context6.next=14;break;case 12:return _context6.next=14,Object(_holochain_playground_core__WEBPACK_IMPORTED_MODULE_104__.r)(_this20.workflowDelay);case 14:index=_this20._errors.findIndex((function(e){return e===errorInfo})),_this20._errors.splice(index,1);case 16:_this20.requestUpdate();case 17:case"end":return _context6.stop()}}),_callee6)})));return function(_x10,_x11){return _ref29.apply(this,arguments)}}())]}},{key:"sortTasks",value:function sortTasks(tasks){return tasks.sort((function(t1,t2){return Object(_holochain_playground_core__WEBPACK_IMPORTED_MODULE_104__.s)(t1[0])-Object(_holochain_playground_core__WEBPACK_IMPORTED_MODULE_104__.s)(t2[0])}))}},{key:"showTasks",value:function showTasks(){return 0!==Object.keys(this._runningTasks).length||0!==this._errors.length||0!==this._callZomeTasks.length}},{key:"render",value:function render(){if(!this.showTasks())return Object(lit_html__WEBPACK_IMPORTED_MODULE_119__.html)(_templateObject51||(_templateObject51=_taggedTemplateLiteral([""])));var orderedTasks=this.sortTasks(Object.entries(this._runningTasks));return Object(lit_html__WEBPACK_IMPORTED_MODULE_119__.html)(_templateObject52||(_templateObject52=_taggedTemplateLiteral(['\n      <mwc-card class="tasks-card">\n        <mwc-list style="max-height: 300px; overflow-y: auto; width: 200px;">\n          ',"\n          ","\n          ","\n        </mwc-list>\n        ","\n      </mwc-card>\n    "])),this._callZomeTasks.map((function(callZome){return Object(lit_html__WEBPACK_IMPORTED_MODULE_119__.html)(_templateObject53||(_templateObject53=_taggedTemplateLiteral(['\n              <mwc-list-item\n                twoline\n                graphic="icon"\n                style="--mdc-list-item-graphic-margin: 4px;"\n              >\n                <mwc-icon slot="graphic" style="color: green;"\n                  >call_made</mwc-icon\n                >\n                <span>','</span>\n                <span slot="secondary">Zome: ',"</span>\n              </mwc-list-item>\n            "])),callZome.details.fnName,callZome.details.zome)})),this._errors.map((function(errorInfo){return Object(lit_html__WEBPACK_IMPORTED_MODULE_119__.html)(_templateObject54||(_templateObject54=_taggedTemplateLiteral(['\n              <mwc-list-item\n                twoline\n                graphic="icon"\n                style="--mdc-list-item-graphic-margin: 4px;"\n              >\n                <mwc-icon slot="graphic" style="color: red"\n                  >error_outline</mwc-icon\n                >\n                <span> ',' </span>\n                <span slot="secondary">\n                  ',"</span\n                >\n              </mwc-list-item>\n            "])),errorInfo.error.message,errorInfo.task.type===_holochain_playground_core__WEBPACK_IMPORTED_MODULE_104__.d.CALL_ZOME?"".concat(errorInfo.task.details.fnName," in ").concat(errorInfo.task.details.zome):errorInfo.task.type)})),orderedTasks.map((function(_ref30){var _ref31=_slicedToArray2(_ref30,2),taskName=_ref31[0],taskNumber=_ref31[1];return Object(lit_html__WEBPACK_IMPORTED_MODULE_119__.html)(_templateObject55||(_templateObject55=_taggedTemplateLiteral(['\n              <mwc-list-item\n                twoline\n                graphic="icon"\n                style="--mdc-list-item-graphic-margin: 4px;"\n              >\n                <mwc-icon slot="graphic">miscellaneous_services</mwc-icon>\n                <span>\n                  '," ",'\n                </span>\n                <span slot="secondary">Cell Workflow</span>\n              </mwc-list-item>\n            '])),taskNumber>1?taskNumber+"x":"",taskName)})),this.stepByStep?Object(lit_html__WEBPACK_IMPORTED_MODULE_119__.html)(_templateObject56||(_templateObject56=_taggedTemplateLiteral([""]))):Object(lit_html__WEBPACK_IMPORTED_MODULE_119__.html)(_templateObject57||(_templateObject57=_taggedTemplateLiteral([" <mwc-linear-progress indeterminate></mwc-linear-progress> "]))))}}],[{key:"styles",get:function get(){return[sharedStyles,Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.b)(_templateObject58||(_templateObject58=_taggedTemplateLiteral(["\n        .tasks-card {\n          width: auto;\n        }\n      "])))]}},{key:"scopedElements",get:function get(){return{"mwc-card":scoped_material_components_mwc_card__WEBPACK_IMPORTED_MODULE_111__.a,"mwc-list":scoped_material_components_mwc_list__WEBPACK_IMPORTED_MODULE_113__.a,"mwc-icon":scoped_material_components_mwc_icon__WEBPACK_IMPORTED_MODULE_107__.a,"mwc-list-item":scoped_material_components_mwc_list_item__WEBPACK_IMPORTED_MODULE_112__.a,"mwc-linear-progress":scoped_material_components_mwc_linear_progress__WEBPACK_IMPORTED_MODULE_120__.a}}}]),CellTasks}(PlaygroundElement);__decorate([Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.g)({type:Object}),__metadata("design:type",_holochain_playground_core__WEBPACK_IMPORTED_MODULE_104__.a)],CellTasks.prototype,"cell",void 0),__decorate([Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.g)({type:Array}),__metadata("design:type",Array)],CellTasks.prototype,"workflowsToDisplay",void 0),__decorate([Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.g)({type:Number}),__metadata("design:type",Number)],CellTasks.prototype,"workflowDelay",void 0),__decorate([Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.g)({type:Boolean,attribute:"hide-errors"}),__metadata("design:type",Object)],CellTasks.prototype,"hideErrors",void 0),__decorate([Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.g)({type:Boolean}),__metadata("design:type",Boolean)],CellTasks.prototype,"stepByStep",void 0),__decorate([Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.g)({type:Array}),__metadata("design:type",Array)],CellTasks.prototype,"_callZomeTasks",void 0),__decorate([Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.g)({type:Object}),__metadata("design:type",Object)],CellTasks.prototype,"_runningTasks",void 0),__decorate([Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.g)({type:Object}),__metadata("design:type",Array)],CellTasks.prototype,"_errors",void 0);var HelpButton=function(_PlaygroundElement6){_inherits(HelpButton,_PlaygroundElement6);var _super12=_createSuper(HelpButton);function HelpButton(){return _classCallCheck2(this,HelpButton),_super12.apply(this,arguments)}return _createClass2(HelpButton,[{key:"renderHelpDialog",value:function renderHelpDialog(){return Object(lit_html__WEBPACK_IMPORTED_MODULE_119__.html)(_templateObject59||(_templateObject59=_taggedTemplateLiteral(['\n      <mwc-dialog id="help-dialog" .heading=','>\n        <slot></slot>\n        <mwc-button slot="primaryAction" dialogAction="cancel">\n          Got it!\n        </mwc-button>\n      </mwc-dialog>\n    '])),this.heading)}},{key:"render",value:function render(){var _this21=this;return Object(lit_html__WEBPACK_IMPORTED_MODULE_119__.html)(_templateObject60||(_templateObject60=_taggedTemplateLiteral(["\n      ",'\n      <mwc-icon-button\n        icon="help_outline"\n        @click=',"\n      ></mwc-icon-button>\n    "])),this.renderHelpDialog(),(function(){return _this21._helpDialog.show()}))}}],[{key:"scopedElements",get:function get(){return{"mwc-icon-button":scoped_material_components_mwc_icon_button__WEBPACK_IMPORTED_MODULE_100__.a,"mwc-button":scoped_material_components_mwc_button__WEBPACK_IMPORTED_MODULE_106__.a,"mwc-dialog":scoped_material_components_mwc_dialog__WEBPACK_IMPORTED_MODULE_115__.a}}}]),HelpButton}(PlaygroundElement);function neighborsEdges(cells){var _step11,allNeighbors={},edges=[],_iterator10=_createForOfIteratorHelper(cells);try{for(_iterator10.s();!(_step11=_iterator10.n()).done;){var _step12,cell=_step11.value,cellAgentPubKey=cell.agentPubKey,_iterator11=_createForOfIteratorHelper(cell.p2p.getNeighbors());try{for(_iterator11.s();!(_step12=_iterator11.n()).done;){var cellNeighbor=_step12.value;allNeighbors[cellNeighbor]&&allNeighbors[cellNeighbor][cellAgentPubKey]||edges.push({data:{id:"".concat(cellAgentPubKey,"->").concat(cellNeighbor),source:cellAgentPubKey,target:cellNeighbor},classes:["neighbor-edge"]}),allNeighbors[cellAgentPubKey]||(allNeighbors[cellAgentPubKey]={}),allNeighbors[cellAgentPubKey][cellNeighbor]=!0}}catch(err){_iterator11.e(err)}finally{_iterator11.f()}var _step13,_iterator12=_createForOfIteratorHelper(cell.p2p.farKnownPeers);try{for(_iterator12.s();!(_step13=_iterator12.n()).done;){var farNeighbor=_step13.value;edges.push({data:{id:"".concat(cellAgentPubKey,"->").concat(farNeighbor),source:cellAgentPubKey,target:farNeighbor},classes:["far-neighbor-edge"]})}}catch(err){_iterator12.e(err)}finally{_iterator12.f()}}}catch(err){_iterator10.e(err)}finally{_iterator10.f()}return edges}__decorate([Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.g)({type:String}),__metadata("design:type",String)],HelpButton.prototype,"heading",void 0),__decorate([Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.h)("#help-dialog"),__metadata("design:type",scoped_material_components_mwc_dialog__WEBPACK_IMPORTED_MODULE_115__.a)],HelpButton.prototype,"_helpDialog",void 0);var layoutConfig={name:"circle",startAngle:2*Math.PI,ready:function ready(e){e.cy.resize()}},DhtCells=function(_PlaygroundElement7){_inherits(DhtCells,_PlaygroundElement7);var _firstUpdated2,_super13=_createSuper(DhtCells);function DhtCells(){var _this22;return _classCallCheck2(this,DhtCells),(_this22=_super13.apply(this,arguments)).animationDelay=2e3,_this22.workflowsToDisplay=[_holochain_playground_core__WEBPACK_IMPORTED_MODULE_104__.d.CALL_ZOME,_holochain_playground_core__WEBPACK_IMPORTED_MODULE_104__.d.APP_VALIDATION],_this22.networkRequestsToDisplay=[_holochain_playground_core__WEBPACK_IMPORTED_MODULE_104__.c.PUBLISH_REQUEST,_holochain_playground_core__WEBPACK_IMPORTED_MODULE_104__.c.CALL_REMOTE],_this22.hideTimeController=!1,_this22.stepByStep=!1,_this22._resumeObservable=new rxjs__WEBPACK_IMPORTED_MODULE_122__.a,_this22._onPause=!1,_this22._neighborEdges=[],_this22}return _createClass2(DhtCells,[{key:"firstUpdated",value:(_firstUpdated2=_asyncToGenerator(regeneratorRuntime.mark((function _callee7(){var rendered,_this23=this;return regeneratorRuntime.wrap((function _callee7$(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:window.addEventListener("scroll",(function(){_this23._cy.resize(),_this23.requestUpdate()})),this._cy=cytoscape_cjs({container:this._graph,boxSelectionEnabled:!1,autoungrabify:!0,userPanningEnabled:!1,userZoomingEnabled:!1,layout:layoutConfig,style:"\n  node {\n    background-color: lightblue;\n    border-color: black;\n    border-width: 2px;\n    label: data(label);\n    font-size: 20px;\n    width: 50px;\n    height: 50px;\n  }\n  \n  .selected {\n    border-width: 4px;\n    border-color: black;\n    border-style: solid;\n  }\n\n  .highlighted {\n    background-color: yellow;\n  }\n\n  edge {\n    width: 1;\n  }\n\n  .network-request {\n    target-arrow-shape: triangle;\n    label: data(label);\n  }\n\n  .neighbor-edge {\n    line-style: dotted;\n  }\n\n  .far-neighbor-edge {\n    line-style: dotted;\n    opacity: 0.2;\n  }\n\n  .network-request {\n    width: 10px;\n    height: 10px;\n    background-color: grey;\n    border-width: 0px;\n  }\n"}),this._cy.on("tap","node",(function(evt){_this23.updatePlayground({activeAgentPubKey:evt.target.id()})})),rendered=!1,this._cy.on("render",(function(){0!==_this23._cy.width()&&(rendered||(rendered=!0,setTimeout((function(){_this23.setupGraphNodes()}))))}));case 5:case"end":return _context7.stop()}}),_callee7,this)}))),function firstUpdated(){return _firstUpdated2.apply(this,arguments)})},{key:"highlightNodesWithEntry",value:function highlightNodesWithEntry(){var _this24=this,allCells=selectAllCells(this.activeDna,this.conductors);if(allCells.forEach((function(cell){return _this24._cy.getElementById(cell.agentPubKey).removeClass("highlighted")})),this.activeHash){var _step14,_iterator13=_createForOfIteratorHelper(function selectHoldingCells(hash,cells){return Object(_holochain_playground_core__WEBPACK_IMPORTED_MODULE_104__.l)(hash)===_holochain_playground_core__WEBPACK_IMPORTED_MODULE_104__.b.ENTRY?cells.filter((function(cell){return Object(_holochain_playground_core__WEBPACK_IMPORTED_MODULE_104__.p)(cell.getState(),hash)})):cells.filter((function(cell){return Object(_holochain_playground_core__WEBPACK_IMPORTED_MODULE_104__.o)(cell.getState(),hash)}))}(this.activeHash,allCells));try{for(_iterator13.s();!(_step14=_iterator13.n()).done;){var cell=_step14.value;this._cy.getElementById(cell.agentPubKey).addClass("highlighted")}}catch(err){_iterator13.e(err)}finally{_iterator13.f()}}}},{key:"observedCells",value:function observedCells(){return selectAllCells(this.activeDna,this.conductors)}},{key:"onNewObservedCell",value:function onNewObservedCell(cell){var _this25=this;return[cell.p2p.networkRequestsExecutor.before(function(){var _ref32=_asyncToGenerator(regeneratorRuntime.mark((function _callee8(networkRequest){var fromNode,toNode,fromPosition,toPosition,label,dhtOps,types,el,halfPosition;return regeneratorRuntime.wrap((function _callee8$(_context8){for(;;)switch(_context8.prev=_context8.next){case 0:if(_this25.requestUpdate(),_this25.networkRequestsToDisplay.includes(networkRequest.type)){_context8.next=3;break}return _context8.abrupt("return");case 3:if(networkRequest.toAgent!==networkRequest.fromAgent){_context8.next=5;break}return _context8.abrupt("return");case 5:if((fromNode=_this25._cy.getElementById(networkRequest.fromAgent)).position()){_context8.next=8;break}return _context8.abrupt("return");case 8:if(toNode=_this25._cy.getElementById(networkRequest.toAgent),fromPosition=fromNode.position(),toPosition=toNode.position(),label=networkRequest.type,networkRequest.type===_holochain_playground_core__WEBPACK_IMPORTED_MODULE_104__.c.PUBLISH_REQUEST&&(dhtOps=networkRequest.details.dhtOps,types=Object.values(dhtOps).map((function(dhtOp){return dhtOp.type})),label="Publish: ".concat(Object(lodash_es__WEBPACK_IMPORTED_MODULE_124__.a)(types).join(", "))),el=_this25._cy.add([{group:"nodes",data:{networkRequest:networkRequest,label:label},position:{x:fromPosition.x+1,y:fromPosition.y+1},classes:["network-request"]}]),!_this25.stepByStep){_context8.next=28;break}return halfPosition={x:(toPosition.x-fromPosition.x)/2+fromPosition.x,y:(toPosition.y-fromPosition.y)/2+fromPosition.y},el.animate({position:halfPosition,duration:_this25.animationDelay/2}),_context8.next=19,Object(_holochain_playground_core__WEBPACK_IMPORTED_MODULE_104__.r)(_this25.animationDelay/2);case 19:return _this25._onPause=!0,_context8.next=22,new Promise((function(resolve){return _this25._resumeObservable.subscribe((function(){return resolve(null)}))}));case 22:return _this25._onPause=!1,el.animate({position:toPosition,duration:_this25.animationDelay/2}),_context8.next=26,Object(_holochain_playground_core__WEBPACK_IMPORTED_MODULE_104__.r)(_this25.animationDelay/2);case 26:_context8.next=31;break;case 28:return el.animate({position:toNode.position(),duration:_this25.animationDelay}),_context8.next=31,Object(_holochain_playground_core__WEBPACK_IMPORTED_MODULE_104__.r)(_this25.animationDelay);case 31:_this25._cy.remove(el);case 32:case"end":return _context8.stop()}}),_callee8)})));return function(_x12){return _ref32.apply(this,arguments)}}())]}},{key:"onCellsChanged",value:function onCellsChanged(){this.setupGraphNodes()}},{key:"setupGraphNodes",value:function setupGraphNodes(){var nodes=function dhtCellsNodes(cells){return cells.sort((function(a,b){return Object(_holochain_playground_core__WEBPACK_IMPORTED_MODULE_104__.q)(a.agentPubKey)-Object(_holochain_playground_core__WEBPACK_IMPORTED_MODULE_104__.q)(b.agentPubKey)})).map((function(cell){return{data:{id:cell.agentPubKey,label:"".concat(cell.agentPubKey.substr(0,10),"...")},classes:["cell"]}}))}(this._observedCells);this._layout&&this._layout.stop(),this._cy.remove("node"),this._cy.remove("edge"),this._cy.add(nodes);var neighbors=neighborsEdges(this._observedCells);this._cy.add(neighbors),this._layout=this._cy.elements().makeLayout(layoutConfig),this._layout.run(),this._cy.fit(nodes,nodes.length<3?170:0),this._cy.center()}},{key:"updated",value:function updated(changedValues){var _this26=this;_get(_getPrototypeOf(DhtCells.prototype),"updated",this).call(this,changedValues);var neighbors=neighborsEdges(this._observedCells);this._neighborEdges.length!=neighbors.length&&(this._neighborEdges=neighbors,this._cy.add(neighbors)),this.observedCells().forEach((function(cell){return _this26._cy.getElementById(cell.agentPubKey).removeClass("selected")})),this._cy.getElementById(this.activeAgentPubKey).addClass("selected"),this.highlightNodesWithEntry(),changedValues.has("_onPause")&&this._cy.style().selector(".cell").style({opacity:this._onPause?.4:1})}},{key:"renderTimeController",value:function renderTimeController(){var _this27=this;return this.hideTimeController?Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject61||(_templateObject61=_taggedTemplateLiteral([""]))):Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject62||(_templateObject62=_taggedTemplateLiteral(['\n      <div class="row center-content">\n        ','\n\n        <span\n          class="vertical-divider"\n          style="margin: 0 16px; margin-right: 24px;"\n        ></span>\n\n        <mwc-formfield label="Step By Step" style="margin-right: 16px;">\n          <mwc-switch\n            id="step-by-step-switch"\n            .checked=',"\n            @change=","\n          ></mwc-switch>\n        </mwc-formfield>\n      </div>\n    "])),this.stepByStep?Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject63||(_templateObject63=_taggedTemplateLiteral(["\n              <mwc-icon-button\n                .disabled=",'\n                icon="play_arrow"\n                style=',"\n                @click=","\n              ></mwc-icon-button>\n            "])),!this._onPause,Object(lit_html_directives_style_map__WEBPACK_IMPORTED_MODULE_108__.a)({"background-color":this._onPause?"#dbdbdb":"white","border-radius":"50%"}),(function(){return _this27._resumeObservable.next()})):Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject64||(_templateObject64=_taggedTemplateLiteral(['\n              <mwc-slider\n                style="margin-right: 16px;"\n                .value=',"\n                pin\n                .min=","\n                .max=","\n                @change=",'\n              ></mwc-slider>\n              <mwc-icon style="margin: 0 8px;">speed</mwc-icon>\n            '])),7e3-this.animationDelay,1e3,7e3,(function(e){return _this27.animationDelay=7e3-e.target.value})),this.stepByStep,(function(e){_this27.stepByStep=e.target.checked,_this27._onPause&&_this27._resumeObservable.next()}))}},{key:"renderHelp",value:function renderHelp(){return Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject65||(_templateObject65=_taggedTemplateLiteral(['\n      <holochain-playground-help-button heading="DHT Cells" class="block-help">\n        <span>\n          This is a visual interactive representation of a holochain\n          <a\n            href="https://developer.holochain.org/docs/concepts/4_public_data_on_the_dht/"\n            target="_blank"\n            >DHT</a\n          >, with '," nodes.\n          <br />\n          <br />\n          In the DHT, all nodes have a <strong>public and private key</strong>.\n          The public key is visible and shared througout the network, but\n          private keys never leave their nodes. This public key is of 256 bits\n          an it's actually the node's ID, which you can see labeled besides the\n          nodes (encoded in base58 strings).\n          <br />\n          <br />\n          If you pay attention, you will see that\n          <strong>all nodes in the DHT are ordered alphabetically</strong>. This\n          is because the nodes organize themselves in neighborhoods: they are\n          more connected with the nodes that are closest to their ID, and less\n          connected with the nodes that are far.\n        </span>\n      </holochain-playground-help-button>\n    "])),this.conductors.length)}},{key:"renderTasksTooltips",value:function renderTasksTooltips(){var _this28=this;if(!this._cy||!this._observedCells)return Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject66||(_templateObject66=_taggedTemplateLiteral([""])));var cellsWithPosition=this._cy.nodes().map((function(node){var agentPubKey=node.id();return{cell:_this28._observedCells.find((function(cell){return cell.agentPubKey===agentPubKey})),position:node.renderedPosition()}}));return Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject67||(_templateObject67=_taggedTemplateLiteral(["",""])),cellsWithPosition.map((function(_ref33){var cell=_ref33.cell,position=_ref33.position,leftSide=_this28._cy.width()/2>position.x,upSide=_this28._cy.height()/2>position.y,finalX=position.x+(leftSide?-250:50),finalY=position.y+(upSide?-50:50);return Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject68||(_templateObject68=_taggedTemplateLiteral(["<holochain-playground-cell-tasks\n        .workflowsToDisplay=","\n        .workflowDelay=","\n        .cell=","\n        style=","\n        .stepByStep=","\n        ._onPause=","\n        ._resumeObservable=","\n        @execution-paused=","\n      >\n      </holochain-playground-cell-tasks>"])),_this28.workflowsToDisplay,_this28.animationDelay,cell,Object(lit_html_directives_style_map__WEBPACK_IMPORTED_MODULE_108__.a)({top:"".concat(finalY,"px"),left:"".concat(finalX,"px"),position:"absolute","z-index":"3"}),_this28.stepByStep,_this28._onPause,_this28._resumeObservable,(function(e){return _this28._onPause=e.detail.paused}))})))}},{key:"renderCopyButton",value:function renderCopyButton(){return Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject69||(_templateObject69=_taggedTemplateLiteral([""])))}},{key:"renderBottomToolbar",value:function renderBottomToolbar(){var _this29=this,workflowsNames=Object.values(_holochain_playground_core__WEBPACK_IMPORTED_MODULE_104__.d),networkRequestNames=Object.values(_holochain_playground_core__WEBPACK_IMPORTED_MODULE_104__.c);return Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject70||(_templateObject70=_taggedTemplateLiteral(['\n      <div class="row center-content" style="margin: 16px; position: relative;">\n        <mwc-button\n          label="Visible Worfklows"\n          style="--mdc-theme-primary: rgba(0,0,0,0.7);"\n          icon="arrow_drop_down"\n          id="active-workflows-button"\n          trailingIcon\n          @click=','\n        ></mwc-button>\n        <mwc-menu\n          corner="BOTTOM_END"\n          multi\n          activatable\n          id="active-workflows-menu"\n          .anchor=',"\n          @selected=","\n        >\n          ",'\n        </mwc-menu>\n\n        <mwc-button\n          label="Visible Network Requests"\n          style="--mdc-theme-primary: rgba(0,0,0,0.7);"\n          icon="arrow_drop_down"\n          id="network-requests-button"\n          trailingIcon\n          @click=','\n        ></mwc-button>\n        <mwc-menu\n          corner="BOTTOM_END"\n          multi\n          activatable\n          id="network-requests-menu"\n          .anchor=',"\n          @selected=","\n        >\n          ",'\n        </mwc-menu>\n\n        <span style="flex: 1;"></span>\n\n        ',"\n      </div>\n    "])),(function(){return _this29._activeWorkflowsMenu.show()}),this._activeWorkflowsButton,(function(e){return _this29.workflowsToDisplay=_toConsumableArray(e.detail.index).map((function(index){return workflowsNames[index]}))}),workflowsNames.map((function(type){return Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject71||(_templateObject71=_taggedTemplateLiteral(['\n              <mwc-list-item\n                graphic="icon"\n                .selected=',"\n                .activated=","\n              >\n                ","\n                ","\n              </mwc-list-item>\n            "])),_this29.workflowsToDisplay.includes(type),_this29.workflowsToDisplay.includes(type),_this29.workflowsToDisplay.includes(type)?Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject72||(_templateObject72=_taggedTemplateLiteral([' <mwc-icon slot="graphic">check</mwc-icon> ']))):Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject73||(_templateObject73=_taggedTemplateLiteral([""]))),type)})),(function(){return _this29._networkRequestsMenu.show()}),this._networkRequestsButton,(function(e){return _this29.networkRequestsToDisplay=_toConsumableArray(e.detail.index).map((function(index){return networkRequestNames[index]}))}),networkRequestNames.map((function(type){return Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject74||(_templateObject74=_taggedTemplateLiteral(['\n              <mwc-list-item\n                graphic="icon"\n                .selected=',"\n                .activated=","\n              >\n                ","\n                ","\n              </mwc-list-item>\n            "])),_this29.networkRequestsToDisplay.includes(type),_this29.networkRequestsToDisplay.includes(type),_this29.networkRequestsToDisplay.includes(type)?Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject75||(_templateObject75=_taggedTemplateLiteral([' <mwc-icon slot="graphic">check</mwc-icon> ']))):Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject76||(_templateObject76=_taggedTemplateLiteral([""]))),type)})),this.renderTimeController())}},{key:"render",value:function render(){return Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject77||(_templateObject77=_taggedTemplateLiteral(['\n      <mwc-card class="block-card" style="position: relative;">\n        '," ","\n        ",'\n        <div class="column fill">\n          <span class="block-title" style="margin: 16px;">DHT Cells</span>\n          <div\n            id="graph"\n            class="fill"\n            style=',"\n          ></div>\n          ","\n        </div>\n      </mwc-card>\n    "])),this.renderHelp(),this.renderTasksTooltips(),this.renderCopyButton(),Object(lit_html_directives_style_map__WEBPACK_IMPORTED_MODULE_108__.a)({"background-color":this._onPause?"#dbdbdba0":"white"}),this.renderBottomToolbar())}}],[{key:"styles",get:function get(){return[sharedStyles,Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.b)(_templateObject78||(_templateObject78=_taggedTemplateLiteral(["\n        :host {\n          display: flex;\n        }\n      "])))]}},{key:"scopedElements",get:function get(){return{"mwc-card":scoped_material_components_mwc_card__WEBPACK_IMPORTED_MODULE_111__.a,"mwc-menu-surface":scoped_material_components_mwc_menu_surface__WEBPACK_IMPORTED_MODULE_116__.a,"mwc-button":scoped_material_components_mwc_button__WEBPACK_IMPORTED_MODULE_106__.a,"mwc-icon":scoped_material_components_mwc_icon__WEBPACK_IMPORTED_MODULE_107__.a,"mwc-menu":scoped_material_components_mwc_menu__WEBPACK_IMPORTED_MODULE_123__.a,"mwc-list-item":scoped_material_components_mwc_list_item__WEBPACK_IMPORTED_MODULE_112__.a,"mwc-slider":scoped_material_components_mwc_slider__WEBPACK_IMPORTED_MODULE_117__.a,"mwc-switch":scoped_material_components_mwc_switch__WEBPACK_IMPORTED_MODULE_118__.a,"mwc-formfield":scoped_material_components_mwc_formfield__WEBPACK_IMPORTED_MODULE_121__.a,"mwc-icon-button":scoped_material_components_mwc_icon_button__WEBPACK_IMPORTED_MODULE_100__.a,"holochain-playground-help-button":HelpButton,"holochain-playground-cell-tasks":CellTasks}}}]),DhtCells}(PlaygroundElement);__decorate([Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.g)({type:Number}),__metadata("design:type",Number)],DhtCells.prototype,"animationDelay",void 0),__decorate([Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.g)({type:Array}),__metadata("design:type",Array)],DhtCells.prototype,"workflowsToDisplay",void 0),__decorate([Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.g)({type:Array}),__metadata("design:type",Array)],DhtCells.prototype,"networkRequestsToDisplay",void 0),__decorate([Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.g)({type:Boolean,attribute:"hide-time-controller"}),__metadata("design:type",Boolean)],DhtCells.prototype,"hideTimeController",void 0),__decorate([Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.g)({type:Boolean,attribute:"step-by-step"}),__metadata("design:type",Object)],DhtCells.prototype,"stepByStep",void 0),__decorate([Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.h)("#graph"),__metadata("design:type",Object)],DhtCells.prototype,"_graph",void 0),__decorate([Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.h)("#active-workflows-button"),__metadata("design:type",scoped_material_components_mwc_button__WEBPACK_IMPORTED_MODULE_106__.a)],DhtCells.prototype,"_activeWorkflowsButton",void 0),__decorate([Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.h)("#active-workflows-menu"),__metadata("design:type",scoped_material_components_mwc_menu__WEBPACK_IMPORTED_MODULE_123__.a)],DhtCells.prototype,"_activeWorkflowsMenu",void 0),__decorate([Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.h)("#network-requests-button"),__metadata("design:type",scoped_material_components_mwc_button__WEBPACK_IMPORTED_MODULE_106__.a)],DhtCells.prototype,"_networkRequestsButton",void 0),__decorate([Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.h)("#network-requests-menu"),__metadata("design:type",scoped_material_components_mwc_menu__WEBPACK_IMPORTED_MODULE_123__.a)],DhtCells.prototype,"_networkRequestsMenu",void 0),__decorate([Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.g)({type:Boolean}),__metadata("design:type",Object)],DhtCells.prototype,"_onPause",void 0);var DhtStats=function(_PlaygroundElement8){_inherits(DhtStats,_PlaygroundElement8);var _republish,_super14=_createSuper(DhtStats);function DhtStats(){var _this30;return _classCallCheck2(this,DhtStats),(_this30=_super14.apply(this,arguments)).processing=!1,_this30}return _createClass2(DhtStats,[{key:"activeCell",get:function get(){return selectCell(this.activeDna,this.activeAgentPubKey,this.conductors)||this.allCells[0]}},{key:"allCells",get:function get(){return selectAllCells(this.activeDna,this.conductors)}},{key:"renderStatsHelp",value:function renderStatsHelp(){return Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject79||(_templateObject79=_taggedTemplateLiteral(['\n      <mwc-dialog id="stats-help" heading="DHT Statistics Help">\n        <span>\n          This panel contains statistics for the current state of the DHT.\n          <br />\n          <br />\n          Having a redundancy factor of\n          ',", it will\n          <strong>\n            replicate every DHT Op in the\n            ",' nodes that are closest to\n            its neighborhood </strong\n          >.\n          <br />\n          <br />\n          The number of\n          <strong\n            >DHT Ops (DHT Operation Transforms) is a measure of the load that\n            the DHT has to hold</strong\n          >. A DHT Op is the command that a node receives to indicate it has to\n          change something in its shard of the DHT. Example of DHT Ops are\n          "StoreEntry", "RegisterAddLink".\n        </span>\n        <mwc-button slot="primaryAction" dialogAction="cancel">\n          Got it!\n        </mwc-button>\n      </mwc-dialog>\n    '])),selectRedundancyFactor(this.activeCell),selectRedundancyFactor(this.activeCell))}},{key:"republish",value:(_republish=_asyncToGenerator(regeneratorRuntime.mark((function _callee9(){var newNodes,currentNodes,conductors,newNodesToCreate,conductorsToRemove,getMaxSourceChainLength,_this31=this;return regeneratorRuntime.wrap((function _callee9$(_context9){for(;;)switch(_context9.prev=_context9.next){case 0:if(newNodes=parseInt(this.nNodes.value),currentNodes=this.allCells.length,parseInt(this.rFactor.value),this.activeDna,conductors=this.conductors,!(newNodes>currentNodes)){_context9.next=12;break}return newNodesToCreate=newNodes-currentNodes,_context9.next=9,Object(_holochain_playground_core__WEBPACK_IMPORTED_MODULE_104__.e)(newNodesToCreate,conductors,Object(_holochain_playground_core__WEBPACK_IMPORTED_MODULE_104__.f)());case 9:conductors=_context9.sent,_context9.next=13;break;case 12:newNodes<currentNodes&&(conductorsToRemove=currentNodes-newNodes,getMaxSourceChainLength=function getMaxSourceChainLength(conductor){return Math.max.apply(Math,_toConsumableArray(selectCells(_this31.activeDna,conductor).map((function(cell){return cell.getState().sourceChain.length}))))},(conductors=conductors.sort((function(c1,c2){return getMaxSourceChainLength(c1)-getMaxSourceChainLength(c2)}))).splice(0,conductorsToRemove));case 13:this.processing=!1;case 14:case"end":return _context9.stop()}}),_callee9,this)}))),function republish(){return _republish.apply(this,arguments)})},{key:"updateDHTStats",value:function updateDHTStats(){var _this32=this;this.processing=!0,this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout((function(){_this32.republish()}),400)}},{key:"render",value:function render(){var _this33=this;return Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject80||(_templateObject80=_taggedTemplateLiteral(["\n      ",'\n      <div class="column" style="position: relative;">\n        <div style="padding: 16px;">\n          <span class="title">Global DHT Stats</span>\n\n          <mwc-icon-button\n            style="position: absolute; right: 8px; top: 8px;"\n            icon="help_outline"\n            @click=','\n          ></mwc-icon-button>\n\n          <div class="row center-content">\n            <div class="row center-content" style="padding-right: 16px;">\n              <span style="margin-right: 8px;">Number of nodes: </span\n              ><mwc-textfield\n                id="number-of-nodes"\n                min="1"\n                max="50"\n                outlined\n                type="number"\n                style="width: 5em;"\n                .disabled=',"\n                @change=","\n                .value=",'\n              ></mwc-textfield>\n            </div>\n            <div class="row center-content" style="padding-right: 24px;">\n              <span style="margin-right: 8px;">Redundancy factor: </span\n              ><mwc-textfield\n                id="r-factor"\n                min="1"\n                max="50"\n                outlined\n                type="number"\n                .disabled=','\n                style="width: 5em;"\n                @change=',"\n                .value=",'\n              ></mwc-textfield>\n            </div>\n            <div class="column fill">\n              <span style="margin-bottom: 2px;"\n                >Unique DHT Ops:\n                <strong>','</strong></span\n              >\n              <span style="margin-bottom: 2px;"\n                >Median DHT Ops per node:\n                <strong\n                  >',"</strong\n                ></span\n              >\n              <span\n                >Global DHT Ops:\n                <strong>","</strong></span\n              >\n            </div>\n          </div>\n        </div>\n        ","\n      </div>\n    "])),this.renderStatsHelp(),(function(){return _this33.statsHelp.open=!0}),void 0!==this.conductorsUrls,(function(){return _this33.updateDHTStats()}),this.allCells.length.toString(),void 0!==this.conductorsUrls,(function(){return _this33.updateDHTStats()}),selectRedundancyFactor(this.activeCell).toString(),function selectUniqueDHTOpsCount(cells){var _step8,globalDHTOps={},_iterator7=_createForOfIteratorHelper(cells);try{for(_iterator7.s();!(_step8=_iterator7.n()).done;)for(var cell=_step8.value,_i15=0,_Object$keys=Object.keys(cell.getState().integratedDHTOps);_i15<_Object$keys.length;_i15++){globalDHTOps[_Object$keys[_i15]]={}}}catch(err){_iterator7.e(err)}finally{_iterator7.f()}return Object.keys(globalDHTOps).length}(this.allCells),function selectMedianHoldingDHTOps(cells){var _step10,holdingDHTOps=[],_iterator9=_createForOfIteratorHelper(cells);try{for(_iterator9.s();!(_step10=_iterator9.n()).done;){var cell=_step10.value;holdingDHTOps.push(Object.keys(cell.getState().integratedDHTOps).length)}}catch(err){_iterator9.e(err)}finally{_iterator9.f()}holdingDHTOps.sort();var medianIndex=Math.floor(holdingDHTOps.length/2);return holdingDHTOps.sort((function(a,b){return a-b}))[medianIndex]}(this.allCells),function selectGlobalDHTOpsCount(cells){var _step5,dhtOps=0,_iterator4=_createForOfIteratorHelper(cells);try{for(_iterator4.s();!(_step5=_iterator4.n()).done;){var cell=_step5.value;dhtOps+=Object.keys(cell.getState().integratedDHTOps).length}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}return dhtOps}(this.allCells),this.processing?Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject81||(_templateObject81=_taggedTemplateLiteral(["<mwc-linear-progress indeterminate></mwc-linear-progress>"]))):Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject82||(_templateObject82=_taggedTemplateLiteral([""]))))}}],[{key:"styles",get:function get(){return sharedStyles}},{key:"scopedElements",get:function get(){return{"mwc-linear-progress":scoped_material_components_mwc_linear_progress__WEBPACK_IMPORTED_MODULE_120__.a,"mwc-textfield":scoped_material_components_mwc_textfield__WEBPACK_IMPORTED_MODULE_105__.a,"mwc-icon-button":scoped_material_components_mwc_icon_button__WEBPACK_IMPORTED_MODULE_100__.a,"mwc-dialog":scoped_material_components_mwc_dialog__WEBPACK_IMPORTED_MODULE_115__.a}}}]),DhtStats}(PlaygroundElement);function allEntries(cells,showEntryContents,excludedEntryTypes){var _step17,details={},links={},entryTypes={},_iterator16=_createForOfIteratorHelper(cells);try{for(_iterator16.s();!(_step17=_iterator16.n()).done;){var _step19,cell=_step17.value,state=cell.getState(),_iterator18=_createForOfIteratorHelper(Object(_holochain_playground_core__WEBPACK_IMPORTED_MODULE_104__.g)(state));try{for(_iterator18.s();!(_step19=_iterator18.n()).done;){var entryHash=_step19.value;details[entryHash]=Object(_holochain_playground_core__WEBPACK_IMPORTED_MODULE_104__.j)(state,entryHash),links[entryHash]||(links[entryHash]=[]),links[entryHash].push(Object(_holochain_playground_core__WEBPACK_IMPORTED_MODULE_104__.m)(state,entryHash));var firstEntryHeader=details[entryHash].headers[0];firstEntryHeader&&firstEntryHeader.header.content.entry_type&&(entryTypes[entryHash]=Object(_holochain_playground_core__WEBPACK_IMPORTED_MODULE_104__.k)(cell,firstEntryHeader.header.content.entry_type))}}catch(err){_iterator18.e(err)}finally{_iterator18.f()}}}catch(err){_iterator16.e(err)}finally{_iterator16.f()}var _step18,sortedEntries=function sortEntries(entryHashes,details){return entryHashes.sort((function(keyA,keyB){return function compareEntries(details,hashA,hashB){var headersA=Object.values(details[hashA].headers).sort(compareHeader),headersB=Object.values(details[hashB].headers).sort(compareHeader);return headersA.length>0?Object(_holochain_open_dev_core_types__WEBPACK_IMPORTED_MODULE_127__.k)(headersA[0].header.content.timestamp):0-headersB.length>0?Object(_holochain_open_dev_core_types__WEBPACK_IMPORTED_MODULE_127__.k)(headersB[0].header.content.timestamp):0}(details,keyA,keyB)}))}(Object.keys(details),details),linksEdges=[],entryNodes=[],entryTypeCount={},_loop3=function _loop3(entryHash){var detail=details[entryHash],entry=detail.entry,newEntryHeader=detail.headers[0],entryType=entryTypes[entryHash];if(entryTypeCount[entryType]||(entryTypeCount[entryType]=0),!excludedEntryTypes.includes(entryType)){if(entryNodes.push({data:{id:entryHash,data:entry,label:"".concat(entryType).concat(entryTypeCount[entryType])},classes:[entryType]}),showEntryContents){var content=shortenStrRec(entry.content);if("object"===_typeof2(content))for(var _i17=0,_properties=Object.keys(entry.content);_i17<_properties.length;_i17++){var _property=_properties[_i17],propertyParentId="".concat(entryHash,":").concat(_property);entryNodes.push({data:{id:propertyParentId,parent:entryHash}}),entryNodes.push({data:{id:"".concat(propertyParentId,":key"),label:_property,parent:propertyParentId}}),entryNodes.push({data:{id:"".concat(propertyParentId,":value"),label:content[_property],parent:propertyParentId}})}else entryNodes.push({data:{id:"".concat(entryHash,":content"),label:content,parent:entryHash}})}if(Object(_holochain_playground_core__WEBPACK_IMPORTED_MODULE_104__.h)(newEntryHeader.header.content.entry_type)){var _step20,implicitLinks=function getImplicitLinks(allEntryIds,value){if(!value)return[];if("string"==typeof value)return allEntryIds.includes(value)?[{label:void 0,target:value}]:[];if(Array.isArray(value)&&value.length>0&&"string"==typeof value[0])return value.filter((function(v){return allEntryIds.includes(v)})).map((function(v){return{target:v,label:void 0}}));if("object"===_typeof2(value)){var _ref36,_values=Object.entries(value).map((function(_ref34){var _step23,_ref35=_slicedToArray2(_ref34,2),key=_ref35[0],v=_ref35[1],implicitLinks=getImplicitLinks(allEntryIds,v),_iterator22=_createForOfIteratorHelper(implicitLinks);try{for(_iterator22.s();!(_step23=_iterator22.n()).done;){var implicitLink=_step23.value;implicitLink.label||(implicitLink.label=key)}}catch(err){_iterator22.e(err)}finally{_iterator22.f()}return implicitLinks}));return(_ref36=[]).concat.apply(_ref36,_toConsumableArray(_values))}return[]}(Object.keys(details),entry.content),_iterator19=_createForOfIteratorHelper(implicitLinks);try{for(_iterator19.s();!(_step20=_iterator19.n()).done;){var implicitLink=_step20.value;excludedEntryTypes.includes(entryTypes[implicitLink.target])||linksEdges.push({data:{id:"".concat(entryHash,"->").concat(implicitLink.target),source:entryHash,target:implicitLink.target,label:implicitLink.label},classes:["implicit"]})}}catch(err){_iterator19.e(err)}finally{_iterator19.f()}}var linksResponses=links[entryHash];if(linksResponses){var _step21,_iterator20=_createForOfIteratorHelper(Object(_holochain_playground_core__WEBPACK_IMPORTED_MODULE_104__.n)(linksResponses));try{for(_iterator20.s();!(_step21=_iterator20.n()).done;){var link=_step21.value,tag=link.tag&&"string"!=typeof link.tag?JSON.stringify(link.tag):link.tag,target=link.target;if(!excludedEntryTypes.includes(entryTypes[target])){var edgeData={data:{id:"".concat(entryHash,"->").concat(target),source:entryHash,target:target},classes:["explicit"]};tag&&(edgeData.data.label=tag),linksEdges.push(edgeData)}}}catch(err){_iterator20.e(err)}finally{_iterator20.f()}}var _step22,_iterator21=_createForOfIteratorHelper(detail.headers.filter((function(h){return h.header.content.original_header_address&&h.header.content.original_entry_address===entryHash})));try{for(_iterator21.s();!(_step22=_iterator21.n()).done;){var strUpdateEntryHash=_step22.value.header.content.entry_hash;linksEdges.push({data:{id:"".concat(entryHash,"-updated-by-").concat(strUpdateEntryHash),source:entryHash,target:strUpdateEntryHash,label:"updated by"},classes:["update-edge"]})}}catch(err){_iterator21.e(err)}finally{_iterator21.f()}var node=entryNodes.find((function(node){return node.data.id===entryHash}));detail.updates.length>0&&node.classes.push("updated"),detail.deletes.length>0&&node.classes.push("deleted")}entryTypeCount[entryType]+=1},_iterator17=_createForOfIteratorHelper(sortedEntries);try{for(_iterator17.s();!(_step18=_iterator17.n()).done;){_loop3(entryHash=_step18.value)}}catch(err){_iterator17.e(err)}finally{_iterator17.f()}return{entries:[].concat(entryNodes,linksEdges),entryTypes:Object.keys(entryTypeCount)}}function compareHeader(headerA,headerB){return Object(_holochain_open_dev_core_types__WEBPACK_IMPORTED_MODULE_127__.k)(headerA.header.content.timestamp)-Object(_holochain_open_dev_core_types__WEBPACK_IMPORTED_MODULE_127__.k)(headerB.header.content.timestamp)}__decorate([Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.h)("#stats-help"),__metadata("design:type",scoped_material_components_mwc_dialog__WEBPACK_IMPORTED_MODULE_115__.a)],DhtStats.prototype,"statsHelp",void 0),__decorate([Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.h)("#number-of-nodes"),__metadata("design:type",scoped_material_components_mwc_textfield__WEBPACK_IMPORTED_MODULE_105__.a)],DhtStats.prototype,"nNodes",void 0),__decorate([Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.h)("#r-factor"),__metadata("design:type",scoped_material_components_mwc_textfield__WEBPACK_IMPORTED_MODULE_105__.a)],DhtStats.prototype,"rFactor",void 0),__decorate([Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.g)({type:Boolean}),__metadata("design:type",Boolean)],DhtStats.prototype,"processing",void 0);var powergraph=createCommonjsModule((function(module,exports){Object.defineProperty(exports,"__esModule",{value:!0});var PowerEdge=function PowerEdge(source,target,type){this.source=source,this.target=target,this.type=type};exports.PowerEdge=PowerEdge;var Configuration=function(){function Configuration(n,edges,linkAccessor,rootGroup){var _this=this;if(this.linkAccessor=linkAccessor,this.modules=new Array(n),this.roots=[],rootGroup)this.initModulesFromGroup(rootGroup);else{this.roots.push(new ModuleSet);for(var i=0;i<n;++i)this.roots[0].add(this.modules[i]=new Module(i))}this.R=edges.length,edges.forEach((function(e){var s=_this.modules[linkAccessor.getSourceIndex(e)],t=_this.modules[linkAccessor.getTargetIndex(e)],type=linkAccessor.getType(e);s.outgoing.add(type,t),t.incoming.add(type,s)}))}return Configuration.prototype.initModulesFromGroup=function(group){var moduleSet=new ModuleSet;this.roots.push(moduleSet);for(var i=0;i<group.leaves.length;++i){var node=group.leaves[i],module=new Module(node.id);this.modules[node.id]=module,moduleSet.add(module)}if(group.groups)for(var j=0;j<group.groups.length;++j){var child=group.groups[j],definition={};for(var prop in child)"leaves"!==prop&&"groups"!==prop&&child.hasOwnProperty(prop)&&(definition[prop]=child[prop]);moduleSet.add(new Module(-1-j,new LinkSets,new LinkSets,this.initModulesFromGroup(child),definition))}return moduleSet},Configuration.prototype.merge=function(a,b,k){void 0===k&&(k=0);var inInt=a.incoming.intersection(b.incoming),outInt=a.outgoing.intersection(b.outgoing),children=new ModuleSet;children.add(a),children.add(b);var m=new Module(this.modules.length,outInt,inInt,children);this.modules.push(m);var update=function update(s,i,o){s.forAll((function(ms,linktype){ms.forAll((function(n){var nls=n[i];nls.add(linktype,m),nls.remove(linktype,a),nls.remove(linktype,b),a[o].remove(linktype,n),b[o].remove(linktype,n)}))}))};return update(outInt,"incoming","outgoing"),update(inInt,"outgoing","incoming"),this.R-=inInt.count()+outInt.count(),this.roots[k].remove(a),this.roots[k].remove(b),this.roots[k].add(m),m},Configuration.prototype.rootMerges=function(k){void 0===k&&(k=0);for(var rs=this.roots[k].modules(),n=rs.length,merges=new Array(n*(n-1)),ctr=0,i=0,i_=n-1;i<i_;++i)for(var j=i+1;j<n;++j){var a=rs[i],b=rs[j];merges[ctr]={id:ctr,nEdges:this.nEdges(a,b),a:a,b:b},ctr++}return merges},Configuration.prototype.greedyMerge=function(){for(var i=0;i<this.roots.length;++i)if(!(this.roots[i].modules().length<2)){var m=this.rootMerges(i).sort((function(a,b){return a.nEdges==b.nEdges?a.id-b.id:a.nEdges-b.nEdges}))[0];if(!(m.nEdges>=this.R))return this.merge(m.a,m.b,i),!0}},Configuration.prototype.nEdges=function(a,b){var inInt=a.incoming.intersection(b.incoming),outInt=a.outgoing.intersection(b.outgoing);return this.R-inInt.count()-outInt.count()},Configuration.prototype.getGroupHierarchy=function(retargetedEdges){var _this=this,groups=[];return function toGroups(modules,group,groups){modules.forAll((function(m){if(m.isLeaf())group.leaves||(group.leaves=[]),group.leaves.push(m.id);else{var g=group;if(m.gid=groups.length,!m.isIsland()||m.isPredefined()){if(g={id:m.gid},m.isPredefined())for(var prop in m.definition)g[prop]=m.definition[prop];group.groups||(group.groups=[]),group.groups.push(m.gid),groups.push(g)}toGroups(m.children,g,groups)}}))}(this.roots[0],{},groups),this.allEdges().forEach((function(e){var a=_this.modules[e.source],b=_this.modules[e.target];retargetedEdges.push(new PowerEdge(void 0===a.gid?e.source:groups[a.gid],void 0===b.gid?e.target:groups[b.gid],e.type))})),groups},Configuration.prototype.allEdges=function(){var es=[];return Configuration.getEdges(this.roots[0],es),es},Configuration.getEdges=function(modules,es){modules.forAll((function(m){m.getEdges(es),Configuration.getEdges(m.children,es)}))},Configuration}();exports.Configuration=Configuration;var Module=function(){function Module(id,outgoing,incoming,children,definition){void 0===outgoing&&(outgoing=new LinkSets),void 0===incoming&&(incoming=new LinkSets),void 0===children&&(children=new ModuleSet),this.id=id,this.outgoing=outgoing,this.incoming=incoming,this.children=children,this.definition=definition}return Module.prototype.getEdges=function(es){var _this=this;this.outgoing.forAll((function(ms,edgetype){ms.forAll((function(target){es.push(new PowerEdge(_this.id,target.id,edgetype))}))}))},Module.prototype.isLeaf=function(){return 0===this.children.count()},Module.prototype.isIsland=function(){return 0===this.outgoing.count()&&0===this.incoming.count()},Module.prototype.isPredefined=function(){return void 0!==this.definition},Module}();exports.Module=Module;var ModuleSet=function(){function ModuleSet(){this.table={}}return ModuleSet.prototype.count=function(){return Object.keys(this.table).length},ModuleSet.prototype.intersection=function(other){var result=new ModuleSet;return result.table=function intersection(m,n){var i={};for(var v in m)v in n&&(i[v]=m[v]);return i}(this.table,other.table),result},ModuleSet.prototype.intersectionCount=function(other){return this.intersection(other).count()},ModuleSet.prototype.contains=function(id){return id in this.table},ModuleSet.prototype.add=function(m){this.table[m.id]=m},ModuleSet.prototype.remove=function(m){delete this.table[m.id]},ModuleSet.prototype.forAll=function(f){for(var mid in this.table)f(this.table[mid])},ModuleSet.prototype.modules=function(){var vs=[];return this.forAll((function(m){m.isPredefined()||vs.push(m)})),vs},ModuleSet}();exports.ModuleSet=ModuleSet;var LinkSets=function(){function LinkSets(){this.sets={},this.n=0}return LinkSets.prototype.count=function(){return this.n},LinkSets.prototype.contains=function(id){var result=!1;return this.forAllModules((function(m){result||m.id!=id||(result=!0)})),result},LinkSets.prototype.add=function(linktype,m){(linktype in this.sets?this.sets[linktype]:this.sets[linktype]=new ModuleSet).add(m),++this.n},LinkSets.prototype.remove=function(linktype,m){var ms=this.sets[linktype];ms.remove(m),0===ms.count()&&delete this.sets[linktype],--this.n},LinkSets.prototype.forAll=function(f){for(var linktype in this.sets)f(this.sets[linktype],Number(linktype))},LinkSets.prototype.forAllModules=function(f){this.forAll((function(ms,lt){return ms.forAll(f)}))},LinkSets.prototype.intersection=function(other){var result=new LinkSets;return this.forAll((function(ms,lt){if(lt in other.sets){var i=ms.intersection(other.sets[lt]),n=i.count();n>0&&(result.sets[lt]=i,result.n+=n)}})),result},LinkSets}();exports.LinkSets=LinkSets,exports.getGroups=function getGroups(nodes,links,la,rootGroup){for(var n=nodes.length,c=new Configuration(n,links,la,rootGroup);c.greedyMerge(););var powerEdges=[],g=c.getGroupHierarchy(powerEdges);return powerEdges.forEach((function(e){var f=function f(end){var g=e[end];"number"==typeof g&&(e[end]=nodes[g])};f("source"),f("target")})),{groups:g,powerEdges:powerEdges}}})),linklengths=createCommonjsModule((function(module,exports){function unionCount(a,b){var u={};for(var i in a)u[i]={};for(var i in b)u[i]={};return Object.keys(u).length}function intersectionCount(a,b){var n=0;for(var i in a)void 0!==b[i]&&++n;return n}function computeLinkLengths(links,w,f,la){var neighbours=function getNeighbours(links,la){var neighbours={},addNeighbours=function addNeighbours(u,v){void 0===neighbours[u]&&(neighbours[u]={}),neighbours[u][v]={}};return links.forEach((function(e){var u=la.getSourceIndex(e),v=la.getTargetIndex(e);addNeighbours(u,v),addNeighbours(v,u)})),neighbours}(links,la);links.forEach((function(l){var a=neighbours[la.getSourceIndex(l)],b=neighbours[la.getTargetIndex(l)];la.setLength(l,1+w*f(a,b))}))}function stronglyConnectedComponents(numVertices,edges,la){var nodes=[],index=0,stack=[],components=[];function strongConnect(v){v.index=v.lowlink=index++,stack.push(v),v.onStack=!0;for(var _i=0,_a=v.out;_i<_a.length;_i++){var w=_a[_i];void 0===w.index?(strongConnect(w),v.lowlink=Math.min(v.lowlink,w.lowlink)):w.onStack&&(v.lowlink=Math.min(v.lowlink,w.index))}if(v.lowlink===v.index){for(var component=[];stack.length&&((w=stack.pop()).onStack=!1,component.push(w),w!==v););components.push(component.map((function(v){return v.id})))}}for(var i=0;i<numVertices;i++)nodes.push({id:i,out:[]});for(var _i=0,edges_1=edges;_i<edges_1.length;_i++){var e=edges_1[_i],v_1=nodes[la.getSourceIndex(e)],w=nodes[la.getTargetIndex(e)];v_1.out.push(w)}for(var _a=0,nodes_1=nodes;_a<nodes_1.length;_a++){var v=nodes_1[_a];void 0===v.index&&strongConnect(v)}return components}Object.defineProperty(exports,"__esModule",{value:!0}),exports.symmetricDiffLinkLengths=function symmetricDiffLinkLengths(links,la,w){void 0===w&&(w=1),computeLinkLengths(links,w,(function(a,b){return Math.sqrt(unionCount(a,b)-intersectionCount(a,b))}),la)},exports.jaccardLinkLengths=function jaccardLinkLengths(links,la,w){void 0===w&&(w=1),computeLinkLengths(links,w,(function(a,b){return Math.min(Object.keys(a).length,Object.keys(b).length)<1.1?0:intersectionCount(a,b)/unionCount(a,b)}),la)},exports.generateDirectedEdgeConstraints=function generateDirectedEdgeConstraints(n,links,axis,la){var components=stronglyConnectedComponents(n,links,la),nodes={};components.forEach((function(c,i){return c.forEach((function(v){return nodes[v]=i}))}));var constraints=[];return links.forEach((function(l){var ui=la.getSourceIndex(l),vi=la.getTargetIndex(l);nodes[ui]!==nodes[vi]&&constraints.push({axis:axis,left:ui,right:vi,gap:la.getMinSeparation(l)})})),constraints},exports.stronglyConnectedComponents=stronglyConnectedComponents})),descent=createCommonjsModule((function(module,exports){Object.defineProperty(exports,"__esModule",{value:!0});var Locks=function(){function Locks(){this.locks={}}return Locks.prototype.add=function(id,x){this.locks[id]=x},Locks.prototype.clear=function(){this.locks={}},Locks.prototype.isEmpty=function(){for(var l in this.locks)return!1;return!0},Locks.prototype.apply=function(f){for(var l in this.locks)f(Number(l),this.locks[l])},Locks}();exports.Locks=Locks;var Descent=function(){function Descent(x,D,G){void 0===G&&(G=null),this.D=D,this.G=G,this.threshold=1e-4,this.numGridSnapNodes=0,this.snapGridSize=100,this.snapStrength=1e3,this.scaleSnapByMaxH=!1,this.random=new PseudoRandom,this.project=null,this.x=x,this.k=x.length;var n=this.n=x[0].length;this.H=new Array(this.k),this.g=new Array(this.k),this.Hd=new Array(this.k),this.a=new Array(this.k),this.b=new Array(this.k),this.c=new Array(this.k),this.d=new Array(this.k),this.e=new Array(this.k),this.ia=new Array(this.k),this.ib=new Array(this.k),this.xtmp=new Array(this.k),this.locks=new Locks,this.minD=Number.MAX_VALUE;for(var j,i=n;i--;)for(j=n;--j>i;){var d=D[i][j];d>0&&d<this.minD&&(this.minD=d)}for(this.minD===Number.MAX_VALUE&&(this.minD=1),i=this.k;i--;){for(this.g[i]=new Array(n),this.H[i]=new Array(n),j=n;j--;)this.H[i][j]=new Array(n);this.Hd[i]=new Array(n),this.a[i]=new Array(n),this.b[i]=new Array(n),this.c[i]=new Array(n),this.d[i]=new Array(n),this.e[i]=new Array(n),this.ia[i]=new Array(n),this.ib[i]=new Array(n),this.xtmp[i]=new Array(n)}}return Descent.createSquareMatrix=function(n,f){for(var M=new Array(n),i=0;i<n;++i){M[i]=new Array(n);for(var j=0;j<n;++j)M[i][j]=f(i,j)}return M},Descent.prototype.offsetDir=function(){for(var _this=this,u=new Array(this.k),l=0,i=0;i<this.k;++i){var x=u[i]=this.random.getNextBetween(.01,1)-.5;l+=x*x}return l=Math.sqrt(l),u.map((function(x){return x*(_this.minD/l)}))},Descent.prototype.computeDerivatives=function(x){var _this=this,n=this.n;if(!(n<1)){for(var i,d=new Array(this.k),d2=new Array(this.k),Huu=new Array(this.k),maxH=0,u=0;u<n;++u){for(i=0;i<this.k;++i)Huu[i]=this.g[i][u]=0;for(var v=0;v<n;++v)if(u!==v){for(var maxDisplaces=n;maxDisplaces--;){var sd2=0;for(i=0;i<this.k;++i){var dx=d[i]=x[i][u]-x[i][v];sd2+=d2[i]=dx*dx}if(sd2>1e-9)break;var rd=this.offsetDir();for(i=0;i<this.k;++i)x[i][v]+=rd[i]}var l=Math.sqrt(sd2),D=this.D[u][v],weight=null!=this.G?this.G[u][v]:1;if(weight>1&&l>D||!isFinite(D))for(i=0;i<this.k;++i)this.H[i][u][v]=0;else{weight>1&&(weight=1);var D2=D*D,gs=2*weight*(l-D)/(D2*l),l3=l*l*l,hs=2*-weight/(D2*l3);for(isFinite(gs)||console.log(gs),i=0;i<this.k;++i)this.g[i][u]+=d[i]*gs,Huu[i]-=this.H[i][u][v]=hs*(l3+D*(d2[i]-sd2)+l*sd2)}}for(i=0;i<this.k;++i)maxH=Math.max(maxH,this.H[i][u][u]=Huu[i])}var r=this.snapGridSize/2,g=this.snapGridSize,k=this.snapStrength/(r*r),numNodes=this.numGridSnapNodes;for(u=0;u<numNodes;++u)for(i=0;i<this.k;++i){var xiu=this.x[i][u],m=xiu/g,f=m%1,q=m-f;-r<(dx=Math.abs(f)<=.5?xiu-q*g:xiu>0?xiu-(q+1)*g:xiu-(q-1)*g)&&dx<=r&&(this.scaleSnapByMaxH?(this.g[i][u]+=maxH*k*dx,this.H[i][u][u]+=maxH*k):(this.g[i][u]+=k*dx,this.H[i][u][u]+=k))}this.locks.isEmpty()||this.locks.apply((function(u,p){for(i=0;i<_this.k;++i)_this.H[i][u][u]+=maxH,_this.g[i][u]-=maxH*(p[i]-x[i][u])}))}},Descent.dotProd=function(a,b){for(var x=0,i=a.length;i--;)x+=a[i]*b[i];return x},Descent.rightMultiply=function(m,v,r){for(var i=m.length;i--;)r[i]=Descent.dotProd(m[i],v)},Descent.prototype.computeStepSize=function(d){for(var numerator=0,denominator=0,i=0;i<this.k;++i)numerator+=Descent.dotProd(this.g[i],d[i]),Descent.rightMultiply(this.H[i],d[i],this.Hd[i]),denominator+=Descent.dotProd(d[i],this.Hd[i]);return 0!==denominator&&isFinite(denominator)?1*numerator/denominator:0},Descent.prototype.reduceStress=function(){this.computeDerivatives(this.x);for(var alpha=this.computeStepSize(this.g),i=0;i<this.k;++i)this.takeDescentStep(this.x[i],this.g[i],alpha);return this.computeStress()},Descent.copy=function(a,b){for(var m=a.length,n=b[0].length,i=0;i<m;++i)for(var j=0;j<n;++j)b[i][j]=a[i][j]},Descent.prototype.stepAndProject=function(x0,r,d,stepSize){Descent.copy(x0,r),this.takeDescentStep(r[0],d[0],stepSize),this.project&&this.project[0](x0[0],x0[1],r[0]),this.takeDescentStep(r[1],d[1],stepSize),this.project&&this.project[1](r[0],x0[1],r[1]);for(var i=2;i<this.k;i++)this.takeDescentStep(r[i],d[i],stepSize)},Descent.mApply=function(m,n,f){for(var i=m;i-- >0;)for(var j=n;j-- >0;)f(i,j)},Descent.prototype.matrixApply=function(f){Descent.mApply(this.k,this.n,f)},Descent.prototype.computeNextPosition=function(x0,r){var _this=this;this.computeDerivatives(x0);var alpha=this.computeStepSize(this.g);if(this.stepAndProject(x0,r,this.g,alpha),this.project){this.matrixApply((function(i,j){return _this.e[i][j]=x0[i][j]-r[i][j]}));var beta=this.computeStepSize(this.e);beta=Math.max(.2,Math.min(beta,1)),this.stepAndProject(x0,r,this.e,beta)}},Descent.prototype.run=function(iterations){for(var stress=Number.MAX_VALUE,converged=!1;!converged&&iterations-- >0;){var s=this.rungeKutta();converged=Math.abs(stress/s-1)<this.threshold,stress=s}return stress},Descent.prototype.rungeKutta=function(){var _this=this;this.computeNextPosition(this.x,this.a),Descent.mid(this.x,this.a,this.ia),this.computeNextPosition(this.ia,this.b),Descent.mid(this.x,this.b,this.ib),this.computeNextPosition(this.ib,this.c),this.computeNextPosition(this.c,this.d);var disp=0;return this.matrixApply((function(i,j){var x=(_this.a[i][j]+2*_this.b[i][j]+2*_this.c[i][j]+_this.d[i][j])/6,d=_this.x[i][j]-x;disp+=d*d,_this.x[i][j]=x})),disp},Descent.mid=function(a,b,m){Descent.mApply(a.length,a[0].length,(function(i,j){return m[i][j]=a[i][j]+(b[i][j]-a[i][j])/2}))},Descent.prototype.takeDescentStep=function(x,d,stepSize){for(var i=0;i<this.n;++i)x[i]=x[i]-stepSize*d[i]},Descent.prototype.computeStress=function(){for(var stress=0,u=0,nMinus1=this.n-1;u<nMinus1;++u)for(var v=u+1,n=this.n;v<n;++v){for(var l=0,i=0;i<this.k;++i){var dx=this.x[i][u]-this.x[i][v];l+=dx*dx}l=Math.sqrt(l);var d=this.D[u][v];if(isFinite(d)){var rl=d-l;stress+=rl*rl/(d*d)}}return stress},Descent.zeroDistance=1e-10,Descent}();exports.Descent=Descent;var PseudoRandom=function(){function PseudoRandom(seed){void 0===seed&&(seed=1),this.seed=seed,this.a=214013,this.c=2531011,this.m=2147483648,this.range=32767}return PseudoRandom.prototype.getNext=function(){return this.seed=(this.seed*this.a+this.c)%this.m,(this.seed>>16)/this.range},PseudoRandom.prototype.getNextBetween=function(min,max){return min+this.getNext()*(max-min)},PseudoRandom}();exports.PseudoRandom=PseudoRandom})),vpsc=createCommonjsModule((function(module,exports){Object.defineProperty(exports,"__esModule",{value:!0});var PositionStats=function(){function PositionStats(scale){this.scale=scale,this.AB=0,this.AD=0,this.A2=0}return PositionStats.prototype.addVariable=function(v){var ai=this.scale/v.scale,bi=v.offset/v.scale,wi=v.weight;this.AB+=wi*ai*bi,this.AD+=wi*ai*v.desiredPosition,this.A2+=wi*ai*ai},PositionStats.prototype.getPosn=function(){return(this.AD-this.AB)/this.A2},PositionStats}();exports.PositionStats=PositionStats;var Constraint=function(){function Constraint(left,right,gap,equality){void 0===equality&&(equality=!1),this.left=left,this.right=right,this.gap=gap,this.equality=equality,this.active=!1,this.unsatisfiable=!1,this.left=left,this.right=right,this.gap=gap,this.equality=equality}return Constraint.prototype.slack=function(){return this.unsatisfiable?Number.MAX_VALUE:this.right.scale*this.right.position()-this.gap-this.left.scale*this.left.position()},Constraint}();exports.Constraint=Constraint;var Variable=function(){function Variable(desiredPosition,weight,scale){void 0===weight&&(weight=1),void 0===scale&&(scale=1),this.desiredPosition=desiredPosition,this.weight=weight,this.scale=scale,this.offset=0}return Variable.prototype.dfdv=function(){return 2*this.weight*(this.position()-this.desiredPosition)},Variable.prototype.position=function(){return(this.block.ps.scale*this.block.posn+this.offset)/this.scale},Variable.prototype.visitNeighbours=function(prev,f){var ff=function ff(c,next){return c.active&&prev!==next&&f(c,next)};this.cOut.forEach((function(c){return ff(c,c.right)})),this.cIn.forEach((function(c){return ff(c,c.left)}))},Variable}();exports.Variable=Variable;var Block=function(){function Block(v){this.vars=[],v.offset=0,this.ps=new PositionStats(v.scale),this.addVariable(v)}return Block.prototype.addVariable=function(v){v.block=this,this.vars.push(v),this.ps.addVariable(v),this.posn=this.ps.getPosn()},Block.prototype.updateWeightedPosition=function(){this.ps.AB=this.ps.AD=this.ps.A2=0;for(var i=0,n=this.vars.length;i<n;++i)this.ps.addVariable(this.vars[i]);this.posn=this.ps.getPosn()},Block.prototype.compute_lm=function(v,u,postAction){var _this=this,dfdv=v.dfdv();return v.visitNeighbours(u,(function(c,next){var _dfdv=_this.compute_lm(next,v,postAction);next===c.right?(dfdv+=_dfdv*c.left.scale,c.lm=_dfdv):(dfdv+=_dfdv*c.right.scale,c.lm=-_dfdv),postAction(c)})),dfdv/v.scale},Block.prototype.populateSplitBlock=function(v,prev){var _this=this;v.visitNeighbours(prev,(function(c,next){next.offset=v.offset+(next===c.right?c.gap:-c.gap),_this.addVariable(next),_this.populateSplitBlock(next,v)}))},Block.prototype.traverse=function(visit,acc,v,prev){var _this=this;void 0===v&&(v=this.vars[0]),void 0===prev&&(prev=null),v.visitNeighbours(prev,(function(c,next){acc.push(visit(c)),_this.traverse(visit,acc,next,v)}))},Block.prototype.findMinLM=function(){var m=null;return this.compute_lm(this.vars[0],null,(function(c){!c.equality&&(null===m||c.lm<m.lm)&&(m=c)})),m},Block.prototype.findMinLMBetween=function(lv,rv){this.compute_lm(lv,null,(function(){}));var m=null;return this.findPath(lv,null,rv,(function(c,next){!c.equality&&c.right===next&&(null===m||c.lm<m.lm)&&(m=c)})),m},Block.prototype.findPath=function(v,prev,to,visit){var _this=this,endFound=!1;return v.visitNeighbours(prev,(function(c,next){endFound||next!==to&&!_this.findPath(next,v,to,visit)||(endFound=!0,visit(c,next))})),endFound},Block.prototype.isActiveDirectedPathBetween=function(u,v){if(u===v)return!0;for(var i=u.cOut.length;i--;){var c=u.cOut[i];if(c.active&&this.isActiveDirectedPathBetween(c.right,v))return!0}return!1},Block.split=function(c){return c.active=!1,[Block.createSplitBlock(c.left),Block.createSplitBlock(c.right)]},Block.createSplitBlock=function(startVar){var b=new Block(startVar);return b.populateSplitBlock(startVar,null),b},Block.prototype.splitBetween=function(vl,vr){var c=this.findMinLMBetween(vl,vr);if(null!==c){var bs=Block.split(c);return{constraint:c,lb:bs[0],rb:bs[1]}}return null},Block.prototype.mergeAcross=function(b,c,dist){c.active=!0;for(var i=0,n=b.vars.length;i<n;++i){var v=b.vars[i];v.offset+=dist,this.addVariable(v)}this.posn=this.ps.getPosn()},Block.prototype.cost=function(){for(var sum=0,i=this.vars.length;i--;){var v=this.vars[i],d=v.position()-v.desiredPosition;sum+=d*d*v.weight}return sum},Block}();exports.Block=Block;var Blocks=function(){function Blocks(vs){this.vs=vs;var n=vs.length;for(this.list=new Array(n);n--;){var b=new Block(vs[n]);this.list[n]=b,b.blockInd=n}}return Blocks.prototype.cost=function(){for(var sum=0,i=this.list.length;i--;)sum+=this.list[i].cost();return sum},Blocks.prototype.insert=function(b){b.blockInd=this.list.length,this.list.push(b)},Blocks.prototype.remove=function(b){var last=this.list.length-1,swapBlock=this.list[last];this.list.length=last,b!==swapBlock&&(this.list[b.blockInd]=swapBlock,swapBlock.blockInd=b.blockInd)},Blocks.prototype.merge=function(c){var l=c.left.block,r=c.right.block,dist=c.right.offset-c.left.offset-c.gap;l.vars.length<r.vars.length?(r.mergeAcross(l,c,dist),this.remove(l)):(l.mergeAcross(r,c,-dist),this.remove(r))},Blocks.prototype.forEach=function(f){this.list.forEach(f)},Blocks.prototype.updateBlockPositions=function(){this.list.forEach((function(b){return b.updateWeightedPosition()}))},Blocks.prototype.split=function(inactive){var _this=this;this.updateBlockPositions(),this.list.forEach((function(b){var v=b.findMinLM();null!==v&&v.lm<Solver.LAGRANGIAN_TOLERANCE&&(b=v.left.block,Block.split(v).forEach((function(nb){return _this.insert(nb)})),_this.remove(b),inactive.push(v))}))},Blocks}();exports.Blocks=Blocks;var Solver=function(){function Solver(vs,cs){this.vs=vs,this.cs=cs,this.vs=vs,vs.forEach((function(v){v.cIn=[],v.cOut=[]})),this.cs=cs,cs.forEach((function(c){c.left.cOut.push(c),c.right.cIn.push(c)})),this.inactive=cs.map((function(c){return c.active=!1,c})),this.bs=null}return Solver.prototype.cost=function(){return this.bs.cost()},Solver.prototype.setStartingPositions=function(ps){this.inactive=this.cs.map((function(c){return c.active=!1,c})),this.bs=new Blocks(this.vs),this.bs.forEach((function(b,i){return b.posn=ps[i]}))},Solver.prototype.setDesiredPositions=function(ps){this.vs.forEach((function(v,i){return v.desiredPosition=ps[i]}))},Solver.prototype.mostViolated=function(){for(var minSlack=Number.MAX_VALUE,v=null,l=this.inactive,n=l.length,deletePoint=n,i=0;i<n;++i){var c=l[i];if(!c.unsatisfiable){var slack=c.slack();if((c.equality||slack<minSlack)&&(minSlack=slack,v=c,deletePoint=i,c.equality))break}}return deletePoint!==n&&(minSlack<Solver.ZERO_UPPERBOUND&&!v.active||v.equality)&&(l[deletePoint]=l[n-1],l.length=n-1),v},Solver.prototype.satisfy=function(){null==this.bs&&(this.bs=new Blocks(this.vs)),this.bs.split(this.inactive);for(var v=null;(v=this.mostViolated())&&(v.equality||v.slack()<Solver.ZERO_UPPERBOUND&&!v.active);){var lb=v.left.block;if(lb!==v.right.block)this.bs.merge(v);else{if(lb.isActiveDirectedPathBetween(v.right,v.left)){v.unsatisfiable=!0;continue}var split=lb.splitBetween(v.left,v.right);if(null===split){v.unsatisfiable=!0;continue}this.bs.insert(split.lb),this.bs.insert(split.rb),this.bs.remove(lb),this.inactive.push(split.constraint),v.slack()>=0?this.inactive.push(v):this.bs.merge(v)}}},Solver.prototype.solve=function(){this.satisfy();for(var lastcost=Number.MAX_VALUE,cost=this.bs.cost();Math.abs(lastcost-cost)>1e-4;)this.satisfy(),lastcost=cost,cost=this.bs.cost();return cost},Solver.LAGRANGIAN_TOLERANCE=-1e-4,Solver.ZERO_UPPERBOUND=-1e-10,Solver}();exports.Solver=Solver,exports.removeOverlapInOneDimension=function removeOverlapInOneDimension(spans,lowerBound,upperBound){for(var vs=spans.map((function(s){return new Variable(s.desiredCenter)})),cs=[],n=spans.length,i=0;i<n-1;i++){var left=spans[i],right=spans[i+1];cs.push(new Constraint(vs[i],vs[i+1],(left.size+right.size)/2))}var leftMost=vs[0],rightMost=vs[n-1],leftMostSize=spans[0].size/2,rightMostSize=spans[n-1].size/2,vLower=null,vUpper=null;return lowerBound&&(vLower=new Variable(lowerBound,1e3*leftMost.weight),vs.push(vLower),cs.push(new Constraint(vLower,leftMost,leftMostSize))),upperBound&&(vUpper=new Variable(upperBound,1e3*rightMost.weight),vs.push(vUpper),cs.push(new Constraint(rightMost,vUpper,rightMostSize))),new Solver(vs,cs).solve(),{newCenters:vs.slice(0,spans.length).map((function(v){return v.position()})),lowerBound:vLower?vLower.position():leftMost.position()-leftMostSize,upperBound:vUpper?vUpper.position():rightMost.position()+rightMostSize}}})),rbtree=createCommonjsModule((function(module,exports){var _extendStatics,__extends=commonjsGlobal&&commonjsGlobal.__extends||(_extendStatics=function extendStatics(d,b){return(_extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)},function(d,b){function __(){this.constructor=d}_extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)});Object.defineProperty(exports,"__esModule",{value:!0});var TreeBase=function(){function TreeBase(){this.findIter=function(data){for(var res=this._root,iter=this.iterator();null!==res;){var c=this._comparator(data,res.data);if(0===c)return iter._cursor=res,iter;iter._ancestors.push(res),res=res.get_child(c>0)}return null}}return TreeBase.prototype.clear=function(){this._root=null,this.size=0},TreeBase.prototype.find=function(data){for(var res=this._root;null!==res;){var c=this._comparator(data,res.data);if(0===c)return res.data;res=res.get_child(c>0)}return null},TreeBase.prototype.lowerBound=function(data){return this._bound(data,this._comparator)},TreeBase.prototype.upperBound=function(data){var cmp=this._comparator;return this._bound(data,(function reverse_cmp(a,b){return cmp(b,a)}))},TreeBase.prototype.min=function(){var res=this._root;if(null===res)return null;for(;null!==res.left;)res=res.left;return res.data},TreeBase.prototype.max=function(){var res=this._root;if(null===res)return null;for(;null!==res.right;)res=res.right;return res.data},TreeBase.prototype.iterator=function(){return new Iterator(this)},TreeBase.prototype.each=function(cb){for(var data,it=this.iterator();null!==(data=it.next());)cb(data)},TreeBase.prototype.reach=function(cb){for(var data,it=this.iterator();null!==(data=it.prev());)cb(data)},TreeBase.prototype._bound=function(data,cmp){for(var cur=this._root,iter=this.iterator();null!==cur;){var c=this._comparator(data,cur.data);if(0===c)return iter._cursor=cur,iter;iter._ancestors.push(cur),cur=cur.get_child(c>0)}for(var i=iter._ancestors.length-1;i>=0;--i)if(cmp(data,(cur=iter._ancestors[i]).data)>0)return iter._cursor=cur,iter._ancestors.length=i,iter;return iter._ancestors.length=0,iter},TreeBase}();exports.TreeBase=TreeBase;var Iterator=function(){function Iterator(tree){this._tree=tree,this._ancestors=[],this._cursor=null}return Iterator.prototype.data=function(){return null!==this._cursor?this._cursor.data:null},Iterator.prototype.next=function(){if(null===this._cursor){var root=this._tree._root;null!==root&&this._minNode(root)}else{var save;if(null===this._cursor.right)do{if(save=this._cursor,!this._ancestors.length){this._cursor=null;break}this._cursor=this._ancestors.pop()}while(this._cursor.right===save);else this._ancestors.push(this._cursor),this._minNode(this._cursor.right)}return null!==this._cursor?this._cursor.data:null},Iterator.prototype.prev=function(){if(null===this._cursor){var root=this._tree._root;null!==root&&this._maxNode(root)}else{var save;if(null===this._cursor.left)do{if(save=this._cursor,!this._ancestors.length){this._cursor=null;break}this._cursor=this._ancestors.pop()}while(this._cursor.left===save);else this._ancestors.push(this._cursor),this._maxNode(this._cursor.left)}return null!==this._cursor?this._cursor.data:null},Iterator.prototype._minNode=function(start){for(;null!==start.left;)this._ancestors.push(start),start=start.left;this._cursor=start},Iterator.prototype._maxNode=function(start){for(;null!==start.right;)this._ancestors.push(start),start=start.right;this._cursor=start},Iterator}();exports.Iterator=Iterator;var Node=function(){function Node(data){this.data=data,this.left=null,this.right=null,this.red=!0}return Node.prototype.get_child=function(dir){return dir?this.right:this.left},Node.prototype.set_child=function(dir,val){dir?this.right=val:this.left=val},Node}(),RBTree=function(_super){function RBTree(comparator){var _this=_super.call(this)||this;return _this._root=null,_this._comparator=comparator,_this.size=0,_this}return __extends(RBTree,_super),RBTree.prototype.insert=function(data){var ret=!1;if(null===this._root)this._root=new Node(data),ret=!0,this.size++;else{var head=new Node(void 0),dir=!1,last=!1,gp=null,ggp=head,p=null,node=this._root;for(ggp.right=this._root;;){if(null===node?(node=new Node(data),p.set_child(dir,node),ret=!0,this.size++):RBTree.is_red(node.left)&&RBTree.is_red(node.right)&&(node.red=!0,node.left.red=!1,node.right.red=!1),RBTree.is_red(node)&&RBTree.is_red(p)){var dir2=ggp.right===gp;node===p.get_child(last)?ggp.set_child(dir2,RBTree.single_rotate(gp,!last)):ggp.set_child(dir2,RBTree.double_rotate(gp,!last))}var cmp=this._comparator(node.data,data);if(0===cmp)break;last=dir,dir=cmp<0,null!==gp&&(ggp=gp),gp=p,p=node,node=node.get_child(dir)}this._root=head.right}return this._root.red=!1,ret},RBTree.prototype.remove=function(data){if(null===this._root)return!1;var head=new Node(void 0),node=head;node.right=this._root;for(var p=null,gp=null,found=null,dir=!0;null!==node.get_child(dir);){var last=dir;gp=p,p=node,node=node.get_child(dir);var cmp=this._comparator(data,node.data);if(dir=cmp>0,0===cmp&&(found=node),!RBTree.is_red(node)&&!RBTree.is_red(node.get_child(dir)))if(RBTree.is_red(node.get_child(!dir))){var sr=RBTree.single_rotate(node,dir);p.set_child(last,sr),p=sr}else if(!RBTree.is_red(node.get_child(!dir))){var sibling=p.get_child(!last);if(null!==sibling)if(RBTree.is_red(sibling.get_child(!last))||RBTree.is_red(sibling.get_child(last))){var dir2=gp.right===p;RBTree.is_red(sibling.get_child(last))?gp.set_child(dir2,RBTree.double_rotate(p,last)):RBTree.is_red(sibling.get_child(!last))&&gp.set_child(dir2,RBTree.single_rotate(p,last));var gpc=gp.get_child(dir2);gpc.red=!0,node.red=!0,gpc.left.red=!1,gpc.right.red=!1}else p.red=!1,sibling.red=!0,node.red=!0}}return null!==found&&(found.data=node.data,p.set_child(p.right===node,node.get_child(null===node.left)),this.size--),this._root=head.right,null!==this._root&&(this._root.red=!1),null!==found},RBTree.is_red=function(node){return null!==node&&node.red},RBTree.single_rotate=function(root,dir){var save=root.get_child(!dir);return root.set_child(!dir,save.get_child(dir)),save.set_child(dir,root),root.red=!0,save.red=!1,save},RBTree.double_rotate=function(root,dir){return root.set_child(!dir,RBTree.single_rotate(root.get_child(!dir),!dir)),RBTree.single_rotate(root,dir)},RBTree}(TreeBase);exports.RBTree=RBTree})),rectangle=createCommonjsModule((function(module,exports){var _extendStatics2,__extends=commonjsGlobal&&commonjsGlobal.__extends||(_extendStatics2=function extendStatics(d,b){return(_extendStatics2=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)},function(d,b){function __(){this.constructor=d}_extendStatics2(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)});function computeGroupBounds(g){return g.bounds=void 0!==g.leaves?g.leaves.reduce((function(r,c){return c.bounds.union(r)}),Rectangle.empty()):Rectangle.empty(),void 0!==g.groups&&(g.bounds=g.groups.reduce((function(r,c){return computeGroupBounds(c).union(r)}),g.bounds)),g.bounds=g.bounds.inflate(g.padding),g.bounds}Object.defineProperty(exports,"__esModule",{value:!0}),exports.computeGroupBounds=computeGroupBounds;var Rectangle=function(){function Rectangle(x,X,y,Y){this.x=x,this.X=X,this.y=y,this.Y=Y}return Rectangle.empty=function(){return new Rectangle(Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY)},Rectangle.prototype.cx=function(){return(this.x+this.X)/2},Rectangle.prototype.cy=function(){return(this.y+this.Y)/2},Rectangle.prototype.overlapX=function(r){var ux=this.cx(),vx=r.cx();return ux<=vx&&r.x<this.X?this.X-r.x:vx<=ux&&this.x<r.X?r.X-this.x:0},Rectangle.prototype.overlapY=function(r){var uy=this.cy(),vy=r.cy();return uy<=vy&&r.y<this.Y?this.Y-r.y:vy<=uy&&this.y<r.Y?r.Y-this.y:0},Rectangle.prototype.setXCentre=function(cx){var dx=cx-this.cx();this.x+=dx,this.X+=dx},Rectangle.prototype.setYCentre=function(cy){var dy=cy-this.cy();this.y+=dy,this.Y+=dy},Rectangle.prototype.width=function(){return this.X-this.x},Rectangle.prototype.height=function(){return this.Y-this.y},Rectangle.prototype.union=function(r){return new Rectangle(Math.min(this.x,r.x),Math.max(this.X,r.X),Math.min(this.y,r.y),Math.max(this.Y,r.Y))},Rectangle.prototype.lineIntersections=function(x1,y1,x2,y2){for(var sides=[[this.x,this.y,this.X,this.y],[this.X,this.y,this.X,this.Y],[this.X,this.Y,this.x,this.Y],[this.x,this.Y,this.x,this.y]],intersections=[],i=0;i<4;++i){var r=Rectangle.lineIntersection(x1,y1,x2,y2,sides[i][0],sides[i][1],sides[i][2],sides[i][3]);null!==r&&intersections.push({x:r.x,y:r.y})}return intersections},Rectangle.prototype.rayIntersection=function(x2,y2){var ints=this.lineIntersections(this.cx(),this.cy(),x2,y2);return ints.length>0?ints[0]:null},Rectangle.prototype.vertices=function(){return[{x:this.x,y:this.y},{x:this.X,y:this.y},{x:this.X,y:this.Y},{x:this.x,y:this.Y}]},Rectangle.lineIntersection=function(x1,y1,x2,y2,x3,y3,x4,y4){var dx12=x2-x1,dx34=x4-x3,dy12=y2-y1,dy34=y4-y3,denominator=dy34*dx12-dx34*dy12;if(0==denominator)return null;var dx31=x1-x3,dy31=y1-y3,a=(dx34*dy31-dy34*dx31)/denominator,b=(dx12*dy31-dy12*dx31)/denominator;return a>=0&&a<=1&&b>=0&&b<=1?{x:x1+a*dx12,y:y1+a*dy12}:null},Rectangle.prototype.inflate=function(pad){return new Rectangle(this.x-pad,this.X+pad,this.y-pad,this.Y+pad)},Rectangle}();exports.Rectangle=Rectangle,exports.makeEdgeBetween=function makeEdgeBetween(source,target,ah){var si=source.rayIntersection(target.cx(),target.cy())||{x:source.cx(),y:source.cy()},ti=target.rayIntersection(source.cx(),source.cy())||{x:target.cx(),y:target.cy()},dx=ti.x-si.x,dy=ti.y-si.y,l=Math.sqrt(dx*dx+dy*dy),al=l-ah;return{sourceIntersection:si,targetIntersection:ti,arrowStart:{x:si.x+al*dx/l,y:si.y+al*dy/l}}},exports.makeEdgeTo=function makeEdgeTo(s,target,ah){var ti=target.rayIntersection(s.x,s.y);ti||(ti={x:target.cx(),y:target.cy()});var dx=ti.x-s.x,dy=ti.y-s.y,l=Math.sqrt(dx*dx+dy*dy);return{x:ti.x-ah*dx/l,y:ti.y-ah*dy/l}};var Node=function Node(v,r,pos){this.v=v,this.r=r,this.pos=pos,this.prev=makeRBTree(),this.next=makeRBTree()},Event=function Event(isOpen,v,pos){this.isOpen=isOpen,this.v=v,this.pos=pos};function compareEvents(a,b){return a.pos>b.pos?1:a.pos<b.pos||a.isOpen?-1:b.isOpen?1:0}function makeRBTree(){return new rbtree.RBTree((function(a,b){return a.pos-b.pos}))}var xRect={getCentre:function getCentre(r){return r.cx()},getOpen:function getOpen(r){return r.y},getClose:function getClose(r){return r.Y},getSize:function getSize(r){return r.width()},makeRect:function makeRect(open,close,center,size){return new Rectangle(center-size/2,center+size/2,open,close)},findNeighbours:function findXNeighbours(v,scanline){var f=function f(forward,reverse){for(var u,it=scanline.findIter(v);null!==(u=it[forward]());){var uovervX=u.r.overlapX(v.r);if((uovervX<=0||uovervX<=u.r.overlapY(v.r))&&(v[forward].insert(u),u[reverse].insert(v)),uovervX<=0)break}};f("next","prev"),f("prev","next")}},yRect={getCentre:function getCentre(r){return r.cy()},getOpen:function getOpen(r){return r.x},getClose:function getClose(r){return r.X},getSize:function getSize(r){return r.height()},makeRect:function makeRect(open,close,center,size){return new Rectangle(open,close,center-size/2,center+size/2)},findNeighbours:function findYNeighbours(v,scanline){var f=function f(forward,reverse){var u=scanline.findIter(v)[forward]();null!==u&&u.r.overlapX(v.r)>0&&(v[forward].insert(u),u[reverse].insert(v))};f("next","prev"),f("prev","next")}};function generateGroupConstraints(root,f,minSep,isContained){void 0===isContained&&(isContained=!1);var padding=root.padding,gn=void 0!==root.groups?root.groups.length:0,ln=void 0!==root.leaves?root.leaves.length:0,childConstraints=gn?root.groups.reduce((function(ccs,g){return ccs.concat(generateGroupConstraints(g,f,minSep,!0))}),[]):[],n=(isContained?2:0)+ln+gn,vs=new Array(n),rs=new Array(n),i=0,add=function add(r,v){rs[i]=r,vs[i++]=v};if(isContained){var b=root.bounds,c=f.getCentre(b),s=f.getSize(b)/2,open=f.getOpen(b),close=f.getClose(b),min=c-s+padding/2,max=c+s-padding/2;root.minVar.desiredPosition=min,add(f.makeRect(open,close,min,padding),root.minVar),root.maxVar.desiredPosition=max,add(f.makeRect(open,close,max,padding),root.maxVar)}ln&&root.leaves.forEach((function(l){return add(l.bounds,l.variable)})),gn&&root.groups.forEach((function(g){var b=g.bounds;add(f.makeRect(f.getOpen(b),f.getClose(b),f.getCentre(b),f.getSize(b)),g.minVar)}));var cs=generateConstraints(rs,vs,f,minSep);return gn&&(vs.forEach((function(v){v.cOut=[],v.cIn=[]})),cs.forEach((function(c){c.left.cOut.push(c),c.right.cIn.push(c)})),root.groups.forEach((function(g){var gapAdjustment=(g.padding-f.getSize(g.bounds))/2;g.minVar.cIn.forEach((function(c){return c.gap+=gapAdjustment})),g.minVar.cOut.forEach((function(c){c.left=g.maxVar,c.gap+=gapAdjustment}))}))),childConstraints.concat(cs)}function generateConstraints(rs,vars,rect,minSep){var i,n=rs.length,N=2*n;console.assert(vars.length>=n);var events=new Array(N);for(i=0;i<n;++i){var r=rs[i],v=new Node(vars[i],r,rect.getCentre(r));events[i]=new Event(!0,v,rect.getOpen(r)),events[i+n]=new Event(!1,v,rect.getClose(r))}events.sort(compareEvents);var cs=new Array,scanline=makeRBTree();for(i=0;i<N;++i){var e=events[i];v=e.v;if(e.isOpen)scanline.insert(v),rect.findNeighbours(v,scanline);else{scanline.remove(v);var makeConstraint=function makeConstraint(l,r){var sep=(rect.getSize(l.r)+rect.getSize(r.r))/2+minSep;cs.push(new vpsc.Constraint(l.v,r.v,sep))},visitNeighbours=function visitNeighbours(forward,reverse,mkcon){for(var u,it=v[forward].iterator();null!==(u=it[forward]());)mkcon(u,v),u[reverse].remove(v)};visitNeighbours("prev","next",(function(u,v){return makeConstraint(u,v)})),visitNeighbours("next","prev",(function(u,v){return makeConstraint(v,u)}))}}return console.assert(0===scanline.size),cs}function generateXConstraints(rs,vars){return generateConstraints(rs,vars,xRect,1e-6)}function generateYConstraints(rs,vars){return generateConstraints(rs,vars,yRect,1e-6)}function generateXGroupConstraints(root){return generateGroupConstraints(root,xRect,1e-6)}function generateYGroupConstraints(root){return generateGroupConstraints(root,yRect,1e-6)}exports.generateXConstraints=generateXConstraints,exports.generateYConstraints=generateYConstraints,exports.generateXGroupConstraints=generateXGroupConstraints,exports.generateYGroupConstraints=generateYGroupConstraints,exports.removeOverlaps=function removeOverlaps(rs){var vs=rs.map((function(r){return new vpsc.Variable(r.cx())})),cs=generateXConstraints(rs,vs),solver=new vpsc.Solver(vs,cs);solver.solve(),vs.forEach((function(v,i){return rs[i].setXCentre(v.position())})),vs=rs.map((function(r){return new vpsc.Variable(r.cy())})),cs=generateYConstraints(rs,vs),(solver=new vpsc.Solver(vs,cs)).solve(),vs.forEach((function(v,i){return rs[i].setYCentre(v.position())}))};var IndexedVariable=function(_super){function IndexedVariable(index,w){var _this=_super.call(this,0,w)||this;return _this.index=index,_this}return __extends(IndexedVariable,_super),IndexedVariable}(vpsc.Variable);exports.IndexedVariable=IndexedVariable;var Projection=function(){function Projection(nodes,groups,rootGroup,constraints,avoidOverlaps){var _this=this;if(void 0===rootGroup&&(rootGroup=null),void 0===constraints&&(constraints=null),void 0===avoidOverlaps&&(avoidOverlaps=!1),this.nodes=nodes,this.groups=groups,this.rootGroup=rootGroup,this.avoidOverlaps=avoidOverlaps,this.variables=nodes.map((function(v,i){return v.variable=new IndexedVariable(i,1)})),constraints&&this.createConstraints(constraints),avoidOverlaps&&rootGroup&&void 0!==rootGroup.groups){nodes.forEach((function(v){if(v.width&&v.height){var w2=v.width/2,h2=v.height/2;v.bounds=new Rectangle(v.x-w2,v.x+w2,v.y-h2,v.y+h2)}else v.bounds=new Rectangle(v.x,v.x,v.y,v.y)})),computeGroupBounds(rootGroup);var i=nodes.length;groups.forEach((function(g){_this.variables[i]=g.minVar=new IndexedVariable(i++,void 0!==g.stiffness?g.stiffness:.01),_this.variables[i]=g.maxVar=new IndexedVariable(i++,void 0!==g.stiffness?g.stiffness:.01)}))}}return Projection.prototype.createSeparation=function(c){return new vpsc.Constraint(this.nodes[c.left].variable,this.nodes[c.right].variable,c.gap,void 0!==c.equality&&c.equality)},Projection.prototype.makeFeasible=function(c){var _this=this;if(this.avoidOverlaps){var axis="x",dim="width";"x"===c.axis&&(axis="y",dim="height");var vs=c.offsets.map((function(o){return _this.nodes[o.node]})).sort((function(a,b){return a[axis]-b[axis]})),p=null;vs.forEach((function(v){if(p){var nextPos=p[axis]+p[dim];nextPos>v[axis]&&(v[axis]=nextPos)}p=v}))}},Projection.prototype.createAlignment=function(c){var _this=this,u=this.nodes[c.offsets[0].node].variable;this.makeFeasible(c);var cs="x"===c.axis?this.xConstraints:this.yConstraints;c.offsets.slice(1).forEach((function(o){var v=_this.nodes[o.node].variable;cs.push(new vpsc.Constraint(u,v,o.offset,!0))}))},Projection.prototype.createConstraints=function(constraints){var _this=this,isSep=function isSep(c){return void 0===c.type||"separation"===c.type};this.xConstraints=constraints.filter((function(c){return"x"===c.axis&&isSep(c)})).map((function(c){return _this.createSeparation(c)})),this.yConstraints=constraints.filter((function(c){return"y"===c.axis&&isSep(c)})).map((function(c){return _this.createSeparation(c)})),constraints.filter((function(c){return"alignment"===c.type})).forEach((function(c){return _this.createAlignment(c)}))},Projection.prototype.setupVariablesAndBounds=function(x0,y0,desired,getDesired){this.nodes.forEach((function(v,i){v.fixed?(v.variable.weight=v.fixedWeight?v.fixedWeight:1e3,desired[i]=getDesired(v)):v.variable.weight=1;var w=(v.width||0)/2,h=(v.height||0)/2,ix=x0[i],iy=y0[i];v.bounds=new Rectangle(ix-w,ix+w,iy-h,iy+h)}))},Projection.prototype.xProject=function(x0,y0,x){(this.rootGroup||this.avoidOverlaps||this.xConstraints)&&this.project(x0,y0,x0,x,(function(v){return v.px}),this.xConstraints,generateXGroupConstraints,(function(v){return v.bounds.setXCentre(x[v.variable.index]=v.variable.position())}),(function(g){var xmin=x[g.minVar.index]=g.minVar.position(),xmax=x[g.maxVar.index]=g.maxVar.position(),p2=g.padding/2;g.bounds.x=xmin-p2,g.bounds.X=xmax+p2}))},Projection.prototype.yProject=function(x0,y0,y){(this.rootGroup||this.yConstraints)&&this.project(x0,y0,y0,y,(function(v){return v.py}),this.yConstraints,generateYGroupConstraints,(function(v){return v.bounds.setYCentre(y[v.variable.index]=v.variable.position())}),(function(g){var ymin=y[g.minVar.index]=g.minVar.position(),ymax=y[g.maxVar.index]=g.maxVar.position(),p2=g.padding/2;g.bounds.y=ymin-p2,g.bounds.Y=ymax+p2}))},Projection.prototype.projectFunctions=function(){var _this=this;return[function(x0,y0,x){return _this.xProject(x0,y0,x)},function(x0,y0,y){return _this.yProject(x0,y0,y)}]},Projection.prototype.project=function(x0,y0,start,desired,getDesired,cs,generateConstraints,updateNodeBounds,updateGroupBounds){this.setupVariablesAndBounds(x0,y0,desired,getDesired),this.rootGroup&&this.avoidOverlaps&&(computeGroupBounds(this.rootGroup),cs=cs.concat(generateConstraints(this.rootGroup))),this.solve(this.variables,cs,start,desired),this.nodes.forEach(updateNodeBounds),this.rootGroup&&this.avoidOverlaps&&(this.groups.forEach(updateGroupBounds),computeGroupBounds(this.rootGroup))},Projection.prototype.solve=function(vs,cs,starting,desired){var solver=new vpsc.Solver(vs,cs);solver.setStartingPositions(starting),solver.setDesiredPositions(desired),solver.solve()},Projection}();exports.Projection=Projection})),pqueue=createCommonjsModule((function(module,exports){Object.defineProperty(exports,"__esModule",{value:!0});var PairingHeap=function(){function PairingHeap(elem){this.elem=elem,this.subheaps=[]}return PairingHeap.prototype.toString=function(selector){for(var str="",needComma=!1,i=0;i<this.subheaps.length;++i){var subheap=this.subheaps[i];subheap.elem?(needComma&&(str+=","),str+=subheap.toString(selector),needComma=!0):needComma=!1}return""!==str&&(str="("+str+")"),(this.elem?selector(this.elem):"")+str},PairingHeap.prototype.forEach=function(f){this.empty()||(f(this.elem,this),this.subheaps.forEach((function(s){return s.forEach(f)})))},PairingHeap.prototype.count=function(){return this.empty()?0:1+this.subheaps.reduce((function(n,h){return n+h.count()}),0)},PairingHeap.prototype.min=function(){return this.elem},PairingHeap.prototype.empty=function(){return null==this.elem},PairingHeap.prototype.contains=function(h){if(this===h)return!0;for(var i=0;i<this.subheaps.length;i++)if(this.subheaps[i].contains(h))return!0;return!1},PairingHeap.prototype.isHeap=function(lessThan){var _this=this;return this.subheaps.every((function(h){return lessThan(_this.elem,h.elem)&&h.isHeap(lessThan)}))},PairingHeap.prototype.insert=function(obj,lessThan){return this.merge(new PairingHeap(obj),lessThan)},PairingHeap.prototype.merge=function(heap2,lessThan){return this.empty()?heap2:heap2.empty()?this:lessThan(this.elem,heap2.elem)?(this.subheaps.push(heap2),this):(heap2.subheaps.push(this),heap2)},PairingHeap.prototype.removeMin=function(lessThan){return this.empty()?null:this.mergePairs(lessThan)},PairingHeap.prototype.mergePairs=function(lessThan){if(0==this.subheaps.length)return new PairingHeap(null);if(1==this.subheaps.length)return this.subheaps[0];var firstPair=this.subheaps.pop().merge(this.subheaps.pop(),lessThan),remaining=this.mergePairs(lessThan);return firstPair.merge(remaining,lessThan)},PairingHeap.prototype.decreaseKey=function(subheap,newValue,setHeapNode,lessThan){var newHeap=subheap.removeMin(lessThan);subheap.elem=newHeap.elem,subheap.subheaps=newHeap.subheaps,null!==setHeapNode&&null!==newHeap.elem&&setHeapNode(subheap.elem,subheap);var pairingNode=new PairingHeap(newValue);return null!==setHeapNode&&setHeapNode(newValue,pairingNode),this.merge(pairingNode,lessThan)},PairingHeap}();exports.PairingHeap=PairingHeap;var PriorityQueue=function(){function PriorityQueue(lessThan){this.lessThan=lessThan}return PriorityQueue.prototype.top=function(){return this.empty()?null:this.root.elem},PriorityQueue.prototype.push=function(){for(var pairingNode,args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];for(var arg,i=0;arg=args[i];++i)pairingNode=new PairingHeap(arg),this.root=this.empty()?pairingNode:this.root.merge(pairingNode,this.lessThan);return pairingNode},PriorityQueue.prototype.empty=function(){return!this.root||!this.root.elem},PriorityQueue.prototype.isHeap=function(){return this.root.isHeap(this.lessThan)},PriorityQueue.prototype.forEach=function(f){this.root.forEach(f)},PriorityQueue.prototype.pop=function(){if(this.empty())return null;var obj=this.root.min();return this.root=this.root.removeMin(this.lessThan),obj},PriorityQueue.prototype.reduceKey=function(heapNode,newKey,setHeapNode){void 0===setHeapNode&&(setHeapNode=null),this.root=this.root.decreaseKey(heapNode,newKey,setHeapNode,this.lessThan)},PriorityQueue.prototype.toString=function(selector){return this.root.toString(selector)},PriorityQueue.prototype.count=function(){return this.root.count()},PriorityQueue}();exports.PriorityQueue=PriorityQueue})),shortestpaths=createCommonjsModule((function(module,exports){Object.defineProperty(exports,"__esModule",{value:!0});var Neighbour=function Neighbour(id,distance){this.id=id,this.distance=distance},Node=function Node(id){this.id=id,this.neighbours=[]},QueueEntry=function QueueEntry(node,prev,d){this.node=node,this.prev=prev,this.d=d},Calculator=function(){function Calculator(n,es,getSourceIndex,getTargetIndex,getLength){this.n=n,this.es=es,this.neighbours=new Array(this.n);for(var i=this.n;i--;)this.neighbours[i]=new Node(i);for(i=this.es.length;i--;){var e=this.es[i],u=getSourceIndex(e),v=getTargetIndex(e),d=getLength(e);this.neighbours[u].neighbours.push(new Neighbour(v,d)),this.neighbours[v].neighbours.push(new Neighbour(u,d))}}return Calculator.prototype.DistanceMatrix=function(){for(var D=new Array(this.n),i=0;i<this.n;++i)D[i]=this.dijkstraNeighbours(i);return D},Calculator.prototype.DistancesFromNode=function(start){return this.dijkstraNeighbours(start)},Calculator.prototype.PathFromNodeToNode=function(start,end){return this.dijkstraNeighbours(start,end)},Calculator.prototype.PathFromNodeToNodeWithPrevCost=function(start,end,prevCost){var q=new pqueue.PriorityQueue((function(a,b){return a.d<=b.d})),u=this.neighbours[start],qu=new QueueEntry(u,null,0),visitedFrom={};for(q.push(qu);!q.empty()&&(u=(qu=q.pop()).node).id!==end;)for(var i=u.neighbours.length;i--;){var neighbour=u.neighbours[i],v=this.neighbours[neighbour.id];if(!qu.prev||v.id!==qu.prev.node.id){var viduid=v.id+","+u.id;if(!(viduid in visitedFrom&&visitedFrom[viduid]<=qu.d)){var cc=qu.prev?prevCost(qu.prev.node.id,u.id,v.id):0,t=qu.d+neighbour.distance+cc;visitedFrom[viduid]=t,q.push(new QueueEntry(v,qu,t))}}}for(var path=[];qu.prev;)qu=qu.prev,path.push(qu.node.id);return path},Calculator.prototype.dijkstraNeighbours=function(start,dest){void 0===dest&&(dest=-1);for(var q=new pqueue.PriorityQueue((function(a,b){return a.d<=b.d})),i=this.neighbours.length,d=new Array(i);i--;){var node=this.neighbours[i];node.d=i===start?0:Number.POSITIVE_INFINITY,node.q=q.push(node)}for(;!q.empty();){var u=q.pop();if(d[u.id]=u.d,u.id===dest){for(var path=[],v=u;void 0!==v.prev;)path.push(v.prev.id),v=v.prev;return path}for(i=u.neighbours.length;i--;){var neighbour=u.neighbours[i],t=(v=this.neighbours[neighbour.id],u.d+neighbour.distance);u.d!==Number.MAX_VALUE&&v.d>t&&(v.d=t,v.prev=u,q.reduceKey(v.q,v,(function(e,q){return e.q=q})))}}return d},Calculator}();exports.Calculator=Calculator})),geom=createCommonjsModule((function(module,exports){var _extendStatics3,__extends=commonjsGlobal&&commonjsGlobal.__extends||(_extendStatics3=function extendStatics(d,b){return(_extendStatics3=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)},function(d,b){function __(){this.constructor=d}_extendStatics3(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)});Object.defineProperty(exports,"__esModule",{value:!0});var Point=function Point(){};exports.Point=Point;var LineSegment=function LineSegment(x1,y1,x2,y2){this.x1=x1,this.y1=y1,this.x2=x2,this.y2=y2};exports.LineSegment=LineSegment;var PolyPoint=function(_super){function PolyPoint(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(PolyPoint,_super),PolyPoint}(Point);function isLeft(P0,P1,P2){return(P1.x-P0.x)*(P2.y-P0.y)-(P2.x-P0.x)*(P1.y-P0.y)}function above(p,vi,vj){return isLeft(p,vi,vj)>0}function below(p,vi,vj){return isLeft(p,vi,vj)<0}function Rtangent_PointPolyC(P,V){var a,b,c,dnC,n=V.length-1;if(below(P,V[1],V[0])&&!above(P,V[n-1],V[0]))return 0;for(a=0,b=n;;){if(b-a==1)return above(P,V[a],V[b])?a:b;if((dnC=below(P,V[(c=Math.floor((a+b)/2))+1],V[c]))&&!above(P,V[c-1],V[c]))return c;above(P,V[a+1],V[a])?dnC||above(P,V[a],V[c])?b=c:a=c:dnC&&below(P,V[a],V[c])?b=c:a=c}}function Ltangent_PointPolyC(P,V){var a,b,c,dnC,n=V.length-1;if(above(P,V[n-1],V[0])&&!below(P,V[1],V[0]))return 0;for(a=0,b=n;;){if(b-a==1)return below(P,V[a],V[b])?a:b;if(dnC=below(P,V[(c=Math.floor((a+b)/2))+1],V[c]),above(P,V[c-1],V[c])&&!dnC)return c;below(P,V[a+1],V[a])?dnC?below(P,V[a],V[c])?b=c:a=c:b=c:dnC?a=c:above(P,V[a],V[c])?b=c:a=c}}function tangent_PolyPolyC(V,W,t1,t2,cmp1,cmp2){var ix1,ix2;ix2=t2(V[ix1=t1(W[0],V)],W);for(var done=!1;!done;){for(done=!0;ix1===V.length-1&&(ix1=0),!cmp1(W[ix2],V[ix1],V[ix1+1]);)++ix1;for(;0===ix2&&(ix2=W.length-1),!cmp2(V[ix1],W[ix2],W[ix2-1]);)--ix2,done=!1}return{t1:ix1,t2:ix2}}function RLtangent_PolyPolyC(V,W){return tangent_PolyPolyC(V,W,Rtangent_PointPolyC,Ltangent_PointPolyC,above,below)}exports.PolyPoint=PolyPoint,exports.isLeft=isLeft,exports.ConvexHull=function ConvexHull(S){var i,P=S.slice(0).sort((function(a,b){return a.x!==b.x?b.x-a.x:b.y-a.y})),n=S.length,xmin=P[0].x;for(i=1;i<n&&P[i].x===xmin;++i);var minmax=i-1,H=[];if(H.push(P[0]),minmax===n-1)P[minmax].y!==P[0].y&&H.push(P[minmax]);else{var maxmin,maxmax=n-1,xmax=P[n-1].x;for(i=n-2;i>=0&&P[i].x===xmax;i--);for(maxmin=i+1,i=minmax;++i<=maxmin;)if(!(isLeft(P[0],P[maxmin],P[i])>=0&&i<maxmin)){for(;H.length>1&&!(isLeft(H[H.length-2],H[H.length-1],P[i])>0);)H.length-=1;0!=i&&H.push(P[i])}maxmax!=maxmin&&H.push(P[maxmax]);var bot=H.length;for(i=maxmin;--i>=minmax;)if(!(isLeft(P[maxmax],P[minmax],P[i])>=0&&i>minmax)){for(;H.length>bot&&!(isLeft(H[H.length-2],H[H.length-1],P[i])>0);)H.length-=1;0!=i&&H.push(P[i])}}return H},exports.clockwiseRadialSweep=function clockwiseRadialSweep(p,P,f){P.slice(0).sort((function(a,b){return Math.atan2(a.y-p.y,a.x-p.x)-Math.atan2(b.y-p.y,b.x-p.x)})).forEach(f)},exports.tangent_PolyPolyC=tangent_PolyPolyC,exports.LRtangent_PolyPolyC=function LRtangent_PolyPolyC(V,W){var rl=RLtangent_PolyPolyC(W,V);return{t1:rl.t2,t2:rl.t1}},exports.RLtangent_PolyPolyC=RLtangent_PolyPolyC,exports.LLtangent_PolyPolyC=function LLtangent_PolyPolyC(V,W){return tangent_PolyPolyC(V,W,Ltangent_PointPolyC,Ltangent_PointPolyC,below,below)},exports.RRtangent_PolyPolyC=function RRtangent_PolyPolyC(V,W){return tangent_PolyPolyC(V,W,Rtangent_PointPolyC,Rtangent_PointPolyC,above,above)};var BiTangent=function BiTangent(t1,t2){this.t1=t1,this.t2=t2};exports.BiTangent=BiTangent;var BiTangents=function BiTangents(){};exports.BiTangents=BiTangents;var TVGPoint=function(_super){function TVGPoint(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(TVGPoint,_super),TVGPoint}(Point);exports.TVGPoint=TVGPoint;var VisibilityVertex=function VisibilityVertex(id,polyid,polyvertid,p){this.id=id,this.polyid=polyid,this.polyvertid=polyvertid,this.p=p,p.vv=this};exports.VisibilityVertex=VisibilityVertex;var VisibilityEdge=function(){function VisibilityEdge(source,target){this.source=source,this.target=target}return VisibilityEdge.prototype.length=function(){var dx=this.source.p.x-this.target.p.x,dy=this.source.p.y-this.target.p.y;return Math.sqrt(dx*dx+dy*dy)},VisibilityEdge}();exports.VisibilityEdge=VisibilityEdge;var TangentVisibilityGraph=function(){function TangentVisibilityGraph(P,g0){if(this.P=P,this.V=[],this.E=[],g0)this.V=g0.V.slice(0),this.E=g0.E.slice(0);else{for(var n=P.length,i=0;i<n;i++){for(var p=P[i],j=0;j<p.length;++j){var pj=p[j],vv=new VisibilityVertex(this.V.length,i,j,pj);this.V.push(vv),j>0&&this.E.push(new VisibilityEdge(p[j-1].vv,vv))}p.length>1&&this.E.push(new VisibilityEdge(p[0].vv,p[p.length-1].vv))}for(i=0;i<n-1;i++){var Pi=P[i];for(j=i+1;j<n;j++){var Pj=P[j],t=tangents(Pi,Pj);for(var q in t){var c=t[q],source=Pi[c.t1],target=Pj[c.t2];this.addEdgeIfVisible(source,target,i,j)}}}}}return TangentVisibilityGraph.prototype.addEdgeIfVisible=function(u,v,i1,i2){this.intersectsPolys(new LineSegment(u.x,u.y,v.x,v.y),i1,i2)||this.E.push(new VisibilityEdge(u.vv,v.vv))},TangentVisibilityGraph.prototype.addPoint=function(p,i1){var P,V,Vclosed,n=this.P.length;this.V.push(new VisibilityVertex(this.V.length,n,0,p));for(var i=0;i<n;++i)if(i!==i1){var poly=this.P[i],t=(P=p,Vclosed=void 0,(Vclosed=(V=poly).slice(0)).push(V[0]),{rtan:Rtangent_PointPolyC(P,Vclosed),ltan:Ltangent_PointPolyC(P,Vclosed)});this.addEdgeIfVisible(p,poly[t.ltan],i1,i),this.addEdgeIfVisible(p,poly[t.rtan],i1,i)}return p.vv},TangentVisibilityGraph.prototype.intersectsPolys=function(l,i1,i2){for(var i=0,n=this.P.length;i<n;++i)if(i!=i1&&i!=i2&&intersects(l,this.P[i]).length>0)return!0;return!1},TangentVisibilityGraph}();function intersects(l,P){for(var ints=[],i=1,n=P.length;i<n;++i){var _int=rectangle.Rectangle.lineIntersection(l.x1,l.y1,l.x2,l.y2,P[i-1].x,P[i-1].y,P[i].x,P[i].y);_int&&ints.push(_int)}return ints}function tangents(V,W){for(var m=V.length-1,n=W.length-1,bt=new BiTangents,i=0;i<m;++i)for(var j=0;j<n;++j){var v1=V[0==i?m-1:i-1],v2=V[i],v3=V[i+1],w1=W[0==j?n-1:j-1],w2=W[j],w3=W[j+1],v1v2w2=isLeft(v1,v2,w2),v2w1w2=isLeft(v2,w1,w2),v2w2w3=isLeft(v2,w2,w3),w1w2v2=isLeft(w1,w2,v2),w2v1v2=isLeft(w2,v1,v2),w2v2v3=isLeft(w2,v2,v3);v1v2w2>=0&&v2w1w2>=0&&v2w2w3<0&&w1w2v2>=0&&w2v1v2>=0&&w2v2v3<0?bt.ll=new BiTangent(i,j):v1v2w2<=0&&v2w1w2<=0&&v2w2w3>0&&w1w2v2<=0&&w2v1v2<=0&&w2v2v3>0?bt.rr=new BiTangent(i,j):v1v2w2<=0&&v2w1w2>0&&v2w2w3<=0&&w1w2v2>=0&&w2v1v2<0&&w2v2v3>=0?bt.rl=new BiTangent(i,j):v1v2w2>=0&&v2w1w2<0&&v2w2w3>=0&&w1w2v2<=0&&w2v1v2>0&&w2v2v3<=0&&(bt.lr=new BiTangent(i,j))}return bt}function isAnyPInQ(p,q){return!p.every((function(v){return!function isPointInsidePoly(p,poly){for(var i=1,n=poly.length;i<n;++i)if(below(poly[i-1],poly[i],p))return!1;return!0}(v,q)}))}exports.TangentVisibilityGraph=TangentVisibilityGraph,exports.tangents=tangents,exports.polysOverlap=function polysOverlap(p,q){if(isAnyPInQ(p,q))return!0;if(isAnyPInQ(q,p))return!0;for(var i=1,n=p.length;i<n;++i){var v=p[i],u=p[i-1];if(intersects(new LineSegment(u.x,u.y,v.x,v.y),q).length>0)return!0}return!1}})),handledisconnected=createCommonjsModule((function(module,exports){Object.defineProperty(exports,"__esModule",{value:!0});var packingOptions_PADDING=10,packingOptions_GOLDEN_SECTION=(1+Math.sqrt(5))/2,packingOptions_FLOAT_EPSILON=1e-4;exports.applyPacking=function applyPacking(graphs,w,h,node_size,desired_ratio,centerGraph){void 0===desired_ratio&&(desired_ratio=1),void 0===centerGraph&&(centerGraph=!0);var svg_width=w,svg_height=h,real_width=(desired_ratio=void 0!==desired_ratio?desired_ratio:1,node_size=void 0!==node_size?node_size:0,0),real_height=0,min_width=0,global_bottom=0,line=[];function step(data,max_width){line=[],real_width=0,real_height=0,global_bottom=0;for(var i=0;i<data.length;i++){put_rect(data[i],max_width)}return Math.abs(function get_real_ratio(){return real_width/real_height}()-desired_ratio)}function put_rect(rect,max_width){for(var parent=void 0,i=0;i<line.length;i++)if(line[i].space_left>=rect.height&&line[i].x+line[i].width+rect.width+packingOptions_PADDING-max_width<=packingOptions_FLOAT_EPSILON){parent=line[i];break}line.push(rect),void 0!==parent?(rect.x=parent.x+parent.width+packingOptions_PADDING,rect.y=parent.bottom,rect.space_left=rect.height,rect.bottom=rect.y,parent.space_left-=rect.height+packingOptions_PADDING,parent.bottom+=rect.height+packingOptions_PADDING):(rect.y=global_bottom,global_bottom+=rect.height+packingOptions_PADDING,rect.x=0,rect.bottom=rect.y,rect.space_left=rect.height),rect.y+rect.height-real_height>-packingOptions_FLOAT_EPSILON&&(real_height=rect.y+rect.height-0),rect.x+rect.width-real_width>-packingOptions_FLOAT_EPSILON&&(real_width=rect.x+rect.width-0)}0!=graphs.length&&(!function calculate_bb(graphs){graphs.forEach((function(g){!function calculate_single_bb(graph){var min_x=Number.MAX_VALUE,min_y=Number.MAX_VALUE,max_x=0,max_y=0;graph.array.forEach((function(v){var w=void 0!==v.width?v.width:node_size,h=void 0!==v.height?v.height:node_size;w/=2,h/=2,max_x=Math.max(v.x+w,max_x),min_x=Math.min(v.x-w,min_x),max_y=Math.max(v.y+h,max_y),min_y=Math.min(v.y-h,min_y)})),graph.width=max_x-min_x,graph.height=max_y-min_y}(g)}))}(graphs),function apply(data,desired_ratio){var curr_best_f=Number.POSITIVE_INFINITY,curr_best=0;data.sort((function(a,b){return b.height-a.height})),min_width=data.reduce((function(a,b){return a.width<b.width?a.width:b.width}));var left=x1=min_width,right=x2=function get_entire_width(data){var width=0;return data.forEach((function(d){return width+=d.width+packingOptions_PADDING})),width}(data),iterationCounter=0,f_x1=Number.MAX_VALUE,f_x2=Number.MAX_VALUE,flag=-1,dx=Number.MAX_VALUE,df=Number.MAX_VALUE;for(;dx>min_width||df>packingOptions_FLOAT_EPSILON;){if(1!=flag){var x1=right-(right-left)/packingOptions_GOLDEN_SECTION;f_x1=step(data,x1)}if(0!=flag){var x2=left+(right-left)/packingOptions_GOLDEN_SECTION;f_x2=step(data,x2)}if(dx=Math.abs(x1-x2),df=Math.abs(f_x1-f_x2),f_x1<curr_best_f&&(curr_best_f=f_x1,curr_best=x1),f_x2<curr_best_f&&(curr_best_f=f_x2,curr_best=x2),f_x1>f_x2?(left=x1,x1=x2,f_x1=f_x2,flag=1):(right=x2,x2=x1,f_x2=f_x1,flag=0),iterationCounter++>100)break}step(data,curr_best)}(graphs),centerGraph&&function put_nodes_to_right_positions(graphs){graphs.forEach((function(g){var center={x:0,y:0};g.array.forEach((function(node){center.x+=node.x,center.y+=node.y})),center.x/=g.array.length,center.y/=g.array.length;var corner_x=center.x-g.width/2,corner_y=center.y-g.height/2,offset_x=g.x-corner_x+svg_width/2-real_width/2,offset_y=g.y-corner_y+svg_height/2-real_height/2;g.array.forEach((function(node){node.x+=offset_x,node.y+=offset_y}))}))}(graphs))},exports.separateGraphs=function separateGraphs(nodes,links){for(var marks={},ways={},graphs=[],clusters=0,i=0;i<links.length;i++){var link=links[i],n1=link.source,n2=link.target;ways[n1.index]?ways[n1.index].push(n2):ways[n1.index]=[n2],ways[n2.index]?ways[n2.index].push(n1):ways[n2.index]=[n1]}for(i=0;i<nodes.length;i++){var node=nodes[i];marks[node.index]||explore_node(node,!0)}function explore_node(n,is_new){if(void 0===marks[n.index]){is_new&&(clusters++,graphs.push({array:[]})),marks[n.index]=clusters,graphs[clusters-1].array.push(n);var adjacent=ways[n.index];if(adjacent)for(var j=0;j<adjacent.length;j++)explore_node(adjacent[j],!1)}}return graphs}})),layout$1=createCommonjsModule((function(module,exports){var EventType;function isGroup(g){return void 0!==g.leaves||void 0!==g.groups}Object.defineProperty(exports,"__esModule",{value:!0}),function(EventType){EventType[EventType.start=0]="start",EventType[EventType.tick=1]="tick",EventType[EventType.end=2]="end"}(EventType=exports.EventType||(exports.EventType={}));var Layout=function(){function Layout(){var _this=this;this._canvasSize=[1,1],this._linkDistance=20,this._defaultNodeSize=10,this._linkLengthCalculator=null,this._linkType=null,this._avoidOverlaps=!1,this._handleDisconnected=!0,this._running=!1,this._nodes=[],this._groups=[],this._rootGroup=null,this._links=[],this._constraints=[],this._distanceMatrix=null,this._descent=null,this._directedLinkConstraints=null,this._threshold=.01,this._visibilityGraph=null,this._groupCompactness=1e-6,this.event=null,this.linkAccessor={getSourceIndex:Layout.getSourceIndex,getTargetIndex:Layout.getTargetIndex,setLength:Layout.setLinkLength,getType:function getType(l){return"function"==typeof _this._linkType?_this._linkType(l):0}}}return Layout.prototype.on=function(e,listener){return this.event||(this.event={}),"string"==typeof e?this.event[EventType[e]]=listener:this.event[e]=listener,this},Layout.prototype.trigger=function(e){this.event&&void 0!==this.event[e.type]&&this.event[e.type](e)},Layout.prototype.kick=function(){for(;!this.tick(););},Layout.prototype.tick=function(){if(this._alpha<this._threshold)return this._running=!1,this.trigger({type:EventType.end,alpha:this._alpha=0,stress:this._lastStress}),!0;var o,i,n=this._nodes.length;for(this._links.length,this._descent.locks.clear(),i=0;i<n;++i)if((o=this._nodes[i]).fixed){void 0!==o.px&&void 0!==o.py||(o.px=o.x,o.py=o.y);var p=[o.px,o.py];this._descent.locks.add(i,p)}var s1=this._descent.rungeKutta();return 0===s1?this._alpha=0:void 0!==this._lastStress&&(this._alpha=s1),this._lastStress=s1,this.updateNodePositions(),this.trigger({type:EventType.tick,alpha:this._alpha,stress:this._lastStress}),!1},Layout.prototype.updateNodePositions=function(){for(var o,x=this._descent.x[0],y=this._descent.x[1],i=this._nodes.length;i--;)(o=this._nodes[i]).x=x[i],o.y=y[i]},Layout.prototype.nodes=function(v){if(!v){if(0===this._nodes.length&&this._links.length>0){var n=0;this._links.forEach((function(l){n=Math.max(n,l.source,l.target)})),this._nodes=new Array(++n);for(var i=0;i<n;++i)this._nodes[i]={}}return this._nodes}return this._nodes=v,this},Layout.prototype.groups=function(x){var _this=this;return x?(this._groups=x,this._rootGroup={},this._groups.forEach((function(g){void 0===g.padding&&(g.padding=1),void 0!==g.leaves&&g.leaves.forEach((function(v,i){"number"==typeof v&&((g.leaves[i]=_this._nodes[v]).parent=g)})),void 0!==g.groups&&g.groups.forEach((function(gi,i){"number"==typeof gi&&((g.groups[i]=_this._groups[gi]).parent=g)}))})),this._rootGroup.leaves=this._nodes.filter((function(v){return void 0===v.parent})),this._rootGroup.groups=this._groups.filter((function(g){return void 0===g.parent})),this):this._groups},Layout.prototype.powerGraphGroups=function(f){var g=powergraph.getGroups(this._nodes,this._links,this.linkAccessor,this._rootGroup);return this.groups(g.groups),f(g),this},Layout.prototype.avoidOverlaps=function(v){return arguments.length?(this._avoidOverlaps=v,this):this._avoidOverlaps},Layout.prototype.handleDisconnected=function(v){return arguments.length?(this._handleDisconnected=v,this):this._handleDisconnected},Layout.prototype.flowLayout=function(axis,minSeparation){return arguments.length||(axis="y"),this._directedLinkConstraints={axis:axis,getMinSeparation:"number"==typeof minSeparation?function(){return minSeparation}:minSeparation},this},Layout.prototype.links=function(x){return arguments.length?(this._links=x,this):this._links},Layout.prototype.constraints=function(c){return arguments.length?(this._constraints=c,this):this._constraints},Layout.prototype.distanceMatrix=function(d){return arguments.length?(this._distanceMatrix=d,this):this._distanceMatrix},Layout.prototype.size=function(x){return x?(this._canvasSize=x,this):this._canvasSize},Layout.prototype.defaultNodeSize=function(x){return x?(this._defaultNodeSize=x,this):this._defaultNodeSize},Layout.prototype.groupCompactness=function(x){return x?(this._groupCompactness=x,this):this._groupCompactness},Layout.prototype.linkDistance=function(x){return x?(this._linkDistance="function"==typeof x?x:+x,this._linkLengthCalculator=null,this):this._linkDistance},Layout.prototype.linkType=function(f){return this._linkType=f,this},Layout.prototype.convergenceThreshold=function(x){return x?(this._threshold="function"==typeof x?x:+x,this):this._threshold},Layout.prototype.alpha=function(x){return arguments.length?(x=+x,this._alpha?this._alpha=x>0?x:0:x>0&&(this._running||(this._running=!0,this.trigger({type:EventType.start,alpha:this._alpha=x}),this.kick())),this):this._alpha},Layout.prototype.getLinkLength=function(link){return"function"==typeof this._linkDistance?+this._linkDistance(link):this._linkDistance},Layout.setLinkLength=function(link,length){link.length=length},Layout.prototype.getLinkType=function(link){return"function"==typeof this._linkType?this._linkType(link):0},Layout.prototype.symmetricDiffLinkLengths=function(idealLength,w){var _this=this;return void 0===w&&(w=1),this.linkDistance((function(l){return idealLength*l.length})),this._linkLengthCalculator=function(){return linklengths.symmetricDiffLinkLengths(_this._links,_this.linkAccessor,w)},this},Layout.prototype.jaccardLinkLengths=function(idealLength,w){var _this=this;return void 0===w&&(w=1),this.linkDistance((function(l){return idealLength*l.length})),this._linkLengthCalculator=function(){return linklengths.jaccardLinkLengths(_this._links,_this.linkAccessor,w)},this},Layout.prototype.start=function(initialUnconstrainedIterations,initialUserConstraintIterations,initialAllConstraintsIterations,gridSnapIterations,keepRunning,centerGraph){var _this=this;void 0===initialUnconstrainedIterations&&(initialUnconstrainedIterations=0),void 0===initialUserConstraintIterations&&(initialUserConstraintIterations=0),void 0===initialAllConstraintsIterations&&(initialAllConstraintsIterations=0),void 0===gridSnapIterations&&(gridSnapIterations=0),void 0===keepRunning&&(keepRunning=!0),void 0===centerGraph&&(centerGraph=!0);var n=this.nodes().length,N=n+2*this._groups.length;this._links.length;var distances,w=this._canvasSize[0],h=this._canvasSize[1],x=new Array(N),y=new Array(N),G=null,ao=this._avoidOverlaps;this._nodes.forEach((function(v,i){v.index=i,void 0===v.x&&(v.x=w/2,v.y=h/2),x[i]=v.x,y[i]=v.y})),this._linkLengthCalculator&&this._linkLengthCalculator(),this._distanceMatrix?distances=this._distanceMatrix:(distances=new shortestpaths.Calculator(N,this._links,Layout.getSourceIndex,Layout.getTargetIndex,(function(l){return _this.getLinkLength(l)})).DistanceMatrix(),G=descent.Descent.createSquareMatrix(N,(function(){return 2})),this._links.forEach((function(l){"number"==typeof l.source&&(l.source=_this._nodes[l.source]),"number"==typeof l.target&&(l.target=_this._nodes[l.target])})),this._links.forEach((function(e){var u=Layout.getSourceIndex(e),v=Layout.getTargetIndex(e);G[u][v]=G[v][u]=e.weight||1})));var D=descent.Descent.createSquareMatrix(N,(function(i,j){return distances[i][j]}));if(this._rootGroup&&void 0!==this._rootGroup.groups){var i=n;this._groups.forEach((function(g){!function addAttraction(i,j,strength,idealDistance){G[i][j]=G[j][i]=strength,D[i][j]=D[j][i]=idealDistance}(i,i+1,_this._groupCompactness,.1),x[i]=0,y[i++]=0,x[i]=0,y[i++]=0}))}else this._rootGroup={leaves:this._nodes,groups:[]};var curConstraints=this._constraints||[];this._directedLinkConstraints&&(this.linkAccessor.getMinSeparation=this._directedLinkConstraints.getMinSeparation,curConstraints=curConstraints.concat(linklengths.generateDirectedEdgeConstraints(n,this._links,this._directedLinkConstraints.axis,this.linkAccessor))),this.avoidOverlaps(!1),this._descent=new descent.Descent([x,y],D),this._descent.locks.clear();for(i=0;i<n;++i){var o=this._nodes[i];if(o.fixed){o.px=o.x,o.py=o.y;var p=[o.x,o.y];this._descent.locks.add(i,p)}}if(this._descent.threshold=this._threshold,this.initialLayout(initialUnconstrainedIterations,x,y),curConstraints.length>0&&(this._descent.project=new rectangle.Projection(this._nodes,this._groups,this._rootGroup,curConstraints).projectFunctions()),this._descent.run(initialUserConstraintIterations),this.separateOverlappingComponents(w,h,centerGraph),this.avoidOverlaps(ao),ao&&(this._nodes.forEach((function(v,i){v.x=x[i],v.y=y[i]})),this._descent.project=new rectangle.Projection(this._nodes,this._groups,this._rootGroup,curConstraints,!0).projectFunctions(),this._nodes.forEach((function(v,i){x[i]=v.x,y[i]=v.y}))),this._descent.G=G,this._descent.run(initialAllConstraintsIterations),gridSnapIterations){this._descent.snapStrength=1e3,this._descent.snapGridSize=this._nodes[0].width,this._descent.numGridSnapNodes=n,this._descent.scaleSnapByMaxH=n!=N;var G0=descent.Descent.createSquareMatrix(N,(function(i,j){return i>=n||j>=n?G[i][j]:0}));this._descent.G=G0,this._descent.run(gridSnapIterations)}return this.updateNodePositions(),this.separateOverlappingComponents(w,h,centerGraph),keepRunning?this.resume():this},Layout.prototype.initialLayout=function(iterations,x,y){if(this._groups.length>0&&iterations>0){var n=this._nodes.length,edges=this._links.map((function(e){return{source:e.source.index,target:e.target.index}})),vs=this._nodes.map((function(v){return{index:v.index}}));this._groups.forEach((function(g,i){vs.push({index:g.index=n+i})})),this._groups.forEach((function(g,i){void 0!==g.leaves&&g.leaves.forEach((function(v){return edges.push({source:g.index,target:v.index})})),void 0!==g.groups&&g.groups.forEach((function(gg){return edges.push({source:g.index,target:gg.index})}))})),(new Layout).size(this.size()).nodes(vs).links(edges).avoidOverlaps(!1).linkDistance(this.linkDistance()).symmetricDiffLinkLengths(5).convergenceThreshold(1e-4).start(iterations,0,0,0,!1),this._nodes.forEach((function(v){x[v.index]=vs[v.index].x,y[v.index]=vs[v.index].y}))}else this._descent.run(iterations)},Layout.prototype.separateOverlappingComponents=function(width,height,centerGraph){var _this=this;if(void 0===centerGraph&&(centerGraph=!0),!this._distanceMatrix&&this._handleDisconnected){var x_1=this._descent.x[0],y_1=this._descent.x[1];this._nodes.forEach((function(v,i){v.x=x_1[i],v.y=y_1[i]}));var graphs=handledisconnected.separateGraphs(this._nodes,this._links);handledisconnected.applyPacking(graphs,width,height,this._defaultNodeSize,1,centerGraph),this._nodes.forEach((function(v,i){_this._descent.x[0][i]=v.x,_this._descent.x[1][i]=v.y,v.bounds&&(v.bounds.setXCentre(v.x),v.bounds.setYCentre(v.y))}))}},Layout.prototype.resume=function(){return this.alpha(.1)},Layout.prototype.stop=function(){return this.alpha(0)},Layout.prototype.prepareEdgeRouting=function(nodeMargin){void 0===nodeMargin&&(nodeMargin=0),this._visibilityGraph=new geom.TangentVisibilityGraph(this._nodes.map((function(v){return v.bounds.inflate(-nodeMargin).vertices()})))},Layout.prototype.routeEdge=function(edge,ah,draw){void 0===ah&&(ah=5);var lineData=[],vg2=new geom.TangentVisibilityGraph(this._visibilityGraph.P,{V:this._visibilityGraph.V,E:this._visibilityGraph.E}),port1={x:edge.source.x,y:edge.source.y},port2={x:edge.target.x,y:edge.target.y},start=vg2.addPoint(port1,edge.source.index),end=vg2.addPoint(port2,edge.target.index);vg2.addEdgeIfVisible(port1,port2,edge.source.index,edge.target.index),void 0!==draw&&draw(vg2);var shortestPath=new shortestpaths.Calculator(vg2.V.length,vg2.E,(function sourceInd(e){return e.source.id}),(function targetInd(e){return e.target.id}),(function length(e){return e.length()})).PathFromNodeToNode(start.id,end.id);if(1===shortestPath.length||shortestPath.length===vg2.V.length){var route=rectangle.makeEdgeBetween(edge.source.innerBounds,edge.target.innerBounds,ah);lineData=[route.sourceIntersection,route.arrowStart]}else{for(var n=shortestPath.length-2,p=vg2.V[shortestPath[n]].p,q=vg2.V[shortestPath[0]].p,i=(lineData=[edge.source.innerBounds.rayIntersection(p.x,p.y)],n);i>=0;--i)lineData.push(vg2.V[shortestPath[i]].p);lineData.push(rectangle.makeEdgeTo(q,edge.target.innerBounds,ah))}return lineData},Layout.getSourceIndex=function(e){return"number"==typeof e.source?e.source:e.source.index},Layout.getTargetIndex=function(e){return"number"==typeof e.target?e.target:e.target.index},Layout.linkId=function(e){return Layout.getSourceIndex(e)+"-"+Layout.getTargetIndex(e)},Layout.dragStart=function(d){isGroup(d)?Layout.storeOffset(d,Layout.dragOrigin(d)):(Layout.stopNode(d),d.fixed|=2)},Layout.stopNode=function(v){v.px=v.x,v.py=v.y},Layout.storeOffset=function(d,origin){void 0!==d.leaves&&d.leaves.forEach((function(v){v.fixed|=2,Layout.stopNode(v),v._dragGroupOffsetX=v.x-origin.x,v._dragGroupOffsetY=v.y-origin.y})),void 0!==d.groups&&d.groups.forEach((function(g){return Layout.storeOffset(g,origin)}))},Layout.dragOrigin=function(d){return isGroup(d)?{x:d.bounds.cx(),y:d.bounds.cy()}:d},Layout.drag=function(d,position){isGroup(d)?(void 0!==d.leaves&&d.leaves.forEach((function(v){d.bounds.setXCentre(position.x),d.bounds.setYCentre(position.y),v.px=v._dragGroupOffsetX+position.x,v.py=v._dragGroupOffsetY+position.y})),void 0!==d.groups&&d.groups.forEach((function(g){return Layout.drag(g,position)}))):(d.px=position.x,d.py=position.y)},Layout.dragEnd=function(d){isGroup(d)?(void 0!==d.leaves&&d.leaves.forEach((function(v){Layout.dragEnd(v),delete v._dragGroupOffsetX,delete v._dragGroupOffsetY})),void 0!==d.groups&&d.groups.forEach(Layout.dragEnd)):d.fixed&=-7},Layout.mouseOver=function(d){d.fixed|=4,d.px=d.x,d.py=d.y},Layout.mouseOut=function(d){d.fixed&=-5},Layout}();exports.Layout=Layout})),adaptor_1=createCommonjsModule((function(module,exports){var _extendStatics4,__extends=commonjsGlobal&&commonjsGlobal.__extends||(_extendStatics4=function extendStatics(d,b){return(_extendStatics4=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)},function(d,b){function __(){this.constructor=d}_extendStatics4(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)});Object.defineProperty(exports,"__esModule",{value:!0});var LayoutAdaptor=function(_super){function LayoutAdaptor(options){var _this=_super.call(this)||this,o=options;return o.trigger&&(_this.trigger=o.trigger),o.kick&&(_this.kick=o.kick),o.drag&&(_this.drag=o.drag),o.on&&(_this.on=o.on),_this.dragstart=_this.dragStart=layout$1.Layout.dragStart,_this.dragend=_this.dragEnd=layout$1.Layout.dragEnd,_this}return __extends(LayoutAdaptor,_super),LayoutAdaptor.prototype.trigger=function(e){},LayoutAdaptor.prototype.kick=function(){},LayoutAdaptor.prototype.drag=function(){},LayoutAdaptor.prototype.on=function(eventType,listener){return this},LayoutAdaptor}(layout$1.Layout);exports.LayoutAdaptor=LayoutAdaptor,exports.adaptor=function adaptor(options){return new LayoutAdaptor(options)}})),d3v3adaptor=createCommonjsModule((function(module,exports){var _extendStatics5,__extends=commonjsGlobal&&commonjsGlobal.__extends||(_extendStatics5=function extendStatics(d,b){return(_extendStatics5=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)},function(d,b){function __(){this.constructor=d}_extendStatics5(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)});Object.defineProperty(exports,"__esModule",{value:!0});var D3StyleLayoutAdaptor=function(_super){function D3StyleLayoutAdaptor(){var _this=_super.call(this)||this;_this.event=d3.dispatch(layout$1.EventType[layout$1.EventType.start],layout$1.EventType[layout$1.EventType.tick],layout$1.EventType[layout$1.EventType.end]);var d3layout=_this;return _this.drag=function(){if(!drag)var drag=d3.behavior.drag().origin(layout$1.Layout.dragOrigin).on("dragstart.d3adaptor",layout$1.Layout.dragStart).on("drag.d3adaptor",(function(d){layout$1.Layout.drag(d,d3.event),d3layout.resume()})).on("dragend.d3adaptor",layout$1.Layout.dragEnd);if(!arguments.length)return drag;this.call(drag)},_this}return __extends(D3StyleLayoutAdaptor,_super),D3StyleLayoutAdaptor.prototype.trigger=function(e){var d3event={type:layout$1.EventType[e.type],alpha:e.alpha,stress:e.stress};this.event[d3event.type](d3event)},D3StyleLayoutAdaptor.prototype.kick=function(){var _this=this;d3.timer((function(){return _super.prototype.tick.call(_this)}))},D3StyleLayoutAdaptor.prototype.on=function(eventType,listener){return"string"==typeof eventType?this.event.on(eventType,listener):this.event.on(layout$1.EventType[eventType],listener),this},D3StyleLayoutAdaptor}(layout$1.Layout);exports.D3StyleLayoutAdaptor=D3StyleLayoutAdaptor,exports.d3adaptor=function d3adaptor(){return new D3StyleLayoutAdaptor}})),d3v4adaptor=createCommonjsModule((function(module,exports){var _extendStatics6,__extends=commonjsGlobal&&commonjsGlobal.__extends||(_extendStatics6=function extendStatics(d,b){return(_extendStatics6=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)},function(d,b){function __(){this.constructor=d}_extendStatics6(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)});Object.defineProperty(exports,"__esModule",{value:!0});var D3StyleLayoutAdaptor=function(_super){function D3StyleLayoutAdaptor(d3Context){var _this=_super.call(this)||this;_this.d3Context=d3Context,_this.event=d3Context.dispatch(layout$1.EventType[layout$1.EventType.start],layout$1.EventType[layout$1.EventType.tick],layout$1.EventType[layout$1.EventType.end]);var d3layout=_this;return _this.drag=function(){if(!drag)var drag=d3Context.drag().subject(layout$1.Layout.dragOrigin).on("start.d3adaptor",layout$1.Layout.dragStart).on("drag.d3adaptor",(function(d){layout$1.Layout.drag(d,d3Context.event),d3layout.resume()})).on("end.d3adaptor",layout$1.Layout.dragEnd);if(!arguments.length)return drag;arguments[0].call(drag)},_this}return __extends(D3StyleLayoutAdaptor,_super),D3StyleLayoutAdaptor.prototype.trigger=function(e){var d3event={type:layout$1.EventType[e.type],alpha:e.alpha,stress:e.stress};this.event.call(d3event.type,d3event)},D3StyleLayoutAdaptor.prototype.kick=function(){var _this=this,t=this.d3Context.timer((function(){return _super.prototype.tick.call(_this)&&t.stop()}))},D3StyleLayoutAdaptor.prototype.on=function(eventType,listener){return"string"==typeof eventType?this.event.on(eventType,listener):this.event.on(layout$1.EventType[eventType],listener),this},D3StyleLayoutAdaptor}(layout$1.Layout);exports.D3StyleLayoutAdaptor=D3StyleLayoutAdaptor})),d3adaptor_1=createCommonjsModule((function(module,exports){Object.defineProperty(exports,"__esModule",{value:!0}),exports.d3adaptor=function d3adaptor(d3Context){return!d3Context||function isD3V3(d3Context){return d3Context.version&&null!==d3Context.version.match(/^3\./)}(d3Context)?new d3v3adaptor.D3StyleLayoutAdaptor:new d3v4adaptor.D3StyleLayoutAdaptor(d3Context)}})),gridrouter=createCommonjsModule((function(module,exports){Object.defineProperty(exports,"__esModule",{value:!0});var NodeWrapper=function NodeWrapper(id,rect,children){this.id=id,this.rect=rect,this.children=children,this.leaf=void 0===children||0===children.length};exports.NodeWrapper=NodeWrapper;var Vert=function Vert(id,x,y,node,line){void 0===node&&(node=null),void 0===line&&(line=null),this.id=id,this.x=x,this.y=y,this.node=node,this.line=line};exports.Vert=Vert;var LongestCommonSubsequence=function(){function LongestCommonSubsequence(s,t){this.s=s,this.t=t;var mf=LongestCommonSubsequence.findMatch(s,t),tr=t.slice(0).reverse(),mr=LongestCommonSubsequence.findMatch(s,tr);mf.length>=mr.length?(this.length=mf.length,this.si=mf.si,this.ti=mf.ti,this.reversed=!1):(this.length=mr.length,this.si=mr.si,this.ti=t.length-mr.ti-mr.length,this.reversed=!0)}return LongestCommonSubsequence.findMatch=function(s,t){for(var m=s.length,n=t.length,match={length:0,si:-1,ti:-1},l=new Array(m),i=0;i<m;i++){l[i]=new Array(n);for(var j=0;j<n;j++)if(s[i]===t[j]){var v=l[i][j]=0===i||0===j?1:l[i-1][j-1]+1;v>match.length&&(match.length=v,match.si=i-v+1,match.ti=j-v+1)}else l[i][j]=0}return match},LongestCommonSubsequence.prototype.getSequence=function(){return this.length>=0?this.s.slice(this.si,this.si+this.length):[]},LongestCommonSubsequence}();exports.LongestCommonSubsequence=LongestCommonSubsequence;var GridRouter=function(){function GridRouter(originalnodes,accessor,groupPadding){var _this=this;void 0===groupPadding&&(groupPadding=12),this.originalnodes=originalnodes,this.groupPadding=groupPadding,this.leaves=null,this.nodes=originalnodes.map((function(v,i){return new NodeWrapper(i,accessor.getBounds(v),accessor.getChildren(v))})),this.leaves=this.nodes.filter((function(v){return v.leaf})),this.groups=this.nodes.filter((function(g){return!g.leaf})),this.cols=this.getGridLines("x"),this.rows=this.getGridLines("y"),this.groups.forEach((function(v){return v.children.forEach((function(c){return _this.nodes[c].parent=v}))})),this.root={children:[]},this.nodes.forEach((function(v){void 0===v.parent&&(v.parent=_this.root,_this.root.children.push(v.id)),v.ports=[]})),this.backToFront=this.nodes.slice(0),this.backToFront.sort((function(x,y){return _this.getDepth(x)-_this.getDepth(y)})),this.backToFront.slice(0).reverse().filter((function(g){return!g.leaf})).forEach((function(v){var r=rectangle.Rectangle.empty();v.children.forEach((function(c){return r=r.union(_this.nodes[c].rect)})),v.rect=r.inflate(_this.groupPadding)}));var colMids=this.midPoints(this.cols.map((function(r){return r.pos}))),rowMids=this.midPoints(this.rows.map((function(r){return r.pos}))),rowx=colMids[0],rowX=colMids[colMids.length-1],coly=rowMids[0],colY=rowMids[rowMids.length-1],hlines=this.rows.map((function(r){return{x1:rowx,x2:rowX,y1:r.pos,y2:r.pos}})).concat(rowMids.map((function(m){return{x1:rowx,x2:rowX,y1:m,y2:m}}))),vlines=this.cols.map((function(c){return{x1:c.pos,x2:c.pos,y1:coly,y2:colY}})).concat(colMids.map((function(m){return{x1:m,x2:m,y1:coly,y2:colY}}))),lines=hlines.concat(vlines);lines.forEach((function(l){return l.verts=[]})),this.verts=[],this.edges=[],hlines.forEach((function(h){return vlines.forEach((function(v){var p=new Vert(_this.verts.length,v.x1,h.y1);h.verts.push(p),v.verts.push(p),_this.verts.push(p);for(var i=_this.backToFront.length;i-- >0;){var node=_this.backToFront[i],r=node.rect,dx=Math.abs(p.x-r.cx()),dy=Math.abs(p.y-r.cy());if(dx<r.width()/2&&dy<r.height()/2){p.node=node;break}}}))})),lines.forEach((function(l,li){_this.nodes.forEach((function(v,i){v.rect.lineIntersections(l.x1,l.y1,l.x2,l.y2).forEach((function(intersect,j){var p=new Vert(_this.verts.length,intersect.x,intersect.y,v,l);_this.verts.push(p),l.verts.push(p),v.ports.push(p)}))}));var isHoriz=Math.abs(l.y1-l.y2)<.1,delta=function delta(a,b){return isHoriz?b.x-a.x:b.y-a.y};l.verts.sort(delta);for(var i=1;i<l.verts.length;i++){var u=l.verts[i-1],v=l.verts[i];u.node&&u.node===v.node&&u.node.leaf||_this.edges.push({source:u.id,target:v.id,length:Math.abs(delta(u,v))})}}))}return GridRouter.prototype.avg=function(a){return a.reduce((function(x,y){return x+y}))/a.length},GridRouter.prototype.getGridLines=function(axis){for(var columns=[],ls=this.leaves.slice(0,this.leaves.length);ls.length>0;){var overlapping=ls.filter((function(v){return v.rect["overlap"+axis.toUpperCase()](ls[0].rect)})),col={nodes:overlapping,pos:this.avg(overlapping.map((function(v){return v.rect["c"+axis]()})))};columns.push(col),col.nodes.forEach((function(v){return ls.splice(ls.indexOf(v),1)}))}return columns.sort((function(a,b){return a.pos-b.pos})),columns},GridRouter.prototype.getDepth=function(v){for(var depth=0;v.parent!==this.root;)depth++,v=v.parent;return depth},GridRouter.prototype.midPoints=function(a){for(var gap=a[1]-a[0],mids=[a[0]-gap/2],i=1;i<a.length;i++)mids.push((a[i]+a[i-1])/2);return mids.push(a[a.length-1]+gap/2),mids},GridRouter.prototype.findLineage=function(v){var lineage=[v];do{v=v.parent,lineage.push(v)}while(v!==this.root);return lineage.reverse()},GridRouter.prototype.findAncestorPathBetween=function(a,b){for(var aa=this.findLineage(a),ba=this.findLineage(b),i=0;aa[i]===ba[i];)i++;return{commonAncestor:aa[i-1],lineages:aa.slice(i).concat(ba.slice(i))}},GridRouter.prototype.siblingObstacles=function(a,b){var _this=this,path=this.findAncestorPathBetween(a,b),lineageLookup={};path.lineages.forEach((function(v){return lineageLookup[v.id]={}}));var obstacles=path.commonAncestor.children.filter((function(v){return!(v in lineageLookup)}));return path.lineages.filter((function(v){return v.parent!==path.commonAncestor})).forEach((function(v){return obstacles=obstacles.concat(v.parent.children.filter((function(c){return c!==v.id})))})),obstacles.map((function(v){return _this.nodes[v]}))},GridRouter.getSegmentSets=function(routes,x,y){for(var vsegments=[],ei=0;ei<routes.length;ei++)for(var route=routes[ei],si=0;si<route.length;si++){(s=route[si]).edgeid=ei,s.i=si;var sdx=s[1][x]-s[0][x];Math.abs(sdx)<.1&&vsegments.push(s)}vsegments.sort((function(a,b){return a[0][x]-b[0][x]}));for(var vsegmentsets=[],segmentset=null,i=0;i<vsegments.length;i++){var s=vsegments[i];(!segmentset||Math.abs(s[0][x]-segmentset.pos)>.1)&&(segmentset={pos:s[0][x],segments:[]},vsegmentsets.push(segmentset)),segmentset.segments.push(s)}return vsegmentsets},GridRouter.nudgeSegs=function(x,y,routes,segments,leftOf,gap){var n=segments.length;if(!(n<=1)){for(var vs=segments.map((function(s){return new vpsc.Variable(s[0][x])})),cs=[],i=0;i<n;i++)for(var j=0;j<n;j++)if(i!==j){var s1=segments[i],s2=segments[j],e1=s1.edgeid,e2=s2.edgeid,lind=-1,rind=-1;"x"==x?leftOf(e1,e2)&&(s1[0][y]<s1[1][y]?(lind=j,rind=i):(lind=i,rind=j)):leftOf(e1,e2)&&(s1[0][y]<s1[1][y]?(lind=i,rind=j):(lind=j,rind=i)),lind>=0&&cs.push(new vpsc.Constraint(vs[lind],vs[rind],gap))}new vpsc.Solver(vs,cs).solve(),vs.forEach((function(v,i){var s=segments[i],pos=v.position();s[0][x]=s[1][x]=pos;var route=routes[s.edgeid];s.i>0&&(route[s.i-1][1][x]=pos),s.i<route.length-1&&(route[s.i+1][0][x]=pos)}))}},GridRouter.nudgeSegments=function(routes,x,y,leftOf,gap){for(var vsegmentsets=GridRouter.getSegmentSets(routes,x,y),i=0;i<vsegmentsets.length;i++){for(var ss=vsegmentsets[i],events=[],j=0;j<ss.segments.length;j++){var s=ss.segments[j];events.push({type:0,s:s,pos:Math.min(s[0][y],s[1][y])}),events.push({type:1,s:s,pos:Math.max(s[0][y],s[1][y])})}events.sort((function(a,b){return a.pos-b.pos+a.type-b.type}));var open=[],openCount=0;events.forEach((function(e){0===e.type?(open.push(e.s),openCount++):openCount--,0==openCount&&(GridRouter.nudgeSegs(x,y,routes,open,leftOf,gap),open=[])}))}},GridRouter.prototype.routeEdges=function(edges,nudgeGap,source,target){var _this=this,routePaths=edges.map((function(e){return _this.route(source(e),target(e))})),order=GridRouter.orderEdges(routePaths),routes=routePaths.map((function(e){return GridRouter.makeSegments(e)}));return GridRouter.nudgeSegments(routes,"x","y",order,nudgeGap),GridRouter.nudgeSegments(routes,"y","x",order,nudgeGap),GridRouter.unreverseEdges(routes,routePaths),routes},GridRouter.unreverseEdges=function(routes,routePaths){routes.forEach((function(segments,i){routePaths[i].reversed&&(segments.reverse(),segments.forEach((function(segment){segment.reverse()})))}))},GridRouter.angleBetween2Lines=function(line1,line2){var angle1=Math.atan2(line1[0].y-line1[1].y,line1[0].x-line1[1].x),angle2=Math.atan2(line2[0].y-line2[1].y,line2[0].x-line2[1].x),diff=angle1-angle2;return(diff>Math.PI||diff<-Math.PI)&&(diff=angle2-angle1),diff},GridRouter.isLeft=function(a,b,c){return(b.x-a.x)*(c.y-a.y)-(b.y-a.y)*(c.x-a.x)<=0},GridRouter.getOrder=function(pairs){for(var outgoing={},i=0;i<pairs.length;i++){var p=pairs[i];void 0===outgoing[p.l]&&(outgoing[p.l]={}),outgoing[p.l][p.r]=!0}return function(l,r){return void 0!==outgoing[l]&&outgoing[l][r]}},GridRouter.orderEdges=function(edges){for(var edgeOrder=[],i=0;i<edges.length-1;i++)for(var j=i+1;j<edges.length;j++){var u,vi,vj,e=edges[i],f=edges[j],lcs=new LongestCommonSubsequence(e,f);0!==lcs.length&&(lcs.reversed&&(f.reverse(),f.reversed=!0,lcs=new LongestCommonSubsequence(e,f)),(lcs.si<=0||lcs.ti<=0)&&(lcs.si+lcs.length>=e.length||lcs.ti+lcs.length>=f.length)?edgeOrder.push({l:i,r:j}):(lcs.si+lcs.length>=e.length||lcs.ti+lcs.length>=f.length?(u=e[lcs.si+1],vj=e[lcs.si-1],vi=f[lcs.ti-1]):(u=e[lcs.si+lcs.length-2],vi=e[lcs.si+lcs.length],vj=f[lcs.ti+lcs.length]),GridRouter.isLeft(u,vi,vj)?edgeOrder.push({l:j,r:i}):edgeOrder.push({l:i,r:j})))}return GridRouter.getOrder(edgeOrder)},GridRouter.makeSegments=function(path){function copyPoint(p){return{x:p.x,y:p.y}}for(var isStraight=function isStraight(a,b,c){return Math.abs((b.x-a.x)*(c.y-a.y)-(b.y-a.y)*(c.x-a.x))<.001},segments=[],a=copyPoint(path[0]),i=1;i<path.length;i++){var b=copyPoint(path[i]),c=i<path.length-1?path[i+1]:null;c&&isStraight(a,b,c)||(segments.push([a,b]),a=b)}return segments},GridRouter.prototype.route=function(s,t){var _this=this,source=this.nodes[s],target=this.nodes[t];this.obstacles=this.siblingObstacles(source,target);var obstacleLookup={};this.obstacles.forEach((function(o){return obstacleLookup[o.id]=o})),this.passableEdges=this.edges.filter((function(e){var u=_this.verts[e.source],v=_this.verts[e.target];return!(u.node&&u.node.id in obstacleLookup||v.node&&v.node.id in obstacleLookup)}));for(var i=1;i<source.ports.length;i++){var u=source.ports[0].id,v=source.ports[i].id;this.passableEdges.push({source:u,target:v,length:0})}for(i=1;i<target.ports.length;i++){u=target.ports[0].id,v=target.ports[i].id;this.passableEdges.push({source:u,target:v,length:0})}var pathPoints=new shortestpaths.Calculator(this.verts.length,this.passableEdges,(function getSource(e){return e.source}),(function getTarget(e){return e.target}),(function getLength(e){return e.length})).PathFromNodeToNodeWithPrevCost(source.ports[0].id,target.ports[0].id,(function bendPenalty(u,v,w){var a=_this.verts[u],b=_this.verts[v],c=_this.verts[w],dx=Math.abs(c.x-a.x),dy=Math.abs(c.y-a.y);return a.node===source&&a.node===b.node||b.node===target&&b.node===c.node?0:dx>1&&dy>1?1e3:0})).reverse().map((function(vi){return _this.verts[vi]}));return pathPoints.push(this.nodes[target.id].ports[0]),pathPoints.filter((function(v,i){return!(i<pathPoints.length-1&&pathPoints[i+1].node===source&&v.node===source||i>0&&v.node===target&&pathPoints[i-1].node===target)}))},GridRouter.getRoutePath=function(route,cornerradius,arrowwidth,arrowheight){var result={routepath:"M "+route[0][0].x+" "+route[0][0].y+" ",arrowpath:""};if(route.length>1)for(var i=0;i<route.length;i++){var x=(li=route[i])[1].x,y=li[1].y,dx=x-li[0].x,dy=y-li[0].y;if(i<route.length-1){Math.abs(dx)>0?x-=dx/Math.abs(dx)*cornerradius:y-=dy/Math.abs(dy)*cornerradius,result.routepath+="L "+x+" "+y+" ";var l=route[i+1],x0=l[0].x,y0=l[0].y;dx=l[1].x-x0,dy=l[1].y-y0;var x2,y2,angle=GridRouter.angleBetween2Lines(li,l)<0?1:0;Math.abs(dx)>0?(x2=x0+dx/Math.abs(dx)*cornerradius,y2=y0):(x2=x0,y2=y0+dy/Math.abs(dy)*cornerradius);var cx=Math.abs(x2-x),cy=Math.abs(y2-y);result.routepath+="A "+cx+" "+cy+" 0 0 "+angle+" "+x2+" "+y2+" "}else{var arrowtip=[x,y];Math.abs(dx)>0?(arrowcorner1=[x-=dx/Math.abs(dx)*arrowheight,y+arrowwidth],arrowcorner2=[x,y-arrowwidth]):(arrowcorner1=[x+arrowwidth,y-=dy/Math.abs(dy)*arrowheight],arrowcorner2=[x-arrowwidth,y]),result.routepath+="L "+x+" "+y+" ",arrowheight>0&&(result.arrowpath="M "+arrowtip[0]+" "+arrowtip[1]+" L "+arrowcorner1[0]+" "+arrowcorner1[1]+" L "+arrowcorner2[0]+" "+arrowcorner2[1])}}else{var li,arrowcorner1,arrowcorner2;x=(li=route[0])[1].x,y=li[1].y,dx=x-li[0].x,dy=y-li[0].y,arrowtip=[x,y];Math.abs(dx)>0?(arrowcorner1=[x-=dx/Math.abs(dx)*arrowheight,y+arrowwidth],arrowcorner2=[x,y-arrowwidth]):(arrowcorner1=[x+arrowwidth,y-=dy/Math.abs(dy)*arrowheight],arrowcorner2=[x-arrowwidth,y]),result.routepath+="L "+x+" "+y+" ",arrowheight>0&&(result.arrowpath="M "+arrowtip[0]+" "+arrowtip[1]+" L "+arrowcorner1[0]+" "+arrowcorner1[1]+" L "+arrowcorner2[0]+" "+arrowcorner2[1])}return result},GridRouter}();exports.GridRouter=GridRouter})),layout3d=createCommonjsModule((function(module,exports){Object.defineProperty(exports,"__esModule",{value:!0});var Link3D=function(){function Link3D(source,target){this.source=source,this.target=target}return Link3D.prototype.actualLength=function(x){var _this=this;return Math.sqrt(x.reduce((function(c,v){var dx=v[_this.target]-v[_this.source];return c+dx*dx}),0))},Link3D}();exports.Link3D=Link3D;var Node3D=function Node3D(x,y,z){void 0===x&&(x=0),void 0===y&&(y=0),void 0===z&&(z=0),this.x=x,this.y=y,this.z=z};exports.Node3D=Node3D;var Layout3D=function(){function Layout3D(nodes,links,idealLinkLength){var _this=this;void 0===idealLinkLength&&(idealLinkLength=1),this.nodes=nodes,this.links=links,this.idealLinkLength=idealLinkLength,this.constraints=null,this.useJaccardLinkLengths=!0,this.result=new Array(Layout3D.k);for(var i=0;i<Layout3D.k;++i)this.result[i]=new Array(nodes.length);nodes.forEach((function(v,i){for(var _i=0,_a=Layout3D.dims;_i<_a.length;_i++){var dim=_a[_i];void 0===v[dim]&&(v[dim]=Math.random())}_this.result[0][i]=v.x,_this.result[1][i]=v.y,_this.result[2][i]=v.z}))}return Layout3D.prototype.linkLength=function(l){return l.actualLength(this.result)},Layout3D.prototype.start=function(iterations){var _this=this;void 0===iterations&&(iterations=100);var n=this.nodes.length,linkAccessor=new LinkAccessor;this.useJaccardLinkLengths&&linklengths.jaccardLinkLengths(this.links,linkAccessor,1.5),this.links.forEach((function(e){return e.length*=_this.idealLinkLength}));var distanceMatrix=new shortestpaths.Calculator(n,this.links,(function(e){return e.source}),(function(e){return e.target}),(function(e){return e.length})).DistanceMatrix(),D=descent.Descent.createSquareMatrix(n,(function(i,j){return distanceMatrix[i][j]})),G=descent.Descent.createSquareMatrix(n,(function(){return 2}));this.links.forEach((function(_a){var source=_a.source,target=_a.target;return G[source][target]=G[target][source]=1})),this.descent=new descent.Descent(this.result,D),this.descent.threshold=.001,this.descent.G=G,this.constraints&&(this.descent.project=new rectangle.Projection(this.nodes,null,null,this.constraints).projectFunctions());for(var i=0;i<this.nodes.length;i++){var v=this.nodes[i];v.fixed&&this.descent.locks.add(i,[v.x,v.y,v.z])}return this.descent.run(iterations),this},Layout3D.prototype.tick=function(){this.descent.locks.clear();for(var i=0;i<this.nodes.length;i++){var v=this.nodes[i];v.fixed&&this.descent.locks.add(i,[v.x,v.y,v.z])}return this.descent.rungeKutta()},Layout3D.dims=["x","y","z"],Layout3D.k=Layout3D.dims.length,Layout3D}();exports.Layout3D=Layout3D;var LinkAccessor=function(){function LinkAccessor(){}return LinkAccessor.prototype.getSourceIndex=function(e){return e.source},LinkAccessor.prototype.getTargetIndex=function(e){return e.target},LinkAccessor.prototype.getLength=function(e){return e.length},LinkAccessor.prototype.setLength=function(e,l){e.length=l},LinkAccessor}()})),batch=createCommonjsModule((function(module,exports){function route(nodes,groups,margin,groupMargin){nodes.forEach((function(d){d.routerNode={name:d.name,bounds:d.bounds.inflate(-margin)}})),groups.forEach((function(d){d.routerNode={bounds:d.bounds.inflate(-groupMargin),children:(void 0!==d.groups?d.groups.map((function(c){return nodes.length+c.id})):[]).concat(void 0!==d.leaves?d.leaves.map((function(c){return c.index})):[])}}));var gridRouterNodes=nodes.concat(groups).map((function(d,i){return d.routerNode.id=i,d.routerNode}));return new gridrouter.GridRouter(gridRouterNodes,{getChildren:function getChildren(v){return v.children},getBounds:function getBounds(v){return v.bounds}},margin-groupMargin)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.gridify=function gridify(pgLayout,nudgeGap,margin,groupMargin){return pgLayout.cola.start(0,0,0,10,!1),route(pgLayout.cola.nodes(),pgLayout.cola.groups(),margin,groupMargin).routeEdges(pgLayout.powerGraph.powerEdges,nudgeGap,(function(e){return e.source.routerNode.id}),(function(e){return e.target.routerNode.id}))},exports.powerGraphGridLayout=function powerGraphGridLayout(graph,size,grouppadding){var powerGraph;graph.nodes.forEach((function(v,i){return v.index=i})),(new layout$1.Layout).avoidOverlaps(!1).nodes(graph.nodes).links(graph.links).powerGraphGroups((function(d){(powerGraph=d).groups.forEach((function(v){return v.padding=grouppadding}))}));var n=graph.nodes.length,edges=[],vs=graph.nodes.slice(0);return vs.forEach((function(v,i){return v.index=i})),powerGraph.groups.forEach((function(g){var sourceInd=g.index=g.id+n;vs.push(g),void 0!==g.leaves&&g.leaves.forEach((function(v){return edges.push({source:sourceInd,target:v.index})})),void 0!==g.groups&&g.groups.forEach((function(gg){return edges.push({source:sourceInd,target:gg.id+n})}))})),powerGraph.powerEdges.forEach((function(e){edges.push({source:e.source.index,target:e.target.index})})),(new layout$1.Layout).size(size).nodes(vs).links(edges).avoidOverlaps(!1).linkDistance(30).symmetricDiffLinkLengths(5).convergenceThreshold(1e-4).start(100,0,0,0,!1),{cola:(new layout$1.Layout).convergenceThreshold(.001).size(size).avoidOverlaps(!0).nodes(graph.nodes).links(graph.links).groupCompactness(1e-4).linkDistance(30).symmetricDiffLinkLengths(5).powerGraphGroups((function(d){(powerGraph=d).groups.forEach((function(v){v.padding=grouppadding}))})).start(50,0,100,0,!1),powerGraph:powerGraph}}})),dist$1=createCommonjsModule((function(module,exports){function __export(m){for(var p in m)exports.hasOwnProperty(p)||(exports[p]=m[p])}Object.defineProperty(exports,"__esModule",{value:!0}),__export(adaptor_1),__export(d3adaptor_1),__export(descent),__export(geom),__export(gridrouter),__export(handledisconnected),__export(layout$1),__export(layout3d),__export(linklengths),__export(powergraph),__export(pqueue),__export(rbtree),__export(rectangle),__export(shortestpaths),__export(vpsc),__export(batch)})),cytoscapeCola=createCommonjsModule((function(module,exports){!function webpackUniversalModuleDefinition(root,factory){module.exports=factory(dist$1)}(0,(function(__WEBPACK_EXTERNAL_MODULE_5__){return function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}return __webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.i=function(value){return value},__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{configurable:!1,enumerable:!0,get:getter})},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module.default}:function getModuleExports(){return module};return __webpack_require__.d(getter,"a",getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=3)}([function(module,exports,__webpack_require__){var _typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(obj){return _typeof2(obj)}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)},assign=__webpack_require__(1),defaults=__webpack_require__(2),cola=__webpack_require__(5)||("undefined"!=typeof window?window.cola:null),raf=__webpack_require__(4),isNumber=function isNumber(o){return(void 0===o?"undefined":_typeof(o))===_typeof(0)},nop=function nop(){},getOptVal=function getOptVal(val,ele){return function isFunction(o){return null!=o&&(void 0===o?"undefined":_typeof(o))===_typeof((function(){}))}(val)?val.apply(ele,[ele]):val};function ColaLayout(options){this.options=assign({},defaults,options)}ColaLayout.prototype.run=function(){var layout=this,options=this.options;layout.manuallyStopped=!1;var cy=options.cy,eles=options.eles,nodes=eles.nodes(),edges=eles.edges(),ready=!1,parentNodes=nodes.filter((function isParent(ele){return ele.isParent()})),nonparentNodes=nodes.subtract(parentNodes),bb=options.boundingBox||{x1:0,y1:0,w:cy.width(),h:cy.height()};void 0===bb.x2&&(bb.x2=bb.x1+bb.w),void 0===bb.w&&(bb.w=bb.x2-bb.x1),void 0===bb.y2&&(bb.y2=bb.y1+bb.h),void 0===bb.h&&(bb.h=bb.y2-bb.y1);var updateNodePositions=function updateNodePositions(){for(var i=0;i<nodes.length;i++){var node=nodes[i],dimensions=node.layoutDimensions(options),scratch=node.scratch("cola");if(!scratch.updatedDims){var padding=getOptVal(options.nodeSpacing,node);scratch.width=dimensions.w+2*padding,scratch.height=dimensions.h+2*padding}}nodes.positions((function(node){var scratch=node.scratch().cola,retPos=void 0;return!node.grabbed()&&nonparentNodes.contains(node)&&(retPos={x:bb.x1+scratch.x,y:bb.y1+scratch.y},isNumber(retPos.x)&&isNumber(retPos.y)||(retPos=void 0)),retPos})),nodes.updateCompoundBounds(),ready||(onReady(),ready=!0),options.fit&&cy.fit(options.padding)},onDone=function onDone(){options.ungrabifyWhileSimulating&&grabbableNodes.grabify(),cy.off("destroy",destroyHandler),nodes.off("grab free position",grabHandler),nodes.off("lock unlock",lockHandler),layout.one("layoutstop",options.stop),layout.trigger({type:"layoutstop",layout:layout})},onReady=function onReady(){layout.one("layoutready",options.ready),layout.trigger({type:"layoutready",layout:layout})},ticksPerFrame=options.refresh;ticksPerFrame=options.refresh<0?1:Math.max(1,ticksPerFrame);var adaptor=layout.adaptor=cola.adaptor({trigger:function trigger(e){var TICK=cola.EventType?cola.EventType.tick:null,END=cola.EventType?cola.EventType.end:null;switch(e.type){case"tick":case TICK:options.animate&&updateNodePositions();break;case"end":case END:updateNodePositions(),options.infinite||onDone()}},kick:function kick(){var firstTick=!0,inftick=function inftick(){if(layout.manuallyStopped)return onDone(),!0;var ret=adaptor.tick();return options.infinite||firstTick||adaptor.convergenceThreshold(options.convergenceThreshold),firstTick=!1,ret&&options.infinite&&adaptor.resume(),ret};if(options.animate){raf((function frame(){(function multitick(){for(var ret=void 0,i=0;i<ticksPerFrame&&!ret;i++)ret=ret||inftick();return ret})()||raf(frame)}))}else for(;!inftick(););},on:nop,drag:nop});layout.adaptor=adaptor;var grabbableNodes=nodes.filter(":grabbable");options.ungrabifyWhileSimulating&&grabbableNodes.ungrabify();var destroyHandler=void 0;cy.one("destroy",destroyHandler=function destroyHandler(){layout.stop()});var grabHandler=void 0;nodes.on("grab free position",grabHandler=function grabHandler(e){var scrCola=this.scratch().cola,pos=this.position();if(e.cyTarget===this||e.target===this)switch(e.type){case"grab":adaptor.dragstart(scrCola);break;case"free":adaptor.dragend(scrCola);break;case"position":scrCola.px===pos.x-bb.x1&&scrCola.py===pos.y-bb.y1||(scrCola.px=pos.x-bb.x1,scrCola.py=pos.y-bb.y1)}});var lockHandler=void 0;nodes.on("lock unlock",lockHandler=function lockHandler(){var scrCola=this.scratch().cola;scrCola.fixed=this.locked(),this.locked()?adaptor.dragstart(scrCola):adaptor.dragend(scrCola)}),adaptor.nodes(nonparentNodes.map((function(node,i){var padding=getOptVal(options.nodeSpacing,node),pos=node.position(),dimensions=node.layoutDimensions(options);return node.scratch().cola={x:options.randomize&&!node.locked()||void 0===pos.x?Math.round(Math.random()*bb.w):pos.x,y:options.randomize&&!node.locked()||void 0===pos.y?Math.round(Math.random()*bb.h):pos.y,width:dimensions.w+2*padding,height:dimensions.h+2*padding,index:i,fixed:node.locked()}})));var constraints=[];if(options.alignment){if(options.alignment.vertical)options.alignment.vertical.forEach((function(alignment){var offsetsX=[];alignment.forEach((function(nodeData){var index=nodeData.node.scratch().cola.index;offsetsX.push({node:index,offset:nodeData.offset?nodeData.offset:0})})),constraints.push({type:"alignment",axis:"x",offsets:offsetsX})}));if(options.alignment.horizontal)options.alignment.horizontal.forEach((function(alignment){var offsetsY=[];alignment.forEach((function(nodeData){var index=nodeData.node.scratch().cola.index;offsetsY.push({node:index,offset:nodeData.offset?nodeData.offset:0})})),constraints.push({type:"alignment",axis:"y",offsets:offsetsY})}))}options.gapInequalities&&options.gapInequalities.forEach((function(inequality){var leftIndex=inequality.left.scratch().cola.index,rightIndex=inequality.right.scratch().cola.index;constraints.push({axis:inequality.axis,left:leftIndex,right:rightIndex,gap:inequality.gap,equality:inequality.equality})})),constraints.length>0&&adaptor.constraints(constraints),adaptor.groups(parentNodes.map((function(node,i){var optPadding=getOptVal(options.nodeSpacing,node),getPadding=function getPadding(d){return parseFloat(node.style("padding-"+d))},pleft=getPadding("left")+optPadding,pright=getPadding("right")+optPadding,ptop=getPadding("top")+optPadding,pbottom=getPadding("bottom")+optPadding;return node.scratch().cola={index:i,padding:Math.max(pleft,pright,ptop,pbottom),leaves:node.children().intersection(nonparentNodes).map((function(child){return child[0].scratch().cola.index})),fixed:node.locked()},node})).map((function(node){return node.scratch().cola.groups=node.children().intersection(parentNodes).map((function(child){return child.scratch().cola.index})),node.scratch().cola})));var length=void 0,lengthFnName=void 0;null!=options.edgeLength?(length=options.edgeLength,lengthFnName="linkDistance"):null!=options.edgeSymDiffLength?(length=options.edgeSymDiffLength,lengthFnName="symmetricDiffLinkLengths"):null!=options.edgeJaccardLength?(length=options.edgeJaccardLength,lengthFnName="jaccardLinkLengths"):(length=100,lengthFnName="linkDistance");if(adaptor.links(edges.stdFilter((function(edge){return nonparentNodes.contains(edge.source())&&nonparentNodes.contains(edge.target())})).map((function(edge){var c=edge.scratch().cola={source:edge.source()[0].scratch().cola.index,target:edge.target()[0].scratch().cola.index};return null!=length&&(c.calcLength=getOptVal(length,edge)),c}))),adaptor.size([bb.w,bb.h]),null!=length&&adaptor[lengthFnName]((function lengthGetter(link){return link.calcLength})),options.flow){var flow=void 0;!function isString(o){return(void 0===o?"undefined":_typeof(o))===_typeof("")}(options.flow)?isNumber(options.flow)?flow={axis:"y",minSeparation:options.flow}:!function isObject(o){return null!=o&&(void 0===o?"undefined":_typeof(o))===_typeof({})}(options.flow)?flow={axis:"y",minSeparation:50}:((flow=options.flow).axis=flow.axis||"y",flow.minSeparation=null!=flow.minSeparation?flow.minSeparation:50):flow={axis:options.flow,minSeparation:50},adaptor.flowLayout(flow.axis,flow.minSeparation)}return layout.trigger({type:"layoutstart",layout:layout}),adaptor.avoidOverlaps(options.avoidOverlap).handleDisconnected(options.handleDisconnected).start(options.unconstrIter,options.userConstIter,options.allConstIter),options.infinite||setTimeout((function(){layout.manuallyStopped||adaptor.stop()}),options.maxSimulationTime),this},ColaLayout.prototype.stop=function(){return this.adaptor&&(this.manuallyStopped=!0,this.adaptor.stop()),this},module.exports=ColaLayout},function(module,exports,__webpack_require__){module.exports=null!=Object.assign?Object.assign.bind(Object):function(tgt){for(var _len=arguments.length,srcs=Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)srcs[_key-1]=arguments[_key];return srcs.filter((function(src){return null!=src})).forEach((function(src){Object.keys(src).forEach((function(k){return tgt[k]=src[k]}))})),tgt}},function(module,exports,__webpack_require__){var defaults={animate:!0,refresh:1,maxSimulationTime:4e3,ungrabifyWhileSimulating:!1,fit:!0,padding:30,boundingBox:void 0,nodeDimensionsIncludeLabels:!1,ready:function ready(){},stop:function stop(){},randomize:!1,avoidOverlap:!0,handleDisconnected:!0,convergenceThreshold:.01,nodeSpacing:function nodeSpacing(node){return 10},flow:void 0,alignment:void 0,gapInequalities:void 0,edgeLength:void 0,edgeSymDiffLength:void 0,edgeJaccardLength:void 0,unconstrIter:void 0,userConstIter:void 0,allConstIter:void 0,infinite:!1};module.exports=defaults},function(module,exports,__webpack_require__){var impl=__webpack_require__(0),register=function register(cytoscape){cytoscape&&cytoscape("layout","cola",impl)};"undefined"!=typeof cytoscape&&register(cytoscape),module.exports=register},function(module,exports,__webpack_require__){var _typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(obj){return _typeof2(obj)}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)},raf=void 0;raf="undefined"!==("undefined"==typeof window?"undefined":_typeof(window))?window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(fn){return setTimeout(fn,16)}:function raf(cb){cb()},module.exports=raf},function(module,exports){module.exports=__WEBPACK_EXTERNAL_MODULE_5__}])}))}));cytoscape_cjs.use(cytoscapeCola);var layoutConfig$1={name:"cola",animate:!0,ready:function ready(e){e.cy.fit(),e.cy.center()}},EntryGraph=function(_PlaygroundElement9){_inherits(EntryGraph,_PlaygroundElement9);var _super15=_createSuper(EntryGraph);function EntryGraph(){var _this34;return _classCallCheck2(this,EntryGraph),(_this34=_super15.apply(this,arguments)).hideFilter=!1,_this34.showEntryContents=!1,_this34.excludedEntryTypes=[],_this34.lastEntriesIds=[],_this34.ready=!1,_this34._entryTypes=[],_this34}return _createClass2(EntryGraph,[{key:"firstUpdated",value:function firstUpdated(){var _this35=this;window.addEventListener("scroll",(function(){_this35.cy.resize()})),this.cy=cytoscape_cjs({container:this.entryGraph,boxSelectionEnabled:!1,autoungrabify:!1,userZoomingEnabled:!0,userPanningEnabled:!0,layout:layoutConfig$1,style:"\n              node {\n                background-color: grey;\n                font-size: 10px;\n                width: 16px;\n                label: data(label);\n                height: 16px;\n                shape: round-rectangle;\n              }\n\n              node > node {\n                height: 1px;\n              }\n      \n              edge {\n                width: 2;\n                target-arrow-shape: triangle;\n                curve-style: bezier;\n              }\n              \n              edge[label] {\n                label: data(label);\n                font-size: 7px;\n                text-rotation: autorotate;\n                text-margin-x: 0px;\n                text-margin-y: -5px;\n                text-valign: top;\n                text-halign: center;        \n              }\n      \n              .selected {\n                border-width: 1px;\n                border-color: black;\n                border-style: solid;\n              }\n      \n              .AgentId {\n                background-color: lime;\n              }\n              .Create {\n                background-color: blue;\n              }\n              .Delete {\n                background-color: red;\n              }\n              .Update {\n                background-color: cyan;\n              }\n              .CreateLink {\n                background-color: purple;\n              }\n              .DeleteLink {\n                background-color: purple;\n              }\n      \n              .implicit {\n                width: 1;\n                line-style: dotted;\n              }\n\n              .update-edge {\n                width: 1;\n                line-style: dashed;\n              }\n              .updated {\n                opacity: 0.5;\n              }\n              .deleted {\n                opacity: 0.3 !important;\n              }\n            "}),this.cy.on("tap","node",(function(event){var selectedEntryId=event.target.id();_this35.updatePlayground({activeHash:selectedEntryId})})),this.cy.ready((function(e){setTimeout((function(){_this35.ready=!0,_this35.updatedGraph()}),500)}))}},{key:"updated",value:function updated(changedValues){_get(_getPrototypeOf(EntryGraph.prototype),"updated",this).call(this,changedValues),this.updatedGraph()}},{key:"observedCells",value:function observedCells(){return selectAllCells(this.activeDna,this.conductors)}},{key:"updatedGraph",value:function updatedGraph(){if(0===this.entryGraph.getBoundingClientRect().width||!this.ready)return null;var _allEntries=allEntries(selectAllCells(this.activeDna,this.conductors),this.showEntryContents,this.excludedEntryTypes),entries=_allEntries.entries,entryTypes=_allEntries.entryTypes;Object(lodash_es__WEBPACK_IMPORTED_MODULE_125__.a)(this.lastEntriesIds,entries.map((function(e){return e.data.id})))||(this.layout&&this.layout.stop(),this.cy.remove("node"),this.cy.add(entries),this.layout=this.cy.elements().makeLayout(layoutConfig$1),this.layout.run(),this._entryTypes=entryTypes),this.lastEntriesIds=entries.map((function(e){return e.data.id})),this.cy.filter("node").removeClass("selected");var activeHashElement=this.cy.getElementById(this.activeHash);activeHashElement&&activeHashElement.addClass("selected")}},{key:"renderHelp",value:function renderHelp(){return Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject83||(_templateObject83=_taggedTemplateLiteral([' <holochain-playground-help-button\n      heading="Entry Graph"\n      class="block-help"\n    >\n      <span>\n        This graph contains a\n        <strong>high-level view of all the entries</strong> that are present in\n        the DHT. Every object you see represents an entry, and the relationships\n        between them are links.\n        <br />\n        <br />\n        Dashed relationships are embedded references, and solid relationships\n        are normal holochain links. The tag of the holochain links appears as\n        the label.\n      </span>\n    </holochain-playground-help-button>'])))}},{key:"renderFilter",value:function renderFilter(){var _this36=this;return Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject84||(_templateObject84=_taggedTemplateLiteral([' <div\n      class="row"\n      style="align-items: center; justify-content: start; position: relative;"\n    >\n      <mwc-formfield label="Show Entry Contents" style="margin-right: 16px">\n        <mwc-checkbox\n          checked\n          @change=','\n        ></mwc-checkbox\n      ></mwc-formfield>\n\n      <span class="vertical-divider"></span>\n\n      <mwc-button\n        label="Visible entries"\n        style="--mdc-theme-primary: rgba(0,0,0,0.7); margin-left: 16px;"\n        icon="arrow_drop_down"\n        id="visible-entries-button"\n        trailingIcon\n        @click=','\n      ></mwc-button>\n      <mwc-menu\n        corner="BOTTOM_END"\n        multi\n        activatable\n        id="visible-entries-menu"\n        .anchor=',"\n        @selected=","\n      >\n        ","\n      </mwc-menu>\n    </div>"])),(function(e){return _this36.showEntryContents=e.target.checked}),(function(){return _this36._visibleEntriesMenu.show()}),this._visibleEntriesButton,(function(e){var includedEntryTypes=_toConsumableArray(e.detail.index);_this36.excludedEntryTypes=_this36._entryTypes.filter((function(type,index){return!includedEntryTypes.includes(index)}))}),this._entryTypes.map((function(type){return Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject85||(_templateObject85=_taggedTemplateLiteral(['\n            <mwc-list-item\n              graphic="icon"\n              .selected=',"\n              .activated=","\n            >\n              ","\n              ","\n            </mwc-list-item>\n          "])),!_this36.excludedEntryTypes.includes(type),!_this36.excludedEntryTypes.includes(type),_this36.excludedEntryTypes.includes(type)?Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject87||(_templateObject87=_taggedTemplateLiteral([""]))):Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject86||(_templateObject86=_taggedTemplateLiteral([' <mwc-icon slot="graphic">check</mwc-icon> ']))),type)})))}},{key:"render",value:function render(){return Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject88||(_templateObject88=_taggedTemplateLiteral(['\n      <mwc-card class="block-card">\n        <div class="column fill" style="margin: 16px;">\n          <span class="block-title">Entry Graph</span>\n\n          <div id="entry-graph" class="fill"></div>\n\n          ',"\n          ","\n        </div>\n      </mwc-card>\n    "])),this.renderHelp(),this.hideFilter?Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject89||(_templateObject89=_taggedTemplateLiteral([""]))):this.renderFilter())}}],[{key:"styles",get:function get(){return[sharedStyles,Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.b)(_templateObject90||(_templateObject90=_taggedTemplateLiteral(["\n        :host {\n          display: flex;\n        }\n      "])))]}},{key:"scopedElements",get:function get(){return{"mwc-checkbox":scoped_material_components_mwc_checkbox__WEBPACK_IMPORTED_MODULE_126__.a,"mwc-formfield":scoped_material_components_mwc_formfield__WEBPACK_IMPORTED_MODULE_121__.a,"mwc-icon-button":scoped_material_components_mwc_icon_button__WEBPACK_IMPORTED_MODULE_100__.a,"mwc-card":scoped_material_components_mwc_card__WEBPACK_IMPORTED_MODULE_111__.a,"mwc-menu":scoped_material_components_mwc_menu__WEBPACK_IMPORTED_MODULE_123__.a,"mwc-icon":scoped_material_components_mwc_icon__WEBPACK_IMPORTED_MODULE_107__.a,"mwc-list-item":scoped_material_components_mwc_list_item__WEBPACK_IMPORTED_MODULE_112__.a,"mwc-button":scoped_material_components_mwc_button__WEBPACK_IMPORTED_MODULE_106__.a,"holochain-playground-help-button":HelpButton}}}]),EntryGraph}(PlaygroundElement);__decorate([Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.g)({type:Boolean,attribute:"hide-filter"}),__metadata("design:type",Boolean)],EntryGraph.prototype,"hideFilter",void 0),__decorate([Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.g)({type:Boolean,attribute:"show-entry-contents"}),__metadata("design:type",Boolean)],EntryGraph.prototype,"showEntryContents",void 0),__decorate([Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.g)({type:Array}),__metadata("design:type",Array)],EntryGraph.prototype,"excludedEntryTypes",void 0),__decorate([Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.h)("#entry-graph"),__metadata("design:type",HTMLElement)],EntryGraph.prototype,"entryGraph",void 0),__decorate([Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.g)({type:Array}),__metadata("design:type",Object)],EntryGraph.prototype,"_entryTypes",void 0),__decorate([Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.h)("#visible-entries-button"),__metadata("design:type",scoped_material_components_mwc_button__WEBPACK_IMPORTED_MODULE_106__.a)],EntryGraph.prototype,"_visibleEntriesButton",void 0),__decorate([Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.h)("#visible-entries-menu"),__metadata("design:type",scoped_material_components_mwc_menu__WEBPACK_IMPORTED_MODULE_123__.a)],EntryGraph.prototype,"_visibleEntriesMenu",void 0);var _listCacheClear=function listCacheClear(){this.__data__=[],this.size=0};var eq_1=function eq(value,other){return value===other||value!=value&&other!=other};var _assocIndexOf=function assocIndexOf(array,key){for(var length=array.length;length--;)if(eq_1(array[length][0],key))return length;return-1},splice=Array.prototype.splice;var _listCacheDelete=function listCacheDelete(key){var data=this.__data__,index=_assocIndexOf(data,key);return!(index<0)&&(index==data.length-1?data.pop():splice.call(data,index,1),--this.size,!0)};var _listCacheGet=function listCacheGet(key){var data=this.__data__,index=_assocIndexOf(data,key);return index<0?void 0:data[index][1]};var _listCacheHas=function listCacheHas(key){return _assocIndexOf(this.__data__,key)>-1};var _listCacheSet=function listCacheSet(key,value){var data=this.__data__,index=_assocIndexOf(data,key);return index<0?(++this.size,data.push([key,value])):data[index][1]=value,this};function ListCache(entries){var index=-1,length=null==entries?0:entries.length;for(this.clear();++index<length;){var entry=entries[index];this.set(entry[0],entry[1])}}ListCache.prototype.clear=_listCacheClear,ListCache.prototype.delete=_listCacheDelete,ListCache.prototype.get=_listCacheGet,ListCache.prototype.has=_listCacheHas,ListCache.prototype.set=_listCacheSet;var _ListCache=ListCache;var _stackClear=function stackClear(){this.__data__=new _ListCache,this.size=0};var _stackDelete=function stackDelete(key){var data=this.__data__,result=data.delete(key);return this.size=data.size,result};var _stackGet=function stackGet(key){return this.__data__.get(key)};var _stackHas=function stackHas(key){return this.__data__.has(key)},_freeGlobal="object"==_typeof2(commonjsGlobal)&&commonjsGlobal&&commonjsGlobal.Object===Object&&commonjsGlobal,freeSelf$1="object"==("undefined"==typeof self?"undefined":_typeof2(self))&&self&&self.Object===Object&&self,_root=_freeGlobal||freeSelf$1||Function("return this")(),_Symbol=_root.Symbol,objectProto$1=Object.prototype,hasOwnProperty=objectProto$1.hasOwnProperty,nativeObjectToString=objectProto$1.toString,symToStringTag=_Symbol?_Symbol.toStringTag:void 0;var _getRawTag=function getRawTag(value){var isOwn=hasOwnProperty.call(value,symToStringTag),tag=value[symToStringTag];try{value[symToStringTag]=void 0;var unmasked=!0}catch(e){}var result=nativeObjectToString.call(value);return unmasked&&(isOwn?value[symToStringTag]=tag:delete value[symToStringTag]),result},nativeObjectToString$1=Object.prototype.toString;var _objectToString=function objectToString$1(value){return nativeObjectToString$1.call(value)},symToStringTag$1=_Symbol?_Symbol.toStringTag:void 0;var _baseGetTag=function baseGetTag(value){return null==value?void 0===value?"[object Undefined]":"[object Null]":symToStringTag$1&&symToStringTag$1 in Object(value)?_getRawTag(value):_objectToString(value)};var isObject_1=function isObject$2(value){var type=_typeof2(value);return null!=value&&("object"==type||"function"==type)};var uid,isFunction_1=function isFunction(value){if(!isObject_1(value))return!1;var tag=_baseGetTag(value);return"[object Function]"==tag||"[object GeneratorFunction]"==tag||"[object AsyncFunction]"==tag||"[object Proxy]"==tag},_coreJsData=_root["__core-js_shared__"],maskSrcKey=(uid=/[^.]+$/.exec(_coreJsData&&_coreJsData.keys&&_coreJsData.keys.IE_PROTO||""))?"Symbol(src)_1."+uid:"";var _isMasked=function isMasked(func){return!!maskSrcKey&&maskSrcKey in func},funcToString=Function.prototype.toString;var _toSource=function toSource(func){if(null!=func){try{return funcToString.call(func)}catch(e){}try{return func+""}catch(e){}}return""},reIsHostCtor=/^\[object .+?Constructor\]$/,funcProto$1=Function.prototype,objectProto$3=Object.prototype,funcToString$1=funcProto$1.toString,hasOwnProperty$1=objectProto$3.hasOwnProperty,reIsNative=RegExp("^"+funcToString$1.call(hasOwnProperty$1).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var _baseIsNative=function baseIsNative(value){return!(!isObject_1(value)||_isMasked(value))&&(isFunction_1(value)?reIsNative:reIsHostCtor).test(_toSource(value))};var _getValue=function getValue$1(object,key){return null==object?void 0:object[key]};var _getNative=function getNative(object,key){var value=_getValue(object,key);return _baseIsNative(value)?value:void 0},_Map=_getNative(_root,"Map"),_nativeCreate=_getNative(Object,"create");var _hashClear=function hashClear(){this.__data__=_nativeCreate?_nativeCreate(null):{},this.size=0};var _hashDelete=function hashDelete(key){var result=this.has(key)&&delete this.__data__[key];return this.size-=result?1:0,result},hasOwnProperty$2=Object.prototype.hasOwnProperty;var _hashGet=function hashGet(key){var data=this.__data__;if(_nativeCreate){var result=data[key];return"__lodash_hash_undefined__"===result?void 0:result}return hasOwnProperty$2.call(data,key)?data[key]:void 0},hasOwnProperty$3=Object.prototype.hasOwnProperty;var _hashHas=function hashHas(key){var data=this.__data__;return _nativeCreate?void 0!==data[key]:hasOwnProperty$3.call(data,key)};var _hashSet=function hashSet(key,value){var data=this.__data__;return this.size+=this.has(key)?0:1,data[key]=_nativeCreate&&void 0===value?"__lodash_hash_undefined__":value,this};function Hash(entries){var index=-1,length=null==entries?0:entries.length;for(this.clear();++index<length;){var entry=entries[index];this.set(entry[0],entry[1])}}Hash.prototype.clear=_hashClear,Hash.prototype.delete=_hashDelete,Hash.prototype.get=_hashGet,Hash.prototype.has=_hashHas,Hash.prototype.set=_hashSet;var _Hash=Hash;var _mapCacheClear=function mapCacheClear(){this.size=0,this.__data__={hash:new _Hash,map:new(_Map||_ListCache),string:new _Hash}};var _isKeyable=function isKeyable(value){var type=_typeof2(value);return"string"==type||"number"==type||"symbol"==type||"boolean"==type?"__proto__"!==value:null===value};var _getMapData=function getMapData(map,key){var data=map.__data__;return _isKeyable(key)?data["string"==typeof key?"string":"hash"]:data.map};var _mapCacheDelete=function mapCacheDelete(key){var result=_getMapData(this,key).delete(key);return this.size-=result?1:0,result};var _mapCacheGet=function mapCacheGet(key){return _getMapData(this,key).get(key)};var _mapCacheHas=function mapCacheHas(key){return _getMapData(this,key).has(key)};var _mapCacheSet=function mapCacheSet(key,value){var data=_getMapData(this,key),size=data.size;return data.set(key,value),this.size+=data.size==size?0:1,this};function MapCache(entries){var index=-1,length=null==entries?0:entries.length;for(this.clear();++index<length;){var entry=entries[index];this.set(entry[0],entry[1])}}MapCache.prototype.clear=_mapCacheClear,MapCache.prototype.delete=_mapCacheDelete,MapCache.prototype.get=_mapCacheGet,MapCache.prototype.has=_mapCacheHas,MapCache.prototype.set=_mapCacheSet;var _MapCache=MapCache;var _stackSet=function stackSet(key,value){var data=this.__data__;if(data instanceof _ListCache){var pairs=data.__data__;if(!_Map||pairs.length<199)return pairs.push([key,value]),this.size=++data.size,this;data=this.__data__=new _MapCache(pairs)}return data.set(key,value),this.size=data.size,this};function Stack(entries){var data=this.__data__=new _ListCache(entries);this.size=data.size}Stack.prototype.clear=_stackClear,Stack.prototype.delete=_stackDelete,Stack.prototype.get=_stackGet,Stack.prototype.has=_stackHas,Stack.prototype.set=_stackSet;var _Stack=Stack;var _arrayEach=function arrayEach(array,iteratee){for(var index=-1,length=null==array?0:array.length;++index<length&&!1!==iteratee(array[index],index,array););return array},_defineProperty$1=function(){try{var func=_getNative(Object,"defineProperty");return func({},"",{}),func}catch(e){}}();var _baseAssignValue=function baseAssignValue(object,key,value){"__proto__"==key&&_defineProperty$1?_defineProperty$1(object,key,{configurable:!0,enumerable:!0,value:value,writable:!0}):object[key]=value},hasOwnProperty$4=Object.prototype.hasOwnProperty;var _assignValue=function assignValue(object,key,value){var objValue=object[key];hasOwnProperty$4.call(object,key)&&eq_1(objValue,value)&&(void 0!==value||key in object)||_baseAssignValue(object,key,value)};var _copyObject=function copyObject(source,props,object,customizer){var isNew=!object;object||(object={});for(var index=-1,length=props.length;++index<length;){var key=props[index],newValue=customizer?customizer(object[key],source[key],key,object,source):void 0;void 0===newValue&&(newValue=source[key]),isNew?_baseAssignValue(object,key,newValue):_assignValue(object,key,newValue)}return object};var _baseTimes=function baseTimes(n,iteratee){for(var index=-1,result=Array(n);++index<n;)result[index]=iteratee(index);return result};var isObjectLike_1=function isObjectLike$1(value){return null!=value&&"object"==_typeof2(value)};var _baseIsArguments=function baseIsArguments(value){return isObjectLike_1(value)&&"[object Arguments]"==_baseGetTag(value)},objectProto$7=Object.prototype,hasOwnProperty$5=objectProto$7.hasOwnProperty,propertyIsEnumerable=objectProto$7.propertyIsEnumerable,isArguments_1=_baseIsArguments(function(){return arguments}())?_baseIsArguments:function(value){return isObjectLike_1(value)&&hasOwnProperty$5.call(value,"callee")&&!propertyIsEnumerable.call(value,"callee")},isArray_1=Array.isArray;var stubFalse_1=function stubFalse(){return!1},isBuffer_1=createCommonjsModule((function(module,exports){var freeExports=exports&&!exports.nodeType&&exports,freeModule=freeExports&&module&&!module.nodeType&&module,Buffer=freeModule&&freeModule.exports===freeExports?_root.Buffer:void 0,isBuffer=(Buffer?Buffer.isBuffer:void 0)||stubFalse_1;module.exports=isBuffer})),reIsUint=/^(?:0|[1-9]\d*)$/;var _isIndex=function isIndex(value,length){var type=_typeof2(value);return!!(length=null==length?9007199254740991:length)&&("number"==type||"symbol"!=type&&reIsUint.test(value))&&value>-1&&value%1==0&&value<length};var isLength_1=function isLength(value){return"number"==typeof value&&value>-1&&value%1==0&&value<=9007199254740991},typedArrayTags={};typedArrayTags["[object Float32Array]"]=typedArrayTags["[object Float64Array]"]=typedArrayTags["[object Int8Array]"]=typedArrayTags["[object Int16Array]"]=typedArrayTags["[object Int32Array]"]=typedArrayTags["[object Uint8Array]"]=typedArrayTags["[object Uint8ClampedArray]"]=typedArrayTags["[object Uint16Array]"]=typedArrayTags["[object Uint32Array]"]=!0,typedArrayTags["[object Arguments]"]=typedArrayTags["[object Array]"]=typedArrayTags["[object ArrayBuffer]"]=typedArrayTags["[object Boolean]"]=typedArrayTags["[object DataView]"]=typedArrayTags["[object Date]"]=typedArrayTags["[object Error]"]=typedArrayTags["[object Function]"]=typedArrayTags["[object Map]"]=typedArrayTags["[object Number]"]=typedArrayTags["[object Object]"]=typedArrayTags["[object RegExp]"]=typedArrayTags["[object Set]"]=typedArrayTags["[object String]"]=typedArrayTags["[object WeakMap]"]=!1;var _baseIsTypedArray=function baseIsTypedArray(value){return isObjectLike_1(value)&&isLength_1(value.length)&&!!typedArrayTags[_baseGetTag(value)]};var _baseUnary=function baseUnary(func){return function(value){return func(value)}},_nodeUtil=createCommonjsModule((function(module,exports){var freeExports=exports&&!exports.nodeType&&exports,freeModule=freeExports&&module&&!module.nodeType&&module,freeProcess=freeModule&&freeModule.exports===freeExports&&_freeGlobal.process,nodeUtil=function(){try{var types=freeModule&&freeModule.require&&freeModule.require("util").types;return types||freeProcess&&freeProcess.binding&&freeProcess.binding("util")}catch(e){}}();module.exports=nodeUtil})),nodeIsTypedArray=_nodeUtil&&_nodeUtil.isTypedArray,isTypedArray_1=nodeIsTypedArray?_baseUnary(nodeIsTypedArray):_baseIsTypedArray,hasOwnProperty$6=Object.prototype.hasOwnProperty;var _arrayLikeKeys=function arrayLikeKeys(value,inherited){var isArr=isArray_1(value),isArg=!isArr&&isArguments_1(value),isBuff=!isArr&&!isArg&&isBuffer_1(value),isType=!isArr&&!isArg&&!isBuff&&isTypedArray_1(value),skipIndexes=isArr||isArg||isBuff||isType,result=skipIndexes?_baseTimes(value.length,String):[],length=result.length;for(var key in value)!inherited&&!hasOwnProperty$6.call(value,key)||skipIndexes&&("length"==key||isBuff&&("offset"==key||"parent"==key)||isType&&("buffer"==key||"byteLength"==key||"byteOffset"==key)||_isIndex(key,length))||result.push(key);return result},objectProto$9=Object.prototype;var _isPrototype=function isPrototype(value){var Ctor=value&&value.constructor;return value===("function"==typeof Ctor&&Ctor.prototype||objectProto$9)};var _overArg=function overArg(func,transform){return function(arg){return func(transform(arg))}},_nativeKeys=_overArg(Object.keys,Object),hasOwnProperty$7=Object.prototype.hasOwnProperty;var _baseKeys=function baseKeys(object){if(!_isPrototype(object))return _nativeKeys(object);var result=[];for(var key in Object(object))hasOwnProperty$7.call(object,key)&&"constructor"!=key&&result.push(key);return result};var isArrayLike_1=function isArrayLike(value){return null!=value&&isLength_1(value.length)&&!isFunction_1(value)};var keys_1=function keys(object){return isArrayLike_1(object)?_arrayLikeKeys(object):_baseKeys(object)};var _baseAssign=function baseAssign(object,source){return object&&_copyObject(source,keys_1(source),object)};var _nativeKeysIn=function nativeKeysIn(object){var result=[];if(null!=object)for(var key in Object(object))result.push(key);return result},hasOwnProperty$8=Object.prototype.hasOwnProperty;var _baseKeysIn=function baseKeysIn(object){if(!isObject_1(object))return _nativeKeysIn(object);var isProto=_isPrototype(object),result=[];for(var key in object)("constructor"!=key||!isProto&&hasOwnProperty$8.call(object,key))&&result.push(key);return result};var keysIn_1=function keysIn(object){return isArrayLike_1(object)?_arrayLikeKeys(object,!0):_baseKeysIn(object)};var _baseAssignIn=function baseAssignIn(object,source){return object&&_copyObject(source,keysIn_1(source),object)},_cloneBuffer=createCommonjsModule((function(module,exports){var freeExports=exports&&!exports.nodeType&&exports,freeModule=freeExports&&module&&!module.nodeType&&module,Buffer=freeModule&&freeModule.exports===freeExports?_root.Buffer:void 0,allocUnsafe=Buffer?Buffer.allocUnsafe:void 0;module.exports=function cloneBuffer(buffer,isDeep){if(isDeep)return buffer.slice();var length=buffer.length,result=allocUnsafe?allocUnsafe(length):new buffer.constructor(length);return buffer.copy(result),result}}));var _copyArray=function copyArray$1(source,array){var index=-1,length=source.length;for(array||(array=Array(length));++index<length;)array[index]=source[index];return array};var _arrayFilter=function arrayFilter(array,predicate){for(var index=-1,length=null==array?0:array.length,resIndex=0,result=[];++index<length;){var value=array[index];predicate(value,index,array)&&(result[resIndex++]=value)}return result};var stubArray_1=function stubArray(){return[]},propertyIsEnumerable$1=Object.prototype.propertyIsEnumerable,nativeGetSymbols=Object.getOwnPropertySymbols,_getSymbols=nativeGetSymbols?function(object){return null==object?[]:(object=Object(object),_arrayFilter(nativeGetSymbols(object),(function(symbol){return propertyIsEnumerable$1.call(object,symbol)})))}:stubArray_1;var _copySymbols=function copySymbols(source,object){return _copyObject(source,_getSymbols(source),object)};var _arrayPush=function arrayPush(array,values){for(var index=-1,length=values.length,offset=array.length;++index<length;)array[offset+index]=values[index];return array},_getPrototype=_overArg(Object.getPrototypeOf,Object),_getSymbolsIn=Object.getOwnPropertySymbols?function(object){for(var result=[];object;)_arrayPush(result,_getSymbols(object)),object=_getPrototype(object);return result}:stubArray_1;var _copySymbolsIn=function copySymbolsIn(source,object){return _copyObject(source,_getSymbolsIn(source),object)};var _baseGetAllKeys=function baseGetAllKeys(object,keysFunc,symbolsFunc){var result=keysFunc(object);return isArray_1(object)?result:_arrayPush(result,symbolsFunc(object))};var _getAllKeys=function getAllKeys(object){return _baseGetAllKeys(object,keys_1,_getSymbols)};var _getAllKeysIn=function getAllKeysIn(object){return _baseGetAllKeys(object,keysIn_1,_getSymbolsIn)},_DataView=_getNative(_root,"DataView"),_Promise=_getNative(_root,"Promise"),_Set=_getNative(_root,"Set"),_WeakMap=_getNative(_root,"WeakMap"),dataViewCtorString=_toSource(_DataView),mapCtorString=_toSource(_Map),promiseCtorString=_toSource(_Promise),setCtorString=_toSource(_Set),weakMapCtorString=_toSource(_WeakMap),getTag=_baseGetTag;(_DataView&&"[object DataView]"!=getTag(new _DataView(new ArrayBuffer(1)))||_Map&&"[object Map]"!=getTag(new _Map)||_Promise&&"[object Promise]"!=getTag(_Promise.resolve())||_Set&&"[object Set]"!=getTag(new _Set)||_WeakMap&&"[object WeakMap]"!=getTag(new _WeakMap))&&(getTag=function getTag(value){var result=_baseGetTag(value),Ctor="[object Object]"==result?value.constructor:void 0,ctorString=Ctor?_toSource(Ctor):"";if(ctorString)switch(ctorString){case dataViewCtorString:return"[object DataView]";case mapCtorString:return"[object Map]";case promiseCtorString:return"[object Promise]";case setCtorString:return"[object Set]";case weakMapCtorString:return"[object WeakMap]"}return result});var _getTag=getTag,hasOwnProperty$9=Object.prototype.hasOwnProperty;var _initCloneArray=function initCloneArray(array){var length=array.length,result=new array.constructor(length);return length&&"string"==typeof array[0]&&hasOwnProperty$9.call(array,"index")&&(result.index=array.index,result.input=array.input),result},_Uint8Array=_root.Uint8Array;var _cloneArrayBuffer=function cloneArrayBuffer(arrayBuffer){var result=new arrayBuffer.constructor(arrayBuffer.byteLength);return new _Uint8Array(result).set(new _Uint8Array(arrayBuffer)),result};var _cloneDataView=function cloneDataView(dataView,isDeep){var buffer=isDeep?_cloneArrayBuffer(dataView.buffer):dataView.buffer;return new dataView.constructor(buffer,dataView.byteOffset,dataView.byteLength)},reFlags=/\w*$/;var _cloneRegExp=function cloneRegExp(regexp){var result=new regexp.constructor(regexp.source,reFlags.exec(regexp));return result.lastIndex=regexp.lastIndex,result},symbolProto=_Symbol?_Symbol.prototype:void 0,symbolValueOf=symbolProto?symbolProto.valueOf:void 0;var _cloneSymbol=function cloneSymbol(symbol){return symbolValueOf?Object(symbolValueOf.call(symbol)):{}};var _cloneTypedArray=function cloneTypedArray(typedArray,isDeep){var buffer=isDeep?_cloneArrayBuffer(typedArray.buffer):typedArray.buffer;return new typedArray.constructor(buffer,typedArray.byteOffset,typedArray.length)};var _initCloneByTag=function initCloneByTag(object,tag,isDeep){var Ctor=object.constructor;switch(tag){case"[object ArrayBuffer]":return _cloneArrayBuffer(object);case"[object Boolean]":case"[object Date]":return new Ctor(+object);case"[object DataView]":return _cloneDataView(object,isDeep);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return _cloneTypedArray(object,isDeep);case"[object Map]":return new Ctor;case"[object Number]":case"[object String]":return new Ctor(object);case"[object RegExp]":return _cloneRegExp(object);case"[object Set]":return new Ctor;case"[object Symbol]":return _cloneSymbol(object)}},objectCreate=Object.create,_baseCreate=function(){function object(){}return function(proto){if(!isObject_1(proto))return{};if(objectCreate)return objectCreate(proto);object.prototype=proto;var result=new object;return object.prototype=void 0,result}}();var _initCloneObject=function initCloneObject(object){return"function"!=typeof object.constructor||_isPrototype(object)?{}:_baseCreate(_getPrototype(object))};var _baseIsMap=function baseIsMap(value){return isObjectLike_1(value)&&"[object Map]"==_getTag(value)},nodeIsMap=_nodeUtil&&_nodeUtil.isMap,isMap_1=nodeIsMap?_baseUnary(nodeIsMap):_baseIsMap;var _baseIsSet=function baseIsSet(value){return isObjectLike_1(value)&&"[object Set]"==_getTag(value)},nodeIsSet=_nodeUtil&&_nodeUtil.isSet,isSet_1=nodeIsSet?_baseUnary(nodeIsSet):_baseIsSet,cloneableTags={};cloneableTags["[object Arguments]"]=cloneableTags["[object Array]"]=cloneableTags["[object ArrayBuffer]"]=cloneableTags["[object DataView]"]=cloneableTags["[object Boolean]"]=cloneableTags["[object Date]"]=cloneableTags["[object Float32Array]"]=cloneableTags["[object Float64Array]"]=cloneableTags["[object Int8Array]"]=cloneableTags["[object Int16Array]"]=cloneableTags["[object Int32Array]"]=cloneableTags["[object Map]"]=cloneableTags["[object Number]"]=cloneableTags["[object Object]"]=cloneableTags["[object RegExp]"]=cloneableTags["[object Set]"]=cloneableTags["[object String]"]=cloneableTags["[object Symbol]"]=cloneableTags["[object Uint8Array]"]=cloneableTags["[object Uint8ClampedArray]"]=cloneableTags["[object Uint16Array]"]=cloneableTags["[object Uint32Array]"]=!0,cloneableTags["[object Error]"]=cloneableTags["[object Function]"]=cloneableTags["[object WeakMap]"]=!1;var _baseClone=function baseClone(value,bitmask,customizer,key,object,stack){var result,isDeep=1&bitmask,isFlat=2&bitmask,isFull=4&bitmask;if(customizer&&(result=object?customizer(value,key,object,stack):customizer(value)),void 0!==result)return result;if(!isObject_1(value))return value;var isArr=isArray_1(value);if(isArr){if(result=_initCloneArray(value),!isDeep)return _copyArray(value,result)}else{var tag=_getTag(value),isFunc="[object Function]"==tag||"[object GeneratorFunction]"==tag;if(isBuffer_1(value))return _cloneBuffer(value,isDeep);if("[object Object]"==tag||"[object Arguments]"==tag||isFunc&&!object){if(result=isFlat||isFunc?{}:_initCloneObject(value),!isDeep)return isFlat?_copySymbolsIn(value,_baseAssignIn(result,value)):_copySymbols(value,_baseAssign(result,value))}else{if(!cloneableTags[tag])return object?value:{};result=_initCloneByTag(value,tag,isDeep)}}stack||(stack=new _Stack);var stacked=stack.get(value);if(stacked)return stacked;stack.set(value,result),isSet_1(value)?value.forEach((function(subValue){result.add(baseClone(subValue,bitmask,customizer,subValue,value,stack))})):isMap_1(value)&&value.forEach((function(subValue,key){result.set(key,baseClone(subValue,bitmask,customizer,key,value,stack))}));var props=isArr?void 0:(isFull?isFlat?_getAllKeysIn:_getAllKeys:isFlat?keysIn_1:keys_1)(value);return _arrayEach(props||value,(function(subValue,key){props&&(subValue=value[key=subValue]),_assignValue(result,key,baseClone(subValue,bitmask,customizer,key,value,stack))})),result};var clone_1=function clone$1(value){return _baseClone(value,4)};var constant_1=function constant(value){return function(){return value}};var _baseFor=function createBaseFor(fromRight){return function(object,iteratee,keysFunc){for(var index=-1,iterable=Object(object),props=keysFunc(object),length=props.length;length--;){var key=props[fromRight?length:++index];if(!1===iteratee(iterable[key],key,iterable))break}return object}}();var _baseForOwn=function baseForOwn(object,iteratee){return object&&_baseFor(object,iteratee,keys_1)};var _baseEach=function createBaseEach(eachFunc,fromRight){return function(collection,iteratee){if(null==collection)return collection;if(!isArrayLike_1(collection))return eachFunc(collection,iteratee);for(var length=collection.length,index=fromRight?length:-1,iterable=Object(collection);(fromRight?index--:++index<length)&&!1!==iteratee(iterable[index],index,iterable););return collection}}(_baseForOwn);var identity_1=function identity$1(value){return value};var _castFunction=function castFunction(value){return"function"==typeof value?value:identity_1};var forEach_1=function forEach(collection,iteratee){return(isArray_1(collection)?_arrayEach:_baseEach)(collection,_castFunction(iteratee))},each=forEach_1;var _baseFilter=function baseFilter(collection,predicate){var result=[];return _baseEach(collection,(function(value,index,collection){predicate(value,index,collection)&&result.push(value)})),result};var _setCacheAdd=function setCacheAdd(value){return this.__data__.set(value,"__lodash_hash_undefined__"),this};var _setCacheHas=function setCacheHas(value){return this.__data__.has(value)};function SetCache(values){var index=-1,length=null==values?0:values.length;for(this.__data__=new _MapCache;++index<length;)this.add(values[index])}SetCache.prototype.add=SetCache.prototype.push=_setCacheAdd,SetCache.prototype.has=_setCacheHas;var _SetCache=SetCache;var _arraySome=function arraySome(array,predicate){for(var index=-1,length=null==array?0:array.length;++index<length;)if(predicate(array[index],index,array))return!0;return!1};var _cacheHas=function cacheHas(cache,key){return cache.has(key)};var _equalArrays=function equalArrays(array,other,bitmask,customizer,equalFunc,stack){var isPartial=1&bitmask,arrLength=array.length,othLength=other.length;if(arrLength!=othLength&&!(isPartial&&othLength>arrLength))return!1;var arrStacked=stack.get(array),othStacked=stack.get(other);if(arrStacked&&othStacked)return arrStacked==other&&othStacked==array;var index=-1,result=!0,seen=2&bitmask?new _SetCache:void 0;for(stack.set(array,other),stack.set(other,array);++index<arrLength;){var arrValue=array[index],othValue=other[index];if(customizer)var compared=isPartial?customizer(othValue,arrValue,index,other,array,stack):customizer(arrValue,othValue,index,array,other,stack);if(void 0!==compared){if(compared)continue;result=!1;break}if(seen){if(!_arraySome(other,(function(othValue,othIndex){if(!_cacheHas(seen,othIndex)&&(arrValue===othValue||equalFunc(arrValue,othValue,bitmask,customizer,stack)))return seen.push(othIndex)}))){result=!1;break}}else if(arrValue!==othValue&&!equalFunc(arrValue,othValue,bitmask,customizer,stack)){result=!1;break}}return stack.delete(array),stack.delete(other),result};var _mapToArray=function mapToArray(map){var index=-1,result=Array(map.size);return map.forEach((function(value,key){result[++index]=[key,value]})),result};var _setToArray=function setToArray(set){var index=-1,result=Array(set.size);return set.forEach((function(value){result[++index]=value})),result},symbolProto$1=_Symbol?_Symbol.prototype:void 0,symbolValueOf$1=symbolProto$1?symbolProto$1.valueOf:void 0;var _equalByTag=function equalByTag(object,other,tag,bitmask,customizer,equalFunc,stack){switch(tag){case"[object DataView]":if(object.byteLength!=other.byteLength||object.byteOffset!=other.byteOffset)return!1;object=object.buffer,other=other.buffer;case"[object ArrayBuffer]":return!(object.byteLength!=other.byteLength||!equalFunc(new _Uint8Array(object),new _Uint8Array(other)));case"[object Boolean]":case"[object Date]":case"[object Number]":return eq_1(+object,+other);case"[object Error]":return object.name==other.name&&object.message==other.message;case"[object RegExp]":case"[object String]":return object==other+"";case"[object Map]":var convert=_mapToArray;case"[object Set]":var isPartial=1&bitmask;if(convert||(convert=_setToArray),object.size!=other.size&&!isPartial)return!1;var stacked=stack.get(object);if(stacked)return stacked==other;bitmask|=2,stack.set(object,other);var result=_equalArrays(convert(object),convert(other),bitmask,customizer,equalFunc,stack);return stack.delete(object),result;case"[object Symbol]":if(symbolValueOf$1)return symbolValueOf$1.call(object)==symbolValueOf$1.call(other)}return!1},hasOwnProperty$a=Object.prototype.hasOwnProperty;var _equalObjects=function equalObjects(object,other,bitmask,customizer,equalFunc,stack){var isPartial=1&bitmask,objProps=_getAllKeys(object),objLength=objProps.length;if(objLength!=_getAllKeys(other).length&&!isPartial)return!1;for(var index=objLength;index--;){var key=objProps[index];if(!(isPartial?key in other:hasOwnProperty$a.call(other,key)))return!1}var objStacked=stack.get(object),othStacked=stack.get(other);if(objStacked&&othStacked)return objStacked==other&&othStacked==object;var result=!0;stack.set(object,other),stack.set(other,object);for(var skipCtor=isPartial;++index<objLength;){var objValue=object[key=objProps[index]],othValue=other[key];if(customizer)var compared=isPartial?customizer(othValue,objValue,key,other,object,stack):customizer(objValue,othValue,key,object,other,stack);if(!(void 0===compared?objValue===othValue||equalFunc(objValue,othValue,bitmask,customizer,stack):compared)){result=!1;break}skipCtor||(skipCtor="constructor"==key)}if(result&&!skipCtor){var objCtor=object.constructor,othCtor=other.constructor;objCtor==othCtor||!("constructor"in object)||!("constructor"in other)||"function"==typeof objCtor&&objCtor instanceof objCtor&&"function"==typeof othCtor&&othCtor instanceof othCtor||(result=!1)}return stack.delete(object),stack.delete(other),result},hasOwnProperty$b=Object.prototype.hasOwnProperty;var _baseIsEqualDeep=function baseIsEqualDeep(object,other,bitmask,customizer,equalFunc,stack){var objIsArr=isArray_1(object),othIsArr=isArray_1(other),objTag=objIsArr?"[object Array]":_getTag(object),othTag=othIsArr?"[object Array]":_getTag(other),objIsObj="[object Object]"==(objTag="[object Arguments]"==objTag?"[object Object]":objTag),othIsObj="[object Object]"==(othTag="[object Arguments]"==othTag?"[object Object]":othTag),isSameTag=objTag==othTag;if(isSameTag&&isBuffer_1(object)){if(!isBuffer_1(other))return!1;objIsArr=!0,objIsObj=!1}if(isSameTag&&!objIsObj)return stack||(stack=new _Stack),objIsArr||isTypedArray_1(object)?_equalArrays(object,other,bitmask,customizer,equalFunc,stack):_equalByTag(object,other,objTag,bitmask,customizer,equalFunc,stack);if(!(1&bitmask)){var objIsWrapped=objIsObj&&hasOwnProperty$b.call(object,"__wrapped__"),othIsWrapped=othIsObj&&hasOwnProperty$b.call(other,"__wrapped__");if(objIsWrapped||othIsWrapped){var objUnwrapped=objIsWrapped?object.value():object,othUnwrapped=othIsWrapped?other.value():other;return stack||(stack=new _Stack),equalFunc(objUnwrapped,othUnwrapped,bitmask,customizer,stack)}}return!!isSameTag&&(stack||(stack=new _Stack),_equalObjects(object,other,bitmask,customizer,equalFunc,stack))};var _baseIsEqual=function baseIsEqual(value,other,bitmask,customizer,stack){return value===other||(null==value||null==other||!isObjectLike_1(value)&&!isObjectLike_1(other)?value!=value&&other!=other:_baseIsEqualDeep(value,other,bitmask,customizer,baseIsEqual,stack))};var _baseIsMatch=function baseIsMatch(object,source,matchData,customizer){var index=matchData.length,length=index,noCustomizer=!customizer;if(null==object)return!length;for(object=Object(object);index--;){var data=matchData[index];if(noCustomizer&&data[2]?data[1]!==object[data[0]]:!(data[0]in object))return!1}for(;++index<length;){var key=(data=matchData[index])[0],objValue=object[key],srcValue=data[1];if(noCustomizer&&data[2]){if(void 0===objValue&&!(key in object))return!1}else{var stack=new _Stack;if(customizer)var result=customizer(objValue,srcValue,key,object,source,stack);if(!(void 0===result?_baseIsEqual(srcValue,objValue,3,customizer,stack):result))return!1}}return!0};var _isStrictComparable=function isStrictComparable(value){return value==value&&!isObject_1(value)};var _getMatchData=function getMatchData(object){for(var result=keys_1(object),length=result.length;length--;){var key=result[length],value=object[key];result[length]=[key,value,_isStrictComparable(value)]}return result};var _matchesStrictComparable=function matchesStrictComparable(key,srcValue){return function(object){return null!=object&&(object[key]===srcValue&&(void 0!==srcValue||key in Object(object)))}};var _baseMatches=function baseMatches(source){var matchData=_getMatchData(source);return 1==matchData.length&&matchData[0][2]?_matchesStrictComparable(matchData[0][0],matchData[0][1]):function(object){return object===source||_baseIsMatch(object,source,matchData)}};var isSymbol_1=function isSymbol$1(value){return"symbol"==_typeof2(value)||isObjectLike_1(value)&&"[object Symbol]"==_baseGetTag(value)},reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/;var _isKey=function isKey(value,object){if(isArray_1(value))return!1;var type=_typeof2(value);return!("number"!=type&&"symbol"!=type&&"boolean"!=type&&null!=value&&!isSymbol_1(value))||(reIsPlainProp.test(value)||!reIsDeepProp.test(value)||null!=object&&value in Object(object))};function memoize$1(func,resolver){if("function"!=typeof func||null!=resolver&&"function"!=typeof resolver)throw new TypeError("Expected a function");var memoized=function memoized(){var args=arguments,key=resolver?resolver.apply(this,args):args[0],cache=memoized.cache;if(cache.has(key))return cache.get(key);var result=func.apply(this,args);return memoized.cache=cache.set(key,result)||cache,result};return memoized.cache=new(memoize$1.Cache||_MapCache),memoized}memoize$1.Cache=_MapCache;var memoize_1=memoize$1;var rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,reEscapeChar=/\\(\\)?/g,_stringToPath=function memoizeCapped(func){var result=memoize_1(func,(function(key){return 500===cache.size&&cache.clear(),key})),cache=result.cache;return result}((function(string){var result=[];return 46===string.charCodeAt(0)&&result.push(""),string.replace(rePropName,(function(match,number,quote,subString){result.push(quote?subString.replace(reEscapeChar,"$1"):number||match)})),result}));var _arrayMap=function arrayMap(array,iteratee){for(var index=-1,length=null==array?0:array.length,result=Array(length);++index<length;)result[index]=iteratee(array[index],index,array);return result},symbolProto$2=_Symbol?_Symbol.prototype:void 0,symbolToString=symbolProto$2?symbolProto$2.toString:void 0;var _baseToString=function baseToString(value){if("string"==typeof value)return value;if(isArray_1(value))return _arrayMap(value,baseToString)+"";if(isSymbol_1(value))return symbolToString?symbolToString.call(value):"";var result=value+"";return"0"==result&&1/value==-1/0?"-0":result};var toString_1=function toString$1(value){return null==value?"":_baseToString(value)};var _castPath=function castPath(value,object){return isArray_1(value)?value:_isKey(value,object)?[value]:_stringToPath(toString_1(value))};var _toKey=function toKey(value){if("string"==typeof value||isSymbol_1(value))return value;var result=value+"";return"0"==result&&1/value==-1/0?"-0":result};var _baseGet=function baseGet(object,path){for(var index=0,length=(path=_castPath(path,object)).length;null!=object&&index<length;)object=object[_toKey(path[index++])];return index&&index==length?object:void 0};var get_1=function get(object,path,defaultValue){var result=null==object?void 0:_baseGet(object,path);return void 0===result?defaultValue:result};var _baseHasIn=function baseHasIn(object,key){return null!=object&&key in Object(object)};var _hasPath=function hasPath(object,path,hasFunc){for(var index=-1,length=(path=_castPath(path,object)).length,result=!1;++index<length;){var key=_toKey(path[index]);if(!(result=null!=object&&hasFunc(object,key)))break;object=object[key]}return result||++index!=length?result:!!(length=null==object?0:object.length)&&isLength_1(length)&&_isIndex(key,length)&&(isArray_1(object)||isArguments_1(object))};var hasIn_1=function hasIn(object,path){return null!=object&&_hasPath(object,path,_baseHasIn)};var _baseMatchesProperty=function baseMatchesProperty(path,srcValue){return _isKey(path)&&_isStrictComparable(srcValue)?_matchesStrictComparable(_toKey(path),srcValue):function(object){var objValue=get_1(object,path);return void 0===objValue&&objValue===srcValue?hasIn_1(object,path):_baseIsEqual(srcValue,objValue,3)}};var _baseProperty=function baseProperty(key){return function(object){return null==object?void 0:object[key]}};var _basePropertyDeep=function basePropertyDeep(path){return function(object){return _baseGet(object,path)}};var property_1=function property(path){return _isKey(path)?_baseProperty(_toKey(path)):_basePropertyDeep(path)};var _baseIteratee=function baseIteratee(value){return"function"==typeof value?value:null==value?identity_1:"object"==_typeof2(value)?isArray_1(value)?_baseMatchesProperty(value[0],value[1]):_baseMatches(value):property_1(value)};var filter_1=function filter$1(collection,predicate){return(isArray_1(collection)?_arrayFilter:_baseFilter)(collection,_baseIteratee(predicate))},hasOwnProperty$c=Object.prototype.hasOwnProperty;var _baseHas=function baseHas(object,key){return null!=object&&hasOwnProperty$c.call(object,key)};var has_1=function has(object,path){return null!=object&&_hasPath(object,path,_baseHas)},hasOwnProperty$d=Object.prototype.hasOwnProperty;var isEmpty_1=function isEmpty(value){if(null==value)return!0;if(isArrayLike_1(value)&&(isArray_1(value)||"string"==typeof value||"function"==typeof value.splice||isBuffer_1(value)||isTypedArray_1(value)||isArguments_1(value)))return!value.length;var tag=_getTag(value);if("[object Map]"==tag||"[object Set]"==tag)return!value.size;if(_isPrototype(value))return!_baseKeys(value).length;for(var key in value)if(hasOwnProperty$d.call(value,key))return!1;return!0};var isUndefined_1=function isUndefined(value){return void 0===value};var _baseMap=function baseMap(collection,iteratee){var index=-1,result=isArrayLike_1(collection)?Array(collection.length):[];return _baseEach(collection,(function(value,key,collection){result[++index]=iteratee(value,key,collection)})),result};var map_1=function map(collection,iteratee){return(isArray_1(collection)?_arrayMap:_baseMap)(collection,_baseIteratee(iteratee))};var _arrayReduce=function arrayReduce(array,iteratee,accumulator,initAccum){var index=-1,length=null==array?0:array.length;for(initAccum&&length&&(accumulator=array[++index]);++index<length;)accumulator=iteratee(accumulator,array[index],index,array);return accumulator};var _baseReduce=function baseReduce(collection,iteratee,accumulator,initAccum,eachFunc){return eachFunc(collection,(function(value,index,collection){accumulator=initAccum?(initAccum=!1,value):iteratee(accumulator,value,index,collection)})),accumulator};var reduce_1=function reduce(collection,iteratee,accumulator){var func=isArray_1(collection)?_arrayReduce:_baseReduce,initAccum=arguments.length<3;return func(collection,_baseIteratee(iteratee),accumulator,initAccum,_baseEach)};var isString_1=function isString$1(value){return"string"==typeof value||!isArray_1(value)&&isObjectLike_1(value)&&"[object String]"==_baseGetTag(value)},_asciiSize=_baseProperty("length"),reHasUnicode=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var _hasUnicode=function hasUnicode(string){return reHasUnicode.test(string)},rsAstral="[\\ud800-\\udfff]",rsCombo="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",rsFitz="\\ud83c[\\udffb-\\udfff]",rsNonAstral="[^\\ud800-\\udfff]",rsRegional="(?:\\ud83c[\\udde6-\\uddff]){2}",rsSurrPair="[\\ud800-\\udbff][\\udc00-\\udfff]",reOptMod="(?:"+rsCombo+"|"+rsFitz+")"+"?",rsSeq="[\\ufe0e\\ufe0f]?"+reOptMod+("(?:\\u200d(?:"+[rsNonAstral,rsRegional,rsSurrPair].join("|")+")[\\ufe0e\\ufe0f]?"+reOptMod+")*"),rsSymbol="(?:"+[rsNonAstral+rsCombo+"?",rsCombo,rsRegional,rsSurrPair,rsAstral].join("|")+")",reUnicode=RegExp(rsFitz+"(?="+rsFitz+")|"+rsSymbol+rsSeq,"g");var _unicodeSize=function unicodeSize(string){for(var result=reUnicode.lastIndex=0;reUnicode.test(string);)++result;return result};var _stringSize=function stringSize(string){return _hasUnicode(string)?_unicodeSize(string):_asciiSize(string)};var size_1=function size(collection){if(null==collection)return 0;if(isArrayLike_1(collection))return isString_1(collection)?_stringSize(collection):collection.length;var tag=_getTag(collection);return"[object Map]"==tag||"[object Set]"==tag?collection.size:_baseKeys(collection).length};var transform_1=function transform(object,iteratee,accumulator){var isArr=isArray_1(object),isArrLike=isArr||isBuffer_1(object)||isTypedArray_1(object);if(iteratee=_baseIteratee(iteratee),null==accumulator){var Ctor=object&&object.constructor;accumulator=isArrLike?isArr?new Ctor:[]:isObject_1(object)&&isFunction_1(Ctor)?_baseCreate(_getPrototype(object)):{}}return(isArrLike?_arrayEach:_baseForOwn)(object,(function(value,index,object){return iteratee(accumulator,value,index,object)})),accumulator},spreadableSymbol=_Symbol?_Symbol.isConcatSpreadable:void 0;var _isFlattenable=function isFlattenable(value){return isArray_1(value)||isArguments_1(value)||!!(spreadableSymbol&&value&&value[spreadableSymbol])};var _baseFlatten=function baseFlatten(array,depth,predicate,isStrict,result){var index=-1,length=array.length;for(predicate||(predicate=_isFlattenable),result||(result=[]);++index<length;){var value=array[index];depth>0&&predicate(value)?depth>1?baseFlatten(value,depth-1,predicate,isStrict,result):_arrayPush(result,value):isStrict||(result[result.length]=value)}return result};var _apply=function apply(func,thisArg,args){switch(args.length){case 0:return func.call(thisArg);case 1:return func.call(thisArg,args[0]);case 2:return func.call(thisArg,args[0],args[1]);case 3:return func.call(thisArg,args[0],args[1],args[2])}return func.apply(thisArg,args)},nativeMax$1=Math.max;var _overRest=function overRest(func,start,transform){return start=nativeMax$1(void 0===start?func.length-1:start,0),function(){for(var args=arguments,index=-1,length=nativeMax$1(args.length-start,0),array=Array(length);++index<length;)array[index]=args[start+index];index=-1;for(var otherArgs=Array(start+1);++index<start;)otherArgs[index]=args[index];return otherArgs[start]=transform(array),_apply(func,this,otherArgs)}},_baseSetToString=_defineProperty$1?function(func,string){return _defineProperty$1(func,"toString",{configurable:!0,enumerable:!1,value:constant_1(string),writable:!0})}:identity_1,nativeNow=Date.now;var _setToString=function shortOut(func){var count=0,lastCalled=0;return function(){var stamp=nativeNow(),remaining=16-(stamp-lastCalled);if(lastCalled=stamp,remaining>0){if(++count>=800)return arguments[0]}else count=0;return func.apply(void 0,arguments)}}(_baseSetToString);var _baseRest=function baseRest(func,start){return _setToString(_overRest(func,start,identity_1),func+"")};var _baseFindIndex=function baseFindIndex(array,predicate,fromIndex,fromRight){for(var length=array.length,index=fromIndex+(fromRight?1:-1);fromRight?index--:++index<length;)if(predicate(array[index],index,array))return index;return-1};var _baseIsNaN=function baseIsNaN(value){return value!=value};var _strictIndexOf=function strictIndexOf(array,value,fromIndex){for(var index=fromIndex-1,length=array.length;++index<length;)if(array[index]===value)return index;return-1};var _baseIndexOf=function baseIndexOf(array,value,fromIndex){return value==value?_strictIndexOf(array,value,fromIndex):_baseFindIndex(array,_baseIsNaN,fromIndex)};var _arrayIncludes=function arrayIncludes(array,value){return!!(null==array?0:array.length)&&_baseIndexOf(array,value,0)>-1};var _arrayIncludesWith=function arrayIncludesWith(array,value,comparator){for(var index=-1,length=null==array?0:array.length;++index<length;)if(comparator(value,array[index]))return!0;return!1};var noop_1=function noop$2(){},_createSet=_Set&&1/_setToArray(new _Set([,-0]))[1]==1/0?function(values){return new _Set(values)}:noop_1;var _baseUniq=function baseUniq(array,iteratee,comparator){var index=-1,includes=_arrayIncludes,length=array.length,isCommon=!0,result=[],seen=result;if(comparator)isCommon=!1,includes=_arrayIncludesWith;else if(length>=200){var set=iteratee?null:_createSet(array);if(set)return _setToArray(set);isCommon=!1,includes=_cacheHas,seen=new _SetCache}else seen=iteratee?[]:result;outer:for(;++index<length;){var value=array[index],computed=iteratee?iteratee(value):value;if(value=comparator||0!==value?value:0,isCommon&&computed==computed){for(var seenIndex=seen.length;seenIndex--;)if(seen[seenIndex]===computed)continue outer;iteratee&&seen.push(computed),result.push(value)}else includes(seen,computed,comparator)||(seen!==result&&seen.push(computed),result.push(value))}return result};var isArrayLikeObject_1=function isArrayLikeObject(value){return isObjectLike_1(value)&&isArrayLike_1(value)},union_1=_baseRest((function(arrays){return _baseUniq(_baseFlatten(arrays,1,isArrayLikeObject_1,!0))}));var _baseValues=function baseValues(object,props){return _arrayMap(props,(function(key){return object[key]}))};var lodash,values_1=function values(object){return null==object?[]:_baseValues(object,keys_1(object))};try{lodash={clone:clone_1,constant:constant_1,each:each,filter:filter_1,has:has_1,isArray:isArray_1,isEmpty:isEmpty_1,isFunction:isFunction_1,isUndefined:isUndefined_1,keys:keys_1,map:map_1,reduce:reduce_1,size:size_1,transform:transform_1,union:union_1,values:values_1}}catch(e){}lodash||(lodash=window._);var lodash_1=lodash,graph=Graph;function Graph(opts){this._isDirected=!lodash_1.has(opts,"directed")||opts.directed,this._isMultigraph=!!lodash_1.has(opts,"multigraph")&&opts.multigraph,this._isCompound=!!lodash_1.has(opts,"compound")&&opts.compound,this._label=void 0,this._defaultNodeLabelFn=lodash_1.constant(void 0),this._defaultEdgeLabelFn=lodash_1.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children["\0"]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}function incrementOrInitEntry(map,k){map[k]?map[k]++:map[k]=1}function decrementOrRemoveEntry(map,k){--map[k]||delete map[k]}function edgeArgsToId(isDirected,v_,w_,name){var v=""+v_,w=""+w_;if(!isDirected&&v>w){var tmp=v;v=w,w=tmp}return v+""+w+""+(lodash_1.isUndefined(name)?"\0":name)}function edgeArgsToObj(isDirected,v_,w_,name){var v=""+v_,w=""+w_;if(!isDirected&&v>w){var tmp=v;v=w,w=tmp}var edgeObj={v:v,w:w};return name&&(edgeObj.name=name),edgeObj}function edgeObjToId(isDirected,edgeObj){return edgeArgsToId(isDirected,edgeObj.v,edgeObj.w,edgeObj.name)}Graph.prototype._nodeCount=0,Graph.prototype._edgeCount=0,Graph.prototype.isDirected=function(){return this._isDirected},Graph.prototype.isMultigraph=function(){return this._isMultigraph},Graph.prototype.isCompound=function(){return this._isCompound},Graph.prototype.setGraph=function(label){return this._label=label,this},Graph.prototype.graph=function(){return this._label},Graph.prototype.setDefaultNodeLabel=function(newDefault){return lodash_1.isFunction(newDefault)||(newDefault=lodash_1.constant(newDefault)),this._defaultNodeLabelFn=newDefault,this},Graph.prototype.nodeCount=function(){return this._nodeCount},Graph.prototype.nodes=function(){return lodash_1.keys(this._nodes)},Graph.prototype.sources=function(){var self=this;return lodash_1.filter(this.nodes(),(function(v){return lodash_1.isEmpty(self._in[v])}))},Graph.prototype.sinks=function(){var self=this;return lodash_1.filter(this.nodes(),(function(v){return lodash_1.isEmpty(self._out[v])}))},Graph.prototype.setNodes=function(vs,value){var args=arguments,self=this;return lodash_1.each(vs,(function(v){args.length>1?self.setNode(v,value):self.setNode(v)})),this},Graph.prototype.setNode=function(v,value){return lodash_1.has(this._nodes,v)?(arguments.length>1&&(this._nodes[v]=value),this):(this._nodes[v]=arguments.length>1?value:this._defaultNodeLabelFn(v),this._isCompound&&(this._parent[v]="\0",this._children[v]={},this._children["\0"][v]=!0),this._in[v]={},this._preds[v]={},this._out[v]={},this._sucs[v]={},++this._nodeCount,this)},Graph.prototype.node=function(v){return this._nodes[v]},Graph.prototype.hasNode=function(v){return lodash_1.has(this._nodes,v)},Graph.prototype.removeNode=function(v){var self=this;if(lodash_1.has(this._nodes,v)){var removeEdge=function removeEdge(e){self.removeEdge(self._edgeObjs[e])};delete this._nodes[v],this._isCompound&&(this._removeFromParentsChildList(v),delete this._parent[v],lodash_1.each(this.children(v),(function(child){self.setParent(child)})),delete this._children[v]),lodash_1.each(lodash_1.keys(this._in[v]),removeEdge),delete this._in[v],delete this._preds[v],lodash_1.each(lodash_1.keys(this._out[v]),removeEdge),delete this._out[v],delete this._sucs[v],--this._nodeCount}return this},Graph.prototype.setParent=function(v,parent){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(lodash_1.isUndefined(parent))parent="\0";else{for(var ancestor=parent+="";!lodash_1.isUndefined(ancestor);ancestor=this.parent(ancestor))if(ancestor===v)throw new Error("Setting "+parent+" as parent of "+v+" would create a cycle");this.setNode(parent)}return this.setNode(v),this._removeFromParentsChildList(v),this._parent[v]=parent,this._children[parent][v]=!0,this},Graph.prototype._removeFromParentsChildList=function(v){delete this._children[this._parent[v]][v]},Graph.prototype.parent=function(v){if(this._isCompound){var parent=this._parent[v];if("\0"!==parent)return parent}},Graph.prototype.children=function(v){if(lodash_1.isUndefined(v)&&(v="\0"),this._isCompound){var children=this._children[v];if(children)return lodash_1.keys(children)}else{if("\0"===v)return this.nodes();if(this.hasNode(v))return[]}},Graph.prototype.predecessors=function(v){var predsV=this._preds[v];if(predsV)return lodash_1.keys(predsV)},Graph.prototype.successors=function(v){var sucsV=this._sucs[v];if(sucsV)return lodash_1.keys(sucsV)},Graph.prototype.neighbors=function(v){var preds=this.predecessors(v);if(preds)return lodash_1.union(preds,this.successors(v))},Graph.prototype.isLeaf=function(v){return 0===(this.isDirected()?this.successors(v):this.neighbors(v)).length},Graph.prototype.filterNodes=function(filter){var copy=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});copy.setGraph(this.graph());var self=this;lodash_1.each(this._nodes,(function(value,v){filter(v)&&copy.setNode(v,value)})),lodash_1.each(this._edgeObjs,(function(e){copy.hasNode(e.v)&&copy.hasNode(e.w)&&copy.setEdge(e,self.edge(e))}));var parents={};return this._isCompound&&lodash_1.each(copy.nodes(),(function(v){copy.setParent(v,function findParent(v){var parent=self.parent(v);return void 0===parent||copy.hasNode(parent)?(parents[v]=parent,parent):parent in parents?parents[parent]:findParent(parent)}(v))})),copy},Graph.prototype.setDefaultEdgeLabel=function(newDefault){return lodash_1.isFunction(newDefault)||(newDefault=lodash_1.constant(newDefault)),this._defaultEdgeLabelFn=newDefault,this},Graph.prototype.edgeCount=function(){return this._edgeCount},Graph.prototype.edges=function(){return lodash_1.values(this._edgeObjs)},Graph.prototype.setPath=function(vs,value){var self=this,args=arguments;return lodash_1.reduce(vs,(function(v,w){return args.length>1?self.setEdge(v,w,value):self.setEdge(v,w),w})),this},Graph.prototype.setEdge=function(){var v,w,name,value,valueSpecified=!1,arg0=arguments[0];"object"===_typeof2(arg0)&&null!==arg0&&"v"in arg0?(v=arg0.v,w=arg0.w,name=arg0.name,2===arguments.length&&(value=arguments[1],valueSpecified=!0)):(v=arg0,w=arguments[1],name=arguments[3],arguments.length>2&&(value=arguments[2],valueSpecified=!0)),v=""+v,w=""+w,lodash_1.isUndefined(name)||(name=""+name);var e=edgeArgsToId(this._isDirected,v,w,name);if(lodash_1.has(this._edgeLabels,e))return valueSpecified&&(this._edgeLabels[e]=value),this;if(!lodash_1.isUndefined(name)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(v),this.setNode(w),this._edgeLabels[e]=valueSpecified?value:this._defaultEdgeLabelFn(v,w,name);var edgeObj=edgeArgsToObj(this._isDirected,v,w,name);return v=edgeObj.v,w=edgeObj.w,Object.freeze(edgeObj),this._edgeObjs[e]=edgeObj,incrementOrInitEntry(this._preds[w],v),incrementOrInitEntry(this._sucs[v],w),this._in[w][e]=edgeObj,this._out[v][e]=edgeObj,this._edgeCount++,this},Graph.prototype.edge=function(v,w,name){var e=1===arguments.length?edgeObjToId(this._isDirected,arguments[0]):edgeArgsToId(this._isDirected,v,w,name);return this._edgeLabels[e]},Graph.prototype.hasEdge=function(v,w,name){var e=1===arguments.length?edgeObjToId(this._isDirected,arguments[0]):edgeArgsToId(this._isDirected,v,w,name);return lodash_1.has(this._edgeLabels,e)},Graph.prototype.removeEdge=function(v,w,name){var e=1===arguments.length?edgeObjToId(this._isDirected,arguments[0]):edgeArgsToId(this._isDirected,v,w,name),edge=this._edgeObjs[e];return edge&&(v=edge.v,w=edge.w,delete this._edgeLabels[e],delete this._edgeObjs[e],decrementOrRemoveEntry(this._preds[w],v),decrementOrRemoveEntry(this._sucs[v],w),delete this._in[w][e],delete this._out[v][e],this._edgeCount--),this},Graph.prototype.inEdges=function(v,u){var inV=this._in[v];if(inV){var edges=lodash_1.values(inV);return u?lodash_1.filter(edges,(function(edge){return edge.v===u})):edges}},Graph.prototype.outEdges=function(v,w){var outV=this._out[v];if(outV){var edges=lodash_1.values(outV);return w?lodash_1.filter(edges,(function(edge){return edge.w===w})):edges}},Graph.prototype.nodeEdges=function(v,w){var inEdges=this.inEdges(v,w);if(inEdges)return inEdges.concat(this.outEdges(v,w))};var lib={Graph:graph,version:"2.1.8"},json$1={write:function write(g){var json={options:{directed:g.isDirected(),multigraph:g.isMultigraph(),compound:g.isCompound()},nodes:writeNodes(g),edges:writeEdges(g)};lodash_1.isUndefined(g.graph())||(json.value=lodash_1.clone(g.graph()));return json},read:function read(json){var g=new graph(json.options).setGraph(json.value);return lodash_1.each(json.nodes,(function(entry){g.setNode(entry.v,entry.value),entry.parent&&g.setParent(entry.v,entry.parent)})),lodash_1.each(json.edges,(function(entry){g.setEdge({v:entry.v,w:entry.w,name:entry.name},entry.value)})),g}};function writeNodes(g){return lodash_1.map(g.nodes(),(function(v){var nodeValue=g.node(v),parent=g.parent(v),node={v:v};return lodash_1.isUndefined(nodeValue)||(node.value=nodeValue),lodash_1.isUndefined(parent)||(node.parent=parent),node}))}function writeEdges(g){return lodash_1.map(g.edges(),(function(e){var edgeValue=g.edge(e),edge={v:e.v,w:e.w};return lodash_1.isUndefined(e.name)||(edge.name=e.name),lodash_1.isUndefined(edgeValue)||(edge.value=edgeValue),edge}))}var components_1=function components(g){var cmpt,visited={},cmpts=[];function dfs(v){lodash_1.has(visited,v)||(visited[v]=!0,cmpt.push(v),lodash_1.each(g.successors(v),dfs),lodash_1.each(g.predecessors(v),dfs))}return lodash_1.each(g.nodes(),(function(v){cmpt=[],dfs(v),cmpt.length&&cmpts.push(cmpt)})),cmpts};var priorityQueue=PriorityQueue;function PriorityQueue(){this._arr=[],this._keyIndices={}}PriorityQueue.prototype.size=function(){return this._arr.length},PriorityQueue.prototype.keys=function(){return this._arr.map((function(x){return x.key}))},PriorityQueue.prototype.has=function(key){return lodash_1.has(this._keyIndices,key)},PriorityQueue.prototype.priority=function(key){var index=this._keyIndices[key];if(void 0!==index)return this._arr[index].priority},PriorityQueue.prototype.min=function(){if(0===this.size())throw new Error("Queue underflow");return this._arr[0].key},PriorityQueue.prototype.add=function(key,priority){var keyIndices=this._keyIndices;if(key=String(key),!lodash_1.has(keyIndices,key)){var arr=this._arr,index=arr.length;return keyIndices[key]=index,arr.push({key:key,priority:priority}),this._decrease(index),!0}return!1},PriorityQueue.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var min=this._arr.pop();return delete this._keyIndices[min.key],this._heapify(0),min.key},PriorityQueue.prototype.decrease=function(key,priority){var index=this._keyIndices[key];if(priority>this._arr[index].priority)throw new Error("New priority is greater than current priority. Key: "+key+" Old: "+this._arr[index].priority+" New: "+priority);this._arr[index].priority=priority,this._decrease(index)},PriorityQueue.prototype._heapify=function(i){var arr=this._arr,l=2*i,r=l+1,largest=i;l<arr.length&&(largest=arr[l].priority<arr[largest].priority?l:largest,r<arr.length&&(largest=arr[r].priority<arr[largest].priority?r:largest),largest!==i&&(this._swap(i,largest),this._heapify(largest)))},PriorityQueue.prototype._decrease=function(index){for(var parent,arr=this._arr,priority=arr[index].priority;0!==index&&!(arr[parent=index>>1].priority<priority);)this._swap(index,parent),index=parent},PriorityQueue.prototype._swap=function(i,j){var arr=this._arr,keyIndices=this._keyIndices,origArrI=arr[i],origArrJ=arr[j];arr[i]=origArrJ,arr[j]=origArrI,keyIndices[origArrJ.key]=i,keyIndices[origArrI.key]=j};var dijkstra_1=function dijkstra(g,source,weightFn,edgeFn){return function runDijkstra(g,source,weightFn,edgeFn){var v,vEntry,results={},pq=new priorityQueue,updateNeighbors=function updateNeighbors(edge){var w=edge.v!==v?edge.v:edge.w,wEntry=results[w],weight=weightFn(edge),distance=vEntry.distance+weight;if(weight<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+edge+" Weight: "+weight);distance<wEntry.distance&&(wEntry.distance=distance,wEntry.predecessor=v,pq.decrease(w,distance))};g.nodes().forEach((function(v){var distance=v===source?0:Number.POSITIVE_INFINITY;results[v]={distance:distance},pq.add(v,distance)}));for(;pq.size()>0&&(v=pq.removeMin(),(vEntry=results[v]).distance!==Number.POSITIVE_INFINITY);)edgeFn(v).forEach(updateNeighbors);return results}(g,String(source),weightFn||DEFAULT_WEIGHT_FUNC,edgeFn||function(v){return g.outEdges(v)})},DEFAULT_WEIGHT_FUNC=lodash_1.constant(1);var dijkstraAll_1=function dijkstraAll(g,weightFunc,edgeFunc){return lodash_1.transform(g.nodes(),(function(acc,v){acc[v]=dijkstra_1(g,v,weightFunc,edgeFunc)}),{})};var tarjan_1=function tarjan(g){var index=0,stack=[],visited={},results=[];return g.nodes().forEach((function(v){lodash_1.has(visited,v)||function dfs(v){var entry=visited[v]={onStack:!0,lowlink:index,index:index++};if(stack.push(v),g.successors(v).forEach((function(w){lodash_1.has(visited,w)?visited[w].onStack&&(entry.lowlink=Math.min(entry.lowlink,visited[w].index)):(dfs(w),entry.lowlink=Math.min(entry.lowlink,visited[w].lowlink))})),entry.lowlink===entry.index){var w,cmpt=[];do{w=stack.pop(),visited[w].onStack=!1,cmpt.push(w)}while(v!==w);results.push(cmpt)}}(v)})),results};var findCycles_1=function findCycles(g){return lodash_1.filter(tarjan_1(g),(function(cmpt){return cmpt.length>1||1===cmpt.length&&g.hasEdge(cmpt[0],cmpt[0])}))};var floydWarshall_1=function floydWarshall(g,weightFn,edgeFn){return function runFloydWarshall(g,weightFn,edgeFn){var results={},nodes=g.nodes();return nodes.forEach((function(v){results[v]={},results[v][v]={distance:0},nodes.forEach((function(w){v!==w&&(results[v][w]={distance:Number.POSITIVE_INFINITY})})),edgeFn(v).forEach((function(edge){var w=edge.v===v?edge.w:edge.v,d=weightFn(edge);results[v][w]={distance:d,predecessor:v}}))})),nodes.forEach((function(k){var rowK=results[k];nodes.forEach((function(i){var rowI=results[i];nodes.forEach((function(j){var ik=rowI[k],kj=rowK[j],ij=rowI[j],altDistance=ik.distance+kj.distance;altDistance<ij.distance&&(ij.distance=altDistance,ij.predecessor=kj.predecessor)}))}))})),results}(g,weightFn||DEFAULT_WEIGHT_FUNC$1,edgeFn||function(v){return g.outEdges(v)})},DEFAULT_WEIGHT_FUNC$1=lodash_1.constant(1);var topsort_1=topsort;function topsort(g){var visited={},stack={},results=[];if(lodash_1.each(g.sinks(),(function visit(node){if(lodash_1.has(stack,node))throw new CycleException;lodash_1.has(visited,node)||(stack[node]=!0,visited[node]=!0,lodash_1.each(g.predecessors(node),visit),delete stack[node],results.push(node))})),lodash_1.size(visited)!==g.nodeCount())throw new CycleException;return results}function CycleException(){}topsort.CycleException=CycleException,CycleException.prototype=new Error;var dfs_1=function dfs(g,vs,order){lodash_1.isArray(vs)||(vs=[vs]);var navigation=(g.isDirected()?g.successors:g.neighbors).bind(g),acc=[],visited={};return lodash_1.each(vs,(function(v){if(!g.hasNode(v))throw new Error("Graph does not have node: "+v);!function doDfs(g,v,postorder,visited,navigation,acc){lodash_1.has(visited,v)||(visited[v]=!0,postorder||acc.push(v),lodash_1.each(navigation(v),(function(w){doDfs(g,w,postorder,visited,navigation,acc)})),postorder&&acc.push(v))}(g,v,"post"===order,visited,navigation,acc)})),acc};var graphlib$1,graphlib={Graph:lib.Graph,json:json$1,alg:{components:components_1,dijkstra:dijkstra_1,dijkstraAll:dijkstraAll_1,findCycles:findCycles_1,floydWarshall:floydWarshall_1,isAcyclic:function isAcyclic(g){try{topsort_1(g)}catch(e){if(e instanceof topsort_1.CycleException)return!1;throw e}return!0},postorder:function postorder(g,vs){return dfs_1(g,vs,"post")},preorder:function preorder(g,vs){return dfs_1(g,vs,"pre")},prim:function prim(g,weightFunc){var v,result=new graph,parents={},pq=new priorityQueue;function updateNeighbors(edge){var w=edge.v===v?edge.w:edge.v,pri=pq.priority(w);if(void 0!==pri){var edgeWeight=weightFunc(edge);edgeWeight<pri&&(parents[w]=v,pq.decrease(w,edgeWeight))}}if(0===g.nodeCount())return result;lodash_1.each(g.nodes(),(function(v){pq.add(v,Number.POSITIVE_INFINITY),result.setNode(v)})),pq.decrease(g.nodes()[0],0);var init=!1;for(;pq.size()>0;){if(v=pq.removeMin(),lodash_1.has(parents,v))result.setEdge(v,parents[v]);else{if(init)throw new Error("Input graph is not connected: "+g);init=!0}g.nodeEdges(v).forEach(updateNeighbors)}return result},tarjan:tarjan_1,topsort:topsort_1},version:lib.version};try{graphlib$1=graphlib}catch(e){}graphlib$1||(graphlib$1=window.graphlib);var graphlib_1=graphlib$1;var cloneDeep_1=function cloneDeep(value){return _baseClone(value,5)};var _isIterateeCall=function isIterateeCall(value,index,object){if(!isObject_1(object))return!1;var type=_typeof2(index);return!!("number"==type?isArrayLike_1(object)&&_isIndex(index,object.length):"string"==type&&index in object)&&eq_1(object[index],value)},objectProto$i=Object.prototype,hasOwnProperty$e=objectProto$i.hasOwnProperty,defaults_1=_baseRest((function(object,sources){object=Object(object);var index=-1,length=sources.length,guard=length>2?sources[2]:void 0;for(guard&&_isIterateeCall(sources[0],sources[1],guard)&&(length=1);++index<length;)for(var source=sources[index],props=keysIn_1(source),propsIndex=-1,propsLength=props.length;++propsIndex<propsLength;){var key=props[propsIndex],value=object[key];(void 0===value||eq_1(value,objectProto$i[key])&&!hasOwnProperty$e.call(object,key))&&(object[key]=source[key])}return object}));var _createFind=function createFind(findIndexFunc){return function(collection,predicate,fromIndex){var iterable=Object(collection);if(!isArrayLike_1(collection)){var iteratee=_baseIteratee(predicate);collection=keys_1(collection),predicate=function predicate(key){return iteratee(iterable[key],key,iterable)}}var index=findIndexFunc(collection,predicate,fromIndex);return index>-1?iterable[iteratee?collection[index]:index]:void 0}},reWhitespace=/\s/;var _trimmedEndIndex=function trimmedEndIndex(string){for(var index=string.length;index--&&reWhitespace.test(string.charAt(index)););return index},reTrimStart=/^\s+/;var _baseTrim=function baseTrim(string){return string?string.slice(0,_trimmedEndIndex(string)+1).replace(reTrimStart,""):string},reIsBadHex$1=/^[-+]0x[0-9a-f]+$/i,reIsBinary$1=/^0b[01]+$/i,reIsOctal$1=/^0o[0-7]+$/i,freeParseInt$1=parseInt;var toNumber_1=function toNumber$1(value){if("number"==typeof value)return value;if(isSymbol_1(value))return NaN;if(isObject_1(value)){var other="function"==typeof value.valueOf?value.valueOf():value;value=isObject_1(other)?other+"":other}if("string"!=typeof value)return 0===value?value:+value;value=_baseTrim(value);var isBinary=reIsBinary$1.test(value);return isBinary||reIsOctal$1.test(value)?freeParseInt$1(value.slice(2),isBinary?2:8):reIsBadHex$1.test(value)?NaN:+value};var toFinite_1=function toFinite(value){return value?(value=toNumber_1(value))===1/0||value===-1/0?17976931348623157e292*(value<0?-1:1):value==value?value:0:0===value?value:0};var toInteger_1=function toInteger(value){var result=toFinite_1(value),remainder=result%1;return result==result?remainder?result-remainder:result:0},nativeMax$2=Math.max;var find_1=_createFind((function findIndex(array,predicate,fromIndex){var length=null==array?0:array.length;if(!length)return-1;var index=null==fromIndex?0:toInteger_1(fromIndex);return index<0&&(index=nativeMax$2(length+index,0)),_baseFindIndex(array,_baseIteratee(predicate),index)}));var flatten_1=function flatten(array){return(null==array?0:array.length)?_baseFlatten(array,1):[]};var forIn_1=function forIn(object,iteratee){return null==object?object:_baseFor(object,_castFunction(iteratee),keysIn_1)};var last_1=function last(array){var length=null==array?0:array.length;return length?array[length-1]:void 0};var mapValues_1=function mapValues(object,iteratee){var result={};return iteratee=_baseIteratee(iteratee),_baseForOwn(object,(function(value,key,object){_baseAssignValue(result,key,iteratee(value,key,object))})),result};var _baseExtremum=function baseExtremum(array,iteratee,comparator){for(var index=-1,length=array.length;++index<length;){var value=array[index],current=iteratee(value);if(null!=current&&(void 0===computed?current==current&&!isSymbol_1(current):comparator(current,computed)))var computed=current,result=value}return result};var _baseGt=function baseGt(value,other){return value>other};var max_1=function max$1(array){return array&&array.length?_baseExtremum(array,identity_1,_baseGt):void 0};var _assignMergeValue=function assignMergeValue(object,key,value){(void 0!==value&&!eq_1(object[key],value)||void 0===value&&!(key in object))&&_baseAssignValue(object,key,value)},funcProto$2=Function.prototype,objectProto$j=Object.prototype,funcToString$2=funcProto$2.toString,hasOwnProperty$f=objectProto$j.hasOwnProperty,objectCtorString=funcToString$2.call(Object);var isPlainObject_1=function isPlainObject(value){if(!isObjectLike_1(value)||"[object Object]"!=_baseGetTag(value))return!1;var proto=_getPrototype(value);if(null===proto)return!0;var Ctor=hasOwnProperty$f.call(proto,"constructor")&&proto.constructor;return"function"==typeof Ctor&&Ctor instanceof Ctor&&funcToString$2.call(Ctor)==objectCtorString};var _safeGet=function safeGet(object,key){if(("constructor"!==key||"function"!=typeof object[key])&&"__proto__"!=key)return object[key]};var toPlainObject_1=function toPlainObject(value){return _copyObject(value,keysIn_1(value))};var _baseMergeDeep=function baseMergeDeep(object,source,key,srcIndex,mergeFunc,customizer,stack){var objValue=_safeGet(object,key),srcValue=_safeGet(source,key),stacked=stack.get(srcValue);if(stacked)_assignMergeValue(object,key,stacked);else{var newValue=customizer?customizer(objValue,srcValue,key+"",object,source,stack):void 0,isCommon=void 0===newValue;if(isCommon){var isArr=isArray_1(srcValue),isBuff=!isArr&&isBuffer_1(srcValue),isTyped=!isArr&&!isBuff&&isTypedArray_1(srcValue);newValue=srcValue,isArr||isBuff||isTyped?isArray_1(objValue)?newValue=objValue:isArrayLikeObject_1(objValue)?newValue=_copyArray(objValue):isBuff?(isCommon=!1,newValue=_cloneBuffer(srcValue,!0)):isTyped?(isCommon=!1,newValue=_cloneTypedArray(srcValue,!0)):newValue=[]:isPlainObject_1(srcValue)||isArguments_1(srcValue)?(newValue=objValue,isArguments_1(objValue)?newValue=toPlainObject_1(objValue):isObject_1(objValue)&&!isFunction_1(objValue)||(newValue=_initCloneObject(srcValue))):isCommon=!1}isCommon&&(stack.set(srcValue,newValue),mergeFunc(newValue,srcValue,srcIndex,customizer,stack),stack.delete(srcValue)),_assignMergeValue(object,key,newValue)}};var _baseMerge=function baseMerge(object,source,srcIndex,customizer,stack){object!==source&&_baseFor(source,(function(srcValue,key){if(stack||(stack=new _Stack),isObject_1(srcValue))_baseMergeDeep(object,source,key,srcIndex,baseMerge,customizer,stack);else{var newValue=customizer?customizer(_safeGet(object,key),srcValue,key+"",object,source,stack):void 0;void 0===newValue&&(newValue=srcValue),_assignMergeValue(object,key,newValue)}}),keysIn_1)};var merge_1=function createAssigner(assigner){return _baseRest((function(object,sources){var index=-1,length=sources.length,customizer=length>1?sources[length-1]:void 0,guard=length>2?sources[2]:void 0;for(customizer=assigner.length>3&&"function"==typeof customizer?(length--,customizer):void 0,guard&&_isIterateeCall(sources[0],sources[1],guard)&&(customizer=length<3?void 0:customizer,length=1),object=Object(object);++index<length;){var source=sources[index];source&&assigner(object,source,index,customizer)}return object}))}((function(object,source,srcIndex){_baseMerge(object,source,srcIndex)}));var _baseLt=function baseLt(value,other){return value<other};var min_1=function min$1(array){return array&&array.length?_baseExtremum(array,identity_1,_baseLt):void 0};var minBy_1=function minBy(array,iteratee){return array&&array.length?_baseExtremum(array,_baseIteratee(iteratee),_baseLt):void 0},now_1=function now$1(){return _root.Date.now()};var _baseSet=function baseSet(object,path,value,customizer){if(!isObject_1(object))return object;for(var index=-1,length=(path=_castPath(path,object)).length,lastIndex=length-1,nested=object;null!=nested&&++index<length;){var key=_toKey(path[index]),newValue=value;if("__proto__"===key||"constructor"===key||"prototype"===key)return object;if(index!=lastIndex){var objValue=nested[key];void 0===(newValue=customizer?customizer(objValue,key,nested):void 0)&&(newValue=isObject_1(objValue)?objValue:_isIndex(path[index+1])?[]:{})}_assignValue(nested,key,newValue),nested=nested[key]}return object};var _basePickBy=function basePickBy(object,paths,predicate){for(var index=-1,length=paths.length,result={};++index<length;){var path=paths[index],value=_baseGet(object,path);predicate(value,path)&&_baseSet(result,_castPath(path,object),value)}return result};var _basePick=function basePick(object,paths){return _basePickBy(object,paths,(function(value,path){return hasIn_1(object,path)}))};var pick_1=function flatRest(func){return _setToString(_overRest(func,void 0,flatten_1),func+"")}((function(object,paths){return null==object?{}:_basePick(object,paths)})),nativeCeil=Math.ceil,nativeMax$3=Math.max;var _baseRange=function baseRange(start,end,step,fromRight){for(var index=-1,length=nativeMax$3(nativeCeil((end-start)/(step||1)),0),result=Array(length);length--;)result[fromRight?length:++index]=start,start+=step;return result};var range_1=function createRange(fromRight){return function(start,end,step){return step&&"number"!=typeof step&&_isIterateeCall(start,end,step)&&(end=step=void 0),start=toFinite_1(start),void 0===end?(end=start,start=0):end=toFinite_1(end),step=void 0===step?start<end?1:-1:toFinite_1(step),_baseRange(start,end,step,fromRight)}}();var _baseSortBy=function baseSortBy(array,comparer){var length=array.length;for(array.sort(comparer);length--;)array[length]=array[length].value;return array};var _compareAscending=function compareAscending(value,other){if(value!==other){var valIsDefined=void 0!==value,valIsNull=null===value,valIsReflexive=value==value,valIsSymbol=isSymbol_1(value),othIsDefined=void 0!==other,othIsNull=null===other,othIsReflexive=other==other,othIsSymbol=isSymbol_1(other);if(!othIsNull&&!othIsSymbol&&!valIsSymbol&&value>other||valIsSymbol&&othIsDefined&&othIsReflexive&&!othIsNull&&!othIsSymbol||valIsNull&&othIsDefined&&othIsReflexive||!valIsDefined&&othIsReflexive||!valIsReflexive)return 1;if(!valIsNull&&!valIsSymbol&&!othIsSymbol&&value<other||othIsSymbol&&valIsDefined&&valIsReflexive&&!valIsNull&&!valIsSymbol||othIsNull&&valIsDefined&&valIsReflexive||!othIsDefined&&valIsReflexive||!othIsReflexive)return-1}return 0};var _compareMultiple=function compareMultiple(object,other,orders){for(var index=-1,objCriteria=object.criteria,othCriteria=other.criteria,length=objCriteria.length,ordersLength=orders.length;++index<length;){var result=_compareAscending(objCriteria[index],othCriteria[index]);if(result)return index>=ordersLength?result:result*("desc"==orders[index]?-1:1)}return object.index-other.index};var _baseOrderBy=function baseOrderBy(collection,iteratees,orders){iteratees=iteratees.length?_arrayMap(iteratees,(function(iteratee){return isArray_1(iteratee)?function(value){return _baseGet(value,1===iteratee.length?iteratee[0]:iteratee)}:iteratee})):[identity_1];var index=-1;iteratees=_arrayMap(iteratees,_baseUnary(_baseIteratee));var result=_baseMap(collection,(function(value,key,collection){return{criteria:_arrayMap(iteratees,(function(iteratee){return iteratee(value)})),index:++index,value:value}}));return _baseSortBy(result,(function(object,other){return _compareMultiple(object,other,orders)}))},sortBy_1=_baseRest((function(collection,iteratees){if(null==collection)return[];var length=iteratees.length;return length>1&&_isIterateeCall(collection,iteratees[0],iteratees[1])?iteratees=[]:length>2&&_isIterateeCall(iteratees[0],iteratees[1],iteratees[2])&&(iteratees=[iteratees[0]]),_baseOrderBy(collection,_baseFlatten(iteratees,1),[])})),idCounter=0;var uniqueId_1=function uniqueId(prefix){var id=++idCounter;return toString_1(prefix)+id};var _baseZipObject=function baseZipObject(props,values,assignFunc){for(var index=-1,length=props.length,valsLength=values.length,result={};++index<length;){var value=index<valsLength?values[index]:void 0;assignFunc(result,props[index],value)}return result};var lodash$1,zipObject_1=function zipObject(props,values){return _baseZipObject(props||[],values||[],_assignValue)};try{lodash$1={cloneDeep:cloneDeep_1,constant:constant_1,defaults:defaults_1,each:each,filter:filter_1,find:find_1,flatten:flatten_1,forEach:forEach_1,forIn:forIn_1,has:has_1,isUndefined:isUndefined_1,last:last_1,map:map_1,mapValues:mapValues_1,max:max_1,merge:merge_1,min:min_1,minBy:minBy_1,now:now_1,pick:pick_1,range:range_1,reduce:reduce_1,sortBy:sortBy_1,uniqueId:uniqueId_1,values:values_1,zipObject:zipObject_1}}catch(e){}lodash$1||(lodash$1=window._);var lodash_1$1=lodash$1,list=List;function List(){var sentinel={};sentinel._next=sentinel._prev=sentinel,this._sentinel=sentinel}function unlink(entry){entry._prev._next=entry._next,entry._next._prev=entry._prev,delete entry._next,delete entry._prev}function filterOutLinks(k,v){if("_next"!==k&&"_prev"!==k)return v}List.prototype.dequeue=function(){var sentinel=this._sentinel,entry=sentinel._prev;if(entry!==sentinel)return unlink(entry),entry},List.prototype.enqueue=function(entry){var sentinel=this._sentinel;entry._prev&&entry._next&&unlink(entry),entry._next=sentinel._next,sentinel._next._prev=entry,sentinel._next=entry,entry._prev=sentinel},List.prototype.toString=function(){for(var strs=[],sentinel=this._sentinel,curr=sentinel._prev;curr!==sentinel;)strs.push(JSON.stringify(curr,filterOutLinks)),curr=curr._prev;return"["+strs.join(", ")+"]"};var Graph$1=graphlib_1.Graph,greedyFas=function greedyFAS(g,weightFn){if(g.nodeCount()<=1)return[];var state=function buildState(g,weightFn){var fasGraph=new Graph$1,maxIn=0,maxOut=0;lodash_1$1.forEach(g.nodes(),(function(v){fasGraph.setNode(v,{v:v,in:0,out:0})})),lodash_1$1.forEach(g.edges(),(function(e){var prevWeight=fasGraph.edge(e.v,e.w)||0,weight=weightFn(e),edgeWeight=prevWeight+weight;fasGraph.setEdge(e.v,e.w,edgeWeight),maxOut=Math.max(maxOut,fasGraph.node(e.v).out+=weight),maxIn=Math.max(maxIn,fasGraph.node(e.w).in+=weight)}));var buckets=lodash_1$1.range(maxOut+maxIn+3).map((function(){return new list})),zeroIdx=maxIn+1;return lodash_1$1.forEach(fasGraph.nodes(),(function(v){assignBucket(buckets,zeroIdx,fasGraph.node(v))})),{graph:fasGraph,buckets:buckets,zeroIdx:zeroIdx}}(g,weightFn||DEFAULT_WEIGHT_FN),results=function doGreedyFAS(g,buckets,zeroIdx){var entry,results=[],sources=buckets[buckets.length-1],sinks=buckets[0];for(;g.nodeCount();){for(;entry=sinks.dequeue();)removeNode(g,buckets,zeroIdx,entry);for(;entry=sources.dequeue();)removeNode(g,buckets,zeroIdx,entry);if(g.nodeCount())for(var i=buckets.length-2;i>0;--i)if(entry=buckets[i].dequeue()){results=results.concat(removeNode(g,buckets,zeroIdx,entry,!0));break}}return results}(state.graph,state.buckets,state.zeroIdx);return lodash_1$1.flatten(lodash_1$1.map(results,(function(e){return g.outEdges(e.v,e.w)})),!0)},DEFAULT_WEIGHT_FN=lodash_1$1.constant(1);function removeNode(g,buckets,zeroIdx,entry,collectPredecessors){var results=collectPredecessors?[]:void 0;return lodash_1$1.forEach(g.inEdges(entry.v),(function(edge){var weight=g.edge(edge),uEntry=g.node(edge.v);collectPredecessors&&results.push({v:edge.v,w:edge.w}),uEntry.out-=weight,assignBucket(buckets,zeroIdx,uEntry)})),lodash_1$1.forEach(g.outEdges(entry.v),(function(edge){var weight=g.edge(edge),w=edge.w,wEntry=g.node(w);wEntry.in-=weight,assignBucket(buckets,zeroIdx,wEntry)})),g.removeNode(entry.v),results}function assignBucket(buckets,zeroIdx,entry){entry.out?entry.in?buckets[entry.out-entry.in+zeroIdx].enqueue(entry):buckets[buckets.length-1].enqueue(entry):buckets[0].enqueue(entry)}var acyclic={run:function run(g){var fas="greedy"===g.graph().acyclicer?greedyFas(g,function weightFn(g){return function(e){return g.edge(e).weight}}(g)):function dfsFAS(g){var fas=[],stack={},visited={};function dfs(v){lodash_1$1.has(visited,v)||(visited[v]=!0,stack[v]=!0,lodash_1$1.forEach(g.outEdges(v),(function(e){lodash_1$1.has(stack,e.w)?fas.push(e):dfs(e.w)})),delete stack[v])}return lodash_1$1.forEach(g.nodes(),dfs),fas}(g);lodash_1$1.forEach(fas,(function(e){var label=g.edge(e);g.removeEdge(e),label.forwardName=e.name,label.reversed=!0,g.setEdge(e.w,e.v,label,lodash_1$1.uniqueId("rev"))}))},undo:function undo(g){lodash_1$1.forEach(g.edges(),(function(e){var label=g.edge(e);if(label.reversed){g.removeEdge(e);var forwardName=label.forwardName;delete label.reversed,delete label.forwardName,g.setEdge(e.w,e.v,label,forwardName)}}))}};var Graph$2=graphlib_1.Graph,util$1={addDummyNode:addDummyNode,simplify:function simplify(g){var simplified=(new Graph$2).setGraph(g.graph());return lodash_1$1.forEach(g.nodes(),(function(v){simplified.setNode(v,g.node(v))})),lodash_1$1.forEach(g.edges(),(function(e){var simpleLabel=simplified.edge(e.v,e.w)||{weight:0,minlen:1},label=g.edge(e);simplified.setEdge(e.v,e.w,{weight:simpleLabel.weight+label.weight,minlen:Math.max(simpleLabel.minlen,label.minlen)})})),simplified},asNonCompoundGraph:function asNonCompoundGraph(g){var simplified=new Graph$2({multigraph:g.isMultigraph()}).setGraph(g.graph());return lodash_1$1.forEach(g.nodes(),(function(v){g.children(v).length||simplified.setNode(v,g.node(v))})),lodash_1$1.forEach(g.edges(),(function(e){simplified.setEdge(e,g.edge(e))})),simplified},successorWeights:function successorWeights(g){var weightMap=lodash_1$1.map(g.nodes(),(function(v){var sucs={};return lodash_1$1.forEach(g.outEdges(v),(function(e){sucs[e.w]=(sucs[e.w]||0)+g.edge(e).weight})),sucs}));return lodash_1$1.zipObject(g.nodes(),weightMap)},predecessorWeights:function predecessorWeights(g){var weightMap=lodash_1$1.map(g.nodes(),(function(v){var preds={};return lodash_1$1.forEach(g.inEdges(v),(function(e){preds[e.v]=(preds[e.v]||0)+g.edge(e).weight})),preds}));return lodash_1$1.zipObject(g.nodes(),weightMap)},intersectRect:function intersectRect(rect,point){var sx,sy,x=rect.x,y=rect.y,dx=point.x-x,dy=point.y-y,w=rect.width/2,h=rect.height/2;if(!dx&&!dy)throw new Error("Not possible to find intersection inside of the rectangle");Math.abs(dy)*w>Math.abs(dx)*h?(dy<0&&(h=-h),sx=h*dx/dy,sy=h):(dx<0&&(w=-w),sx=w,sy=w*dy/dx);return{x:x+sx,y:y+sy}},buildLayerMatrix:function buildLayerMatrix(g){var layering=lodash_1$1.map(lodash_1$1.range(maxRank(g)+1),(function(){return[]}));return lodash_1$1.forEach(g.nodes(),(function(v){var node=g.node(v),rank=node.rank;lodash_1$1.isUndefined(rank)||(layering[rank][node.order]=v)})),layering},normalizeRanks:function normalizeRanks(g){var min=lodash_1$1.min(lodash_1$1.map(g.nodes(),(function(v){return g.node(v).rank})));lodash_1$1.forEach(g.nodes(),(function(v){var node=g.node(v);lodash_1$1.has(node,"rank")&&(node.rank-=min)}))},removeEmptyRanks:function removeEmptyRanks(g){var offset=lodash_1$1.min(lodash_1$1.map(g.nodes(),(function(v){return g.node(v).rank}))),layers=[];lodash_1$1.forEach(g.nodes(),(function(v){var rank=g.node(v).rank-offset;layers[rank]||(layers[rank]=[]),layers[rank].push(v)}));var delta=0,nodeRankFactor=g.graph().nodeRankFactor;lodash_1$1.forEach(layers,(function(vs,i){lodash_1$1.isUndefined(vs)&&i%nodeRankFactor!=0?--delta:delta&&lodash_1$1.forEach(vs,(function(v){g.node(v).rank+=delta}))}))},addBorderNode:function addBorderNode(g,prefix,rank,order){var node={width:0,height:0};arguments.length>=4&&(node.rank=rank,node.order=order);return addDummyNode(g,"border",node,prefix)},maxRank:maxRank,partition:function partition(collection,fn){var result={lhs:[],rhs:[]};return lodash_1$1.forEach(collection,(function(value){fn(value)?result.lhs.push(value):result.rhs.push(value)})),result},time:function time(name,fn){var start=lodash_1$1.now();try{return fn()}finally{console.log(name+" time: "+(lodash_1$1.now()-start)+"ms")}},notime:function notime(name,fn){return fn()}};function addDummyNode(g,type,attrs,name){var v;do{v=lodash_1$1.uniqueId(name)}while(g.hasNode(v));return attrs.dummy=type,g.setNode(v,attrs),v}function maxRank(g){return lodash_1$1.max(lodash_1$1.map(g.nodes(),(function(v){var rank=g.node(v).rank;if(!lodash_1$1.isUndefined(rank))return rank})))}var normalize$1={run:function run$1(g){g.graph().dummyChains=[],lodash_1$1.forEach(g.edges(),(function(edge){!function normalizeEdge(g,e){var dummy,attrs,i,v=e.v,vRank=g.node(v).rank,w=e.w,wRank=g.node(w).rank,name=e.name,edgeLabel=g.edge(e),labelRank=edgeLabel.labelRank;if(wRank===vRank+1)return;for(g.removeEdge(e),i=0,++vRank;vRank<wRank;++i,++vRank)edgeLabel.points=[],attrs={width:0,height:0,edgeLabel:edgeLabel,edgeObj:e,rank:vRank},dummy=util$1.addDummyNode(g,"edge",attrs,"_d"),vRank===labelRank&&(attrs.width=edgeLabel.width,attrs.height=edgeLabel.height,attrs.dummy="edge-label",attrs.labelpos=edgeLabel.labelpos),g.setEdge(v,dummy,{weight:edgeLabel.weight},name),0===i&&g.graph().dummyChains.push(dummy),v=dummy;g.setEdge(v,w,{weight:edgeLabel.weight},name)}(g,edge)}))},undo:function undo$1(g){lodash_1$1.forEach(g.graph().dummyChains,(function(v){var w,node=g.node(v),origLabel=node.edgeLabel;for(g.setEdge(node.edgeObj,origLabel);node.dummy;)w=g.successors(v)[0],g.removeNode(v),origLabel.points.push({x:node.x,y:node.y}),"edge-label"===node.dummy&&(origLabel.x=node.x,origLabel.y=node.y,origLabel.width=node.width,origLabel.height=node.height),v=w,node=g.node(v)}))}};var util$2_longestPath=function longestPath(g){var visited={};lodash_1$1.forEach(g.sources(),(function dfs(v){var label=g.node(v);if(lodash_1$1.has(visited,v))return label.rank;visited[v]=!0;var rank=lodash_1$1.min(lodash_1$1.map(g.outEdges(v),(function(e){return dfs(e.w)-g.edge(e).minlen})));return rank!==Number.POSITIVE_INFINITY&&null!=rank||(rank=0),label.rank=rank}))},util$2_slack=function slack(g,e){return g.node(e.w).rank-g.node(e.v).rank-g.edge(e).minlen};var Graph$3=graphlib_1.Graph,slack$1=util$2_slack,feasibleTree_1=function feasibleTree(g){var edge,delta,t=new Graph$3({directed:!1}),start=g.nodes()[0],size=g.nodeCount();t.setNode(start,{});for(;tightTree(t,g)<size;)edge=findMinSlackEdge(t,g),delta=t.hasNode(edge.v)?slack$1(g,edge):-slack$1(g,edge),shiftRanks(t,g,delta);return t};function tightTree(t,g){return lodash_1$1.forEach(t.nodes(),(function dfs(v){lodash_1$1.forEach(g.nodeEdges(v),(function(e){var edgeV=e.v,w=v===edgeV?e.w:edgeV;t.hasNode(w)||slack$1(g,e)||(t.setNode(w,{}),t.setEdge(v,w,{}),dfs(w))}))})),t.nodeCount()}function findMinSlackEdge(t,g){return lodash_1$1.minBy(g.edges(),(function(e){if(t.hasNode(e.v)!==t.hasNode(e.w))return slack$1(g,e)}))}function shiftRanks(t,g,delta){lodash_1$1.forEach(t.nodes(),(function(v){g.node(v).rank+=delta}))}var slack$2=util$2_slack,initRank=util$2_longestPath,preorder$1=graphlib_1.alg.preorder,postorder$1=graphlib_1.alg.postorder,simplify$1=util$1.simplify,networkSimplex_1=networkSimplex;function networkSimplex(g){g=simplify$1(g),initRank(g);var e,t=feasibleTree_1(g);for(initLowLimValues(t),initCutValues(t,g);e=leaveEdge(t);)exchangeEdges(t,g,e,enterEdge(t,g,e))}function initCutValues(t,g){var vs=postorder$1(t,t.nodes());vs=vs.slice(0,vs.length-1),lodash_1$1.forEach(vs,(function(v){!function assignCutValue(t,g,child){var parent=t.node(child).parent;t.edge(child,parent).cutvalue=calcCutValue(t,g,child)}(t,g,v)}))}function calcCutValue(t,g,child){var parent=t.node(child).parent,childIsTail=!0,graphEdge=g.edge(child,parent),cutValue=0;return graphEdge||(childIsTail=!1,graphEdge=g.edge(parent,child)),cutValue=graphEdge.weight,lodash_1$1.forEach(g.nodeEdges(child),(function(e){var isOutEdge=e.v===child,other=isOutEdge?e.w:e.v;if(other!==parent){var pointsToHead=isOutEdge===childIsTail,otherWeight=g.edge(e).weight;if(cutValue+=pointsToHead?otherWeight:-otherWeight,function isTreeEdge(tree,u,v){return tree.hasEdge(u,v)}(t,child,other)){var otherCutValue=t.edge(child,other).cutvalue;cutValue+=pointsToHead?-otherCutValue:otherCutValue}}})),cutValue}function initLowLimValues(tree,root){arguments.length<2&&(root=tree.nodes()[0]),dfsAssignLowLim(tree,{},1,root)}function dfsAssignLowLim(tree,visited,nextLim,v,parent){var low=nextLim,label=tree.node(v);return visited[v]=!0,lodash_1$1.forEach(tree.neighbors(v),(function(w){lodash_1$1.has(visited,w)||(nextLim=dfsAssignLowLim(tree,visited,nextLim,w,v))})),label.low=low,label.lim=nextLim++,parent?label.parent=parent:delete label.parent,nextLim}function leaveEdge(tree){return lodash_1$1.find(tree.edges(),(function(e){return tree.edge(e).cutvalue<0}))}function enterEdge(t,g,edge){var v=edge.v,w=edge.w;g.hasEdge(v,w)||(v=edge.w,w=edge.v);var vLabel=t.node(v),wLabel=t.node(w),tailLabel=vLabel,flip=!1;vLabel.lim>wLabel.lim&&(tailLabel=wLabel,flip=!0);var candidates=lodash_1$1.filter(g.edges(),(function(edge){return flip===isDescendant(t,t.node(edge.v),tailLabel)&&flip!==isDescendant(t,t.node(edge.w),tailLabel)}));return lodash_1$1.minBy(candidates,(function(edge){return slack$2(g,edge)}))}function exchangeEdges(t,g,e,f){var v=e.v,w=e.w;t.removeEdge(v,w),t.setEdge(f.v,f.w,{}),initLowLimValues(t),initCutValues(t,g),function updateRanks(t,g){var root=lodash_1$1.find(t.nodes(),(function(v){return!g.node(v).parent})),vs=preorder$1(t,root);vs=vs.slice(1),lodash_1$1.forEach(vs,(function(v){var parent=t.node(v).parent,edge=g.edge(v,parent),flipped=!1;edge||(edge=g.edge(parent,v),flipped=!0),g.node(v).rank=g.node(parent).rank+(flipped?edge.minlen:-edge.minlen)}))}(t,g)}function isDescendant(tree,vLabel,rootLabel){return rootLabel.low<=vLabel.lim&&vLabel.lim<=rootLabel.lim}networkSimplex.initLowLimValues=initLowLimValues,networkSimplex.initCutValues=initCutValues,networkSimplex.calcCutValue=calcCutValue,networkSimplex.leaveEdge=leaveEdge,networkSimplex.enterEdge=enterEdge,networkSimplex.exchangeEdges=exchangeEdges;var longestPath$1=util$2_longestPath,rank_1=function rank(g){switch(g.graph().ranker){case"network-simplex":networkSimplexRanker(g);break;case"tight-tree":!function tightTreeRanker(g){longestPath$1(g),feasibleTree_1(g)}(g);break;case"longest-path":longestPathRanker(g);break;default:networkSimplexRanker(g)}};var longestPathRanker=longestPath$1;function networkSimplexRanker(g){networkSimplex_1(g)}var parentDummyChains_1=function parentDummyChains(g){var postorderNums=function postorder$2(g){var result={},lim=0;function dfs(v){var low=lim;lodash_1$1.forEach(g.children(v),dfs),result[v]={low:low,lim:lim++}}return lodash_1$1.forEach(g.children(),dfs),result}(g);lodash_1$1.forEach(g.graph().dummyChains,(function(v){for(var node=g.node(v),edgeObj=node.edgeObj,pathData=function findPath(g,postorderNums,v,w){var parent,lca,vPath=[],wPath=[],low=Math.min(postorderNums[v].low,postorderNums[w].low),lim=Math.max(postorderNums[v].lim,postorderNums[w].lim);parent=v;do{parent=g.parent(parent),vPath.push(parent)}while(parent&&(postorderNums[parent].low>low||lim>postorderNums[parent].lim));lca=parent,parent=w;for(;(parent=g.parent(parent))!==lca;)wPath.push(parent);return{path:vPath.concat(wPath.reverse()),lca:lca}}(g,postorderNums,edgeObj.v,edgeObj.w),path=pathData.path,lca=pathData.lca,pathIdx=0,pathV=path[pathIdx],ascending=!0;v!==edgeObj.w;){if(node=g.node(v),ascending){for(;(pathV=path[pathIdx])!==lca&&g.node(pathV).maxRank<node.rank;)pathIdx++;pathV===lca&&(ascending=!1)}if(!ascending){for(;pathIdx<path.length-1&&g.node(pathV=path[pathIdx+1]).minRank<=node.rank;)pathIdx++;pathV=path[pathIdx]}g.setParent(v,pathV),v=g.successors(v)[0]}}))};var nestingGraph={run:function run$2(g){var root=util$1.addDummyNode(g,"root",{},"_root"),depths=function treeDepths(g){var depths={};return lodash_1$1.forEach(g.children(),(function(v){!function dfs(v,depth){var children=g.children(v);children&&children.length&&lodash_1$1.forEach(children,(function(child){dfs(child,depth+1)}));depths[v]=depth}(v,1)})),depths}(g),height=lodash_1$1.max(lodash_1$1.values(depths))-1,nodeSep=2*height+1;g.graph().nestingRoot=root,lodash_1$1.forEach(g.edges(),(function(e){g.edge(e).minlen*=nodeSep}));var weight=function sumWeights(g){return lodash_1$1.reduce(g.edges(),(function(acc,e){return acc+g.edge(e).weight}),0)}(g)+1;lodash_1$1.forEach(g.children(),(function(child){!function dfs$1(g,root,nodeSep,weight,height,depths,v){var children=g.children(v);if(!children.length)return void(v!==root&&g.setEdge(root,v,{weight:0,minlen:nodeSep}));var top=util$1.addBorderNode(g,"_bt"),bottom=util$1.addBorderNode(g,"_bb"),label=g.node(v);g.setParent(top,v),label.borderTop=top,g.setParent(bottom,v),label.borderBottom=bottom,lodash_1$1.forEach(children,(function(child){dfs$1(g,root,nodeSep,weight,height,depths,child);var childNode=g.node(child),childTop=childNode.borderTop?childNode.borderTop:child,childBottom=childNode.borderBottom?childNode.borderBottom:child,thisWeight=childNode.borderTop?weight:2*weight,minlen=childTop!==childBottom?1:height-depths[v]+1;g.setEdge(top,childTop,{weight:thisWeight,minlen:minlen,nestingEdge:!0}),g.setEdge(childBottom,bottom,{weight:thisWeight,minlen:minlen,nestingEdge:!0})})),g.parent(v)||g.setEdge(root,top,{weight:0,minlen:height+depths[v]})}(g,root,nodeSep,weight,height,depths,child)})),g.graph().nodeRankFactor=nodeSep},cleanup:function cleanup(g){var graphLabel=g.graph();g.removeNode(graphLabel.nestingRoot),delete graphLabel.nestingRoot,lodash_1$1.forEach(g.edges(),(function(e){g.edge(e).nestingEdge&&g.removeEdge(e)}))}};var addBorderSegments_1=function addBorderSegments(g){lodash_1$1.forEach(g.children(),(function dfs(v){var children=g.children(v),node=g.node(v);if(children.length&&lodash_1$1.forEach(children,dfs),lodash_1$1.has(node,"minRank")){node.borderLeft=[],node.borderRight=[];for(var rank=node.minRank,maxRank=node.maxRank+1;rank<maxRank;++rank)addBorderNode$1(g,"borderLeft","_bl",v,node,rank),addBorderNode$1(g,"borderRight","_br",v,node,rank)}}))};function addBorderNode$1(g,prop,prefix,sg,sgNode,rank){var label={width:0,height:0,rank:rank,borderType:prop},prev=sgNode[prop][rank-1],curr=util$1.addDummyNode(g,"border",label,prefix);sgNode[prop][rank]=curr,g.setParent(curr,sg),prev&&g.setEdge(prev,curr,{weight:1})}var coordinateSystem={adjust:function adjust(g){var rankDir=g.graph().rankdir.toLowerCase();"lr"!==rankDir&&"rl"!==rankDir||swapWidthHeight(g)},undo:function undo$2(g){var rankDir=g.graph().rankdir.toLowerCase();"bt"!==rankDir&&"rl"!==rankDir||function reverseY(g){lodash_1$1.forEach(g.nodes(),(function(v){reverseYOne(g.node(v))})),lodash_1$1.forEach(g.edges(),(function(e){var edge=g.edge(e);lodash_1$1.forEach(edge.points,reverseYOne),lodash_1$1.has(edge,"y")&&reverseYOne(edge)}))}(g);"lr"!==rankDir&&"rl"!==rankDir||(!function swapXY(g){lodash_1$1.forEach(g.nodes(),(function(v){swapXYOne(g.node(v))})),lodash_1$1.forEach(g.edges(),(function(e){var edge=g.edge(e);lodash_1$1.forEach(edge.points,swapXYOne),lodash_1$1.has(edge,"x")&&swapXYOne(edge)}))}(g),swapWidthHeight(g))}};function swapWidthHeight(g){lodash_1$1.forEach(g.nodes(),(function(v){swapWidthHeightOne(g.node(v))})),lodash_1$1.forEach(g.edges(),(function(e){swapWidthHeightOne(g.edge(e))}))}function swapWidthHeightOne(attrs){var w=attrs.width;attrs.width=attrs.height,attrs.height=w}function reverseYOne(attrs){attrs.y=-attrs.y}function swapXYOne(attrs){var x=attrs.x;attrs.x=attrs.y,attrs.y=x}var initOrder_1=function initOrder(g){var visited={},simpleNodes=lodash_1$1.filter(g.nodes(),(function(v){return!g.children(v).length})),maxRank=lodash_1$1.max(lodash_1$1.map(simpleNodes,(function(v){return g.node(v).rank}))),layers=lodash_1$1.map(lodash_1$1.range(maxRank+1),(function(){return[]}));function dfs(v){if(!lodash_1$1.has(visited,v)){visited[v]=!0;var node=g.node(v);layers[node.rank].push(v),lodash_1$1.forEach(g.successors(v),dfs)}}var orderedVs=lodash_1$1.sortBy(simpleNodes,(function(v){return g.node(v).rank}));return lodash_1$1.forEach(orderedVs,dfs),layers};var crossCount_1=function crossCount(g,layering){for(var cc=0,i=1;i<layering.length;++i)cc+=twoLayerCrossCount(g,layering[i-1],layering[i]);return cc};function twoLayerCrossCount(g,northLayer,southLayer){for(var southPos=lodash_1$1.zipObject(southLayer,lodash_1$1.map(southLayer,(function(v,i){return i}))),southEntries=lodash_1$1.flatten(lodash_1$1.map(northLayer,(function(v){return lodash_1$1.sortBy(lodash_1$1.map(g.outEdges(v),(function(e){return{pos:southPos[e.w],weight:g.edge(e).weight}})),"pos")})),!0),firstIndex=1;firstIndex<southLayer.length;)firstIndex<<=1;var treeSize=2*firstIndex-1;firstIndex-=1;var tree=lodash_1$1.map(new Array(treeSize),(function(){return 0})),cc=0;return lodash_1$1.forEach(southEntries.forEach((function(entry){var index=entry.pos+firstIndex;tree[index]+=entry.weight;for(var weightSum=0;index>0;)index%2&&(weightSum+=tree[index+1]),tree[index=index-1>>1]+=entry.weight;cc+=entry.weight*weightSum}))),cc}var barycenter_1=function barycenter(g,movable){return lodash_1$1.map(movable,(function(v){var inV=g.inEdges(v);if(inV.length){var result=lodash_1$1.reduce(inV,(function(acc,e){var edge=g.edge(e),nodeU=g.node(e.v);return{sum:acc.sum+edge.weight*nodeU.order,weight:acc.weight+edge.weight}}),{sum:0,weight:0});return{v:v,barycenter:result.sum/result.weight,weight:result.weight}}return{v:v}}))};var resolveConflicts_1=function resolveConflicts(entries,cg){var mappedEntries={};return lodash_1$1.forEach(entries,(function(entry,i){var tmp=mappedEntries[entry.v]={indegree:0,in:[],out:[],vs:[entry.v],i:i};lodash_1$1.isUndefined(entry.barycenter)||(tmp.barycenter=entry.barycenter,tmp.weight=entry.weight)})),lodash_1$1.forEach(cg.edges(),(function(e){var entryV=mappedEntries[e.v],entryW=mappedEntries[e.w];lodash_1$1.isUndefined(entryV)||lodash_1$1.isUndefined(entryW)||(entryW.indegree++,entryV.out.push(mappedEntries[e.w]))})),function doResolveConflicts(sourceSet){var entries=[];function handleIn(vEntry){return function(uEntry){uEntry.merged||(lodash_1$1.isUndefined(uEntry.barycenter)||lodash_1$1.isUndefined(vEntry.barycenter)||uEntry.barycenter>=vEntry.barycenter)&&function mergeEntries(target,source){var sum=0,weight=0;target.weight&&(sum+=target.barycenter*target.weight,weight+=target.weight);source.weight&&(sum+=source.barycenter*source.weight,weight+=source.weight);target.vs=source.vs.concat(target.vs),target.barycenter=sum/weight,target.weight=weight,target.i=Math.min(source.i,target.i),source.merged=!0}(vEntry,uEntry)}}function handleOut(vEntry){return function(wEntry){wEntry.in.push(vEntry),0==--wEntry.indegree&&sourceSet.push(wEntry)}}for(;sourceSet.length;){var entry=sourceSet.pop();entries.push(entry),lodash_1$1.forEach(entry.in.reverse(),handleIn(entry)),lodash_1$1.forEach(entry.out,handleOut(entry))}return lodash_1$1.map(lodash_1$1.filter(entries,(function(entry){return!entry.merged})),(function(entry){return lodash_1$1.pick(entry,["vs","i","barycenter","weight"])}))}(lodash_1$1.filter(mappedEntries,(function(entry){return!entry.indegree})))};var sort_1=function sort(entries,biasRight){var parts=util$1.partition(entries,(function(entry){return lodash_1$1.has(entry,"barycenter")})),sortable=parts.lhs,unsortable=lodash_1$1.sortBy(parts.rhs,(function(entry){return-entry.i})),vs=[],sum=0,weight=0,vsIndex=0;sortable.sort(function compareWithBias(bias){return function(entryV,entryW){return entryV.barycenter<entryW.barycenter?-1:entryV.barycenter>entryW.barycenter?1:bias?entryW.i-entryV.i:entryV.i-entryW.i}}(!!biasRight)),vsIndex=consumeUnsortable(vs,unsortable,vsIndex),lodash_1$1.forEach(sortable,(function(entry){vsIndex+=entry.vs.length,vs.push(entry.vs),sum+=entry.barycenter*entry.weight,weight+=entry.weight,vsIndex=consumeUnsortable(vs,unsortable,vsIndex)}));var result={vs:lodash_1$1.flatten(vs,!0)};weight&&(result.barycenter=sum/weight,result.weight=weight);return result};function consumeUnsortable(vs,unsortable,index){for(var last;unsortable.length&&(last=lodash_1$1.last(unsortable)).i<=index;)unsortable.pop(),vs.push(last.vs),index++;return index}var sortSubgraph_1=function sortSubgraph(g,v,cg,biasRight){var movable=g.children(v),node=g.node(v),bl=node?node.borderLeft:void 0,br=node?node.borderRight:void 0,subgraphs={};bl&&(movable=lodash_1$1.filter(movable,(function(w){return w!==bl&&w!==br})));var barycenters=barycenter_1(g,movable);lodash_1$1.forEach(barycenters,(function(entry){if(g.children(entry.v).length){var subgraphResult=sortSubgraph(g,entry.v,cg,biasRight);subgraphs[entry.v]=subgraphResult,lodash_1$1.has(subgraphResult,"barycenter")&&function mergeBarycenters(target,other){lodash_1$1.isUndefined(target.barycenter)?(target.barycenter=other.barycenter,target.weight=other.weight):(target.barycenter=(target.barycenter*target.weight+other.barycenter*other.weight)/(target.weight+other.weight),target.weight+=other.weight)}(entry,subgraphResult)}}));var entries=resolveConflicts_1(barycenters,cg);!function expandSubgraphs(entries,subgraphs){lodash_1$1.forEach(entries,(function(entry){entry.vs=lodash_1$1.flatten(entry.vs.map((function(v){return subgraphs[v]?subgraphs[v].vs:v})),!0)}))}(entries,subgraphs);var result=sort_1(entries,biasRight);if(bl&&(result.vs=lodash_1$1.flatten([bl,result.vs,br],!0),g.predecessors(bl).length)){var blPred=g.node(g.predecessors(bl)[0]),brPred=g.node(g.predecessors(br)[0]);lodash_1$1.has(result,"barycenter")||(result.barycenter=0,result.weight=0),result.barycenter=(result.barycenter*result.weight+blPred.order+brPred.order)/(result.weight+2),result.weight+=2}return result};var Graph$4=graphlib_1.Graph,buildLayerGraph_1=function buildLayerGraph(g,rank,relationship){var root=function createRootNode(g){var v;for(;g.hasNode(v=lodash_1$1.uniqueId("_root")););return v}(g),result=new Graph$4({compound:!0}).setGraph({root:root}).setDefaultNodeLabel((function(v){return g.node(v)}));return lodash_1$1.forEach(g.nodes(),(function(v){var node=g.node(v),parent=g.parent(v);(node.rank===rank||node.minRank<=rank&&rank<=node.maxRank)&&(result.setNode(v),result.setParent(v,parent||root),lodash_1$1.forEach(g[relationship](v),(function(e){var u=e.v===v?e.w:e.v,edge=result.edge(u,v),weight=lodash_1$1.isUndefined(edge)?0:edge.weight;result.setEdge(u,v,{weight:g.edge(e).weight+weight})})),lodash_1$1.has(node,"minRank")&&result.setNode(v,{borderLeft:node.borderLeft[rank],borderRight:node.borderRight[rank]}))})),result};var addSubgraphConstraints_1=function addSubgraphConstraints(g,cg,vs){var rootPrev,prev={};lodash_1$1.forEach(vs,(function(v){for(var parent,prevChild,child=g.parent(v);child;){if((parent=g.parent(child))?(prevChild=prev[parent],prev[parent]=child):(prevChild=rootPrev,rootPrev=child),prevChild&&prevChild!==child)return void cg.setEdge(prevChild,child);child=parent}}))};var Graph$5=graphlib_1.Graph,order_1=function order(g){var maxRank=util$1.maxRank(g),downLayerGraphs=buildLayerGraphs(g,lodash_1$1.range(1,maxRank+1),"inEdges"),upLayerGraphs=buildLayerGraphs(g,lodash_1$1.range(maxRank-1,-1,-1),"outEdges"),layering=initOrder_1(g);assignOrder(g,layering);for(var best,bestCC=Number.POSITIVE_INFINITY,i=0,lastBest=0;lastBest<4;++i,++lastBest){sweepLayerGraphs(i%2?downLayerGraphs:upLayerGraphs,i%4>=2),layering=util$1.buildLayerMatrix(g);var cc=crossCount_1(g,layering);cc<bestCC&&(lastBest=0,best=lodash_1$1.cloneDeep(layering),bestCC=cc)}assignOrder(g,best)};function buildLayerGraphs(g,ranks,relationship){return lodash_1$1.map(ranks,(function(rank){return buildLayerGraph_1(g,rank,relationship)}))}function sweepLayerGraphs(layerGraphs,biasRight){var cg=new Graph$5;lodash_1$1.forEach(layerGraphs,(function(lg){var root=lg.graph().root,sorted=sortSubgraph_1(lg,root,cg,biasRight);lodash_1$1.forEach(sorted.vs,(function(v,i){lg.node(v).order=i})),addSubgraphConstraints_1(lg,cg,sorted.vs)}))}function assignOrder(g,layering){lodash_1$1.forEach(layering,(function(layer){lodash_1$1.forEach(layer,(function(v,i){g.node(v).order=i}))}))}var Graph$6=graphlib_1.Graph,bk_positionX=function positionX(g){var adjustedLayering,layering=util$1.buildLayerMatrix(g),conflicts=lodash_1$1.merge(findType1Conflicts(g,layering),findType2Conflicts(g,layering)),xss={};lodash_1$1.forEach(["u","d"],(function(vert){adjustedLayering="u"===vert?layering:lodash_1$1.values(layering).reverse(),lodash_1$1.forEach(["l","r"],(function(horiz){"r"===horiz&&(adjustedLayering=lodash_1$1.map(adjustedLayering,(function(inner){return lodash_1$1.values(inner).reverse()})));var neighborFn=("u"===vert?g.predecessors:g.successors).bind(g),align=verticalAlignment(g,adjustedLayering,conflicts,neighborFn),xs=horizontalCompaction(g,adjustedLayering,align.root,align.align,"r"===horiz);"r"===horiz&&(xs=lodash_1$1.mapValues(xs,(function(x){return-x}))),xss[vert+horiz]=xs}))}));var smallestWidth=findSmallestWidthAlignment(g,xss);return alignCoordinates(xss,smallestWidth),balance(xss,g.graph().align)};function findType1Conflicts(g,layering){var conflicts={};return lodash_1$1.reduce(layering,(function visitLayer(prevLayer,layer){var k0=0,scanPos=0,prevLayerLength=prevLayer.length,lastNode=lodash_1$1.last(layer);return lodash_1$1.forEach(layer,(function(v,i){var w=function findOtherInnerSegmentNode(g,v){if(g.node(v).dummy)return lodash_1$1.find(g.predecessors(v),(function(u){return g.node(u).dummy}))}(g,v),k1=w?g.node(w).order:prevLayerLength;(w||v===lastNode)&&(lodash_1$1.forEach(layer.slice(scanPos,i+1),(function(scanNode){lodash_1$1.forEach(g.predecessors(scanNode),(function(u){var uLabel=g.node(u),uPos=uLabel.order;!(uPos<k0||k1<uPos)||uLabel.dummy&&g.node(scanNode).dummy||addConflict(conflicts,u,scanNode)}))})),scanPos=i+1,k0=k1)})),layer})),conflicts}function findType2Conflicts(g,layering){var conflicts={};function scan(south,southPos,southEnd,prevNorthBorder,nextNorthBorder){var v;lodash_1$1.forEach(lodash_1$1.range(southPos,southEnd),(function(i){v=south[i],g.node(v).dummy&&lodash_1$1.forEach(g.predecessors(v),(function(u){var uNode=g.node(u);uNode.dummy&&(uNode.order<prevNorthBorder||uNode.order>nextNorthBorder)&&addConflict(conflicts,u,v)}))}))}return lodash_1$1.reduce(layering,(function visitLayer(north,south){var nextNorthPos,prevNorthPos=-1,southPos=0;return lodash_1$1.forEach(south,(function(v,southLookahead){if("border"===g.node(v).dummy){var predecessors=g.predecessors(v);predecessors.length&&(nextNorthPos=g.node(predecessors[0]).order,scan(south,southPos,southLookahead,prevNorthPos,nextNorthPos),southPos=southLookahead,prevNorthPos=nextNorthPos)}scan(south,southPos,south.length,nextNorthPos,north.length)})),south})),conflicts}function addConflict(conflicts,v,w){if(v>w){var tmp=v;v=w,w=tmp}var conflictsV=conflicts[v];conflictsV||(conflicts[v]=conflictsV={}),conflictsV[w]=!0}function hasConflict(conflicts,v,w){if(v>w){var tmp=v;v=w,w=tmp}return lodash_1$1.has(conflicts[v],w)}function verticalAlignment(g,layering,conflicts,neighborFn){var root={},align={},pos={};return lodash_1$1.forEach(layering,(function(layer){lodash_1$1.forEach(layer,(function(v,order){root[v]=v,align[v]=v,pos[v]=order}))})),lodash_1$1.forEach(layering,(function(layer){var prevIdx=-1;lodash_1$1.forEach(layer,(function(v){var ws=neighborFn(v);if(ws.length)for(var mp=((ws=lodash_1$1.sortBy(ws,(function(w){return pos[w]}))).length-1)/2,i=Math.floor(mp),il=Math.ceil(mp);i<=il;++i){var w=ws[i];align[v]===v&&prevIdx<pos[w]&&!hasConflict(conflicts,v,w)&&(align[w]=v,align[v]=root[v]=root[w],prevIdx=pos[w])}}))})),{root:root,align:align}}function horizontalCompaction(g,layering,root,align,reverseSep){var xs={},blockG=function buildBlockGraph(g,layering,root,reverseSep){var blockGraph=new Graph$6,graphLabel=g.graph(),sepFn=function sep(nodeSep,edgeSep,reverseSep){return function(g,v,w){var delta,vLabel=g.node(v),wLabel=g.node(w),sum=0;if(sum+=vLabel.width/2,lodash_1$1.has(vLabel,"labelpos"))switch(vLabel.labelpos.toLowerCase()){case"l":delta=-vLabel.width/2;break;case"r":delta=vLabel.width/2}if(delta&&(sum+=reverseSep?delta:-delta),delta=0,sum+=(vLabel.dummy?edgeSep:nodeSep)/2,sum+=(wLabel.dummy?edgeSep:nodeSep)/2,sum+=wLabel.width/2,lodash_1$1.has(wLabel,"labelpos"))switch(wLabel.labelpos.toLowerCase()){case"l":delta=wLabel.width/2;break;case"r":delta=-wLabel.width/2}return delta&&(sum+=reverseSep?delta:-delta),delta=0,sum}}(graphLabel.nodesep,graphLabel.edgesep,reverseSep);return lodash_1$1.forEach(layering,(function(layer){var u;lodash_1$1.forEach(layer,(function(v){var vRoot=root[v];if(blockGraph.setNode(vRoot),u){var uRoot=root[u],prevMax=blockGraph.edge(uRoot,vRoot);blockGraph.setEdge(uRoot,vRoot,Math.max(sepFn(g,v,u),prevMax||0))}u=v}))})),blockGraph}(g,layering,root,reverseSep),borderType=reverseSep?"borderLeft":"borderRight";function iterate(setXsFunc,nextNodesFunc){for(var stack=blockG.nodes(),elem=stack.pop(),visited={};elem;)visited[elem]?setXsFunc(elem):(visited[elem]=!0,stack.push(elem),stack=stack.concat(nextNodesFunc(elem))),elem=stack.pop()}return iterate((function pass1(elem){xs[elem]=blockG.inEdges(elem).reduce((function(acc,e){return Math.max(acc,xs[e.v]+blockG.edge(e))}),0)}),blockG.predecessors.bind(blockG)),iterate((function pass2(elem){var min=blockG.outEdges(elem).reduce((function(acc,e){return Math.min(acc,xs[e.w]-blockG.edge(e))}),Number.POSITIVE_INFINITY),node=g.node(elem);min!==Number.POSITIVE_INFINITY&&node.borderType!==borderType&&(xs[elem]=Math.max(xs[elem],min))}),blockG.successors.bind(blockG)),lodash_1$1.forEach(align,(function(v){xs[v]=xs[root[v]]})),xs}function findSmallestWidthAlignment(g,xss){return lodash_1$1.minBy(lodash_1$1.values(xss),(function(xs){var max=Number.NEGATIVE_INFINITY,min=Number.POSITIVE_INFINITY;return lodash_1$1.forIn(xs,(function(x,v){var halfWidth=function width(g,v){return g.node(v).width}(g,v)/2;max=Math.max(x+halfWidth,max),min=Math.min(x-halfWidth,min)})),max-min}))}function alignCoordinates(xss,alignTo){var alignToVals=lodash_1$1.values(alignTo),alignToMin=lodash_1$1.min(alignToVals),alignToMax=lodash_1$1.max(alignToVals);lodash_1$1.forEach(["u","d"],(function(vert){lodash_1$1.forEach(["l","r"],(function(horiz){var delta,alignment=vert+horiz,xs=xss[alignment];if(xs!==alignTo){var xsVals=lodash_1$1.values(xs);(delta="l"===horiz?alignToMin-lodash_1$1.min(xsVals):alignToMax-lodash_1$1.max(xsVals))&&(xss[alignment]=lodash_1$1.mapValues(xs,(function(x){return x+delta})))}}))}))}function balance(xss,align){return lodash_1$1.mapValues(xss.ul,(function(ignore,v){if(align)return xss[align.toLowerCase()][v];var xs=lodash_1$1.sortBy(lodash_1$1.map(xss,v));return(xs[1]+xs[2])/2}))}var positionX$1=bk_positionX,position_1=function position$1(g){(function positionY(g){var layering=util$1.buildLayerMatrix(g),rankSep=g.graph().ranksep,prevY=0;lodash_1$1.forEach(layering,(function(layer){var maxHeight=lodash_1$1.max(lodash_1$1.map(layer,(function(v){return g.node(v).height})));lodash_1$1.forEach(layer,(function(v){g.node(v).y=prevY+maxHeight/2})),prevY+=maxHeight+rankSep}))})(g=util$1.asNonCompoundGraph(g)),lodash_1$1.forEach(positionX$1(g),(function(x,v){g.node(v).x=x}))};var normalizeRanks$1=util$1.normalizeRanks,removeEmptyRanks$1=util$1.removeEmptyRanks,util$3=util$1,Graph$7=graphlib_1.Graph,layout_1=function layout$2(g,opts){var time=opts&&opts.debugTiming?util$3.time:util$3.notime;time("layout",(function(){var layoutGraph=time("  buildLayoutGraph",(function(){return function buildLayoutGraph(inputGraph){var g=new Graph$7({multigraph:!0,compound:!0}),graph=canonicalize(inputGraph.graph());return g.setGraph(lodash_1$1.merge({},graphDefaults,selectNumberAttrs(graph,graphNumAttrs),lodash_1$1.pick(graph,graphAttrs))),lodash_1$1.forEach(inputGraph.nodes(),(function(v){var node=canonicalize(inputGraph.node(v));g.setNode(v,lodash_1$1.defaults(selectNumberAttrs(node,nodeNumAttrs),nodeDefaults)),g.setParent(v,inputGraph.parent(v))})),lodash_1$1.forEach(inputGraph.edges(),(function(e){var edge=canonicalize(inputGraph.edge(e));g.setEdge(e,lodash_1$1.merge({},edgeDefaults,selectNumberAttrs(edge,edgeNumAttrs),lodash_1$1.pick(edge,edgeAttrs)))})),g}(g)}));time("  runLayout",(function(){!function runLayout(g,time){time("    makeSpaceForEdgeLabels",(function(){!function makeSpaceForEdgeLabels(g){var graph=g.graph();graph.ranksep/=2,lodash_1$1.forEach(g.edges(),(function(e){var edge=g.edge(e);edge.minlen*=2,"c"!==edge.labelpos.toLowerCase()&&("TB"===graph.rankdir||"BT"===graph.rankdir?edge.width+=edge.labeloffset:edge.height+=edge.labeloffset)}))}(g)})),time("    removeSelfEdges",(function(){!function removeSelfEdges(g){lodash_1$1.forEach(g.edges(),(function(e){if(e.v===e.w){var node=g.node(e.v);node.selfEdges||(node.selfEdges=[]),node.selfEdges.push({e:e,label:g.edge(e)}),g.removeEdge(e)}}))}(g)})),time("    acyclic",(function(){acyclic.run(g)})),time("    nestingGraph.run",(function(){nestingGraph.run(g)})),time("    rank",(function(){rank_1(util$3.asNonCompoundGraph(g))})),time("    injectEdgeLabelProxies",(function(){!function injectEdgeLabelProxies(g){lodash_1$1.forEach(g.edges(),(function(e){var edge=g.edge(e);if(edge.width&&edge.height){var v=g.node(e.v),label={rank:(g.node(e.w).rank-v.rank)/2+v.rank,e:e};util$3.addDummyNode(g,"edge-proxy",label,"_ep")}}))}(g)})),time("    removeEmptyRanks",(function(){removeEmptyRanks$1(g)})),time("    nestingGraph.cleanup",(function(){nestingGraph.cleanup(g)})),time("    normalizeRanks",(function(){normalizeRanks$1(g)})),time("    assignRankMinMax",(function(){!function assignRankMinMax(g){var maxRank=0;lodash_1$1.forEach(g.nodes(),(function(v){var node=g.node(v);node.borderTop&&(node.minRank=g.node(node.borderTop).rank,node.maxRank=g.node(node.borderBottom).rank,maxRank=lodash_1$1.max(maxRank,node.maxRank))})),g.graph().maxRank=maxRank}(g)})),time("    removeEdgeLabelProxies",(function(){!function removeEdgeLabelProxies(g){lodash_1$1.forEach(g.nodes(),(function(v){var node=g.node(v);"edge-proxy"===node.dummy&&(g.edge(node.e).labelRank=node.rank,g.removeNode(v))}))}(g)})),time("    normalize.run",(function(){normalize$1.run(g)})),time("    parentDummyChains",(function(){parentDummyChains_1(g)})),time("    addBorderSegments",(function(){addBorderSegments_1(g)})),time("    order",(function(){order_1(g)})),time("    insertSelfEdges",(function(){!function insertSelfEdges(g){var layers=util$3.buildLayerMatrix(g);lodash_1$1.forEach(layers,(function(layer){var orderShift=0;lodash_1$1.forEach(layer,(function(v,i){var node=g.node(v);node.order=i+orderShift,lodash_1$1.forEach(node.selfEdges,(function(selfEdge){util$3.addDummyNode(g,"selfedge",{width:selfEdge.label.width,height:selfEdge.label.height,rank:node.rank,order:i+ ++orderShift,e:selfEdge.e,label:selfEdge.label},"_se")})),delete node.selfEdges}))}))}(g)})),time("    adjustCoordinateSystem",(function(){coordinateSystem.adjust(g)})),time("    position",(function(){position_1(g)})),time("    positionSelfEdges",(function(){!function positionSelfEdges(g){lodash_1$1.forEach(g.nodes(),(function(v){var node=g.node(v);if("selfedge"===node.dummy){var selfNode=g.node(node.e.v),x=selfNode.x+selfNode.width/2,y=selfNode.y,dx=node.x-x,dy=selfNode.height/2;g.setEdge(node.e,node.label),g.removeNode(v),node.label.points=[{x:x+2*dx/3,y:y-dy},{x:x+5*dx/6,y:y-dy},{x:x+dx,y:y},{x:x+5*dx/6,y:y+dy},{x:x+2*dx/3,y:y+dy}],node.label.x=node.x,node.label.y=node.y}}))}(g)})),time("    removeBorderNodes",(function(){!function removeBorderNodes(g){lodash_1$1.forEach(g.nodes(),(function(v){if(g.children(v).length){var node=g.node(v),t=g.node(node.borderTop),b=g.node(node.borderBottom),l=g.node(lodash_1$1.last(node.borderLeft)),r=g.node(lodash_1$1.last(node.borderRight));node.width=Math.abs(r.x-l.x),node.height=Math.abs(b.y-t.y),node.x=l.x+node.width/2,node.y=t.y+node.height/2}})),lodash_1$1.forEach(g.nodes(),(function(v){"border"===g.node(v).dummy&&g.removeNode(v)}))}(g)})),time("    normalize.undo",(function(){normalize$1.undo(g)})),time("    fixupEdgeLabelCoords",(function(){!function fixupEdgeLabelCoords(g){lodash_1$1.forEach(g.edges(),(function(e){var edge=g.edge(e);if(lodash_1$1.has(edge,"x"))switch("l"!==edge.labelpos&&"r"!==edge.labelpos||(edge.width-=edge.labeloffset),edge.labelpos){case"l":edge.x-=edge.width/2+edge.labeloffset;break;case"r":edge.x+=edge.width/2+edge.labeloffset}}))}(g)})),time("    undoCoordinateSystem",(function(){coordinateSystem.undo(g)})),time("    translateGraph",(function(){!function translateGraph(g){var minX=Number.POSITIVE_INFINITY,maxX=0,minY=Number.POSITIVE_INFINITY,maxY=0,graphLabel=g.graph(),marginX=graphLabel.marginx||0,marginY=graphLabel.marginy||0;function getExtremes(attrs){var x=attrs.x,y=attrs.y,w=attrs.width,h=attrs.height;minX=Math.min(minX,x-w/2),maxX=Math.max(maxX,x+w/2),minY=Math.min(minY,y-h/2),maxY=Math.max(maxY,y+h/2)}lodash_1$1.forEach(g.nodes(),(function(v){getExtremes(g.node(v))})),lodash_1$1.forEach(g.edges(),(function(e){var edge=g.edge(e);lodash_1$1.has(edge,"x")&&getExtremes(edge)})),minX-=marginX,minY-=marginY,lodash_1$1.forEach(g.nodes(),(function(v){var node=g.node(v);node.x-=minX,node.y-=minY})),lodash_1$1.forEach(g.edges(),(function(e){var edge=g.edge(e);lodash_1$1.forEach(edge.points,(function(p){p.x-=minX,p.y-=minY})),lodash_1$1.has(edge,"x")&&(edge.x-=minX),lodash_1$1.has(edge,"y")&&(edge.y-=minY)})),graphLabel.width=maxX-minX+marginX,graphLabel.height=maxY-minY+marginY}(g)})),time("    assignNodeIntersects",(function(){!function assignNodeIntersects(g){lodash_1$1.forEach(g.edges(),(function(e){var p1,p2,edge=g.edge(e),nodeV=g.node(e.v),nodeW=g.node(e.w);edge.points?(p1=edge.points[0],p2=edge.points[edge.points.length-1]):(edge.points=[],p1=nodeW,p2=nodeV),edge.points.unshift(util$3.intersectRect(nodeV,p1)),edge.points.push(util$3.intersectRect(nodeW,p2))}))}(g)})),time("    reversePoints",(function(){!function reversePointsForReversedEdges(g){lodash_1$1.forEach(g.edges(),(function(e){var edge=g.edge(e);edge.reversed&&edge.points.reverse()}))}(g)})),time("    acyclic.undo",(function(){acyclic.undo(g)}))}(layoutGraph,time)})),time("  updateInputGraph",(function(){!function updateInputGraph(inputGraph,layoutGraph){lodash_1$1.forEach(inputGraph.nodes(),(function(v){var inputLabel=inputGraph.node(v),layoutLabel=layoutGraph.node(v);inputLabel&&(inputLabel.x=layoutLabel.x,inputLabel.y=layoutLabel.y,layoutGraph.children(v).length&&(inputLabel.width=layoutLabel.width,inputLabel.height=layoutLabel.height))})),lodash_1$1.forEach(inputGraph.edges(),(function(e){var inputLabel=inputGraph.edge(e),layoutLabel=layoutGraph.edge(e);inputLabel.points=layoutLabel.points,lodash_1$1.has(layoutLabel,"x")&&(inputLabel.x=layoutLabel.x,inputLabel.y=layoutLabel.y)})),inputGraph.graph().width=layoutGraph.graph().width,inputGraph.graph().height=layoutGraph.graph().height}(g,layoutGraph)}))}))};var graphNumAttrs=["nodesep","edgesep","ranksep","marginx","marginy"],graphDefaults={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},graphAttrs=["acyclicer","ranker","rankdir","align"],nodeNumAttrs=["width","height"],nodeDefaults={width:0,height:0},edgeNumAttrs=["minlen","weight","width","height","labeloffset"],edgeDefaults={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},edgeAttrs=["labelpos"];function selectNumberAttrs(obj,attrs){return lodash_1$1.mapValues(lodash_1$1.pick(obj,attrs),Number)}function canonicalize(attrs){var newAttrs={};return lodash_1$1.forEach(attrs,(function(v,k){newAttrs[k.toLowerCase()]=v})),newAttrs}var Graph$8=graphlib_1.Graph;var dagre={graphlib:graphlib_1,layout:layout_1,debug:{debugOrdering:function debugOrdering(g){var layerMatrix=util$1.buildLayerMatrix(g),h=new Graph$8({compound:!0,multigraph:!0}).setGraph({});return lodash_1$1.forEach(g.nodes(),(function(v){h.setNode(v,{label:v}),h.setParent(v,"layer"+g.node(v).rank)})),lodash_1$1.forEach(g.edges(),(function(e){h.setEdge(e.v,e.w,{},e.name)})),lodash_1$1.forEach(layerMatrix,(function(layer,i){var layerV="layer"+i;h.setNode(layerV,{rank:"same"}),lodash_1$1.reduce(layer,(function(u,v){return h.setEdge(u,v,{style:"invis"}),v}))})),h}},util:{time:util$1.time,notime:util$1.notime},version:"0.8.5"},cytoscapeDagre=createCommonjsModule((function(module,exports){!function webpackUniversalModuleDefinition(root,factory){module.exports=factory(dagre)}(0,(function(__WEBPACK_EXTERNAL_MODULE__4__){return function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}return __webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{enumerable:!0,get:getter})},__webpack_require__.r=function(exports){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(exports,"__esModule",{value:!0})},__webpack_require__.t=function(value,mode){if(1&mode&&(value=__webpack_require__(value)),8&mode)return value;if(4&mode&&"object"===_typeof2(value)&&value&&value.__esModule)return value;var ns=Object.create(null);if(__webpack_require__.r(ns),Object.defineProperty(ns,"default",{enumerable:!0,value:value}),2&mode&&"string"!=typeof value)for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key]}.bind(null,key));return ns},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module.default}:function getModuleExports(){return module};return __webpack_require__.d(getter,"a",getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=0)}([function(module,exports,__webpack_require__){var impl=__webpack_require__(1),register=function register(cytoscape){cytoscape&&cytoscape("layout","dagre",impl)};"undefined"!=typeof cytoscape&&register(cytoscape),module.exports=register},function(module,exports,__webpack_require__){function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}var defaults=__webpack_require__(2),assign=__webpack_require__(3),dagre=__webpack_require__(4);function DagreLayout(options){this.options=assign({},defaults,options)}DagreLayout.prototype.run=function(){var options=this.options,cy=options.cy,eles=options.eles,getVal=function getVal(ele,val){return function isFunction(o){return"function"==typeof o}(val)?val.apply(ele,[ele]):val},bb=options.boundingBox||{x1:0,y1:0,w:cy.width(),h:cy.height()};void 0===bb.x2&&(bb.x2=bb.x1+bb.w),void 0===bb.w&&(bb.w=bb.x2-bb.x1),void 0===bb.y2&&(bb.y2=bb.y1+bb.h),void 0===bb.h&&(bb.h=bb.y2-bb.y1);var g=new dagre.graphlib.Graph({multigraph:!0,compound:!0}),gObj={},setGObj=function setGObj(name,val){null!=val&&(gObj[name]=val)};setGObj("nodesep",options.nodeSep),setGObj("edgesep",options.edgeSep),setGObj("ranksep",options.rankSep),setGObj("rankdir",options.rankDir),setGObj("ranker",options.ranker),g.setGraph(gObj),g.setDefaultEdgeLabel((function(){return{}})),g.setDefaultNodeLabel((function(){return{}}));for(var nodes=eles.nodes(),i=0;i<nodes.length;i++){var node=nodes[i],nbb=node.layoutDimensions(options);g.setNode(node.id(),{width:nbb.w,height:nbb.h,name:node.id()})}for(var _i=0;_i<nodes.length;_i++){var _node=nodes[_i];_node.isChild()&&g.setParent(_node.id(),_node.parent().id())}for(var edges=eles.edges().stdFilter((function(edge){return!edge.source().isParent()&&!edge.target().isParent()})),_i2=0;_i2<edges.length;_i2++){var edge=edges[_i2];g.setEdge(edge.source().id(),edge.target().id(),{minlen:getVal(edge,options.minLen),weight:getVal(edge,options.edgeWeight),name:edge.id()},edge.id())}dagre.layout(g);for(var dagreBB,gNodeIds=g.nodes(),_i3=0;_i3<gNodeIds.length;_i3++){var id=gNodeIds[_i3],n=g.node(id);cy.getElementById(id).scratch().dagre=n}options.boundingBox?(dagreBB={x1:1/0,x2:-1/0,y1:1/0,y2:-1/0},nodes.forEach((function(node){var dModel=node.scratch().dagre;dagreBB.x1=Math.min(dagreBB.x1,dModel.x),dagreBB.x2=Math.max(dagreBB.x2,dModel.x),dagreBB.y1=Math.min(dagreBB.y1,dModel.y),dagreBB.y2=Math.max(dagreBB.y2,dModel.y)})),dagreBB.w=dagreBB.x2-dagreBB.x1,dagreBB.h=dagreBB.y2-dagreBB.y1):dagreBB=bb;return nodes.layoutPositions(this,options,(function(ele){var dModel=(ele="object"===_typeof(ele)?ele:this).scratch().dagre;return function constrainPos(p){if(options.boundingBox){var xPct=0===dagreBB.w?0:(p.x-dagreBB.x1)/dagreBB.w,yPct=0===dagreBB.h?0:(p.y-dagreBB.y1)/dagreBB.h;return{x:bb.x1+xPct*bb.w,y:bb.y1+yPct*bb.h}}return p}({x:dModel.x,y:dModel.y})})),this},module.exports=DagreLayout},function(module,exports){var defaults={nodeSep:void 0,edgeSep:void 0,rankSep:void 0,rankDir:void 0,ranker:void 0,minLen:function minLen(edge){return 1},edgeWeight:function edgeWeight(edge){return 1},fit:!0,padding:30,spacingFactor:void 0,nodeDimensionsIncludeLabels:!1,animate:!1,animateFilter:function animateFilter(node,i){return!0},animationDuration:500,animationEasing:void 0,boundingBox:void 0,transform:function transform(node,pos){return pos},ready:function ready(){},stop:function stop(){}};module.exports=defaults},function(module,exports){module.exports=null!=Object.assign?Object.assign.bind(Object):function(tgt){for(var _len=arguments.length,srcs=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)srcs[_key-1]=arguments[_key];return srcs.forEach((function(src){Object.keys(src).forEach((function(k){return tgt[k]=src[k]}))})),tgt}},function(module,exports){module.exports=__WEBPACK_EXTERNAL_MODULE__4__}])}))}));cytoscape_cjs.use(cytoscapeDagre);var SourceChain=function(_PlaygroundElement10){_inherits(SourceChain,_PlaygroundElement10);var _super16=_createSuper(SourceChain);function SourceChain(){var _this37;return _classCallCheck2(this,SourceChain),(_this37=_super16.apply(this,arguments)).nodes=[],_this37}return _createClass2(SourceChain,[{key:"activeCell",get:function get(){return selectCell(this.activeDna,this.activeAgentPubKey,this.conductors)}},{key:"firstUpdated",value:function firstUpdated(){var _this38=this;window.addEventListener("scroll",(function(){_this38.cy.resize()})),this.cy=cytoscape_cjs({container:this.graph,layout:{name:"dagre"},autoungrabify:!0,userZoomingEnabled:!0,userPanningEnabled:!0,style:"\n        node {\n          width: 30px;\n          height: 30px;\n          font-size: 10px;\n          label: data(label);\n          background-color: grey;\n          text-halign: right;\n          text-valign: center;\n          text-margin-x: 4px;\n        }\n\n        .header {\n          text-margin-x: -5px;\n          text-halign: left;\n          shape: round-rectangle;\n        }\n\n        edge {\n          width: 4;\n          target-arrow-shape: triangle;\n          curve-style: bezier;\n          line-style: dotted;\n        }\n\n        .selected {\n          border-width: 4px;\n          border-color: black;\n          border-style: solid;\n        }\n\n        .Dna {\n          background-color: green;\n        }\n        .AgentValidationPkg {\n          background-color: lime;\n        }\n        .Create {\n          background-color: blue;\n        }\n        .Delete {\n          background-color: red;\n        }\n        .Update {\n          background-color: cyan;\n        }\n        .CreateLink {\n          background-color: purple;\n        }\n        .DeleteLink {\n          background-color: purple;\n        }\n      "}),this.cy.on("tap","node",(function(event){var activeHash=event.target.id();activeHash.includes(":")&&(activeHash=activeHash.split(":")[1]),_this38.updatePlayground({activeHash:activeHash})}));var rendered=!1;this.cy.on("render",(function(){0!==_this38.cy.width()&&(rendered||(rendered=!0,setTimeout((function(){_this38.setupGraph()}))))})),this.requestUpdate()}},{key:"observedCells",value:function observedCells(){return[this.activeCell]}},{key:"setupGraph",value:function setupGraph(){this.cy.remove("node"),this.cy.add(this.nodes);var tipNodes=this.nodes.slice(0,7);this.cy.fit(tipNodes),this.cy.center(tipNodes),this.cy.resize(),this.cy.layout({name:"dagre"}).run()}},{key:"updated",value:function updated(changedValues){_get(_getPrototypeOf(SourceChain.prototype),"updated",this).call(this,changedValues);var nodes=function sourceChainNodes(cell){if(!cell)return[];var _step15,nodes=[],state=cell.getState(),headersHashes=state.sourceChain,_iterator14=_createForOfIteratorHelper(headersHashes);try{for(_iterator14.s();!(_step15=_iterator14.n()).done;){var headerHash=_step15.value,header=state.CAS[headerHash];if(nodes.push({data:{id:headerHash,data:header,label:header.header.content.type},classes:["header",header.header.content.type]}),header.header.content.prev_header){var previousHeaderHash=header.header.content.prev_header;nodes.push({data:{id:"".concat(headerHash,"->").concat(previousHeaderHash),source:headerHash,target:previousHeaderHash}})}}}catch(err){_iterator14.e(err)}finally{_iterator14.f()}var _step16,_iterator15=_createForOfIteratorHelper(headersHashes);try{for(_iterator15.s();!(_step16=_iterator15.n()).done;){var strHeaderHash=_step16.value,_header=state.CAS[strHeaderHash];if(_header.header.content.entry_hash){var newEntryHeader=_header.header.content,entryHash=newEntryHeader.entry_hash,entryNodeId="".concat(strHeaderHash,":").concat(entryHash),entry=state.CAS[entryHash],entryType=Object(_holochain_playground_core__WEBPACK_IMPORTED_MODULE_104__.k)(cell,newEntryHeader.entry_type);nodes.push({data:{id:entryNodeId,data:entry,label:entryType},classes:[entryType]}),nodes.push({data:{id:"".concat(strHeaderHash,"->").concat(entryNodeId),source:strHeaderHash,target:entryNodeId}})}}}catch(err){_iterator15.e(err)}finally{_iterator15.f()}return nodes}(this.activeCell);if(Object(lodash_es__WEBPACK_IMPORTED_MODULE_125__.a)(nodes,this.nodes)||(this.nodes=nodes,this.setupGraph()),changedValues.has("activeHash")){this.cy.filter("node").removeClass("selected");var _step24,_iterator23=_createForOfIteratorHelper(this.cy.nodes());try{for(_iterator23.s();!(_step24=_iterator23.n()).done;){var nodeElement=_step24.value,nodeId=nodeElement.id();(nodeId===this.activeHash||nodeId.includes(":".concat(this.activeHash)))&&nodeElement.addClass("selected")}}catch(err){_iterator23.e(err)}finally{_iterator23.f()}}}},{key:"renderHelp",value:function renderHelp(){return Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject91||(_templateObject91=_taggedTemplateLiteral([' <holochain-playground-help-button\n      heading="Source-Chain"\n      class="block-help"\n    >\n      <span>\n        This graph displays the source chain of the selected cell. On the\n        top-left sequence, you can see the hash-chain of headers. On the\n        bottom-right sequence, you can see the entries associated with each\n        header. Links between headers\n        <br />\n        <br />\n        Dashed relationships are embedded references: the headers contain the\n        hash of the last header, and also the entry hash if they have an entry.\n      </span>\n    </holochain-playground-help-button>'])))}},{key:"render",value:function render(){return Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject92||(_templateObject92=_taggedTemplateLiteral(['\n      <mwc-card class="block-card">\n        <div class="column fill">\n          <span class="block-title" style="margin: 16px;">Source chain</span>\n          ',"\n          ","\n\n          <div\n            style=",'\n            class="fill"\n            id="source-chain-graph"\n          ></div>\n        </div>\n      </mwc-card>\n    '])),this.renderHelp(),this.activeCell?Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject93||(_templateObject93=_taggedTemplateLiteral([""]))):Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.e)(_templateObject94||(_templateObject94=_taggedTemplateLiteral(['\n                <div style="flex: 1;" class="center-content placeholder">\n                  <span>Select a cell to display its source chain</span>\n                </div>\n              ']))),Object(lit_html_directives_style_map__WEBPACK_IMPORTED_MODULE_108__.a)({display:this.activeCell?"":"none"}))}}],[{key:"styles",get:function get(){return[sharedStyles,Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.b)(_templateObject95||(_templateObject95=_taggedTemplateLiteral(["\n        :host {\n          display: flex;\n        }\n        #source-chain-graph {\n          width: 100%;\n          height: 100%;\n        }\n      "])))]}},{key:"scopedElements",get:function get(){return{"mwc-card":scoped_material_components_mwc_card__WEBPACK_IMPORTED_MODULE_111__.a,"holochain-playground-help-button":HelpButton}}}]),SourceChain}(PlaygroundElement);__decorate([Object(lit_element__WEBPACK_IMPORTED_MODULE_102__.h)("#source-chain-graph"),__metadata("design:type",HTMLElement)],SourceChain.prototype,"graph",void 0)}).call(this,__webpack_require__(77),__webpack_require__(479).setImmediate)},586:function(module){module.exports=JSON.parse('{"version":"experimental","tags":[{"name":"json-viewer","path":"./dist/index.js","description":"Custom Element that shows a JavaScript object\'s properties as syntax-highlighted JSON.\\n\\nThe element will respect `prefers-color-scheme` by default, but if you use the\\nCSS Custom Properties listed below, you should customize both light and dark themes.\\n\\n❤️ Proudly uses [open-wc](https://open-wc.org) tools and recommendations.","attributes":[{"name":"object","description":"JavaScript Object to display\\nSetting this property will override `<script type=\\"application/json\\">` children","type":"string|object"},{"name":"allowlist","description":"User-defined allowlist of top-level keys for the object.\\nOptional for plain objects,\\nRequired when setting `object` to a non-serializable object (e.g. an HTMLElement)\\nProperty is an Array of strings\\nAttribute is a comma-separated string","type":"string[]"}],"properties":[{"name":"object","attribute":"object","description":"JavaScript Object to display\\nSetting this property will override `<script type=\\"application/json\\">` children","type":"string|object"},{"name":"allowlist","attribute":"allowlist","description":"User-defined allowlist of top-level keys for the object.\\nOptional for plain objects,\\nRequired when setting `object` to a non-serializable object (e.g. an HTMLElement)\\nProperty is an Array of strings\\nAttribute is a comma-separated string","type":"string[]"},{"name":"error","description":"JSON.parse error","type":"Error"},{"name":"floatingLabelFoundation","type":"MDCFloatingLabelFoundation | undefined"},{"name":"lineRippleFoundation","type":"MDCLineRippleFoundation | undefined"}],"events":[{"name":"json-parse-error","description":"when JSON parse fails"}],"slots":[{"name":"","description":"JSON scripts or JSON strings appended as text nodes will be parsed and displayed"}],"cssProperties":[{"name":"--json-viewer-color","description":"Color for generic text. Light white, Dark #212121"},{"name":"--json-viewer-background","description":"Color for generic text. Light #212121, Dark white"},{"name":"--json-viewer-key-color","description":"Color for keys. Light #f76707, Dark #ff922b"},{"name":"--json-viewer-boolean-color","description":"Color for booleans. Light #f76707, Dark #22b8cf"},{"name":"--json-viewer-number-color","description":"Color for numbers. Light #0ca678, Dark #51cf66"},{"name":"--json-viewer-null-color","description":"Color for nulls. Light #e03131, Dark #ff6b6b"},{"name":"--json-viewer-string-color","description":"Color for strings. Light #0c8599, Dark #22b8cf"}]},{"name":"dht-cells","path":"./src/elements/dht-cells/index.ts","attributes":[{"name":"animationDelay","type":"number","default":"2000"},{"name":"workflowsToDisplay","type":"WorkflowType[]","default":"[\\"Call Zome Function\\",\\"App Validation\\"]"},{"name":"networkRequestsToDisplay","type":"NetworkRequestType[]","default":"[\\"Publish Request\\",\\"Call Remote\\"]"},{"name":"hide-time-controller","type":"boolean","default":"false"},{"name":"step-by-step","type":"boolean","default":"false"},{"name":"activeDna","description":"Context variables","type":"string | undefined"},{"name":"activeAgentPubKey","type":"string | undefined"},{"name":"activeHash","type":"string | undefined"},{"name":"conductors","type":"Conductor[]","default":"[]"},{"name":"conductorsUrls","type":"string[] | undefined"}],"properties":[{"name":"animationDelay","attribute":"animationDelay","type":"number","default":"2000"},{"name":"workflowsToDisplay","attribute":"workflowsToDisplay","type":"WorkflowType[]","default":"[\\"Call Zome Function\\",\\"App Validation\\"]"},{"name":"networkRequestsToDisplay","attribute":"networkRequestsToDisplay","type":"NetworkRequestType[]","default":"[\\"Publish Request\\",\\"Call Remote\\"]"},{"name":"hideTimeController","attribute":"hide-time-controller","type":"boolean","default":"false"},{"name":"stepByStep","attribute":"step-by-step","type":"boolean","default":"false"},{"name":"activeDna","attribute":"activeDna","description":"Context variables","type":"string | undefined"},{"name":"activeAgentPubKey","attribute":"activeAgentPubKey","type":"string | undefined"},{"name":"activeHash","attribute":"activeHash","type":"string | undefined"},{"name":"conductors","attribute":"conductors","type":"Conductor[]","default":"[]"},{"name":"conductorsUrls","attribute":"conductorsUrls","type":"string[] | undefined"}],"events":[{"name":"show-message"},{"name":"update-context"}]},{"name":"holochain-playground-container","path":"./stories/dht-graph.stories.js","properties":[{"name":"numberOfSimulatedConductors","type":"number"},{"name":"simulatedDnaTemplate","type":"SimulatedDnaTemplate"},{"name":"activeDna","description":"Context variables","type":"string | undefined"},{"name":"activeAgentPubKey","type":"string | undefined"},{"name":"activeHash","type":"string | undefined"},{"name":"conductors","type":"Conductor[]"},{"name":"conductorsUrls","type":"string[] | undefined"}]},{"name":"dht-cells","path":"./stories/dht-graph.stories.js","properties":[{"name":"animationDelay","type":"number"},{"name":"workflowsToDisplay","type":"WorkflowType[]"},{"name":"networkRequestsToDisplay","type":"NetworkRequestType[]"},{"name":"hideTimeController","type":"boolean"},{"name":"stepByStep","type":"boolean"}]}]}')},597:function(module,exports,__webpack_require__){__webpack_require__(598),__webpack_require__(758),__webpack_require__(759),__webpack_require__(913),__webpack_require__(1131),__webpack_require__(1134),__webpack_require__(1139),__webpack_require__(1151),__webpack_require__(1153),__webpack_require__(1158),__webpack_require__(1160),module.exports=__webpack_require__(1214)},671:function(module,exports){},759:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__(249)}},[[597,1,2]]]);
//# sourceMappingURL=main.6992514120066dd7bd3c.bundle.js.map